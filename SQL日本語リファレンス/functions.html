<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第 12 章 関数と演算子</title><link rel="stylesheet" type="text/css" href="mvl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="MySQL 5.6 リファレンスマニュアル"><link rel="up" href="index.html" title="MySQL 5.6 リファレンスマニュアル"><link rel="prev" href="data-types.html" title="第 11 章 データ型"><link rel="next" href="sql-syntax.html" title="第 13 章 SQL ステートメントの構文">
<script language="javascript" type="text/javascript">
  function addOnload(theFunc)
  {
    var previous = window.onload;
    if (typeof window.onload != 'function')
    {
      window.onload = theFunc;
    }
    else
    {
      window.onload = function()
      {
        previous();
        theFunc();
      }
    }
  }

  addOnload(function()
  {
    var base = new Date(1442918127*1000);
    var now = new Date();
    var diff = ((now-base)/1000)/(24*3600);

    if (diff > 90) {
      var nodes = document.getElementsByClassName('titlepage');
      nodes[0].innerHTML = '<p style="border: 5px #ff0000 solid; padding: 5px; margin 5px">' +
        'This copy of the manual is more than 90 days old. We encourage you to download a ' +
        'new version from <a href="http://dev.mysql.com">dev.mysql.com/doc</a>.</p>' + nodes[0].innerHTML;
    }
  });
</script>
<noscript></noscript>
</head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 12 章 関数と演算子</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="data-types.html">前</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="sql-syntax.html">次へ</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="functions"></a>第 12 章 関数と演算子</h1></div></div></div><div class="toc"><p><b>目次</b></p><dl class="toc"><dt><span class="section"><a href="functions.html#func-op-summary-ref">12.1 関数と演算子のリファレンス</a></span></dt><dt><span class="section"><a href="functions.html#type-conversion">12.2 式評価での型変換</a></span></dt><dt><span class="section"><a href="functions.html#non-typed-operators">12.3 演算子</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#operator-precedence">12.3.1 演算子の優先順位</a></span></dt><dt><span class="section"><a href="functions.html#comparison-operators">12.3.2 比較関数と演算子</a></span></dt><dt><span class="section"><a href="functions.html#logical-operators">12.3.3 論理演算子</a></span></dt><dt><span class="section"><a href="functions.html#assignment-operators">12.3.4 割り当て演算子</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#control-flow-functions">12.4 制御フロー関数</a></span></dt><dt><span class="section"><a href="functions.html#string-functions">12.5 文字列関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#string-comparison-functions">12.5.1 文字列比較関数</a></span></dt><dt><span class="section"><a href="functions.html#regexp">12.5.2 正規表現</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#numeric-functions">12.6 数値関数と演算子</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#arithmetic-functions">12.6.1 算術演算子</a></span></dt><dt><span class="section"><a href="functions.html#mathematical-functions">12.6.2 数学関数</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#date-and-time-functions">12.7 日付および時間関数</a></span></dt><dt><span class="section"><a href="functions.html#mysql-calendar">12.8 MySQL で使用されるカレンダー</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search">12.9 全文検索関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#fulltext-natural-language">12.9.1 自然言語全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-boolean">12.9.2 ブール全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-query-expansion">12.9.3 クエリー拡張を使用した全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-stopwords">12.9.4 全文ストップワード</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-restrictions">12.9.5 全文制限</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-fine-tuning">12.9.6 MySQL の全文検索の微調整</a></span></dt><dt><span class="section"><a href="functions.html#full-text-adding-collation">12.9.7 全文インデックス作成用の照合順序の追加</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#cast-functions">12.10 キャスト関数と演算子</a></span></dt><dt><span class="section"><a href="functions.html#xml-functions">12.11 XML 関数</a></span></dt><dt><span class="section"><a href="functions.html#bit-functions">12.12 ビット関数</a></span></dt><dt><span class="section"><a href="functions.html#encryption-functions">12.13 暗号化関数と圧縮関数</a></span></dt><dt><span class="section"><a href="functions.html#information-functions">12.14 情報関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-analysis-functions">12.15 空間分析関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#spatial-function-reference">12.15.1 空間関数のリファレンス</a></span></dt><dt><span class="section"><a href="functions.html#spatial-function-argument-handling">12.15.2 空間関数による引数処理</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkt-functions">12.15.3 WKT 値から幾何値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkb-functions">12.15.4 WKB 値から幾何値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-mysql-specific-functions">12.15.5 幾何値を作成する MySQL 固有の関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-format-conversion-functions">12.15.6 幾何形式変換関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-property-functions">12.15.7 幾何プロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-operator-functions">12.15.8 空間演算子関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions">12.15.9 幾何オブジェクト間の空間関係をテストする関数</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#gtid-functions">12.16 グローバルトランザクション ID とともに使用される関数</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption">12.17 MySQL Enterprise Encryption の関数</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#enterprise-encryption-installation">12.17.1 Enterprise Encryption のインストール</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-usage">12.17.2 Enterprise Encryption の使用法と例</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-function-reference">12.17.3 Enterprise Encryption 関数のリファレンス</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-functions">12.17.4 Enterprise Encryption 関数の説明</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#miscellaneous-functions">12.18 その他の関数</a></span></dt><dt><span class="section"><a href="functions.html#group-by-functions-and-modifiers">12.19 GROUP BY 句で使用される関数と修飾子</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#group-by-functions">12.19.1 GROUP BY (集約) 関数</a></span></dt><dt><span class="section"><a href="functions.html#group-by-modifiers">12.19.2 GROUP BY 修飾子</a></span></dt><dt><span class="section"><a href="functions.html#group-by-handling">12.19.3 MySQL での GROUP BY の処理</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#precision-math">12.20 高精度計算</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#precision-math-numbers">12.20.1 数値の型</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-decimal-characteristics">12.20.2 DECIMAL データ型の特性</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-expressions">12.20.3 式の処理</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-rounding">12.20.4 丸め動作</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-examples">12.20.5 高精度計算の例</a></span></dt></dl></dd></dl></div><a class="indexterm" name="idm139979101236752"></a><a class="indexterm" name="idm139979101234544"></a><a class="indexterm" name="idm139979101233200"></a><p>
    <a class="link" href="glossary.html#glos_sql" title="SQL">SQL</a> ステートメントのいくつかのポイント (<code class="literal">SELECT</code> ステートメントの <code class="literal">ORDER BY</code> または <code class="literal">HAVING</code> 句、<code class="literal">SELECT</code>、<code class="literal">DELETE</code>、または <code class="literal">UPDATE</code> ステートメントの <code class="literal">WHERE</code> 句、<code class="literal">SET</code> ステートメントなど) では、式を使用できます。式は、リテラル値、カラム値、<code class="literal">NULL</code>、組み込み関数、ストアドファンクション、ユーザー定義関数、および演算子を使用して作成できます。この章では、MySQL で式を記述する際に許可されている関数および演算子について説明します。ストアドファンクションおよびユーザー定義関数を作成する手順については、<a class="xref" href="stored-programs-views.html#stored-routines" title="20.2 ストアドルーチン (プロシージャーと関数) の使用">セクション20.2「ストアドルーチン (プロシージャーと関数) の使用」</a>および<a class="xref" href="extending-mysql.html#adding-functions" title="24.3 MySQL への新しい関数の追加">セクション24.3「MySQL への新しい関数の追加」</a>で説明されています。各種の関数への参照をサーバーが解釈する方法を記述したルールについては、<a class="xref" href="language-structure.html#function-resolution" title="9.2.4 関数名の構文解析と解決">セクション9.2.4「関数名の構文解析と解決」</a>を参照してください。
  </p><p>
    <code class="literal">NULL</code> を含む式では、その関数または演算子に関するドキュメントで明記されていないかぎり、常に <code class="literal">NULL</code> 値が生成されます。
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
      デフォルトでは、関数名とそれに続く丸括弧の間には空白を入れることはできません。これは、MySQL パーサーが、関数呼び出しと、偶然に関数と同じ名前を持つテーブルまたはカラムへの参照を区別するのに役立ちます。ただし、関数の引数の前後にスペースを入れることは許可されています。
    </p></div><p>
    最初に <code class="option">--sql-mode=IGNORE_SPACE</code> オプションを付けると、関数名のあとの空白文字を受け入れるように MySQL サーバーに指示できます。(<a class="xref" href="server-administration.html#sql-mode" title="5.1.7 サーバー SQL モード">セクション5.1.7「サーバー SQL モード」</a>を参照してください。)各クライアントプログラムで <code class="literal">mysql_real_connect()</code> に <code class="literal">CLIENT_IGNORE_SPACE</code> オプションを使用すると、この動作をリクエストできます。どちらの場合でも、すべての関数名は予約語になります。
  </p><p>
    簡略化のため、この章で示すほとんどの例では、<span class="command"><strong>mysql</strong></span> プログラムからの出力が省略形で表示されています。例は次の書式で表示されません。
  </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong>
+-----------+
| mod(29,9) |
+-----------+
|         2 |
+-----------+
1 rows in set (0.00 sec)
</pre><p>
    代わりに、次の書式が使用されます。
  </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong>
        -&gt; 2
</pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="func-op-summary-ref"></a>12.1 関数と演算子のリファレンス</h2></div></div></div><div class="table"><a name="idm139979101204912"></a><p class="title"><b>表 12.1 関数/演算子</b></p><div class="table-contents"><table summary="関数/演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></td><td>
      絶対値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></td><td>
      アークコサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE()</code></a></td><td>
      日付値に時間値 (間隔) を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_addtime"><code class="literal">ADDTIME()</code></a></td><td>
      時間を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a></td><td>
      AES を使用して復号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a></td><td>
      AES を使用して暗号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></td><td>
      論理 AND
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_area"><code class="literal">Area()</code></a></td><td>
      Polygon または MultiPolygon 領域を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asbinary"><code class="literal">AsBinary()</code>, <code class="literal">AsWKB()</code></a></td><td>
      内部幾何形式から WKB に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a></td><td>
      左端の文字の数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></td><td>
      アークサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></td><td>
      (<code class="literal">SET</code>
      ステートメントの一部として、または
      <code class="literal">UPDATE</code> ステートメントの
      <code class="literal">SET</code> 句の一部として)
      値を割り当てます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></td><td>
      値を割り当てます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_astext"><code class="literal">AsText()</code>, <code class="literal">AsWKT()</code></a></td><td>
      内部幾何形式から WKT に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT()</code></a></td><td>
      秘密鍵または公開鍵を使用して暗号文を復号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE()</code></a></td><td>
      非対称鍵から対称鍵を導出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a></td><td>
      秘密鍵または公開鍵を使用してプレーンテキストを暗号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN()</code></a></td><td>
      ダイジェストから署名を生成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-verify"><code class="literal">ASYMMETRIC_VERIFY()</code></a></td><td>
      署名がダイジェストと一致することを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></td><td>
      2 つの引数のアークタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></td><td>
      アークタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a></td><td>
      引数の平均値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a></td><td>
      式を繰り返し実行します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></td><td>
      値が値の範囲内に含まれているかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bin"><code class="literal">BIN()</code></a></td><td>
      数値のバイナリ表現を含む文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></td><td>
      文字列をバイナリ文字列にキャストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a></td><td>
      ビット単位の And を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT()</code></a></td><td>
      設定されているビット数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-length"><code class="literal">BIT_LENGTH()</code></a></td><td>
      ビット単位で引数の長さを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a></td><td>
      ビット単位の OR を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a></td><td>
      ビット単位の XOR を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></td><td>
      ビット単位の AND
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></td><td>
      ビットを反転します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></td><td>
      ビット単位の OR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></td><td>
      ビット単位の XOR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_buffer"><code class="literal">Buffer()</code></a></td><td>
      幾何図形から指定された距離内にある点の幾何図形を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></td><td>
      CASE 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a></td><td>
      値を特定の型としてキャストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></td><td>
      引数以上のもっとも小さな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></td><td>
      引数以上のもっとも小さな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_centroid"><code class="literal">Centroid()</code></a></td><td>
      重心を Point として返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a></td><td>
      引数の文字数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a></td><td>
      渡された各整数の文字を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_character-length"><code class="literal">CHARACTER_LENGTH()</code></a></td><td>
      CHAR_LENGTH() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_charset"><code class="literal">CHARSET()</code></a></td><td>
      引数の文字セットを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE()</code></a></td><td>
      NULL 以外の最初の引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_coercibility"><code class="literal">COERCIBILITY()</code></a></td><td>
      文字列引数の照合順序強制性値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_collation"><code class="literal">COLLATION()</code></a></td><td>
      文字列引数の照合順序を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_compress"><code class="literal">COMPRESS()</code></a></td><td>
      バイナリ文字列として結果を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a></td><td>
      連結されたものをセパレータ付きで返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a></td><td>
      連結された文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a></td><td>
      接続のための接続 ID (スレッド ID) を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_contains"><code class="literal">Contains()</code></a></td><td>
      ある幾何図形に別の幾何図形が含まれているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></td><td>
      数値を異なる基数間で変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a></td><td>
      あるタイムゾーンから別のタイムゾーンに変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a></td><td>
      値を特定の型としてキャストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></td><td>
      コサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></td><td>
      コタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_count-distinct"><code class="literal">COUNT(DISTINCT)</code></a></td><td>
      異なる値のカウントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a></td><td>
      返された行数のカウントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></td><td>
      巡回冗長検査値を計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a></td><td>
      秘密鍵を作成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-pub-key"><code class="literal">CREATE_ASYMMETRIC_PUB_KEY()</code></a></td><td>
      公開鍵を作成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a></td><td>
      共有 DH シークレットを生成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_create-digest"><code class="literal">CREATE_DIGEST()</code></a></td><td>
      文字列からダイジェストを生成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_crosses"><code class="literal">Crosses()</code></a></td><td>
      ある幾何図形が別の幾何図形と交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a></td><td>
      現在の日付を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code>, <code class="literal">CURRENT_DATE</code></a></td><td>
      CURDATE() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME()</code>, <code class="literal">CURRENT_TIME</code></a></td><td>
      CURTIME() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP()</code>, <code class="literal">CURRENT_TIMESTAMP</code></a></td><td>
      NOW() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code>, <code class="literal">CURRENT_USER</code></a></td><td>
      認証済みユーザー名とホスト名
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME()</code></a></td><td>
      現在の時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a></td><td>
      デフォルト (現在) のデータベース名を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a></td><td>
      日付値に時間値 (間隔) を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a></td><td>
      日付を指定された書式に設定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a></td><td>
      日付から時間値 (間隔) を引きます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_date"><code class="literal">DATE()</code></a></td><td>
      日付または日付時間式の日付部分を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_datediff"><code class="literal">DATEDIFF()</code></a></td><td>
      2 つの日付の差を求めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_day"><code class="literal">DAY()</code></a></td><td>
      DAYOFMONTH() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dayname"><code class="literal">DAYNAME()</code></a></td><td>
      曜日の名前を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofmonth"><code class="literal">DAYOFMONTH()</code></a></td><td>
      月の日を返します (0 - 31)
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofweek"><code class="literal">DAYOFWEEK()</code></a></td><td>
      引数の曜日インデックスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofyear"><code class="literal">DAYOFYEAR()</code></a></td><td>
      年の日を返します (1 - 366)
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_decode"><code class="literal">DECODE()</code></a></td><td>
      ENCODE()
      を使用して暗号化された文字列をデコードします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_default"><code class="literal">DEFAULT()</code></a></td><td>
      テーブルカラムのデフォルト値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></td><td>
      ラジアンを角度に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_des-decrypt"><code class="literal">DES_DECRYPT()</code></a></td><td>
      文字列を復号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_des-encrypt"><code class="literal">DES_ENCRYPT()</code></a></td><td>
      文字列を暗号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dimension"><code class="literal">Dimension()</code></a></td><td>
      幾何図形の次元
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_disjoint"><code class="literal">Disjoint()</code></a></td><td>
      ある幾何図形が別の幾何図形から切り離されているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td><td>
      整数除算
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td><td>
      除算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a></td><td>
      インデックス番号位置の文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_encode"><code class="literal">ENCODE()</code></a></td><td>
      文字列をエンコードします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_encrypt"><code class="literal">ENCRYPT()</code></a></td><td>
      文字列を暗号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_endpoint"><code class="literal">EndPoint()</code></a></td><td>
      LineString の終点
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_envelope"><code class="literal">Envelope()</code></a></td><td>
      幾何図形の MBR を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a></td><td>
      NULL 安全等価演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></td><td>
      等価 (等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_equals"><code class="literal">Equals()</code></a></td><td>
      ある幾何図形が別の幾何図形に等しいかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></td><td>
      累乗します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_export-set"><code class="literal">EXPORT_SET()</code></a></td><td>
      値 bits 内の各ビットが設定されている場合は on
      文字列を取得し、各ビットが設定されていない場合には
      off 文字列を取得するように、文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_exteriorring"><code class="literal">ExteriorRing()</code></a></td><td>
      Polygon の外側のリングを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT()</code></a></td><td>
      日付の一部を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a></td><td>
      XPath 表記法を使用して、XML
      文字列から値を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a></td><td>
      後続の引数内で第 1 引数のインデックス (位置)
      を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_find-in-set"><code class="literal">FIND_IN_SET()</code></a></td><td>
      第 2 引数内で第 1
      引数のインデックス位置を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></td><td>
      引数以下のもっとも大きな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_format"><code class="literal">FORMAT()</code></a></td><td>
      指定された小数点以下桁数に書式設定された数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a></td><td>
      LIMIT 句付き SELECT で、LIMIT
      句がない場合に戻される可能性がある行の数です
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64()</code></a></td><td>
      base 64 文字列にデコードして結果を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_from-days"><code class="literal">FROM_DAYS()</code></a></td><td>
      日数を日付に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a></td><td>
      UNIX タイムスタンプを日付として書式設定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geomcollfromtext"><code class="literal">GeomCollFromText()</code>, <code class="literal">GeometryCollectionFromText()</code></a></td><td>
      WKT からジオメトリコレクションを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geomcollfromwkb"><code class="literal">GeomCollFromWKB()</code>, <code class="literal">GeometryCollectionFromWKB()</code></a></td><td>
      WKB からジオメトリコレクションを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a></td><td>
      幾何図形からジオメトリコレクションを構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geometryn"><code class="literal">GeometryN()</code></a></td><td>
      ジオメトリコレクションから N
      番目の幾何図形を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geometrytype"><code class="literal">GeometryType()</code></a></td><td>
      幾何型の名前を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geomfromtext"><code class="literal">GeomFromText()</code>, <code class="literal">GeometryFromText()</code></a></td><td>
      WKT から幾何図形を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geomfromwkb"><code class="literal">GeomFromWKB()</code></a></td><td>
      WKB から幾何図形を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT()</code></a></td><td>
      日付書式文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a></td><td>
      名前付きロックを取得します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_glength"><code class="literal">GLength()</code></a></td><td>
      LineString の長さを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></td><td>
      以上 (より多いか等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></td><td>
      右不等 (より多い) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a></td><td>
      最大の引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_group-concat"><code class="literal">GROUP_CONCAT()</code></a></td><td>
      連結された文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_gtid-subset"><code class="literal">GTID_SUBSET()</code></a></td><td>
      サブセット内のすべての GTID
      がセット内にもある場合は、true
      を返します。そうでない場合は、false
      を返します。
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_gtid-subtract"><code class="literal">GTID_SUBTRACT()</code></a></td><td>
      セット内の GTID
      のうち、サブセット内にないものをすべてを返します。
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a></td><td>
      10 進値または文字列値の 16 進表現を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_hour"><code class="literal">HOUR()</code></a></td><td>
      時を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a></td><td>
      If/else 構文
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL()</code></a></td><td>
      Null if/else 構文
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_in"><code class="literal">IN()</code></a></td><td>
      ある値が値セット内に含まれているかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a></td><td>
      IP アドレスの数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_inet-ntoa"><code class="literal">INET_NTOA()</code></a></td><td>
      数値から IP アドレスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a></td><td>
      IPv6 アドレスの数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA()</code></a></td><td>
      数値から IPv6 アドレスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_insert"><code class="literal">INSERT()</code></a></td><td>
      部分文字列を、指定された位置に指定された文字数だけ挿入します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_instr"><code class="literal">INSTR()</code></a></td><td>
      部分文字列が最初に出現する位置のインデックスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_interiorringn"><code class="literal">InteriorRingN()</code></a></td><td>
      Polygon の N 番目の内側のリングを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_intersects"><code class="literal">Intersects()</code></a></td><td>
      ある幾何図形が別の幾何図形と交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_interval"><code class="literal">INTERVAL()</code></a></td><td>
      第 1
      引数より小さい引数のインデックスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-free-lock"><code class="literal">IS_FREE_LOCK()</code></a></td><td>
      名前付きロックが解放されているかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4-compat"><code class="literal">IS_IPV4_COMPAT()</code></a></td><td>
      引数が IPv4 互換アドレスの場合、true を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4-mapped"><code class="literal">IS_IPV4_MAPPED()</code></a></td><td>
      引数が IPv4 マップアドレスの場合、true
      を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a></td><td>
      引数が IPv4 アドレスの場合、true を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv6"><code class="literal">IS_IPV6()</code></a></td><td>
      引数が IPv6 アドレスの場合、true を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></td><td>
      NOT NULL 値テスト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></td><td>
      ブーリアンに対して値をテストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></td><td>
      NULL 値テスト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-used-lock"><code class="literal">IS_USED_LOCK()</code></a></td><td>
      名前付きロックが使用中かどうかを確認します。true
      の場合は接続識別子を返します。
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></td><td>
      ブーリアンに対して値をテストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_isclosed"><code class="literal">IsClosed()</code></a></td><td>
      幾何図形が閉じていて単純かどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_isempty"><code class="literal">IsEmpty()</code></a></td><td>
      プレースホルダ関数
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a></td><td>
      引数が NULL かどうかをテストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_issimple"><code class="literal">IsSimple()</code></a></td><td>
      幾何図形が単純かどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_last-day"><code class="literal">LAST_DAY</code></a></td><td>
      引数の月の最終日を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a></td><td>
      前回の INSERT での AUTOINCREMENT カラムの値です
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_lcase"><code class="literal">LCASE()</code></a></td><td>
      LOWER() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a></td><td>
      最小の引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></td><td>
      左シフト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_left"><code class="literal">LEFT()</code></a></td><td>
      左端から指定された数の文字を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a></td><td>
      文字列の長さをバイト単位で返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></td><td>
      以下 (より少ないか等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></td><td>
      左不等 (より少ない) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td><td>
      単純なパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_linefromtext"><code class="literal">LineFromText()</code></a></td><td>
      WKT から LineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_linefromwkb"><code class="literal">LineFromWKB()</code>, <code class="literal">LineStringFromWKB()</code></a></td><td>
      WKB から LineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_linestring"><code class="literal">LineString()</code></a></td><td>
      Point 値から LineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></td><td>
      引数の自然対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a></td><td>
      指定されたファイルをロードします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME()</code>, <code class="literal">LOCALTIME</code></a></td><td>
      NOW() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP</code>, <code class="literal">LOCALTIMESTAMP()</code></a></td><td>
      NOW() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_locate"><code class="literal">LOCATE()</code></a></td><td>
      部分文字列が最初に出現する位置を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></td><td>
      引数の底 10 の対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></td><td>
      引数の底 2 の対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></td><td>
      最初の引数の自然対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a></td><td>
      引数を小文字で返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_lpad"><code class="literal">LPAD()</code></a></td><td>
      指定された文字列で左からパディングした文字列引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ltrim"><code class="literal">LTRIM()</code></a></td><td>
      先頭の空白を削除します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_make-set"><code class="literal">MAKE_SET()</code></a></td><td>
      bits
      セット内の対応するビットを持つ、カンマ区切り文字列のセットを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_makedate"><code class="literal">MAKEDATE()</code></a></td><td>
      年と年間通算日から日付を作成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_maketime"><code class="literal">MAKETIME()</code></a></td><td>
      時、分、秒から時間を作成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a></td><td>
      スレーブが指定された位置まですべての更新を読み取って適用するまで、ブロックします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_match"><code class="literal">MATCH</code></a></td><td>
      全文検索を実行します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a></td><td>
      最大値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains()</code></a></td><td>
      ある幾何図形の MBR に、別の幾何図形の MBR
      が含まれているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrdisjoint"><code class="literal">MBRDisjoint()</code></a></td><td>
      2 つの幾何図形の MBR
      が切り離されているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrequal"><code class="literal">MBREqual()</code></a></td><td>
      2 つの幾何図形の MBR が等しいかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrintersects"><code class="literal">MBRIntersects()</code></a></td><td>
      2 つの幾何図形の MBR が交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbroverlaps"><code class="literal">MBROverlaps()</code></a></td><td>
      2 つの幾何図形の MBR
      がオーバーラップしているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrtouches"><code class="literal">MBRTouches()</code></a></td><td>
      2 つの幾何図形の MBR が接しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin()</code></a></td><td>
      ある幾何図形の MBR が、別の幾何図形の MBR
      の内部にあるかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a></td><td>
      MD5 チェックサムを計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_microsecond"><code class="literal">MICROSECOND()</code></a></td><td>
      引数からマイクロ秒を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mid"><code class="literal">MID()</code></a></td><td>
      指定された位置から始まる部分文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a></td><td>
      最小値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td><td>
      減算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_minute"><code class="literal">MINUTE()</code></a></td><td>
      引数から分を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mlinefromtext"><code class="literal">MLineFromText()</code>, <code class="literal">MultiLineStringFromText()</code></a></td><td>
      WKT から MultiLineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mlinefromwkb"><code class="literal">MLineFromWKB()</code>, <code class="literal">MultiLineStringFromWKB()</code></a></td><td>
      WKB から MultiLineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mod"><code class="literal">MOD()</code></a></td><td>
      余りを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_mod"><code class="literal">%</code>, <code class="literal">MOD</code></a></td><td>
      モジュロ演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_month"><code class="literal">MONTH()</code></a></td><td>
      渡された日付から月を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_monthname"><code class="literal">MONTHNAME()</code></a></td><td>
      月の名前を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mpointfromtext"><code class="literal">MPointFromText()</code>, <code class="literal">MultiPointFromText()</code></a></td><td>
      WKT から MultiPoint を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mpointfromwkb"><code class="literal">MPointFromWKB()</code>, <code class="literal">MultiPointFromWKB()</code></a></td><td>
      WKB から MultiPoint を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mpolyfromtext"><code class="literal">MPolyFromText()</code>, <code class="literal">MultiPolygonFromText()</code></a></td><td>
      WKT から MultiPolygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mpolyfromwkb"><code class="literal">MPolyFromWKB()</code>, <code class="literal">MultiPolygonFromWKB()</code></a></td><td>
      WKB から MultiPolygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_multilinestring"><code class="literal">MultiLineString()</code></a></td><td>
      LineString 値から MultiLineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_multipoint"><code class="literal">MultiPoint()</code></a></td><td>
      Point 値から MultiPoint を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_multipolygon"><code class="literal">MultiPolygon()</code></a></td><td>
      Polygon 値から MultiPolygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_name-const"><code class="literal">NAME_CONST()</code></a></td><td>
      指定された名前がカラムに付けられます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></td><td>
      値が値の範囲内に含まれていないかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-equal"><code class="literal">!=</code>, <code class="literal">&lt;&gt;</code></a></td><td>
      不等価 (等しくない) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_not-in"><code class="literal">NOT IN()</code></a></td><td>
      値が値セット内に含まれていないかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td><td>
      単純なパターン一致の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td><td>
      REGEXP の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></td><td>
      値を否定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a></td><td>
      現在の日付と時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_nullif"><code class="literal">NULLIF()</code></a></td><td>
      expr1 = expr2 の場合に NULL を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_numgeometries"><code class="literal">NumGeometries()</code></a></td><td>
      ジオメトリコレクション内の幾何図形数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_numinteriorrings"><code class="literal">NumInteriorRings()</code></a></td><td>
      Polygon 内の内側のリング数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_numpoints"><code class="literal">NumPoints()</code></a></td><td>
      LineString 内の Point の数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_oct"><code class="literal">OCT()</code></a></td><td>
      数値の 8 進数表現を含む文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_octet-length"><code class="literal">OCTET_LENGTH()</code></a></td><td>
      LENGTH() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_old-password"><code class="literal">OLD_PASSWORD()</code></a> (deprecated 5.6.5)</td><td>
      4.1 より前の PASSWORD 実装の値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_or"><code class="literal">||</code>, <code class="literal">OR</code></a></td><td>
      論理 OR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ord"><code class="literal">ORD()</code></a></td><td>
      引数の左端の文字の文字コードを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_overlaps"><code class="literal">Overlaps()</code></a></td><td>
      ある幾何図形が別の幾何図形とオーバーラップしているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a></td><td>
      パスワード文字列を計算して返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_period-add"><code class="literal">PERIOD_ADD()</code></a></td><td>
      年月に期間を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_period-diff"><code class="literal">PERIOD_DIFF()</code></a></td><td>
      期間内の月数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></td><td>
      pi の値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td><td>
      加算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_point"><code class="literal">Point()</code></a></td><td>
      座標から Point を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pointfromtext"><code class="literal">PointFromText()</code></a></td><td>
      WKT から Point を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pointfromwkb"><code class="literal">PointFromWKB()</code></a></td><td>
      WKB から Point を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pointn"><code class="literal">PointN()</code></a></td><td>
      LineString から N 番目の Point を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_polyfromtext"><code class="literal">PolyFromText()</code>, <code class="literal">PolygonFromText()</code></a></td><td>
      WKT から Polygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_polyfromwkb"><code class="literal">PolyFromWKB()</code>, <code class="literal">PolygonFromWKB()</code></a></td><td>
      WKB から Polygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_polygon"><code class="literal">Polygon()</code></a></td><td>
      LineString 引数から Polygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_position"><code class="literal">POSITION()</code></a></td><td>
      LOCATE() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></td><td>
      指定した指数で累乗された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></td><td>
      指定した指数で累乗された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="optimization.html#procedure-analyse" title="8.4.2.4 PROCEDURE ANALYSE の使用"><code class="literal">PROCEDURE ANALYSE()</code></a></td><td>
      クエリーの結果を解析します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_quarter"><code class="literal">QUARTER()</code></a></td><td>
      日付引数から四半期を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_quote"><code class="literal">QUOTE()</code></a></td><td>
      SQL
      ステートメント内で使用するために引数をエスケープします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></td><td>
      ラジアンに変換された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td><td>
      ランダムな浮動小数点値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a></td><td>
      ランダムなバイトベクトルを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td><td>
      正規表現を使用したパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a></td><td>
      名前付きロックを解放します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_repeat"><code class="literal">REPEAT()</code></a></td><td>
      文字列を指定された回数だけ繰り返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a></td><td>
      指定された文字列の出現箇所を置き換えます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_reverse"><code class="literal">REVERSE()</code></a></td><td>
      文字列内の文字を逆順に並べ替えます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></td><td>
      右シフト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_right"><code class="literal">RIGHT()</code></a></td><td>
      右端から指定された数の文字を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a></td><td>
      REGEXP のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></td><td>
      引数を丸めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a></td><td>
      更新された行数
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_rpad"><code class="literal">RPAD()</code></a></td><td>
      指定された回数だけ文字列を追加します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_rtrim"><code class="literal">RTRIM()</code></a></td><td>
      末尾の空白を削除します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_schema"><code class="literal">SCHEMA()</code></a></td><td>
      DATABASE() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sec-to-time"><code class="literal">SEC_TO_TIME()</code></a></td><td>
      秒を「HH:MM:SS」形式に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_second"><code class="literal">SECOND()</code></a></td><td>
      秒 (0-59) を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a></td><td>
      USER() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code>, <code class="literal">SHA()</code></a></td><td>
      SHA-1 160 ビットチェックサムを計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a></td><td>
      SHA-2 チェックサムを計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></td><td>
      引数の符号を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></td><td>
      引数のサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a></td><td>
      ある秒数間スリープ状態にします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a></td><td>
      soundex 文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></td><td>
      音声を比較します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_space"><code class="literal">SPACE()</code></a></td><td>
      指定された数の空白で構成される文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sql-thread-wait-after-gtids"><code class="literal">SQL_THREAD_WAIT_AFTER_GTIDS()</code></a> (deprecated 5.6.9)</td><td>
      廃止: WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()
      に置き換わりました
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></td><td>
      引数の平方根を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_srid"><code class="literal">SRID()</code></a></td><td>
      幾何図形の空間参照システム ID を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a></td><td>
      Polygon または MultiPolygon 領域を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-centroid"><code class="literal">ST_Centroid()</code></a></td><td>
      重心を Point として返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains()</code></a></td><td>
      ある幾何図形に別の幾何図形が含まれているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-crosses"><code class="literal">ST_Crosses()</code></a></td><td>
      ある幾何図形が別の幾何図形と交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-difference"><code class="literal">ST_Difference()</code></a></td><td>
      2 つの幾何図形の点集合の差集合を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-disjoint"><code class="literal">ST_Disjoint()</code></a></td><td>
      ある幾何図形が別の幾何図形から切り離されているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a></td><td>
      ある幾何図形の別の幾何図形からの距離
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope()</code></a></td><td>
      幾何図形の MBR を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-equals"><code class="literal">ST_Equals()</code></a></td><td>
      ある幾何図形が別の幾何図形に等しいかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-intersection"><code class="literal">ST_Intersection()</code></a></td><td>
      2 つの幾何図形の点集合の積集合を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-intersects"><code class="literal">ST_Intersects()</code></a></td><td>
      ある幾何図形が別の幾何図形と交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-overlaps"><code class="literal">ST_Overlaps()</code></a></td><td>
      ある幾何図形が別の幾何図形とオーバーラップしているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-symdifference"><code class="literal">ST_SymDifference()</code></a></td><td>
      2 つの幾何図形の点集合の対称差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-touches"><code class="literal">ST_Touches()</code></a></td><td>
      ある幾何図形が別の幾何図形に接しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-union"><code class="literal">ST_Union()</code></a></td><td>
      2 つの幾何図形の点集合の和集合を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within()</code></a></td><td>
      ある幾何図形が別の幾何図形の内部にあるかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_startpoint"><code class="literal">StartPoint()</code></a></td><td>
      LineString の始点
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a></td><td>
      母標準偏差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a></td><td>
      母標準偏差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev-samp"><code class="literal">STDDEV_SAMP()</code></a></td><td>
      標本標準偏差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a></td><td>
      母標準偏差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a></td><td>
      文字列を日付に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td><td>
      2 つの文字列を比較します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE()</code></a></td><td>
      3 つの引数で呼び出されるときは DATE_SUB()
      のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR()</code></a></td><td>
      指定された部分文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_substring-index"><code class="literal">SUBSTRING_INDEX()</code></a></td><td>
      文字列から、区切り文字が指定された回数出現する前の部分文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a></td><td>
      指定された部分文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_subtime"><code class="literal">SUBTIME()</code></a></td><td>
      時間の差を求めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a></td><td>
      集計を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a></td><td>
      この関数が実行される時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a></td><td>
      USER() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></td><td>
      引数のタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT()</code></a></td><td>
      時間として書式設定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_time-to-sec"><code class="literal">TIME_TO_SEC()</code></a></td><td>
      秒に変換された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_time"><code class="literal">TIME()</code></a></td><td>
      渡された式の時部分を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_timediff"><code class="literal">TIMEDIFF()</code></a></td><td>
      時間の差を求めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td><td>
      乗算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP()</code></a></td><td>
      引数が 1
      つの場合、この関数は日付または日付時間式を返します。引数が
      2 つの場合、引数の合計を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_timestampadd"><code class="literal">TIMESTAMPADD()</code></a></td><td>
      日付時間式に間隔を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF()</code></a></td><td>
      日付時間式から間隔を減算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a></td><td>
      base 64 文字列に変換された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a></td><td>
      日に変換された日付引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS()</code></a></td><td>
      0
      年以降の秒数に変換された日付または日付時間引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_touches"><code class="literal">Touches()</code></a></td><td>
      ある幾何図形が別の幾何図形に接しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_trim"><code class="literal">TRIM()</code></a></td><td>
      先頭と末尾にある空白を削除します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></td><td>
      指定された小数点以下の桁数に切り捨てます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ucase"><code class="literal">UCASE()</code></a></td><td>
      UPPER() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td><td>
      引数の符号を変更します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_uncompress"><code class="literal">UNCOMPRESS()</code></a></td><td>
      圧縮された文字列を圧縮解除します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_uncompressed-length"><code class="literal">UNCOMPRESSED_LENGTH()</code></a></td><td>
      圧縮前の文字列長を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a></td><td>
      数値の 16 進数表現を含む文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a></td><td>
      UNIX タイムスタンプを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a></td><td>
      置換後 XML フラグメントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a></td><td>
      大文字に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a></td><td>
      ユーザー名と、クライアントによって提供されるホスト名です
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE()</code></a></td><td>
      現在の UTC 日付を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME()</code></a></td><td>
      現在の UTC 時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP()</code></a></td><td>
      現在の UTC 日付と時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a></td><td>
      整数値のユニバーサル識別子を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a></td><td>
      ユニバーサル固有識別子 (UUID) を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH()</code></a></td><td>
      パスワードの強度を判断します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a></td><td>
      INSERT で使用される値を定義します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a></td><td>
      母標準分散を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP()</code></a></td><td>
      標本分散を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a></td><td>
      母標準分散を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_version"><code class="literal">VERSION()</code></a></td><td>
      MySQL
      サーバーのバージョンを示す文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_wait-until-sql-thread-after-gtids"><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code></a></td><td>
      指定された GTID
      がスレーブで実行されるまで待ちます。
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a></td><td>
      週番号を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_weekday"><code class="literal">WEEKDAY()</code></a></td><td>
      曜日インデックスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR()</code></a></td><td>
      日付の暦週を返します (0 - 53)
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a></td><td>
      文字列の重み文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_within"><code class="literal">Within()</code></a></td><td>
      ある幾何図形が別の幾何図形の内部にあるかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_x"><code class="literal">X()</code></a></td><td>
      Point の X 座標を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></td><td>
      論理 XOR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_y"><code class="literal">Y()</code></a></td><td>
      Point の Y 座標を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_year"><code class="literal">YEAR()</code></a></td><td>
      年を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a></td><td>
      年と週を返します
    </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="type-conversion"></a>12.2 式評価での型変換</h2></div></div></div><a class="indexterm" name="idm139979100420176"></a><a class="indexterm" name="idm139979100418752"></a><p>
      演算子が別の型のオペランドとともに使用されると、オペランドの互換性を保つために型変換が発生します。一部の変換は暗黙的に発生します。たとえば、MySQL では必要に応じて数字が文字列 (またはその逆) に自動的に変換されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1+'1';</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT CONCAT(2,' test');</code></strong>
        -&gt; '2 test'
</pre><p>
      また、<code class="literal">CAST()</code> 関数を明示的に使用して、数字を文字列に変換することもできます。<code class="literal">CONCAT()</code> 関数では文字列の引数が要求されるため、使用すると暗黙的に変換が発生します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 38.8, CAST(38.8 AS CHAR);</code></strong>
        -&gt; 38.8, '38.8'
mysql&gt; <strong class="userinput"><code>SELECT 38.8, CONCAT(38.8);</code></strong>
        -&gt; 38.8, '38.8'
</pre><p>
      文字セットの数字から文字列への暗黙的な変換について、および <code class="literal">CREATE TABLE ... SELECT</code> ステートメントに適用される変更済みのルールについては、このセクションの後半を参照してください。
    </p><p>
      次のルールでは、比較演算の際にどのように変換が発生するのかについて説明します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">NULL</code>-safe <code class="literal">&lt;=&gt;</code> 等価比較演算子の場合を除いて、一方または両方の引数が <code class="literal">NULL</code> の場合は、比較の結果も <code class="literal">NULL</code> になります。<code class="literal">NULL &lt;=&gt; NULL</code> の場合は、結果が true になります。変換は必要ありません。
        </p></li><li class="listitem"><p>
          比較演算の両方の引数が文字列の場合は、文字列として比較されます。
        </p></li><li class="listitem"><p>
          両方の引数が整数の場合は、整数として比較されます。
        </p></li><li class="listitem"><p>
          16 進値が数字と比較されない場合は、バイナリ文字列として処理されます。
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139979100397968"></a> <a class="indexterm" name="idm139979100396464"></a>引数の一方が <code class="literal">TIMESTAMP</code> または <code class="literal">DATETIME</code> カラムで他方が定数の場合は、比較が実行される前に定数がタイムスタンプに変換されます。これは、ODBC により適合させるために実行されます。これは、<code class="literal">IN()</code> への引数には実行されません。念のため、比較を行う際は、常に完全な日付時間、日付、または時間文字列を使用してください。たとえば、日付または時間の値とともに <code class="literal">BETWEEN</code> を使用したときの結果を最適にするには、<code class="literal">CAST()</code> を使用して、明示的に値を目的のデータ型に変換します。
        </p><p>
          テーブル (複数可) からの単一行のサブクエリーは、定数とみなされません。たとえば、サブクエリーで <code class="literal">DATETIME</code> 値と比較される整数が返される場合は、比較が 2 つの整数として実行されます。整数は時間値には変換されません。オペランドを <code class="literal">DATETIME</code> 値として比較するには、<code class="literal">CAST()</code> を使用して、明示的にサブクエリーの値を <code class="literal">DATETIME</code> に変換します。
        </p></li><li class="listitem"><p>
          引数のいずれかが 10 進値の場合、比較はその他の引数に依存します。その他の引数が 10 進値または整数値の場合、引数は 10 進値として比較され、その他の引数が浮動小数点値の場合、引数は浮動小数点値として比較されます。
        </p></li><li class="listitem"><p>
          ほかのすべてのケースでは、引数は浮動小数点 (実) 数として比較されます。
        </p></li></ul></div><p>
      別の時間型への値の変換については、<a class="xref" href="data-types.html#date-and-time-type-conversion" title="11.3.7 日付と時間型間での変換">セクション11.3.7「日付と時間型間での変換」</a>を参照してください。
    </p><p>
      次の例は、比較演算での文字列から数字への変換を示しています。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 &gt; '6x';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 7 &gt; '6x';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 0 &gt; 'x6';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 0 = 'x6';</code></strong>
        -&gt; 1
</pre><p>
      文字列カラムと数字との比較では、MySQL はカラム上のインデックスを使用して、値をすばやく検索できません。<em class="replaceable"><code>str_col</code></em> がインデックスの付いた文字列カラムである場合は、次のステートメントで検索を実行するときに、そのインデックスを使用できません。
    </p><pre class="programlisting">
SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>str_col</code></em>=1;
</pre><p>
      その理由は、<code class="literal">'1'</code>、<code class="literal">' 1'</code>、<code class="literal">'1a'</code> のように、値 <code class="literal">1</code> に変換できるさまざまな文字列があるためです。
    </p><p>
      このような数字は不正確であるため、浮動小数点数 (または浮動小数点数に変換される値) を使用する比較は概算になります。これにより、整合性のない結果が表示される可能性があります。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT '18015376320243458' = 18015376320243458;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT '18015376320243459' = 18015376320243459;</code></strong>
        -&gt; 0
</pre><p>
      このような結果は、53 ビットの精度しか持たない浮動小数点数に値が変換され、丸めの対象になるために発生する可能性があります。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT '18015376320243459'+0.0;</code></strong>
        -&gt; 1.8015376320243e+16
</pre><p>
      さらに、文字列から浮動小数点への変換および整数から浮動小数点への変換は、必ずしも同様に発生するとはかぎりません。整数は、CPU によって浮動小数点に変換される可能性があります。一方、文字列は、浮動小数点の乗算を伴う演算で 1 桁ずつ変換されます。
    </p><p>
      表示される結果はシステムによって異なり、コンピュータのアーキテクチャーやコンパイラのバージョンなどの要因、または最適化レベルの影響を受ける可能性があります。このような問題を回避する方法の 1 つは、値が暗黙的に浮動小数点値に変換されないように、<code class="literal">CAST()</code> を使用することです。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CAST('18015376320243459' AS UNSIGNED) = 18015376320243459;</code></strong>
        -&gt; 1
</pre><p>
      浮動小数点の比較についての詳細は、<a class="xref" href="error-handling.html#problems-with-float" title="B.5.5.8 浮動小数点値に関する問題">セクションB.5.5.8「浮動小数点値に関する問題」</a>を参照してください。
    </p><p>
      MySQL 5.6 では、サーバーに <code class="literal">dtoa</code> が含まれています。これは、文字列または <code class="literal">DECIMAL</code> 値と近似値 (<code class="literal">FLOAT</code>/<code class="literal">DOUBLE</code>) の数値間の変換を改善するための基礎を提供する変換ライブラリです。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Unix と Windows 間の変換の相違などが除去された、プラットフォーム間で整合性のある変換結果。
        </p></li><li class="listitem"><p>
          以前の結果に十分な精度がなかった場合 (IEEE の制限に近い値など) の正確な値の表示。
        </p></li><li class="listitem"><p>
          最大限の精度を持つ文字列書式への数字の変換。<code class="literal">dtoa</code> の精度は、常に標準の C ライブラリ関数の精度と同じか、それ以上です。
        </p></li></ul></div><p>
      このライブラリで生成された変換は、<code class="literal">dtoa</code> 以外の結果とは異なる場合があるため、以前の結果に依存するアプリケーションとの互換性が保たれない可能性があります。たとえば、以前の変換からの特定の正確な結果に依存するアプリケーションでは、追加の精度に対応するように調整が必要となる場合があります。
    </p><p>
      <code class="literal">dtoa</code> ライブラリでは、次のプロパティーを使用した変換が提供されます。<em class="replaceable"><code>D</code></em> は <code class="literal">DECIMAL</code> または文字列表現を含む値を表し、<em class="replaceable"><code>F</code></em> はネイティブバイナリ (IEEE) 書式の浮動小数点数を表します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <em class="replaceable"><code>F</code></em> -&gt; <em class="replaceable"><code>D</code></em> の変換は、最大限の精度で実行され、読み取り時に <em class="replaceable"><code>F</code></em> が生成されるもっとも短い文字列として <em class="replaceable"><code>D</code></em> が返され、IEEE で指定されているネイティブバイナリ形式でもっとも近い値に丸められます。
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>D</code></em> -&gt; <em class="replaceable"><code>F</code></em> の変換は、<em class="replaceable"><code>F</code></em> が入力された 10 進文字列 <em class="replaceable"><code>D</code></em> にもっとも近いネイティブバイナリの数字になるように実行されます。
        </p></li></ul></div><p>
      <em class="replaceable"><code>F</code></em> が <code class="literal">-inf</code>、<code class="literal">+inf</code>、または <code class="literal">NaN</code> の場合を除いて、これらのプロパティーは、<em class="replaceable"><code>F</code></em> -&gt; <em class="replaceable"><code>D</code></em> -&gt; <em class="replaceable"><code>F</code></em> の変換が可逆であることを暗黙的に示しています。後者の値は、SQL 標準では <code class="literal">FLOAT</code> または <code class="literal">DOUBLE</code> の無効な値として定義されているため、サポートされていません。
    </p><p>
      <em class="replaceable"><code>D</code></em> -&gt; <em class="replaceable"><code>F</code></em> -&gt; <em class="replaceable"><code>D</code></em> の変換では、<em class="replaceable"><code>D</code></em> が 15 桁以下の精度を使用し、非正規値 (<code class="literal">-inf</code>、<code class="literal">+inf</code>、または <code class="literal">NaN</code>) でないことが可逆のための十分な条件となります。<em class="replaceable"><code>D</code></em> の精度が 15 桁よりも大きい場合でも、変換が可逆であるケースもありますが、常に該当するとはかぎりません。
    </p><p>
      MySQL 5.6 では、暗黙的に数値または時間値を文字列に変換すると、<code class="literal">character_set_connection</code> および <code class="literal">collation_connection</code> システム変数で決定された文字セットおよび照合順序を含む値が生成されます。(一般に、これらの変数は <code class="literal">SET NAMES</code> を使用して設定されます。接続文字セットについては、<a class="xref" href="globalization.html#charset-connection" title="10.1.4 接続文字セットおよび照合順序">セクション10.1.4「接続文字セットおよび照合順序」</a>を参照してください。)
    </p><p>
      つまり、接続文字セットが <code class="literal">binary</code> に設定されている場合を除いて、このような変換では、(非バイナリ) 文字列 (<code class="literal">CHAR</code>、<code class="literal">VARCHAR</code>、または <code class="literal">LONGTEXT</code> 値) が生成されます。この場合、変換の結果はバイナリ文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、または <code class="literal">LONGBLOB</code> 値) になります。
    </p><p>
      整数式では、式の<span class="emphasis"><em>評価</em></span>に関する上記の備考は、式の<span class="emphasis"><em>割り当て</em></span>には多少異なる方法で適用されます。次のようなステートメントでの例を示します。
    </p><pre class="programlisting">
CREATE TABLE t SELECT <em class="replaceable"><code>integer_expr</code></em>;
</pre><p>
      この場合、式の結果として生成されるカラム内のテーブルの型は、整数式の長さに応じて、<code class="literal">INT</code> または <code class="literal">BIGINT</code> になります。式の最大長が <code class="literal">INT</code> に収まらない場合は、代わりに <code class="literal">BIGINT</code> が使用されます。長さは、<code class="literal">SELECT</code> 結果セットメタデータの <code class="literal">max_length</code> 値から取得されます (<a class="xref" href="connectors-apis.html#c-api-data-structures" title="23.8.5 C API データ構造">セクション23.8.5「C API データ構造」</a>を参照してください)。つまり、十分に長い式を使用することで、<code class="literal">INT</code> ではなく、<code class="literal">BIGINT</code> を強制的に適用できます。
    </p><pre class="programlisting">
CREATE TABLE t SELECT 000000000000000000000;
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="non-typed-operators"></a>12.3 演算子</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#operator-precedence">12.3.1 演算子の優先順位</a></span></dt><dt><span class="section"><a href="functions.html#comparison-operators">12.3.2 比較関数と演算子</a></span></dt><dt><span class="section"><a href="functions.html#logical-operators">12.3.3 論理演算子</a></span></dt><dt><span class="section"><a href="functions.html#assignment-operators">12.3.4 割り当て演算子</a></span></dt></dl></div><div class="table"><a name="idm139979100299040"></a><p class="title"><b>表 12.2 演算子</b></p><div class="table-contents"><table summary="演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></td><td>
      論理 AND
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></td><td>
      (<code class="literal">SET</code>
      ステートメントの一部として、または
      <code class="literal">UPDATE</code> ステートメントの
      <code class="literal">SET</code> 句の一部として)
      値を割り当てます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></td><td>
      値を割り当てます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></td><td>
      値が値の範囲内に含まれているかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></td><td>
      文字列をバイナリ文字列にキャストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></td><td>
      ビット単位の AND
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></td><td>
      ビットを反転します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></td><td>
      ビット単位の OR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></td><td>
      ビット単位の XOR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></td><td>
      CASE 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td><td>
      整数除算
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td><td>
      除算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a></td><td>
      NULL 安全等価演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></td><td>
      等価 (等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></td><td>
      以上 (より多いか等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></td><td>
      右不等 (より多い) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></td><td>
      NOT NULL 値テスト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></td><td>
      ブーリアンに対して値をテストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></td><td>
      NULL 値テスト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></td><td>
      ブーリアンに対して値をテストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></td><td>
      左シフト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></td><td>
      以下 (より少ないか等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></td><td>
      左不等 (より少ない) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td><td>
      単純なパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td><td>
      減算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_mod"><code class="literal">%</code>, <code class="literal">MOD</code></a></td><td>
      モジュロ演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></td><td>
      値が値の範囲内に含まれていないかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-equal"><code class="literal">!=</code>, <code class="literal">&lt;&gt;</code></a></td><td>
      不等価 (等しくない) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td><td>
      単純なパターン一致の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td><td>
      REGEXP の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></td><td>
      値を否定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_or"><code class="literal">||</code>, <code class="literal">OR</code></a></td><td>
      論理 OR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td><td>
      加算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td><td>
      正規表現を使用したパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></td><td>
      右シフト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a></td><td>
      REGEXP のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></td><td>
      音声を比較します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td><td>
      乗算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td><td>
      引数の符号を変更します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></td><td>
      論理 XOR
    </td></tr></tbody></table></div></div><br class="table-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="operator-precedence"></a>12.3.1 演算子の優先順位</h3></div></div></div><a class="indexterm" name="idm139979100210960"></a><a class="indexterm" name="idm139979100208832"></a><p>
        次のリストには、演算子の優先順位をもっとも高いものから順番に示しています。同じ行に並んで記載されている演算子は、優先順位が同じものです。
      </p><pre class="programlisting">
INTERVAL
BINARY, COLLATE
!
- (unary minus), ~ (unary bit inversion)
^
*, /, DIV, %, MOD
-, +
&lt;&lt;, &gt;&gt;
&amp;
|
= (comparison), &lt;=&gt;, &gt;=, &gt;, &lt;=, &lt;, &lt;&gt;, !=, IS, LIKE, REGEXP, IN
BETWEEN, CASE, WHEN, THEN, ELSE
NOT
&amp;&amp;, AND
XOR
||, OR
= (assignment), :=
</pre><p>
        <code class="literal">=</code> の優先順位は、比較演算子 (<code class="literal">=</code>) として使用されるのか、割り当て演算子 (<code class="literal">=</code>) として使用されるのかによって異なります。比較演算子として使用される場合は、優先順位が <code class="literal">&lt;=&gt;</code>、<code class="literal">&gt;=</code>、<code class="literal">&gt;</code>、<code class="literal">&lt;=</code>、<code class="literal">&lt;</code>、<code class="literal">&lt;&gt;</code>、<code class="literal">!=</code>、<code class="literal">IS</code>、<code class="literal">LIKE</code>、<code class="literal">REGEXP</code>、および <code class="literal">IN</code> と同じです。割り当て演算子として使用される場合は、優先順位が <code class="literal">:=</code> と同じです。<a class="xref" href="sql-syntax.html#set-statement" title="13.7.4 SET 構文">セクション13.7.4「SET 構文」</a>および<a class="xref" href="language-structure.html#user-variables" title="9.4 ユーザー定義変数">セクション9.4「ユーザー定義変数」</a>では、適用される <code class="literal">=</code> の解釈が MySQL でどのように決定されるのかについて説明されています。
      </p><p>
        一部の演算子の意味は、SQL モードによって異なります。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            デフォルトでは、<code class="literal">||</code> は論理 <code class="literal">OR</code> 演算子です。<code class="literal">PIPES_AS_CONCAT</code> が有効になっている場合は、<code class="literal">||</code> は <code class="literal">^</code> と単項演算子間の優先順位を持つ文字列連結です。
          </p></li><li class="listitem"><p>
            デフォルトでは、<code class="literal">!</code> は <code class="literal">NOT</code> よりも高い優先順位です。<code class="literal">HIGH_NOT_PRECEDENCE</code> が有効になっている場合は、<code class="literal">!</code> と <code class="literal">NOT</code> の優先順位は同じです。
          </p></li></ul></div><p>
        <a class="xref" href="server-administration.html#sql-mode" title="5.1.7 サーバー SQL モード">セクション5.1.7「サーバー SQL モード」</a>を参照してください。
      </p><a class="indexterm" name="idm139979100170560"></a><a class="indexterm" name="idm139979100169136"></a><a class="indexterm" name="idm139979100167792"></a><a class="indexterm" name="idm139979100165760"></a><p>
        演算子の優先順位によって、式の項の評価順序が決まります。この順序をオーバーライドし、明示的に項をグループ化するには、丸括弧を使用します。例:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1+2*3;</code></strong>
        -&gt; 7
mysql&gt; <strong class="userinput"><code>SELECT (1+2)*3;</code></strong>
        -&gt; 9
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="comparison-operators"></a>12.3.2 比較関数と演算子</h3></div></div></div><a class="indexterm" name="idm139979100159536"></a><div class="table"><a name="idm139979100158096"></a><p class="title"><b>表 12.3 比較演算子</b></p><div class="table-contents"><table summary="比較演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></td><td>
      値が値の範囲内に含まれているかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE()</code></a></td><td>
      NULL 以外の最初の引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a></td><td>
      NULL 安全等価演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></td><td>
      等価 (等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></td><td>
      以上 (より多いか等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></td><td>
      右不等 (より多い) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a></td><td>
      最大の引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_in"><code class="literal">IN()</code></a></td><td>
      ある値が値セット内に含まれているかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_interval"><code class="literal">INTERVAL()</code></a></td><td>
      第 1
      引数より小さい引数のインデックスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></td><td>
      NOT NULL 値テスト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></td><td>
      ブーリアンに対して値をテストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></td><td>
      NULL 値テスト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></td><td>
      ブーリアンに対して値をテストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a></td><td>
      引数が NULL かどうかをテストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a></td><td>
      最小の引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></td><td>
      以下 (より少ないか等しい) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></td><td>
      左不等 (より少ない) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td><td>
      単純なパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></td><td>
      値が値の範囲内に含まれていないかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-equal"><code class="literal">!=</code>, <code class="literal">&lt;&gt;</code></a></td><td>
      不等価 (等しくない) 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_not-in"><code class="literal">NOT IN()</code></a></td><td>
      値が値セット内に含まれていないかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td><td>
      単純なパターン一致の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td><td>
      2 つの文字列を比較します
    </td></tr></tbody></table></div></div><br class="table-break"><a class="indexterm" name="idm139979100107904"></a><a class="indexterm" name="idm139979100106448"></a><p>
        比較演算の結果は、<code class="literal">1</code> (<code class="literal">TRUE</code>)、<code class="literal">0</code> (<code class="literal">FALSE</code>)、または <code class="literal">NULL</code> の値になります。これらの演算は、数字と文字列の両方で機能します。必要に応じて、文字列は数字に、数字は文字列に自動的に変換されます。
      </p><p>
        次の関係比較演算子を使用すれば、スカラーオペランドだけでなく行オペランドも比較できます。
      </p><pre class="programlisting">
=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=
</pre><p>
        行比較の例については、<a class="xref" href="sql-syntax.html#row-subqueries" title="13.2.10.5 行サブクエリー">セクション13.2.10.5「行サブクエリー」</a>を参照してください。
      </p><p>
        このセクションで示す関数の一部では、<code class="literal">1</code> (<code class="literal">TRUE</code>)、<code class="literal">0</code> (<code class="literal">FALSE</code>)、または <code class="literal">NULL</code> 以外の値が返されます。たとえば、<code class="literal">LEAST()</code> や <code class="literal">GREATEST()</code> です。ただし、返される値は、<a class="xref" href="functions.html#type-conversion" title="12.2 式評価での型変換">セクション12.2「式評価での型変換」</a>で説明したルールに従って実行された比較演算に基づきます。
      </p><p>
        <code class="literal">CAST()</code> 関数を使用すると、比較目的で値を特定の型に変換できます。<code class="literal">CONVERT()</code> を使用すると、文字列値を別の文字セットに変換できます。<a class="xref" href="functions.html#cast-functions" title="12.10 キャスト関数と演算子">セクション12.10「キャスト関数と演算子」</a>を参照してください。
      </p><p>
        デフォルトでは、文字列の比較では大文字と小文字が区別されず、現在の文字セットが使用されます。デフォルトは <code class="literal">latin1</code> (cp1252 西ヨーロッパ言語) であり、英語でも正常に機能します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_equal"></a><p>
            <a class="indexterm" name="idm139979100083792"></a> <a class="indexterm" name="idm139979100082320"></a> <code class="literal">=</code>
          </p><p>
            等しい:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 = 0;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT '0' = 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT '0.0' = 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT '0.01' = 0;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT '.01' = 0.01;</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="operator_equal-to"></a><p>
            <a class="indexterm" name="idm139979100071584"></a> <a class="indexterm" name="idm139979100069424"></a> <code class="literal">&lt;=&gt;</code>
          </p><p>
            <code class="literal">NULL</code> - 安全等価。この演算子では、<code class="literal">=</code> 演算子のように等価比較が実行されますが、両方のオペランドが <code class="literal">NULL</code> であれば、<code class="literal">NULL</code> でなく <code class="literal">1</code> が返され、一方のオペランドが <code class="literal">NULL</code> の場合は、<code class="literal">NULL</code> でなく <code class="literal">0</code> が返されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 &lt;=&gt; 1, NULL &lt;=&gt; NULL, 1 &lt;=&gt; NULL;</code></strong>
        -&gt; 1, 1, 0
mysql&gt; <strong class="userinput"><code>SELECT 1 = 1, NULL = NULL, 1 = NULL;</code></strong>
        -&gt; 1, NULL, NULL
</pre></li><li class="listitem"><a name="operator_not-equal"></a><p>
            <a class="indexterm" name="idm139979100052416"></a> <a class="indexterm" name="idm139979100050928"></a> <a class="indexterm" name="idm139979100049568"></a> <a class="indexterm" name="idm139979100048192"></a> <code class="literal">&lt;&gt;</code>, <code class="literal">!=</code>
          </p><p>
            等しくない:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT '.01' &lt;&gt; '0.01';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT .01 &lt;&gt; '0.01';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'zapp' &lt;&gt; 'zappp';</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="operator_less-than-or-equal"></a><p>
            <a class="indexterm" name="idm139979100036496"></a> <a class="indexterm" name="idm139979100035008"></a> <code class="literal">&lt;=</code>
          </p><p>
            より少ないか等しい:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 0.1 &lt;= 2;</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="operator_less-than"></a><p>
            <a class="indexterm" name="idm139979100026000"></a> <a class="indexterm" name="idm139979100024512"></a> <code class="literal">&lt;</code>
          </p><p>
            より少ない:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 2 &lt; 2;</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="operator_greater-than-or-equal"></a><p>
            <a class="indexterm" name="idm139979100015520"></a> <a class="indexterm" name="idm139979100014048"></a> <code class="literal">&gt;=</code>
          </p><p>
            より多いか等しい:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 2 &gt;= 2;</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="operator_greater-than"></a><p>
            <a class="indexterm" name="idm139979100005024"></a> <a class="indexterm" name="idm139979100003536"></a> <code class="literal">&gt;</code>
          </p><p>
            より多い:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 2 &gt; 2;</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="operator_is"></a><p>
            <a class="indexterm" name="idm139979099993888"></a> <a class="indexterm" name="idm139979099991744"></a> <a class="indexterm" name="idm139979099989712"></a> <a class="indexterm" name="idm139979099987680"></a> <code class="literal">IS <em class="replaceable"><code>boolean_value</code></em></code>
          </p><p>
            <em class="replaceable"><code>boolean_value</code></em> を <code class="literal">TRUE</code>、<code class="literal">FALSE</code>、または <code class="literal">UNKNOWN</code> にすることができるブール値に対して値をテストします。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 IS TRUE, 0 IS FALSE, NULL IS UNKNOWN;</code></strong>
        -&gt; 1, 1, 1
</pre></li><li class="listitem"><a name="operator_is-not"></a><p>
            <a class="indexterm" name="idm139979099975104"></a> <a class="indexterm" name="idm139979099972960"></a> <a class="indexterm" name="idm139979099970928"></a> <a class="indexterm" name="idm139979099968896"></a> <code class="literal">IS NOT <em class="replaceable"><code>boolean_value</code></em></code>
          </p><p>
            <em class="replaceable"><code>boolean_value</code></em> を <code class="literal">TRUE</code>、<code class="literal">FALSE</code>、または <code class="literal">UNKNOWN</code> にすることができるブール値に対して値をテストします。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 IS NOT UNKNOWN, 0 IS NOT UNKNOWN, NULL IS NOT UNKNOWN;</code></strong>
        -&gt; 1, 1, 0
</pre></li><li class="listitem"><a name="operator_is-null"></a><p>
            <a class="indexterm" name="idm139979099956224"></a> <a class="indexterm" name="idm139979099954016"></a> <code class="literal">IS NULL</code>
          </p><p>
            値が <code class="literal">NULL</code> かどうかをテストします。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 IS NULL, 0 IS NULL, NULL IS NULL;</code></strong>
        -&gt; 0, 0, 1
</pre><p>
            <a class="indexterm" name="idm139979099946400"></a> <a class="indexterm" name="idm139979099944896"></a>ODBC プログラムとの連携が正しく機能するように、MySQL では <code class="literal">IS NULL</code> の使用時に次の追加機能がサポートされます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">sql_auto_is_null</code> 変数が 1 に設定されている場合は、自動的に生成された <code class="literal">AUTO_INCREMENT</code> 値を正常に挿入するステートメントのあとに、次の形式のステートメントを発行すれば、その値を検索できます。
              </p><pre class="programlisting">
SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>auto_col</code></em> IS NULL
</pre><p>
                ステートメントが行を返す場合、返される値は <code class="literal">LAST_INSERT_ID()</code> 関数を呼び出した場合と同じです。複数行の挿入後の戻り値などについての詳細は、<a class="xref" href="functions.html#information-functions" title="12.14 情報関数">セクション12.14「情報関数」</a>を参照してください。<code class="literal">AUTO_INCREMENT</code> 値を正常に挿入できなかった場合、<code class="literal">SELECT</code> ステートメントは行を返しません。
              </p><p>
                <code class="literal">IS NULL</code> の比較を使用して <code class="literal">AUTO_INCREMENT</code> 値を取得する動作は、<code class="literal">sql_auto_is_null = 0</code> を設定すると無効にできます。<a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 サーバーシステム変数">セクション5.1.4「サーバーシステム変数」</a>を参照してください。
              </p><p>
                MySQL 5.6 では <code class="literal">sql_auto_is_null</code> のデフォルト値は 0 です。
              </p></li><li class="listitem"><p>
                <code class="literal">NOT NULL</code> として宣言された <code class="literal">DATE</code> および <code class="literal">DATETIME</code> カラムでは、次のようなステートメントを使用することで、特殊な日付 <code class="literal">'0000-00-00'</code> を検索できます。
              </p><pre class="programlisting">
SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>date_column</code></em> IS NULL
</pre><p>
                ODBC では <code class="literal">'0000-00-00'</code> 日付値がサポートされていないため、一部の ODBC アプリケーションを取得する際に、これが必要になります。
              </p><p>
                <a class="ulink" href="http://dev.mysql.com/doc/connector-odbc/en/connector-odbc-usagenotes-functionality-last-insert-id.html" target="_top">Obtaining Auto-Increment Values</a>、および<a class="ulink" href="http://dev.mysql.com/doc/connector-odbc/en/connector-odbc-configuration-connection-parameters.html" target="_top">Connector/ODBC Connection Parameters</a>の <code class="literal">FLAG_AUTO_IS_NULL</code> オプションについての説明を参照してください。
              </p></li></ul></div></li><li class="listitem"><a name="operator_is-not-null"></a><p>
            <a class="indexterm" name="idm139979099913344"></a> <a class="indexterm" name="idm139979099911136"></a> <code class="literal">IS NOT NULL</code>
          </p><p>
            値が <code class="literal">NULL</code> でないかどうかをテストします。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 IS NOT NULL, 0 IS NOT NULL, NULL IS NOT NULL;</code></strong>
        -&gt; 1, 1, 0
</pre></li><li class="listitem"><a name="operator_between"></a><p>
            <a class="indexterm" name="idm139979099900656"></a> <code class="literal"><em class="replaceable"><code>expr</code></em> BETWEEN <em class="replaceable"><code>min</code></em> AND <em class="replaceable"><code>max</code></em></code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> が <em class="replaceable"><code>min</code></em> より多いか等しく、<em class="replaceable"><code>expr</code></em> が <em class="replaceable"><code>max</code></em> より少ないか等しい場合、<code class="literal">BETWEEN</code> は <code class="literal">1</code> を返し、それ以外では <code class="literal">0</code> を返します。すべての引数の型が同じであれば、これは式 <code class="literal">(<em class="replaceable"><code>min</code></em> &lt;= <em class="replaceable"><code>expr</code></em> AND <em class="replaceable"><code>expr</code></em> &lt;= <em class="replaceable"><code>max</code></em>)</code> と同等です。それ以外の場合は、<a class="xref" href="functions.html#type-conversion" title="12.2 式評価での型変換">セクション12.2「式評価での型変換」</a>に記載したルールに従って型変換が実行されますが、3 つのすべての引数に適用されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 1 AND 3, 2 BETWEEN 3 and 1;</code></strong>
        -&gt; 1, 0
mysql&gt; <strong class="userinput"><code>SELECT 1 BETWEEN 2 AND 3;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'b' BETWEEN 'a' AND 'c';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 2 AND '3';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 2 AND 'x-3';</code></strong>
        -&gt; 0
</pre><p>
            日付または時間の値とともに <code class="literal">BETWEEN</code> を使用したときの結果を最適にするには、<code class="literal">CAST()</code> を使用して明示的に値を目的のデータ型に変換します。例 : <code class="literal">DATETIME</code> を 2 つの <code class="literal">DATE</code> 値と比較する場合は、<code class="literal">DATE</code> 値を <code class="literal">DATETIME</code> 値に変換します。<code class="literal">DATE</code> との比較で <code class="literal">'2001-1-1'</code> などの文字列定数を使用する場合は、文字列を <code class="literal">DATE</code> にキャストします。
          </p></li><li class="listitem"><a name="operator_not-between"></a><p>
            <a class="indexterm" name="idm139979099870336"></a> <code class="literal"><em class="replaceable"><code>expr</code></em> NOT BETWEEN <em class="replaceable"><code>min</code></em> AND <em class="replaceable"><code>max</code></em></code>
          </p><p>
            これは、<code class="literal">NOT (<em class="replaceable"><code>expr</code></em> BETWEEN <em class="replaceable"><code>min</code></em> AND <em class="replaceable"><code>max</code></em>)</code> と同じです。
          </p></li><li class="listitem"><a name="function_coalesce"></a><p>
            <a class="indexterm" name="idm139979099860320"></a> <a class="indexterm" name="idm139979099858288"></a> <code class="literal">COALESCE(<em class="replaceable"><code>value</code></em>,...)</code>
          </p><p>
            リストの最初の非 <code class="literal">NULL</code> 値を返します。非 <code class="literal">NULL</code> 値がない場合は、<code class="literal">NULL</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT COALESCE(NULL,1);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT COALESCE(NULL,NULL,NULL);</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_greatest"></a><p>
            <a class="indexterm" name="idm139979099846048"></a> <code class="literal">GREATEST(<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,...)</code>
          </p><p>
            2 つ以上の引数がある場合は、最大の (最大値の) 引数を返します。引数は、<code class="literal">LEAST()</code> のルールと同じルールを使用して比較されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT GREATEST(2,0);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT GREATEST(34.0,3.0,5.0,767.0);</code></strong>
        -&gt; 767.0
mysql&gt; <strong class="userinput"><code>SELECT GREATEST('B','A','C');</code></strong>
        -&gt; 'C'
</pre><p>
            引数のいずれかが <code class="literal">NULL</code> である場合、<code class="literal">GREATEST()</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_in"></a><p>
            <a class="indexterm" name="idm139979099830624"></a> <code class="literal"><em class="replaceable"><code>expr</code></em> IN (<em class="replaceable"><code>value</code></em>,...)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> が <code class="literal">IN</code> リストのいずれかの値と等しい場合は <code class="literal">1</code> を返し、それ以外の場合は <code class="literal">0</code> を返します。すべての値が定数の場合は、<em class="replaceable"><code>expr</code></em> の型に従って評価され、ソートされます。その際の項目の検索は、バイナリ検索を使って行われます。つまり、<code class="literal">IN</code> 値のリストがすべて定数で構成されている場合、<code class="literal">IN</code> は非常に高速です。それ以外の場合は、<a class="xref" href="functions.html#type-conversion" title="12.2 式評価での型変換">セクション12.2「式評価での型変換」</a>で説明したルールに従って型変換が実行されますが、すべての引数に適用されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 2 IN (0,3,5,7);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'wefwf' IN ('wee','wefwf','weg');</code></strong>
        -&gt; 1
</pre><p>
            引用符で囲まれた値 (文字列など) と囲まれていない値 (数字など) の比較ルールは異なるため、<code class="literal">IN</code> リストの引用符で囲まれた値と囲まれていない値を決して混同しないでください。したがって、型を混同すると、整合性のない結果になる可能性があります。たとえば、<code class="literal">IN</code> 式を次のように記述しないでください。
          </p><pre class="programlisting">
SELECT val1 FROM tbl1 WHERE val1 IN (1,2,'a');
</pre><p>
            代わりに、次のように記述してください。
          </p><pre class="programlisting">
SELECT val1 FROM tbl1 WHERE val1 IN ('1','2','a');
</pre><p>
            <code class="literal">IN</code> リストの値の数は、<code class="literal">max_allowed_packet</code> 値によってのみ制限されます。
          </p><p>
            SQL の標準に準拠するために、左側の式が <code class="literal">NULL</code> である場合だけでなく、リストに一致が見つからない場合やリストの式のいずれかが <code class="literal">NULL</code> である場合にも、<code class="literal">IN</code> は <code class="literal">NULL</code> を返します。
          </p><p>
            <code class="literal">IN()</code> 構文は、特定のタイプのサブクエリーを作成する際にも使用できます。<a class="xref" href="sql-syntax.html#any-in-some-subqueries" title="13.2.10.3 ANY、IN、または SOME を使用したサブクエリー">セクション13.2.10.3「ANY、IN、または SOME を使用したサブクエリー」</a>を参照してください。
          </p></li><li class="listitem"><a name="function_not-in"></a><p>
            <a class="indexterm" name="idm139979099801616"></a> <code class="literal"><em class="replaceable"><code>expr</code></em> NOT IN (<em class="replaceable"><code>value</code></em>,...)</code>
          </p><p>
            これは、<code class="literal">NOT (<em class="replaceable"><code>expr</code></em> IN (<em class="replaceable"><code>value</code></em>,...))</code> と同じです。
          </p></li><li class="listitem"><a name="function_isnull"></a><p>
            <a class="indexterm" name="idm139979099792144"></a> <code class="literal">ISNULL(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> が <code class="literal">NULL</code> の場合、<code class="literal">ISNULL()</code> は <code class="literal">1</code> を返し、それ以外の場合は <code class="literal">0</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ISNULL(1+1);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT ISNULL(1/0);</code></strong>
        -&gt; 1
</pre><p>
            <code class="literal">=</code> の代わりに <code class="literal">ISNULL()</code> を使用すると、値が <code class="literal">NULL</code> であるかどうかをテストできます。(<code class="literal">=</code> を使用して値を <code class="literal">NULL</code> と比較すると、常に false が発生します。)
          </p><p>
            <code class="literal">ISNULL()</code> 関数は <code class="literal">IS NULL</code> 比較演算子と、いくつかの特殊な動作を共有します。<code class="literal">IS NULL</code> の説明を参照してください。
          </p></li><li class="listitem"><a name="function_interval"></a><p>
            <a class="indexterm" name="idm139979099769040"></a> <code class="literal">INTERVAL(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>N1</code></em>,<em class="replaceable"><code>N2</code></em>,<em class="replaceable"><code>N3</code></em>,...)</code>
          </p><p>
            <em class="replaceable"><code>N</code></em> &lt; <em class="replaceable"><code>N1</code></em> の場合は <code class="literal">0</code> を返し、<em class="replaceable"><code>N</code></em> &lt; <em class="replaceable"><code>N2</code></em> などの場合は <code class="literal">1</code> を返し、<em class="replaceable"><code>N</code></em> が <code class="literal">NULL</code> の場合は <code class="literal">-1</code> を返します。すべての引数は整数として処理されます。この関数が正しく機能するには、<em class="replaceable"><code>N1</code></em> &lt; <em class="replaceable"><code>N2</code></em> &lt; <em class="replaceable"><code>N3</code></em> &lt; <code class="literal">...</code> &lt; <em class="replaceable"><code>Nn</code></em> とする必要があります。これは、バイナリ検索が使用されていることが理由です (非常に高速)。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(23, 1, 15, 17, 30, 44, 200);</code></strong>
        -&gt; 3
mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(10, 1, 10, 100, 1000);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(22, 23, 30, 44, 200);</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="function_least"></a><p>
            <a class="indexterm" name="idm139979099749296"></a> <code class="literal">LEAST(<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,...)</code>
          </p><p>
            2 つ以上の引数がある場合は、最小の (最小値の) 引数を返します。引数は、次のルールを使用して比較されます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                引数が <code class="literal">NULL</code> である場合、結果は <code class="literal">NULL</code> になります。比較は必要ありません。
              </p></li><li class="listitem"><p>
                戻り値が <code class="literal">INTEGER</code> コンテキストで使用されている場合、またはすべての引数が整数値である場合は、整数として比較されます。
              </p></li><li class="listitem"><p>
                戻り値が <code class="literal">REAL</code> コンテキストで使用されている場合、またはすべての引数が実数値である場合は、実数として比較されます。
              </p></li><li class="listitem"><p>
                引数が数字と文字列が混在して構成されている場合は、数字として比較されます。
              </p></li><li class="listitem"><p>
                引数が非バイナリ (文字) 文字列の場合は、非バイナリ文字列として比較されます。
              </p></li><li class="listitem"><p>
                ほかのすべてのケースでは、引数はバイナリ文字列として比較されます。
              </p></li></ul></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LEAST(2,0);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT LEAST(34.0,3.0,5.0,767.0);</code></strong>
        -&gt; 3.0
mysql&gt; <strong class="userinput"><code>SELECT LEAST('B','A','C');</code></strong>
        -&gt; 'A'
</pre><p>
            一部のボーダーラインケースでは、前述の変換ルールで異常な結果が生成される可能性があります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CAST(LEAST(3600, 9223372036854775808.0) as SIGNED);</code></strong>
        -&gt; -9223372036854775808
</pre><p>
            これは、MySQL が <code class="literal">9223372036854775808.0</code> を整数のコンテキストで読み取ることが原因で発生します。整数表記では値を保持するのに十分でないため、符号付き整数にラップします。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="logical-operators"></a>12.3.3 論理演算子</h3></div></div></div><a class="indexterm" name="idm139979099724608"></a><a class="indexterm" name="idm139979099723136"></a><div class="table"><a name="idm139979099721104"></a><p class="title"><b>表 12.4 論理演算子</b></p><div class="table-contents"><table summary="論理演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></td><td>
      論理 AND
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></td><td>
      値を否定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_or"><code class="literal">||</code>, <code class="literal">OR</code></a></td><td>
      論理 OR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></td><td>
      論理 XOR
    </td></tr></tbody></table></div></div><br class="table-break"><p>
        SQL では、すべての論理演算子は <code class="literal">TRUE</code>、<code class="literal">FALSE</code>、または <code class="literal">NULL</code> (<code class="literal">UNKNOWN</code>) に評価されます。MySQL では、これらは 1 (<code class="literal">TRUE</code>)、0 (<code class="literal">FALSE</code>)、および <code class="literal">NULL</code> として実装されます。この大部分は、さまざまな SQL データベースサーバーに共通のものです。ただし、一部のサーバーは <code class="literal">TRUE</code> にゼロ以外の任意の値を返す場合があります。
      </p><p>
        MySQL では、ゼロ以外の任意の非 <code class="literal">NULL</code> 値が <code class="literal">TRUE</code> に評価されます。たとえば、次のステートメントはすべて <code class="literal">TRUE</code> に評価されます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 10 IS TRUE;</code></strong>
-&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT -10 IS TRUE;</code></strong>
-&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'string' IS NOT NULL;</code></strong>
-&gt; 1
</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_not"></a><p>
            <a class="indexterm" name="idm139979099691664"></a> <a class="indexterm" name="idm139979099689584"></a> <code class="literal">NOT</code>、<code class="literal">!</code>
          </p><p>
            NOT 演算。オペランドが <code class="literal">0</code> の場合は <code class="literal">1</code> に、オペランドがゼロ以外の場合は <code class="literal">0</code> にそれぞれ評価され、<code class="literal">NOT NULL</code> の場合は <code class="literal">NULL</code> が返されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NOT 10;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT NOT 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT NOT NULL;</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT ! (1+1);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT ! 1+1;</code></strong>
        -&gt; 1
</pre><p>
            最後の例では、式が <code class="literal">(!1)+1</code> と同様に評価されるため、<code class="literal">1</code> が生成されています。
          </p></li><li class="listitem"><a name="operator_and"></a><p>
            <a class="indexterm" name="idm139979099670384"></a> <a class="indexterm" name="idm139979099668304"></a> <code class="literal">AND</code>、<code class="literal">&amp;&amp;</code>
          </p><p>
            AND 演算。すべてのオペランドがゼロ以外で非 <code class="literal">NULL</code> の場合は <code class="literal">1</code> に、1 つ以上のオペランドが <code class="literal">0</code> の場合は <code class="literal">0</code> に評価され、それ以外の場合は <code class="literal">NULL</code> が返されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 &amp;&amp; 1;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 1 &amp;&amp; 0;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 1 &amp;&amp; NULL;</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT 0 &amp;&amp; NULL;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT NULL &amp;&amp; 0;</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="operator_or"></a><p>
            <a class="indexterm" name="idm139979099651040"></a> <a class="indexterm" name="idm139979099648960"></a> <code class="literal">OR</code>、<code class="literal">||</code>
          </p><p>
            論理 OR。両方のオペランドが非 <code class="literal">NULL</code> であれば、オペランドのいずれかがゼロ以外である場合の結果は <code class="literal">1</code>、それ以外の場合は <code class="literal">0</code> になります。<code class="literal">NULL</code> オペランドが 1 つあれば、ほかのオペランドがゼロ以外である場合の結果は <code class="literal">1</code>、それ以外の場合は <code class="literal">NULL</code> になります。両方のオペランドが <code class="literal">NULL</code> であれば、結果は <code class="literal">NULL</code> になります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 || 1;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 1 || 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 0 || 0;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 0 || NULL;</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT 1 || NULL;</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="operator_xor"></a><p>
            <a class="indexterm" name="idm139979099629984"></a> <code class="literal">XOR</code>
          </p><p>
            論理 XOR。オペランドのいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。非 <code class="literal">NULL</code> のオペランドでは、奇数のオペランドがゼロ以外の場合は <code class="literal">1</code> に評価され、それ以外の場合は <code class="literal">0</code> が返されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 1;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR NULL;</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 1 XOR 1;</code></strong>
        -&gt; 1
</pre><p>
            <code class="literal">a XOR b</code> は、数学的に <code class="literal">(a AND (NOT b)) OR ((NOT a) and b)</code> に等しくなります。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="assignment-operators"></a>12.3.4 割り当て演算子</h3></div></div></div><a class="indexterm" name="idm139979099613472"></a><a class="indexterm" name="idm139979099612000"></a><div class="table"><a name="idm139979099609968"></a><p class="title"><b>表 12.5 割り当て演算子</b></p><div class="table-contents"><table summary="割り当て演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></td><td>
      (<code class="literal">SET</code>
      ステートメントの一部として、または
      <code class="literal">UPDATE</code> ステートメントの
      <code class="literal">SET</code> 句の一部として)
      値を割り当てます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></td><td>
      値を割り当てます
    </td></tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_assign-value"></a><p>
            <a class="indexterm" name="idm139979099597168"></a> <a class="indexterm" name="idm139979099595664"></a> <code class="literal">:=</code>
          </p><p>
            割り当て演算子。演算子の左側にあるユーザー変数が右側にある値に代入されます。右側の値は、リテラル値、値を格納する別の変数、またはクエリーの結果を含むスカラー値を生成する任意の有効な式 (この値がスカラー値の場合) である可能性があります。同じ <code class="literal">SET</code> ステートメントで、複数の割り当てを実行できます。同じステートメントで、複数の割り当てを実行できます。
          </p><p>
            <code class="literal">=</code> とは異なり、<code class="literal">:=</code> 演算子は比較演算子として解釈されません。つまり、(<code class="literal">SET</code> ステートメントだけでなく) 有効な任意の SQL ステートメントで <code class="literal">:=</code> を使用すれば、値を変数に割り当てることができます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; NULL, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1 := 1, @var2;</code></strong>
        -&gt; 1, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; 1, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2 := @var1;</code></strong>
        -&gt; 1, 1
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; 1, 1

mysql&gt; <strong class="userinput"><code>SELECT @var1:=COUNT(*) FROM t1;</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong>
        -&gt; 4
</pre><p>
            次に示すように、<code class="literal">SELECT</code> 以外のステートメント (<code class="literal">UPDATE</code> など) でも、<code class="literal">:=</code> を使用して値の割り当てを実行できます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong>
        -&gt; 1, 3, 5, 7

mysql&gt; <strong class="userinput"><code>UPDATE t1 SET c1 = 2 WHERE c1 = @var1:= 1;</code></strong>
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong>
        -&gt; 2, 3, 5, 7
</pre><p>
            <code class="literal">:=</code> 演算子を使用すれば、単一の SQL ステートメントで同じ変数の値の設定と読み取りの両方を行うこともできますが、これは推奨されていません。<a class="xref" href="language-structure.html#user-variables" title="9.4 ユーザー定義変数">セクション9.4「ユーザー定義変数」</a>では、これを回避するべき理由について説明されています。
          </p></li><li class="listitem"><a name="operator_assign-equal"></a><p>
            <a class="indexterm" name="idm139979099562624"></a> <a class="indexterm" name="idm139979099561120"></a> <a class="indexterm" name="idm139979099559248"></a> <code class="literal">=</code>
          </p><p>
            この演算子は、次の 2 つのパラグラフで説明する 2 つのケースで値の割り当てを実行する際に使用されます。
          </p><p>
            <code class="literal">SET</code> ステートメントでは、<code class="literal">=</code> は、演算子の左側にあるユーザー変数を右側にある値に代入する割り当て演算子として処理されます。(言い換えると、<code class="literal">SET</code> ステートメントで使用されると、<code class="literal">=</code> は <code class="literal">:=</code> と同じように処理されます。)右側の値は、リテラル値、値を格納する別の変数、またはクエリーの結果を含むスカラー値を生成する任意の有効な式 (この値がスカラー値の場合) である可能性があります。同じ <code class="literal">SET</code> ステートメントで、複数の割り当てを実行できます。
          </p><p>
            <code class="literal">UPDATE</code> ステートメントの <code class="literal">SET</code> 句では、<code class="literal">=</code> は割り当て演算子としても機能します。ただし、この場合、<code class="literal">UPDATE</code> の一部である <code class="literal">WHERE</code> 条件に一致していれば、演算子の左側で指定されたカラムが右側に指定された値であるとみなされます。<code class="literal">UPDATE</code> ステートメントの同じ <code class="literal">SET</code> 句で、複数の割り当てを実行できます。
          </p><p>
            その他のコンテキストでは、<code class="literal">=</code> は<a class="link" href="functions.html#operator_equal">比較演算子</a>として処理されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; NULL, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1 := 1, @var2;</code></strong>
        -&gt; 1, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; 1, NULL
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2 := @var1;</code></strong>
        -&gt; 1, 1
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong>
        -&gt; 1, 1
</pre><p>
            詳細は、<a class="xref" href="sql-syntax.html#set-statement" title="13.7.4 SET 構文">セクション13.7.4「SET 構文」</a>、<a class="xref" href="sql-syntax.html#update" title="13.2.11 UPDATE 構文">セクション13.2.11「UPDATE 構文」</a>、および<a class="xref" href="sql-syntax.html#subqueries" title="13.2.10 サブクエリー構文">セクション13.2.10「サブクエリー構文」</a>を参照してください。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="control-flow-functions"></a>12.4 制御フロー関数</h2></div></div></div><a class="indexterm" name="idm139979099527520"></a><a class="indexterm" name="idm139979099526048"></a><div class="table"><a name="idm139979099524016"></a><p class="title"><b>表 12.6 フロー制御演算子</b></p><div class="table-contents"><table summary="フロー制御演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></td><td>
      CASE 演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a></td><td>
      If/else 構文
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL()</code></a></td><td>
      Null if/else 構文
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_nullif"><code class="literal">NULLIF()</code></a></td><td>
      expr1 = expr2 の場合に NULL を返します
    </td></tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_case"></a><p>
          <a class="indexterm" name="idm139979099508816"></a> <code class="literal">CASE <em class="replaceable"><code>value</code></em> WHEN [<em class="replaceable"><code>compare_value</code></em>] THEN <em class="replaceable"><code>result</code></em> [WHEN [<em class="replaceable"><code>compare_value</code></em>] THEN <em class="replaceable"><code>result</code></em> ...] [ELSE <em class="replaceable"><code>result</code></em>] END</code>
        </p><p>
          <code class="literal">CASE WHEN [<em class="replaceable"><code>condition</code></em>] THEN <em class="replaceable"><code>result</code></em> [WHEN [<em class="replaceable"><code>condition</code></em>] THEN <em class="replaceable"><code>result</code></em> ...] [ELSE <em class="replaceable"><code>result</code></em>] END</code>
        </p><p>
          1 番目のバージョンでは、<code class="literal"><em class="replaceable"><code>value</code></em>=<em class="replaceable"><code>compare_value</code></em></code> の場合に <em class="replaceable"><code>result</code></em> が返されます。2 番目のバージョンでは、true である最初の条件の結果が返されます。一致する結果値がなかった場合は、<code class="literal">ELSE</code> のあとの結果が返され、<code class="literal">ELSE</code> 部分がない場合は、<code class="literal">NULL</code> が返されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CASE 1 WHEN 1 THEN 'one'</code></strong>
    -&gt;     <strong class="userinput"><code>WHEN 2 THEN 'two' ELSE 'more' END;</code></strong>
        -&gt; 'one'
mysql&gt; <strong class="userinput"><code>SELECT CASE WHEN 1&gt;0 THEN 'true' ELSE 'false' END;</code></strong>
        -&gt; 'true'
mysql&gt; <strong class="userinput"><code>SELECT CASE BINARY 'B'</code></strong>
    -&gt;     <strong class="userinput"><code>WHEN 'a' THEN 1 WHEN 'b' THEN 2 END;</code></strong>
        -&gt; NULL
</pre><p>
          <code class="literal">CASE</code> 式の戻り型は、すべての戻り値の互換性のある集約型ですが、使用されるコンテキストにも依存します。文字列のコンテキストで使用される場合は、結果は文字列として返されます。数値のコンテキストで使用される場合は、結果が 10 進数値、実数値、または整数値として返されます。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            ここで示す <code class="literal">CASE</code> <span class="emphasis"><em>式</em></span>の構文は、ストアドプログラム内部で使用するために、<a class="xref" href="sql-syntax.html#case" title="13.6.5.1 CASE 構文">セクション13.6.5.1「CASE 構文」</a>で説明した SQL <code class="literal">CASE</code> <span class="emphasis"><em>ステートメント</em></span>の構文とはわずかに異なります。<code class="literal">CASE</code> ステートメントは <code class="literal">ELSE NULL</code> 句を持つことができず、<code class="literal">END</code> でなく、<code class="literal">END CASE</code> で終了します。
          </p></div></li><li class="listitem"><a name="function_if"></a><p>
          <a class="indexterm" name="idm139979099475264"></a> <code class="literal">IF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>,<em class="replaceable"><code>expr3</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>expr1</code></em> が <code class="literal">TRUE</code> (<code class="literal"><em class="replaceable"><code>expr1</code></em> &lt;&gt; 0</code> および <code class="literal"><em class="replaceable"><code>expr1</code></em> &lt;&gt; NULL</code>) の場合、<code class="literal">IF()</code> は <em class="replaceable"><code>expr2</code></em> を返します。それ以外の場合は <em class="replaceable"><code>expr3</code></em> を返します。<code class="literal">IF()</code> は、使用されているコンテキストに応じて、数値または文字列値を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT IF(1&gt;2,2,3);</code></strong>
        -&gt; 3
mysql&gt; <strong class="userinput"><code>SELECT IF(1&lt;2,'yes','no');</code></strong>
        -&gt; 'yes'
mysql&gt; <strong class="userinput"><code>SELECT IF(STRCMP('test','test1'),'no','yes');</code></strong>
        -&gt; 'no'
</pre><p>
          <em class="replaceable"><code>expr2</code></em> と <em class="replaceable"><code>expr3</code></em> の一方のみが明示的に <code class="literal">NULL</code> である場合は、<code class="literal">IF()</code> 関数の結果型は非 <code class="literal">NULL</code> 式の型になります。
        </p><p>
          <code class="literal">IF()</code> のデフォルトの戻り値 (一時テーブルに格納されるときに重要となる場合があります) は、次のように計算されます。
        </p><div class="informaltable"><table summary="この表には、IF() のデフォルトの戻り型が計算される方法を示す式および対応する戻り値を一覧表示します。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">式</th><th scope="col">戻り値</th></tr></thead><tbody><tr><td scope="row"><em class="replaceable"><code>expr2</code></em> または <em class="replaceable"><code>expr3</code></em> は文字列を返す</td><td>文字列</td></tr><tr><td scope="row"><em class="replaceable"><code>expr2</code></em> または <em class="replaceable"><code>expr3</code></em> は浮動小数点値を返す</td><td>浮動小数点</td></tr><tr><td scope="row"><em class="replaceable"><code>expr2</code></em> または <em class="replaceable"><code>expr3</code></em> は整数を返す</td><td>整数</td></tr></tbody></table></div><p>
          <em class="replaceable"><code>expr2</code></em> と <em class="replaceable"><code>expr3</code></em> の両方が文字列で、どちらかの文字列で大文字と小文字が区別される場合は、結果でも大文字と小文字が区別されます。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">IF</code> <span class="emphasis"><em>ステートメント</em></span>もありますが、ここで説明されている <code class="literal">IF()</code> <span class="emphasis"><em>関数</em></span>とは異なります。<a class="xref" href="sql-syntax.html#if" title="13.6.5.2 IF 構文">セクション13.6.5.2「IF 構文」</a>を参照してください。
          </p></div></li><li class="listitem"><a name="function_ifnull"></a><p>
          <a class="indexterm" name="idm139979099433744"></a> <a class="indexterm" name="idm139979099431536"></a> <code class="literal">IFNULL(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>expr1</code></em> が <code class="literal">NULL</code> でない場合、<code class="literal">IFNULL()</code> は <em class="replaceable"><code>expr1</code></em> を返し、それ以外の場合は <em class="replaceable"><code>expr2</code></em> を返します。<code class="literal">IFNULL()</code> は、使用されているコンテキストに応じて、数値または文字列値を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1,0);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(NULL,10);</code></strong>
        -&gt; 10
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1/0,10);</code></strong>
        -&gt; 10
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1/0,'yes');</code></strong>
        -&gt; 'yes'
</pre><p>
          <code class="literal">IFNULL(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code> のデフォルトの結果値は、<code class="literal">STRING</code>、<code class="literal">REAL</code>、または <code class="literal">INTEGER</code> の順に、2 つの式のよりも<span class="quote">「<span class="quote">一般的</span>」</span>です。式や MySQL が一時テーブルの <code class="literal">IFNULL()</code> で返された値を内部に格納する必要のある場所に基づいて、テーブルの大文字と小文字を考慮してください。
        </p><pre class="programlisting">

mysql&gt; <strong class="userinput"><code>CREATE TABLE tmp SELECT IFNULL(1,'test') AS test;</code></strong>
mysql&gt; <strong class="userinput"><code>DESCRIBE tmp;</code></strong>
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| test  | varbinary(4) | NO   |     |         |       |
+-------+--------------+------+-----+---------+-------+
</pre><p>
          この例では、<code class="literal">test</code> カラムの型は <code class="literal">VARBINARY(4)</code> です。
        </p></li><li class="listitem"><a name="function_nullif"></a><p>
          <a class="indexterm" name="idm139979099404080"></a> <code class="literal">NULLIF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><p>
          <code class="literal"><em class="replaceable"><code>expr1</code></em> = <em class="replaceable"><code>expr2</code></em></code> が true の場合は <code class="literal">NULL</code> を返し、それ以外の場合は <em class="replaceable"><code>expr1</code></em> を返します。これは、<code class="literal">CASE WHEN <em class="replaceable"><code>expr1</code></em> = <em class="replaceable"><code>expr2</code></em> THEN NULL ELSE <em class="replaceable"><code>expr1</code></em> END</code> と同じです。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NULLIF(1,1);</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT NULLIF(1,2);</code></strong>
        -&gt; 1
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            引数が等しくない場合は、MySQL で <em class="replaceable"><code>expr1</code></em> が 2 回評価されます。
          </p></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="string-functions"></a>12.5 文字列関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#string-comparison-functions">12.5.1 文字列比較関数</a></span></dt><dt><span class="section"><a href="functions.html#regexp">12.5.2 正規表現</a></span></dt></dl></div><a class="indexterm" name="idm139979099388160"></a><a class="indexterm" name="idm139979099386688"></a><div class="table"><a name="idm139979099384656"></a><p class="title"><b>表 12.7 文字列演算子</b></p><div class="table-contents"><table summary="文字列演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a></td><td>
      左端の文字の数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bin"><code class="literal">BIN()</code></a></td><td>
      数値のバイナリ表現を含む文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-length"><code class="literal">BIT_LENGTH()</code></a></td><td>
      ビット単位で引数の長さを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a></td><td>
      引数の文字数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a></td><td>
      渡された各整数の文字を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_character-length"><code class="literal">CHARACTER_LENGTH()</code></a></td><td>
      CHAR_LENGTH() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a></td><td>
      連結されたものをセパレータ付きで返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a></td><td>
      連結された文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a></td><td>
      インデックス番号位置の文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_export-set"><code class="literal">EXPORT_SET()</code></a></td><td>
      値 bits 内の各ビットが設定されている場合は on
      文字列を取得し、各ビットが設定されていない場合には
      off 文字列を取得するように、文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a></td><td>
      後続の引数内で第 1 引数のインデックス (位置)
      を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_find-in-set"><code class="literal">FIND_IN_SET()</code></a></td><td>
      第 2 引数内で第 1
      引数のインデックス位置を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_format"><code class="literal">FORMAT()</code></a></td><td>
      指定された小数点以下桁数に書式設定された数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64()</code></a></td><td>
      base 64 文字列にデコードして結果を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a></td><td>
      10 進値または文字列値の 16 進表現を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_insert"><code class="literal">INSERT()</code></a></td><td>
      部分文字列を、指定された位置に指定された文字数だけ挿入します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_instr"><code class="literal">INSTR()</code></a></td><td>
      部分文字列が最初に出現する位置のインデックスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_lcase"><code class="literal">LCASE()</code></a></td><td>
      LOWER() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_left"><code class="literal">LEFT()</code></a></td><td>
      左端から指定された数の文字を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a></td><td>
      文字列の長さをバイト単位で返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td><td>
      単純なパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a></td><td>
      指定されたファイルをロードします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_locate"><code class="literal">LOCATE()</code></a></td><td>
      部分文字列が最初に出現する位置を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a></td><td>
      引数を小文字で返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_lpad"><code class="literal">LPAD()</code></a></td><td>
      指定された文字列で左からパディングした文字列引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ltrim"><code class="literal">LTRIM()</code></a></td><td>
      先頭の空白を削除します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_make-set"><code class="literal">MAKE_SET()</code></a></td><td>
      bits
      セット内の対応するビットを持つ、カンマ区切り文字列のセットを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_match"><code class="literal">MATCH</code></a></td><td>
      全文検索を実行します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mid"><code class="literal">MID()</code></a></td><td>
      指定された位置から始まる部分文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td><td>
      単純なパターン一致の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td><td>
      REGEXP の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_oct"><code class="literal">OCT()</code></a></td><td>
      数値の 8 進数表現を含む文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_octet-length"><code class="literal">OCTET_LENGTH()</code></a></td><td>
      LENGTH() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ord"><code class="literal">ORD()</code></a></td><td>
      引数の左端の文字の文字コードを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_position"><code class="literal">POSITION()</code></a></td><td>
      LOCATE() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_quote"><code class="literal">QUOTE()</code></a></td><td>
      SQL
      ステートメント内で使用するために引数をエスケープします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td><td>
      正規表現を使用したパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_repeat"><code class="literal">REPEAT()</code></a></td><td>
      文字列を指定された回数だけ繰り返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a></td><td>
      指定された文字列の出現箇所を置き換えます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_reverse"><code class="literal">REVERSE()</code></a></td><td>
      文字列内の文字を逆順に並べ替えます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_right"><code class="literal">RIGHT()</code></a></td><td>
      右端から指定された数の文字を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a></td><td>
      REGEXP のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_rpad"><code class="literal">RPAD()</code></a></td><td>
      指定された回数だけ文字列を追加します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_rtrim"><code class="literal">RTRIM()</code></a></td><td>
      末尾の空白を削除します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a></td><td>
      soundex 文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></td><td>
      音声を比較します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_space"><code class="literal">SPACE()</code></a></td><td>
      指定された数の空白で構成される文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td><td>
      2 つの文字列を比較します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR()</code></a></td><td>
      指定された部分文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_substring-index"><code class="literal">SUBSTRING_INDEX()</code></a></td><td>
      文字列から、区切り文字が指定された回数出現する前の部分文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a></td><td>
      指定された部分文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a></td><td>
      base 64 文字列に変換された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_trim"><code class="literal">TRIM()</code></a></td><td>
      先頭と末尾にある空白を削除します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ucase"><code class="literal">UCASE()</code></a></td><td>
      UPPER() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a></td><td>
      数値の 16 進数表現を含む文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a></td><td>
      大文字に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a></td><td>
      文字列の重み文字列を返します
    </td></tr></tbody></table></div></div><br class="table-break"><p>
      文字列値の関数は、結果の長さが <code class="literal">max_allowed_packet</code> システム環境変数の値よりも長くなると、<code class="literal">NULL</code> を返します。<a class="xref" href="optimization.html#server-parameters" title="8.11.2 サーバーパラメータのチューニング">セクション8.11.2「サーバーパラメータのチューニング」</a>を参照してください。
    </p><p>
      文字列の位置を操作する関数では、最初の位置には数値 1 が付けられます。
    </p><p>
      長さの引数を取る関数では、整数以外の引数はもっとも近い整数に丸められます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_ascii"></a><p>
          <a class="indexterm" name="idm139979099260112"></a> <code class="literal">ASCII(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>str</code></em> の左端の文字の数値を返します。<em class="replaceable"><code>str</code></em> が空の文字列である場合は、<code class="literal">0</code> を返します。<em class="replaceable"><code>str</code></em> が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。<code class="literal">ASCII()</code> は、8 ビット文字の場合に動作します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ASCII('2');</code></strong>
        -&gt; 50
mysql&gt; <strong class="userinput"><code>SELECT ASCII(2);</code></strong>
        -&gt; 50
mysql&gt; <strong class="userinput"><code>SELECT ASCII('dx');</code></strong>
        -&gt; 100
</pre><p>
          <code class="literal">ORD()</code> 関数も参照してください。
        </p></li><li class="listitem"><a name="function_bin"></a><p>
          <a class="indexterm" name="idm139979099243328"></a> <code class="literal">BIN(<em class="replaceable"><code>N</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>N</code></em> のバイナリ値の文字列表現を返します。<em class="replaceable"><code>N</code></em> は longlong (<code class="literal">BIGINT</code>) 数字です。これは、<code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10,2)</code> と同等です。<em class="replaceable"><code>N</code></em> が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT BIN(12);</code></strong>
        -&gt; '1100'
</pre></li><li class="listitem"><a name="function_bit-length"></a><p>
          <a class="indexterm" name="idm139979099228896"></a> <code class="literal">BIT_LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>str</code></em> の長さをビット単位で返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT BIT_LENGTH('text');</code></strong>
        -&gt; 32
</pre></li><li class="listitem"><a name="function_char"></a><p>
          <a class="indexterm" name="idm139979099219184"></a> <code class="literal">CHAR(<em class="replaceable"><code>N</code></em>,... [USING <em class="replaceable"><code>charset_name</code></em>])</code>
        </p><p>
          <code class="literal">CHAR()</code> は各 <em class="replaceable"><code>N</code></em> 引数を整数として解釈し、それらの整数のコード値で指定された文字を構成している文字列を返します。<code class="literal">NULL</code> 値はスキップされます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CHAR(77,121,83,81,'76');</code></strong>
        -&gt; 'MySQL'
mysql&gt; <strong class="userinput"><code>SELECT CHAR(77,77.3,'77.3');</code></strong>
        -&gt; 'MMM'
</pre><p>
          255 よりも大きい <code class="literal">CHAR()</code> 引数は、複数の結果バイトに変換されます。たとえば、<code class="literal">CHAR(256)</code> は <code class="literal">CHAR(1,0)</code> に同等で、<code class="literal">CHAR(256*256)</code> は <code class="literal">CHAR(1,0,0)</code> に同等です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(CHAR(1,0)), HEX(CHAR(256));</code></strong>
+----------------+----------------+
| HEX(CHAR(1,0)) | HEX(CHAR(256)) |
+----------------+----------------+
| 0100           | 0100           |
+----------------+----------------+
mysql&gt; <strong class="userinput"><code>SELECT HEX(CHAR(1,0,0)), HEX(CHAR(256*256));</code></strong>
+------------------+--------------------+
| HEX(CHAR(1,0,0)) | HEX(CHAR(256*256)) |
+------------------+--------------------+
| 010000           | 010000             |
+------------------+--------------------+
</pre><p>
          デフォルトでは、<code class="literal">CHAR()</code> はバイナリ文字列を返します。指定された文字セットで文字列を生成するには、オプションの <code class="literal">USING</code> 句を使用します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CHARSET(CHAR(0x65)), CHARSET(CHAR(0x65 USING utf8));</code></strong>
+---------------------+--------------------------------+
| CHARSET(CHAR(0x65)) | CHARSET(CHAR(0x65 USING utf8)) |
+---------------------+--------------------------------+
| binary              | utf8                           |
+---------------------+--------------------------------+
</pre><p>
          <code class="literal">USING</code> が指定され、結果文字列が指定された文字セットで不正である場合は、警告が発行されます。また、厳密な SQL モードが有効になっている場合は、<code class="literal">CHAR()</code> からの結果は <code class="literal">NULL</code> になります。
        </p></li><li class="listitem"><a name="function_char-length"></a><p>
          <a class="indexterm" name="idm139979099189456"></a> <code class="literal">CHAR_LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字で測定された文字列 <em class="replaceable"><code>str</code></em> の長さを返します。マルチバイト文字は、単一の文字としてカウントされます。つまり、5 つの 2 バイト文字を含む文字列では、<code class="literal">LENGTH()</code> は <code class="literal">10</code> を返し、<code class="literal">CHAR_LENGTH()</code> は <code class="literal">5</code> を返します。
        </p></li><li class="listitem"><a name="function_character-length"></a><p>
          <a class="indexterm" name="idm139979099177968"></a> <code class="literal">CHARACTER_LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <code class="literal">CHARACTER_LENGTH()</code> は <code class="literal">CHAR_LENGTH()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_concat"></a><p>
          <a class="indexterm" name="idm139979099168752"></a> <a class="indexterm" name="idm139979099167408"></a> <a class="indexterm" name="idm139979099165984"></a> <code class="literal">CONCAT(<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code>
        </p><p>
          引数を連結することで生成される文字列を返します。1 つ以上の引数を持つ場合があります。すべての引数が非バイナリ文字列の場合は、結果も非バイナリ文字列になります。引数にバイナリ文字列が含まれる場合は、結果はバイナリ文字列になります。数値の引数は、同等の非バイナリ文字列形式に変換されます。
        </p><p>
          引数のいずれかかが <code class="literal">NULL</code> である場合、<code class="literal">CONCAT()</code> は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CONCAT('My', 'S', 'QL');</code></strong>
        -&gt; 'MySQL'
mysql&gt; <strong class="userinput"><code>SELECT CONCAT('My', NULL, 'QL');</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT CONCAT(14.3);</code></strong>
        -&gt; '14.3'
</pre><p>
          引用符で囲まれた文字列では、文字列を並べて配置することで連結が実行されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'My' 'S' 'QL';</code></strong>
        -&gt; 'MySQL'
</pre></li><li class="listitem"><a name="function_concat-ws"></a><p>
          <a class="indexterm" name="idm139979099148544"></a> <code class="literal">CONCAT_WS(<em class="replaceable"><code>separator</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code>
        </p><p>
          <code class="literal">CONCAT_WS()</code> は Concatenate With Separator (区切り文字を使用した連結) を表し、<code class="literal">CONCAT()</code> の特殊な形式です。最初の引数は、残りの引数の区切り文字です。区切り文字は、連結される文字列の間に追加されます。区切り文字は、残りの引数と同様に文字列にすることができます。区切り文字が <code class="literal">NULL</code> の場合は、結果も <code class="literal">NULL</code> になります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CONCAT_WS(',','First name','Second name','Last Name');</code></strong>
        -&gt; 'First name,Second name,Last Name'
mysql&gt; <strong class="userinput"><code>SELECT CONCAT_WS(',','First name',NULL,'Last Name');</code></strong>
        -&gt; 'First name,Last Name'
</pre><p>
          <code class="literal">CONCAT_WS()</code> では、空の文字列がスキップされません。ただし、区切り文字引数のあとの <code class="literal">NULL</code> 値はすべてスキップされます。
        </p></li><li class="listitem"><a name="function_elt"></a><p>
          <a class="indexterm" name="idm139979099131024"></a> <code class="literal">ELT(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,<em class="replaceable"><code>str3</code></em>,...)</code>
        </p><p>
          <code class="literal">ELT()</code> は、文字列リストの <em class="replaceable"><code>N</code></em> 番目の要素を返します。<em class="replaceable"><code>N</code></em> = <code class="literal">1</code> の場合は <em class="replaceable"><code>str1</code></em>、<em class="replaceable"><code>N</code></em> = <code class="literal">2</code> の場合は <em class="replaceable"><code>str2</code></em> のように返します。<em class="replaceable"><code>N</code></em> が <code class="literal">1</code> よりも小さいか、引数の数よりも大きい場合は、<code class="literal">NULL</code> を返します。<code class="literal">ELT()</code> は <code class="literal">FIELD()</code> の補数です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ELT(1, 'ej', 'Heja', 'hej', 'foo');</code></strong>
        -&gt; 'ej'
mysql&gt; <strong class="userinput"><code>SELECT ELT(4, 'ej', 'Heja', 'hej', 'foo');</code></strong>
        -&gt; 'foo'
</pre></li><li class="listitem"><a name="function_export-set"></a><p>
          <a class="indexterm" name="idm139979099111232"></a> <code class="literal">EXPORT_SET(<em class="replaceable"><code>bits</code></em>,<em class="replaceable"><code>on</code></em>,<em class="replaceable"><code>off</code></em>[,<em class="replaceable"><code>separator</code></em>[,<em class="replaceable"><code>number_of_bits</code></em>]])</code>
        </p><p>
          値 <em class="replaceable"><code>bits</code></em> 内で各ビットが設定されている場合には <em class="replaceable"><code>on</code></em> 文字列を取得し、値内で各ビットが設定されていない場合には <em class="replaceable"><code>off</code></em> 文字列を取得するように、文字列を返します。<em class="replaceable"><code>bits</code></em> のビットは、右から左 (下位ビットから上位ビット) へと検証されます。文字列は、<em class="replaceable"><code>separator</code></em> 文字列 (デフォルトはカンマ文字 <span class="quote">「<span class="quote"><code class="literal">,</code></span>」</span>) で区切られた結果に左から右へと追加されます。検証されるビット数は、<em class="replaceable"><code>number_of_bits</code></em> で指定されます。指定されない場合のデフォルトは 64 です。<em class="replaceable"><code>number_of_bits</code></em> が 64 よりも大きい場合は、警告なしで 64 に短縮されます。符号なし整数として処理されるため、値 −1 は実際には 64 と同じです。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT EXPORT_SET(5,'Y','N',',',4);</code></strong>
        -&gt; 'Y,N,Y,N'
mysql&gt; <strong class="userinput"><code>SELECT EXPORT_SET(6,'1','0',',',10);</code></strong>
        -&gt; '0,1,1,0,0,0,0,0,0,0'
</pre></li><li class="listitem"><a name="function_field"></a><p>
          <a class="indexterm" name="idm139979099094368"></a> <code class="literal">FIELD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,<em class="replaceable"><code>str3</code></em>,...)</code>
        </p><p>
          <em class="replaceable"><code>str1</code></em>、<em class="replaceable"><code>str2</code></em>、<em class="replaceable"><code>str3</code></em>、<code class="literal">...</code> リスト内で <em class="replaceable"><code>str</code></em> のインデックス (位置) を返します。<em class="replaceable"><code>str</code></em> が見つからない場合は、<code class="literal">0</code> を返します。
        </p><p>
          <code class="literal">FIELD()</code> へのすべての引数が文字列の場合は、すべての引数が文字列として比較されます。すべての引数が数値の場合は、数字として比較されます。それ以外の場合は、引数が倍精度として比較されます。
        </p><p>
          <code class="literal">NULL</code> ではどの値との等価比較にも失敗するため、<em class="replaceable"><code>str</code></em> が <code class="literal">NULL</code> である場合は、戻り値が <code class="literal">0</code> になります。<code class="literal">FIELD()</code> は <code class="literal">ELT()</code> の補数です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FIELD('ej', 'Hej', 'ej', 'Heja', 'hej', 'foo');</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT FIELD('fo', 'Hej', 'ej', 'Heja', 'hej', 'foo');</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="function_find-in-set"></a><p>
          <a class="indexterm" name="idm139979099072464"></a> <code class="literal">FIND_IN_SET(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>strlist</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>str</code></em> が <em class="replaceable"><code>N</code></em> 部分文字列で構成される文字列リスト <em class="replaceable"><code>strlist</code></em> 内にある場合は、1 から <em class="replaceable"><code>N</code></em> までの範囲内の値を返します。文字列リストは、<span class="quote">「<span class="quote"><code class="literal">,</code></span>」</span> 文字で区切られた部分文字列で構成された文字列です。最初の引数が定数文字列で、2 番目が <code class="literal">SET</code> 型のカラムの場合、<code class="literal">FIND_IN_SET()</code> 関数はビット演算を使用するために最適化されます。<em class="replaceable"><code>str</code></em> が <em class="replaceable"><code>strlist</code></em> 内にない場合、または <em class="replaceable"><code>strlist</code></em> が空の文字列の場合は、<code class="literal">0</code> を返します。引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。最初の引数にカンマ (<span class="quote">「<span class="quote"><code class="literal">,</code></span>」</span>) 文字が含まれる場合は、この関数が正しく動作しません。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FIND_IN_SET('b','a,b,c,d');</code></strong>
        -&gt; 2
</pre></li><li class="listitem"><a name="function_format"></a><p>
          <a class="indexterm" name="idm139979099053008"></a> <code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>[,<em class="replaceable"><code>locale</code></em>])</code>
        </p><p>
          数値 <em class="replaceable"><code>X</code></em> を <code class="literal">'#,###,###.##'</code> のような書式に変換し、小数点第 <em class="replaceable"><code>D</code></em> 位に丸めて、その結果を文字列として返します。<em class="replaceable"><code>D</code></em> が <code class="literal">0</code> の場合は、結果に小数点または小数部が含まれません。
        </p><p>
          オプションの 3 番目のパラメータを使用すると、結果数の小数点、3 桁の区切り文字、および区切り文字間のグループ化に使用されるロケールを指定できます。許可されるロケール値は、<code class="literal">lc_time_names</code> システム変数の有効な値と同じです (<a class="xref" href="globalization.html#locale-support" title="10.7 MySQL Server のロケールサポート">セクション10.7「MySQL Server のロケールサポート」</a>を参照してください)。ロケールが指定されていない場合のデフォルトは、<code class="literal">'en_US'</code> です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.123456, 4);</code></strong>
        -&gt; '12,332.1235'
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.1,4);</code></strong>
        -&gt; '12,332.1000'
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.2,0);</code></strong>
        -&gt; '12,332'
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.2,2,'de_DE');</code></strong>
        -&gt; '12.332,20'
</pre></li><li class="listitem"><a name="function_from-base64"></a><p>
          <a class="indexterm" name="idm139979099034064"></a> <code class="literal">FROM_BASE64(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <code class="literal">TO_BASE64()</code> で使用される base-64 でエンコードされたルールでエンコードされた文字列が指定され、デコードされた結果をバイナリ文字列として返します。引数が <code class="literal">NULL</code> の場合または有効な base-64 文字列でない場合は、結果が <code class="literal">NULL</code> になります。ルールのエンコードおよびデコードについての詳細は、<code class="literal">TO_BASE64()</code> の説明を参照してください。
        </p><p>
          この関数は、MySQL 5.6.1 で追加されました。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TO_BASE64('abc'), FROM_BASE64(TO_BASE64('abc'));</code></strong>
        -&gt; 'JWJj', 'abc'
</pre></li><li class="listitem"><a name="function_hex"></a><p>
          <a class="indexterm" name="idm139979099020064"></a> <code class="literal">HEX(<em class="replaceable"><code>str</code></em>)</code>, <code class="literal">HEX(<em class="replaceable"><code>N</code></em>)</code>
        </p><p>
          文字列の引数 <em class="replaceable"><code>str</code></em> では、<code class="literal">HEX()</code> は <em class="replaceable"><code>str</code></em> の 16 進数文字列表現を返します。<em class="replaceable"><code>str</code></em> 内の各文字の各バイトは、2 つの 16 進数字に変換されます。(したがって、マルチバイト文字は 2 桁よりも大きくなります。)この演算の逆は、<code class="literal">UNHEX()</code> 関数で実行されます。
        </p><p>
          数値の引数 <em class="replaceable"><code>N</code></em> では、<code class="literal">HEX()</code> は、longlong (<code class="literal">BIGINT</code>) 数字として処理される <em class="replaceable"><code>N</code></em> の 16 進数文字列表現を返します。これは、<code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10.16)</code> と同等です。この演算の逆は、<code class="literal">CONV(HEX(<em class="replaceable"><code>N</code></em>),16,10)</code> で実行されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 0x616263, HEX('abc'), UNHEX(HEX('abc'));</code></strong>
        -&gt; 'abc', 616263, 'abc'
mysql&gt; <strong class="userinput"><code>SELECT HEX(255), CONV(HEX(255),16,10);</code></strong>
        -&gt; 'FF', 255
</pre></li><li class="listitem"><a name="function_insert"></a><p>
          <a class="indexterm" name="idm139979098997904"></a> <code class="literal">INSERT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>newstr</code></em>)</code>
        </p><p>
          位置 <em class="replaceable"><code>pos</code></em> で始まる部分文字列と、文字列 <em class="replaceable"><code>newstr</code></em> で置換された <em class="replaceable"><code>len</code></em> 文字長とともに、文字列 <em class="replaceable"><code>str</code></em> を返します。<em class="replaceable"><code>pos</code></em> が文字列の長さに収まらない場合は、元の文字列を返します。<em class="replaceable"><code>len</code></em> が残りの文字列の長さに収まらない場合は、位置 <em class="replaceable"><code>pos</code></em> からの残りの文字列を置換します。引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', 3, 4, 'What');</code></strong>
        -&gt; 'QuWhattic'
mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', -1, 4, 'What');</code></strong>
        -&gt; 'Quadratic'
mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', 3, 100, 'What');</code></strong>
        -&gt; 'QuWhat'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_instr"></a><p>
          <a class="indexterm" name="idm139979098980240"></a> <code class="literal">INSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>substr</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>str</code></em> 内で部分文字列 <em class="replaceable"><code>substr</code></em> が最初に出現する位置を返します。これは、引数の順序が逆になる点を除いて、2 つの引数形式の <code class="literal">LOCATE()</code> と同じです。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT INSTR('foobarbar', 'bar');</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT INSTR('xbar', 'foobar');</code></strong>
        -&gt; 0
</pre><p>
          この関数はマルチバイトセーフであり、1 つ以上の引数がバイナリ文字列である場合にのみ大文字と小文字が区別されます。
        </p></li><li class="listitem"><a name="function_lcase"></a><p>
          <a class="indexterm" name="idm139979098966992"></a> <code class="literal">LCASE(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <code class="literal">LCASE()</code> は <code class="literal">LOWER()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_left"></a><p>
          <a class="indexterm" name="idm139979098957840"></a> <code class="literal">LEFT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>str</code></em> から左端の <em class="replaceable"><code>len</code></em> 文字を返し、引数が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LEFT('foobarbar', 5);</code></strong>
        -&gt; 'fooba'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_length"></a><p>
          <a class="indexterm" name="idm139979098945296"></a> <code class="literal">LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          バイトで測定された文字列 <em class="replaceable"><code>str</code></em> の長さを返します。マルチバイト文字は、複数のバイトとしてカウントされます。つまり、5 つの 2 バイト文字を含む文字列では、<code class="literal">LENGTH()</code> は <code class="literal">10</code> を返し、<code class="literal">CHAR_LENGTH()</code> は <code class="literal">5</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LENGTH('text');</code></strong>
        -&gt; 4
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">Length()</code> OpenGIS 空間関数は、MySQL では <code class="literal">GLength()</code> という名前です。
          </p></div></li><li class="listitem"><a name="function_load-file"></a><p>
          <a class="indexterm" name="idm139979098929344"></a> <a class="indexterm" name="idm139979098928000"></a> <code class="literal">LOAD_FILE(<em class="replaceable"><code>file_name</code></em>)</code>
        </p><p>
          ファイルを読み取り、ファイルの内容を文字列として返します。この関数を使用するには、ファイルがサーバーホストに配置されている必要があり、ファイルへのフルパス名を指定し、<code class="literal">FILE</code> 権限を持つ必要があります。ファイルはすべてのユーザーから読み取り可能で、<code class="literal">max_allowed_packet</code> バイトよりも小さなサイズである必要があります。<code class="literal">secure_file_priv</code> システム変数が空でないディレクトリ名に設定されている場合は、そのディレクトリ内にロード対象のファイルが配置されている必要があります。
        </p><p>
          ファイルが存在しない場合、または上記の条件が満たされていないために、ファイルを読み取ることができない場合、この関数は <code class="literal">NULL</code> を返します。
        </p><p>
          <code class="literal">character_set_filesystem</code> システム変数では、リテラル文字列として指定されているファイル名の解釈が制御されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE t</code></strong>
          <strong class="userinput"><code>  SET blob_col=LOAD_FILE('/tmp/picture')</code></strong>
          <strong class="userinput"><code>  WHERE id=1;</code></strong>
</pre></li><li class="listitem"><a name="function_locate"></a><p>
          <a class="indexterm" name="idm139979098910032"></a> <code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>)</code>, <code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code>
        </p><p>
          1 番目の構文は、文字列 <em class="replaceable"><code>str</code></em> 内で、部分文字列 <em class="replaceable"><code>substr</code></em> が最初に出現する位置を返します。2 番目の構文は、文字列 <em class="replaceable"><code>str</code></em> 内の位置 <em class="replaceable"><code>pos</code></em> 以降で、部分文字列 <em class="replaceable"><code>substr</code></em> が最初に出現する位置を返します。<em class="replaceable"><code>str</code></em> 内に <em class="replaceable"><code>substr</code></em> がない場合は、<code class="literal">0</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOCATE('bar', 'foobarbar');</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT LOCATE('xbar', 'foobar');</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT LOCATE('bar', 'foobarbar', 5);</code></strong>
        -&gt; 7
</pre><p>
          この関数はマルチバイトセーフであり、1 つ以上の引数がバイナリ文字列である場合にのみ大文字と小文字が区別されます。
        </p></li><li class="listitem"><a name="function_lower"></a><p>
          <a class="indexterm" name="idm139979098891888"></a> <code class="literal">LOWER(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          現在の文字セットのマッピングに従って、すべての文字が小文字に変更された文字列 <em class="replaceable"><code>str</code></em> を返します。デフォルトは <code class="literal">latin1</code> (cp1252 西ヨーロッパ言語) です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOWER('QUADRATICALLY');</code></strong>
        -&gt; 'quadratically'
</pre><p>
          <code class="literal">LOWER()</code> (および <code class="literal">UPPER()</code>) をバイナリ文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、<code class="literal">BLOB</code>) に適用しても、何の効果もありません。大文字/小文字の変換を実行するには、バイナリ文字列を非バイナリ文字列に変換します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @str = BINARY 'New York';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT LOWER(@str), LOWER(CONVERT(@str USING latin1));</code></strong>
+-------------+-----------------------------------+
| LOWER(@str) | LOWER(CONVERT(@str USING latin1)) |
+-------------+-----------------------------------+
| New York    | new york                          |
+-------------+-----------------------------------+
</pre><p>
          Unicode 文字セットの場合、<code class="literal"><em class="replaceable"><code>xxx</code></em>_unicode_520_ci</code> 照合順序およびそれらから派生した言語固有の照合順序では、<code class="literal">LOWER()</code> および <code class="literal">UPPER()</code> は Unicode 照合順序アルゴリズム (UCA) 5.2.0 に従って動作します。その他の Unicode 照合では、<code class="literal">LOWER()</code> および <code class="literal">UPPER()</code> は Unicode 照合アルゴリズム (UCA) 4.0.0 に従って動作します。<a class="xref" href="globalization.html#charset-unicode-sets" title="10.1.14.1 Unicode 文字セット">セクション10.1.14.1「Unicode 文字セット」</a>を参照してください。
        </p><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_lpad"></a><p>
          <a class="indexterm" name="idm139979098866272"></a> <code class="literal">LPAD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>padstr</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>len</code></em> 文字の長さになるように文字列 <em class="replaceable"><code>padstr</code></em> で左にパディングされた文字列 <em class="replaceable"><code>str</code></em> を返します。<em class="replaceable"><code>str</code></em> が <em class="replaceable"><code>len</code></em> よりも長い場合は、戻り値は <em class="replaceable"><code>len</code></em> 文字に短縮されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LPAD('hi',4,'??');</code></strong>
        -&gt; '??hi'
mysql&gt; <strong class="userinput"><code>SELECT LPAD('hi',1,'??');</code></strong>
        -&gt; 'h'
</pre></li><li class="listitem"><a name="function_ltrim"></a><p>
          <a class="indexterm" name="idm139979098852704"></a> <code class="literal">LTRIM(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          先頭の空白文字が削除された文字列 <em class="replaceable"><code>str</code></em> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LTRIM('  barbar');</code></strong>
        -&gt; 'barbar'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_make-set"></a><p>
          <a class="indexterm" name="idm139979098842416"></a> <code class="literal">MAKE_SET(<em class="replaceable"><code>bits</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code>
        </p><p>
          <em class="replaceable"><code>bits</code></em> セット内の対応するビットを持つ文字列で構成されるセット値 (<span class="quote">「<span class="quote"><code class="literal">,</code></span>」</span> 文字で区切られた部分文字列を含む文字列) を返します。<em class="replaceable"><code>str1</code></em> はビット 0 に対応し、<em class="replaceable"><code>str2</code></em> はビット 1 に対応する、などとなります。<em class="replaceable"><code>str1</code></em>、<em class="replaceable"><code>str2</code></em>、<code class="literal">...</code> 内の <code class="literal">NULL</code> 値は結果に追加されません。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1,'a','b','c');</code></strong>
        -&gt; 'a'
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1 | 4,'hello','nice','world');</code></strong>
        -&gt; 'hello,world'
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1 | 4,'hello','nice',NULL,'world');</code></strong>
        -&gt; 'hello'
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(0,'a','b','c');</code></strong>
        -&gt; ''
</pre></li><li class="listitem"><a name="function_mid"></a><p>
          <a class="indexterm" name="idm139979098825120"></a> <code class="literal">MID(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code>
        </p><p>
          <code class="literal">MID(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code> は、<code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_oct"></a><p>
          <a class="indexterm" name="idm139979098812912"></a> <code class="literal">OCT(<em class="replaceable"><code>N</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>N</code></em> の 8 進数の文字列表現を返します。<em class="replaceable"><code>N</code></em> は longlong (<code class="literal">BIGINT</code>) 数字です。これは、<code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10.8)</code> と同等です。<em class="replaceable"><code>N</code></em> が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT OCT(12);</code></strong>
        -&gt; '14'
</pre></li><li class="listitem"><a name="function_octet-length"></a><p>
          <a class="indexterm" name="idm139979098798560"></a> <code class="literal">OCTET_LENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <code class="literal">OCTET_LENGTH()</code> は <code class="literal">LENGTH()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_ord"></a><p>
          <a class="indexterm" name="idm139979098789392"></a> <code class="literal">ORD(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>str</code></em> の左端の文字がマルチバイト文字である場合は、その文字のコードを返します。コードは、次の計算式を使用して、その構成要素の数値から計算されます。
        </p><pre class="programlisting">
  (1st byte code)
+ (2nd byte code * 256)
+ (3rd byte code * 256<sup>2</sup>) ...
</pre><p>
          左端の文字がマルチバイト文字でない場合は、<code class="literal">ORD()</code> は <code class="literal">ASCII()</code> 関数と同じ値を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ORD('2');</code></strong>
        -&gt; 50
</pre></li><li class="listitem"><a name="function_position"></a><p>
          <a class="indexterm" name="idm139979098775632"></a> <code class="literal">POSITION(<em class="replaceable"><code>substr</code></em> IN <em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <code class="literal">POSITION(<em class="replaceable"><code>substr</code></em> IN <em class="replaceable"><code>str</code></em>)</code> は <code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>)</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_quote"></a><p>
          <a class="indexterm" name="idm139979098764336"></a> <code class="literal">QUOTE(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          SQL ステートメントで、適切にエスケープされたデータ値として使用できる結果を生成する文字列を引用符で囲みます。一重引用符で囲まれ、バックスラッシュの後ろにバックスラッシュ (<span class="quote">「<span class="quote"><code class="literal">\</code></span>」</span>)、一重引用符 (<span class="quote">「<span class="quote"><code class="literal">'</code></span>」</span>)、ASCII <code class="literal">NUL</code>、および Control+Z の各インスタンスが続く文字列が返されます。引数が <code class="literal">NULL</code> の場合の戻り値は、一重引用符で囲まれていない単語 <span class="quote">「<span class="quote">NULL</span>」</span> です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT QUOTE('Don\'t!');</code></strong>
        -&gt; 'Don\'t!'
mysql&gt; <strong class="userinput"><code>SELECT QUOTE(NULL);</code></strong>
        -&gt; NULL
</pre><a class="indexterm" name="idm139979098752528"></a><p>
          比較するために、<a class="xref" href="language-structure.html#string-literals" title="9.1.1 文字列リテラル">セクション9.1.1「文字列リテラル」</a>および<a class="xref" href="connectors-apis.html#mysql-real-escape-string" title="23.8.7.54 mysql_real_escape_string()">セクション23.8.7.54「mysql_real_escape_string()」</a>で、リテラル文字列に対する引用ルールと C API 内の引用ルールを参照してください。
        </p></li><li class="listitem"><a name="function_repeat"></a><p>
          <a class="indexterm" name="idm139979098746752"></a> <code class="literal">REPEAT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>count</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>count</code></em> 回繰り返された文字列 <em class="replaceable"><code>str</code></em> で構成される文字列を返します。<em class="replaceable"><code>count</code></em> が 1 よりも小さい場合は、空の文字列を返します。<em class="replaceable"><code>str</code></em> または <em class="replaceable"><code>count</code></em> が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT REPEAT('MySQL', 3);</code></strong>
        -&gt; 'MySQLMySQLMySQL'
</pre></li><li class="listitem"><a name="function_replace"></a><p>
          <a class="indexterm" name="idm139979098733232"></a> <code class="literal">REPLACE(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>from_str</code></em>,<em class="replaceable"><code>to_str</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>from_str</code></em> のすべての出現箇所が文字列 <em class="replaceable"><code>to_str</code></em> で置換された、文字列 <em class="replaceable"><code>str</code></em> を返します。<code class="literal">REPLACE()</code> は、<em class="replaceable"><code>from_str</code></em> を検索する際に、大文字と小文字を区別した一致を実行します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT REPLACE('www.mysql.com', 'w', 'Ww');</code></strong>
        -&gt; 'WwWwWw.mysql.com'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_reverse"></a><p>
          <a class="indexterm" name="idm139979098719520"></a> <code class="literal">REVERSE(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字の順序が逆になった文字列 <em class="replaceable"><code>str</code></em> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT REVERSE('abc');</code></strong>
        -&gt; 'cba'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_right"></a><p>
          <a class="indexterm" name="idm139979098709264"></a> <code class="literal">RIGHT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>str</code></em> から右端の <em class="replaceable"><code>len</code></em> 文字を返し、引数が <code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT RIGHT('foobarbar', 4);</code></strong>
        -&gt; 'rbar'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_rpad"></a><p>
          <a class="indexterm" name="idm139979098696784"></a> <code class="literal">RPAD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>padstr</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>len</code></em> 文字の長さになるように文字列 <em class="replaceable"><code>padstr</code></em> で右にパディングされた文字列 <em class="replaceable"><code>str</code></em> を返します。<em class="replaceable"><code>str</code></em> が <em class="replaceable"><code>len</code></em> よりも長い場合は、戻り値は <em class="replaceable"><code>len</code></em> 文字に短縮されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT RPAD('hi',5,'?');</code></strong>
        -&gt; 'hi???'
mysql&gt; <strong class="userinput"><code>SELECT RPAD('hi',1,'?');</code></strong>
        -&gt; 'h'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_rtrim"></a><p>
          <a class="indexterm" name="idm139979098682672"></a> <code class="literal">RTRIM(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          末尾の空白文字が削除された文字列 <em class="replaceable"><code>str</code></em> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT RTRIM('barbar   ');</code></strong>
        -&gt; 'barbar'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_soundex"></a><p>
          <a class="indexterm" name="idm139979098672448"></a> <code class="literal">SOUNDEX(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>str</code></em> から soundex 文字列を返します。ほぼ同じ発音の 2 つの文字列は、同じ soundex 文字列を持つはずです。標準の soundex 文字列の長さは 4 文字ですが、<code class="literal">SOUNDEX()</code> 関数は任意の長さの文字列を返します。結果で <code class="literal">SUBSTRING()</code> を使用すると、標準の soundex 文字列を取得できます。<em class="replaceable"><code>str</code></em> 内のアルファベット以外の文字はすべて無視されます。A から Z までの範囲外の国際アルファベット文字はすべて、母音として処理されます。
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            <code class="literal">SOUNDEX()</code> の使用時には、次の制限に注意してください。
          </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              現在実装されているこの関数は、文字列の言語が英語である場合にのみ機能するように設計されています。その他の言語の文字列では、信頼できる結果が生成されない可能性があります。
            </p></li><li class="listitem"><p>
              この関数では、文字列でマルチバイト文字セット (<code class="literal">utf-8</code> など) が使用されている場合に、整合性のある結果が生成されることは保証されません。
            </p><p>
              今後のリリースで、このような制限が解除されることを期待しています。詳細は、Bug #22638 を参照してください。
            </p></li></ul></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SOUNDEX('Hello');</code></strong>
        -&gt; 'H400'
mysql&gt; <strong class="userinput"><code>SELECT SOUNDEX('Quadratically');</code></strong>
        -&gt; 'Q36324'
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            この関数には、オリジナルの Soundex アルゴリズムが実装されています。より人気のある拡張バージョンではありません (この作成者も D. Knuth です)。相違点としては、元のバージョンではまず母音が破棄されてから複製が破棄されますが、拡張バージョンではまず複製が破棄されてから母音が破棄されます。
          </p></div></li><li class="listitem"><a name="operator_sounds-like"></a><p>
          <a class="indexterm" name="idm139979098650336"></a> <code class="literal"><em class="replaceable"><code>expr1</code></em> SOUNDS LIKE <em class="replaceable"><code>expr2</code></em></code>
        </p><p>
          これは、<code class="literal">SOUNDEX(<em class="replaceable"><code>expr1</code></em>) = SOUNDEX(<em class="replaceable"><code>expr2</code></em>)</code> と同じです。
        </p></li><li class="listitem"><a name="function_space"></a><p>
          <a class="indexterm" name="idm139979098640816"></a> <code class="literal">SPACE(<em class="replaceable"><code>N</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>N</code></em> 空白文字で構成される文字列を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SPACE(6);</code></strong>
        -&gt; '      '
</pre></li><li class="listitem"><a name="function_substr"></a><p>
          <a class="indexterm" name="idm139979098631168"></a> <code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code>, <code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em> FROM <em class="replaceable"><code>pos</code></em>)</code>, <code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code>, <code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em> FROM <em class="replaceable"><code>pos</code></em> FOR <em class="replaceable"><code>len</code></em>)</code>
        </p><p>
          <code class="literal">SUBSTR()</code> は <code class="literal">SUBSTRING()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_substring"></a><p>
          <a class="indexterm" name="idm139979098615520"></a> <code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code>, <code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em> FROM <em class="replaceable"><code>pos</code></em>)</code>, <code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code>, <code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em> FROM <em class="replaceable"><code>pos</code></em> FOR <em class="replaceable"><code>len</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>len</code></em> 引数を付けない形式では、位置 <em class="replaceable"><code>pos</code></em> で始まる文字列 <em class="replaceable"><code>str</code></em> からの部分文字列が返されます。<em class="replaceable"><code>len</code></em> 引数を付けた形式では、位置 <em class="replaceable"><code>pos</code></em> で始まる文字列 <em class="replaceable"><code>str</code></em> からの部分文字列 <em class="replaceable"><code>len</code></em> 文字長が返されます。<code class="literal">FROM</code> を使用する形式は、標準の SQL 構文です。また、<em class="replaceable"><code>pos</code></em> に負の値を使用することもできます。その場合、部分文字列の先頭は文字列の先頭でなく、文字列の末尾からの <em class="replaceable"><code>pos</code></em> 文字になります。この関数のどの形式でも、<em class="replaceable"><code>pos</code></em> で負の値を使用できます。
        </p><p>
          すべての形式の <code class="literal">SUBSTRING()</code> で、部分文字列の抽出が開始される文字列内の最初の文字の位置が <code class="literal">1</code> とみなされます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Quadratically',5);</code></strong>
        -&gt; 'ratically'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('foobarbar' FROM 4);</code></strong>
        -&gt; 'barbar'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Quadratically',5,6);</code></strong>
        -&gt; 'ratica'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila', -3);</code></strong>
        -&gt; 'ila'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila', -5, 3);</code></strong>
        -&gt; 'aki'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila' FROM -4 FOR 2);</code></strong>
        -&gt; 'ki'
</pre><p>
          この関数はマルチバイトセーフです。
        </p><p>
          <em class="replaceable"><code>len</code></em> が 1 よりも小さい場合は、結果が空の文字列になります。
        </p></li><li class="listitem"><a name="function_substring-index"></a><p>
          <a class="indexterm" name="idm139979098586208"></a> <code class="literal">SUBSTRING_INDEX(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>delim</code></em>,<em class="replaceable"><code>count</code></em>)</code>
        </p><p>
          文字列 <em class="replaceable"><code>str</code></em> から、区切り文字 <em class="replaceable"><code>delim</code></em> が <em class="replaceable"><code>count</code></em> 回出現する前の部分文字列を返します。<em class="replaceable"><code>count</code></em> が正の値の場合は、(左から数えて) 最後の区切り文字の左側にあるすべてが返されます。<em class="replaceable"><code>count</code></em> が負の値の場合は、(右から数えて) 最後の区切り文字の右側にあるすべてが返されます。<code class="literal">SUBSTRING_INDEX()</code> は、<em class="replaceable"><code>delim</code></em> を検索する際に、大文字と小文字を区別した一致を実行します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING_INDEX('www.mysql.com', '.', 2);</code></strong>
        -&gt; 'www.mysql'
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING_INDEX('www.mysql.com', '.', -2);</code></strong>
        -&gt; 'mysql.com'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_to-base64"></a><p>
          <a class="indexterm" name="idm139979098570400"></a> <code class="literal">TO_BASE64(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列の引数を base-64 でエンコードされた形式に変換し、その結果を接続文字セットと照合順序が含まれる文字列として返します。引数が文字列でない場合は、変換が実行される前に文字列に変換されます。引数が <code class="literal">NULL</code> である場合は、結果も <code class="literal">NULL</code> になります。<code class="literal">FROM_BASE64()</code> 関数を使用すると、base-64 でエンコードされた文字列をデコードできます。
        </p><p>
          この関数は、MySQL 5.6.1 で追加されました。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TO_BASE64('abc'), FROM_BASE64(TO_BASE64('abc'));</code></strong>
        -&gt; 'JWJj', 'abc'
</pre><p>
          さまざまな base-64 エンコードスキームが存在します。これらは、<code class="literal">TO_BASE64()</code> および <code class="literal">FROM_BASE64()</code> で使用されるエンコードおよびデコードのルールです。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              アルファベット値 62 のエンコードは <code class="literal">'+'</code> です。
            </p></li><li class="listitem"><p>
              アルファベット値 63 のエンコードは <code class="literal">'/'</code> です。
            </p></li><li class="listitem"><p>
              エンコードされた出力は、出力可能な 4 文字のグループで構成されます。入力データの各 3 バイトは、4 文字を使用してエンコードされます。最後のグループが不完全な場合は、長さが 4 になるまで <code class="literal">'='</code> 文字でパディングされます。
            </p></li><li class="listitem"><p>
              長い出力を複数の行に分割するために、エンコードされた出力の各 76 文字の後ろに改行が追加されます。
            </p></li><li class="listitem"><p>
              デコードでは改行、復帰改行、タブ、および空白が認識および無視されます。
            </p></li></ul></div></li><li class="listitem"><a name="function_trim"></a><p>
          <a class="indexterm" name="idm139979098545792"></a> <code class="literal">TRIM([{BOTH | LEADING | TRAILING} [<em class="replaceable"><code>remstr</code></em>] FROM] <em class="replaceable"><code>str</code></em>)</code>, <code class="literal">TRIM([<em class="replaceable"><code>remstr</code></em> FROM] <em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          すべての <em class="replaceable"><code>remstr</code></em> プリフィクスまたはサフィクスが削除された文字列 <em class="replaceable"><code>str</code></em> を返します。<code class="literal">BOTH</code>、<code class="literal">LEADING</code>、<code class="literal">TRAILING</code> のいずれの指定子も指定されない場合は、<code class="literal">BOTH</code> が指定されたとみなされます。<em class="replaceable"><code>remstr</code></em> はオプションであり、指定されない場合は空白文字が削除されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TRIM('  bar   ');</code></strong>
        -&gt; 'bar'
mysql&gt; <strong class="userinput"><code>SELECT TRIM(LEADING 'x' FROM 'xxxbarxxx');</code></strong>
        -&gt; 'barxxx'
mysql&gt; <strong class="userinput"><code>SELECT TRIM(BOTH 'x' FROM 'xxxbarxxx');</code></strong>
        -&gt; 'bar'
mysql&gt; <strong class="userinput"><code>SELECT TRIM(TRAILING 'xyz' FROM 'barxxyz');</code></strong>
        -&gt; 'barx'
</pre><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_ucase"></a><p>
          <a class="indexterm" name="idm139979098526736"></a> <code class="literal">UCASE(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <code class="literal">UCASE()</code> は <code class="literal">UPPER()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_unhex"></a><p>
          <a class="indexterm" name="idm139979098516464"></a> <code class="literal">UNHEX(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列の引数 <em class="replaceable"><code>str</code></em> では、<code class="literal">UNHEX(<em class="replaceable"><code>str</code></em>)</code> は引数の各文字ペアを 16 進数として解釈し、その数字で表されたバイトに変換します。戻り値はバイナリ文字列です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UNHEX('4D7953514C');</code></strong>
        -&gt; 'MySQL'
mysql&gt; <strong class="userinput"><code>SELECT 0x4D7953514C;</code></strong>
        -&gt; 'MySQL'
mysql&gt; <strong class="userinput"><code>SELECT UNHEX(HEX('string'));</code></strong>
        -&gt; 'string'
mysql&gt; <strong class="userinput"><code>SELECT HEX(UNHEX('1267'));</code></strong>
        -&gt; '1267'
</pre><p>
          引数文字列内の文字は、正当な 16 進数である必要があります: <code class="literal">'0'</code> .. <code class="literal">'9'</code>、<code class="literal">'A'</code> ..<code class="literal">'F'</code>、<code class="literal">'a'</code> .. <code class="literal">'f'</code>。引数に 16 進以外の数字が含まれている場合は、結果が <code class="literal">NULL</code> になります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UNHEX('GG');</code></strong>
+-------------+
| UNHEX('GG') |
+-------------+
| NULL        |
+-------------+
</pre><p>
          <code class="literal">UNHEX()</code> への引数が <code class="literal">BINARY</code> カラムである場合は、格納時に値に 0x00 バイトがパディングされますが、それらのバイトは取得時に削除されないため、結果が <code class="literal">NULL</code> になる可能性があります。たとえば、<code class="literal">'41'</code> は <code class="literal">'41 '</code> として <code class="literal">CHAR(3)</code> カラムに格納され、(末尾にパディングされた空白文字が削除された) <code class="literal">'41'</code> として取得されるため、カラム値に対する <code class="literal">UNHEX()</code> では <code class="literal">'A'</code> が返されます。反対に、<code class="literal">'41'</code> は <code class="literal">'41\0'</code> として <code class="literal">BINARY(3)</code> カラムに格納され、(末尾にパディングされた <code class="literal">0x00</code> バイトが削除されない) <code class="literal">'41\0'</code> として取得されます。<code class="literal">'\0'</code> は不正な 16 進数であるため、カラム値に対する <code class="literal">UNHEX()</code> では <code class="literal">NULL</code> が返されます。
        </p><p>
          数値の引数 <em class="replaceable"><code>N</code></em> の場合、<code class="literal">HEX(<em class="replaceable"><code>N</code></em>)</code> の逆は <code class="literal">UNHEX()</code> では実行されません。代わりに、<code class="literal">CONV(HEX(<em class="replaceable"><code>N</code></em>),16,10)</code> を使用してください。<code class="literal">HEX()</code> の説明を参照してください。
        </p></li><li class="listitem"><a name="function_upper"></a><p>
          <a class="indexterm" name="idm139979098476048"></a> <code class="literal">UPPER(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          現在の文字セットのマッピングに従って、すべての文字が大文字に変更された文字列 <em class="replaceable"><code>str</code></em> を返します。デフォルトは <code class="literal">latin1</code> (cp1252 西ヨーロッパ言語) です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UPPER('Hej');</code></strong>
        -&gt; 'HEJ'
</pre><p>
          <code class="literal">UPPER()</code> にも適用される情報については、<code class="literal">LOWER()</code> の説明を参照してください。これには、現在は機能が無効になっているバイナリ文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、<code class="literal">BLOB</code>) の大文字と小文字の変換を実行する方法に関する情報、および Unicode 文字セットの大文字と小文字の変換に関する情報が含まれていました。
        </p><p>
          この関数はマルチバイトセーフです。
        </p></li><li class="listitem"><a name="function_weight-string"></a><p>
          <a class="indexterm" name="idm139979098459376"></a> <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str</code></em> [AS {CHAR|BINARY}(<em class="replaceable"><code>N</code></em>)] [LEVEL <em class="replaceable"><code>levels</code></em>] [<em class="replaceable"><code>flags</code></em>])</code>
        </p><p>
          <code class="literal"><em class="replaceable"><code>levels</code></em>: <em class="replaceable"><code>N</code></em> [ASC|DESC|REVERSE] [, <em class="replaceable"><code>N</code></em> [ASC|DESC|REVERSE]] ...</code>
        </p><p>
          この関数は、入力文字列の重み文字列を返します。戻り値は、文字列のソートおよび比較の値を表すバイナリ文字列です。これらのプロパティーがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str1</code></em>)</code> = <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str2</code></em>)</code> の場合は、<code class="literal"><em class="replaceable"><code>str1</code></em> = <em class="replaceable"><code>str2</code></em></code> です (<em class="replaceable"><code>str1</code></em> と <em class="replaceable"><code>str2</code></em> は等しいとみなされます)。
            </p></li><li class="listitem"><p>
              <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str1</code></em>)</code> &lt; <code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str2</code></em>)</code> の場合は、<code class="literal"><em class="replaceable"><code>str1</code></em> &lt; <em class="replaceable"><code>str2</code></em></code> です (<em class="replaceable"><code>str1</code></em> は <em class="replaceable"><code>str2</code></em> の前にソートされます)。
            </p></li></ul></div><p>
          <code class="literal">WEIGHT_STRING()</code> は、照合順序のテストおよびデバッグを行う際、特に新しい照合順序を追加する場合に使用できます。<a class="xref" href="globalization.html#adding-collation" title="10.4 文字セットへの照合順序の追加">セクション10.4「文字セットへの照合順序の追加」</a>を参照してください。
        </p><p>
          入力文字列 <em class="replaceable"><code>str</code></em> は文字列式です。入力が非バイナリ (文字) 文字列 (<code class="literal">CHAR</code>、<code class="literal">VARCHAR</code>、<code class="literal">TEXT</code> 値など) である場合は、戻り値に文字列の照合順序重みが含まれます。入力がバイナリ (バイト) 文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、<code class="literal">BLOB</code> 値など) である場合は、戻り値は入力と同じです (バイナリ文字列のバイトごとの重みはバイト値です)。入力が <code class="literal">NULL</code> である場合は、<code class="literal">WEIGHT_STRING()</code> は <code class="literal">NULL</code> を返します。
        </p><p>
          例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @s = _latin1 'AB' COLLATE latin1_swedish_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong>
+------+---------+------------------------+
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |
+------+---------+------------------------+
| AB   | 4142    | 4142                   |
+------+---------+------------------------+
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @s = _latin1 'ab' COLLATE latin1_swedish_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong>
+------+---------+------------------------+
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |
+------+---------+------------------------+
| ab   | 6162    | 4142                   |
+------+---------+------------------------+
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @s = CAST('AB' AS BINARY);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong>
+------+---------+------------------------+
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |
+------+---------+------------------------+
| AB   | 4142    | 4142                   |
+------+---------+------------------------+
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @s = CAST('ab' AS BINARY);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong>
+------+---------+------------------------+
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |
+------+---------+------------------------+
| ab   | 6162    | 6162                   |
+------+---------+------------------------+
</pre><p>
          上記の例では、<code class="literal">HEX()</code> を使用して <code class="literal">WEIGHT_STRING()</code> の結果を表示しています。結果はバイナリ値であるため、結果に出力されない値が含まれるときに出力可能な形式で表示する際に、<code class="literal">HEX()</code> が特に役立ちます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @s = CONVERT(0xC39F USING utf8) COLLATE utf8_czech_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING(@s));</code></strong>
+------------------------+
| HEX(WEIGHT_STRING(@s)) |
+------------------------+
| 0FEA0FEA               |
+------------------------+
</pre><p>
          非 <code class="literal">NULL</code> の戻り値では、長さが <code class="literal">VARBINARY</code> の最大長内である場合は、値のデータ型が <code class="literal">VARBINARY</code> であり、その他の場合はデータ型は <code class="literal">BLOB</code> です。
        </p><p>
          入力文字列を非バイナリまたはバイナリの文字列にキャストし、強制的に指定した長さになるように、<code class="literal">AS</code> 句が指定されている場合があります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">AS CHAR(<em class="replaceable"><code>N</code></em>)</code> は、文字列を非バイナリ文字列にキャストし、<em class="replaceable"><code>N</code></em> 文字の長さになるように空白文字で右側をパディングします。<em class="replaceable"><code>N</code></em> は少なくとも 1 にする必要があります。<em class="replaceable"><code>N</code></em> が入力文字列の長さよりも小さい場合は、文字列が <em class="replaceable"><code>N</code></em> 文字まで切り捨てられます。切り捨てられても警告は発生しません。
            </p></li><li class="listitem"><p>
              <code class="literal">AS BINARY(<em class="replaceable"><code>N</code></em>)</code> は、文字列がバイナリ文字列にキャストされ、<em class="replaceable"><code>N</code></em> が (文字単位ではなく) バイト単位で測定され、パディングで (空白文字でななく) <code class="literal">0x00</code> バイトが使用される点を除いて同様です。
            </p></li></ul></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING('ab' AS CHAR(4)));</code></strong>
+-------------------------------------+
| HEX(WEIGHT_STRING('ab' AS CHAR(4))) |
+-------------------------------------+
| 41422020                            |
+-------------------------------------+
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING('ab' AS BINARY(4)));</code></strong>
+---------------------------------------+
| HEX(WEIGHT_STRING('ab' AS BINARY(4))) |
+---------------------------------------+
| 61620000                              |
+---------------------------------------+
</pre><p>
          戻り値に特定の照合順序レベルに合った重みが含まれるように指定するために、<code class="literal">LEVEL</code> 句が指定される場合があります。
        </p><p>
          カンマで区切られた 1 つ以上の整数のリストとして、またはダッシュで区切られた 2 つの整数の範囲として、<code class="literal">LEVEL</code> キーワードの後ろに <em class="replaceable"><code>levels</code></em> 指定子が指定される場合があります。句読文字の前後の空白の有無は影響しません。
        </p><p>
          例:
        </p><pre class="programlisting">
LEVEL 1
LEVEL 2, 3, 5
LEVEL 1-3
</pre><p>
          1 よりも低いレベルは 1 として処理されます。入力文字列照合順序の最大値よりも高いレベルは、照合順序の最大値として処理されます。最大値は照合順序ごとに異なりますが、6 よりも大きい値にはなりません。
        </p><p>
          レベルのリストでは、レベルを小さい順に指定する必要があります。レベルの範囲では、2 番目の数字が 1 番目よりも小さい場合は、1 番目の数字として処理されます (たとえば、4-2 は 4-4 と同じになります)。
        </p><p>
          <code class="literal">LEVEL</code> 句が省略された場合は、MySQL では <code class="literal">LEVEL 1 - <em class="replaceable"><code>max</code></em></code> であるとみなされます。ここで、<em class="replaceable"><code>max</code></em> は照合順序の最大レベルです。
        </p><p>
          <code class="literal">LEVEL</code> が (範囲構文ではなく) リスト構文を使用して指定されている場合は、レベルの数字のあとに次の修飾子を指定できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">ASC</code>: 変更なしで重みを返します。これはデフォルトです。
            </p></li><li class="listitem"><p>
              <code class="literal">DESC</code>: ビット反転された重みを返します (たとえば、<code class="literal">0x78f0 DESC</code> = <code class="literal">0x870f</code> です)。
            </p></li><li class="listitem"><p>
              <code class="literal">REVERSE</code>: 逆順で重み (つまり、最初の文字を最後に、最後の文字を最後にと、逆に並べた文字列の重み) を返します。
            </p></li></ul></div><p>
          例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING(0x007fff LEVEL 1));</code></strong>
+--------------------------------------+
| HEX(WEIGHT_STRING(0x007fff LEVEL 1)) |
+--------------------------------------+
| 007FFF                               |
+--------------------------------------+
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING(0x007fff LEVEL 1 DESC));</code></strong>
+-------------------------------------------+
| HEX(WEIGHT_STRING(0x007fff LEVEL 1 DESC)) |
+-------------------------------------------+
| FF8000                                    |
+-------------------------------------------+
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING(0x007fff LEVEL 1 REVERSE));</code></strong>
+----------------------------------------------+
| HEX(WEIGHT_STRING(0x007fff LEVEL 1 REVERSE)) |
+----------------------------------------------+
| FF7F00                                       |
+----------------------------------------------+
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING(0x007fff LEVEL 1 DESC REVERSE));</code></strong>
+---------------------------------------------------+
| HEX(WEIGHT_STRING(0x007fff LEVEL 1 DESC REVERSE)) |
+---------------------------------------------------+
| 0080FF                                            |
+---------------------------------------------------+
</pre><p>
          現在、<em class="replaceable"><code>flags</code></em> 句は使用されていません。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="string-comparison-functions"></a>12.5.1 文字列比較関数</h3></div></div></div><a class="indexterm" name="idm139979098365456"></a><a class="indexterm" name="idm139979098364032"></a><div class="table"><a name="idm139979098362000"></a><p class="title"><b>表 12.8 文字列比較演算子</b></p><div class="table-contents"><table summary="文字列比較演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td><td>
      単純なパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td><td>
      単純なパターン一致の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td><td>
      2 つの文字列を比較します
    </td></tr></tbody></table></div></div><br class="table-break"><p>
        文字列関数に引数としてバイナリ文字列が指定されている場合は、結果の文字列もバイナリ文字列になります。文字列に変換された数字は、バイナリ文字列として処理されます。比較のみがこの影響を受けます。
      </p><a class="indexterm" name="idm139979098350896"></a><a class="indexterm" name="idm139979098348720"></a><p>
        通常、文字列比較の式で大文字と小文字が区別される場合は、大文字と小文字が区別される方法で比較が実行されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_like"></a><p>
            <a class="indexterm" name="idm139979098342848"></a> <code class="literal"><em class="replaceable"><code>expr</code></em> LIKE <em class="replaceable"><code>pat</code></em> [ESCAPE '<em class="replaceable"><code>escape_char</code></em>']</code>
          </p><p>
            SQL の単純な正規表現比較を使用したパターンマッチング。<code class="literal">1</code> (<code class="literal">TRUE</code>) または <code class="literal">0</code> (<code class="literal">FALSE</code>) を返します。<em class="replaceable"><code>expr</code></em> または <em class="replaceable"><code>pat</code></em> のいずれかが <code class="literal">NULL</code> である場合は、結果も <code class="literal">NULL</code> になります。
          </p><p>
            パターンはリテラル文字列である必要はありません。たとえば、文字列式やテーブルカラムとして指定できます。
          </p><p>
            SQL 標準では、<code class="literal">LIKE</code> は文字ごとに一致を実行するため、<code class="literal">=</code> 比較演算子とは異なる結果が生成される可能性があります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'ä' LIKE 'ae' COLLATE latin1_german2_ci;</code></strong>
+-----------------------------------------+
| 'ä' LIKE 'ae' COLLATE latin1_german2_ci |
+-----------------------------------------+
|                                       0 |
+-----------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT 'ä' = 'ae' COLLATE latin1_german2_ci;</code></strong>
+--------------------------------------+
| 'ä' = 'ae' COLLATE latin1_german2_ci |
+--------------------------------------+
|                                    1 |
+--------------------------------------+
</pre><p>
            特に、末尾の空白は重要です。ただし、<code class="literal">=</code> 演算子を使って実行される <code class="literal">CHAR</code> や <code class="literal">VARCHAR</code> の比較には当てはまりません。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'a' = 'a ', 'a' LIKE 'a ';</code></strong>
+------------+---------------+
| 'a' = 'a ' | 'a' LIKE 'a ' |
+------------+---------------+
|          1 |             0 |
+------------+---------------+
1 row in set (0.00 sec)
</pre><p>
            <code class="literal">LIKE</code> では、パターンで次の 2 つのワイルドカード文字を使用できます。
          </p><div class="informaltable"><table summary="この表には、LIKE 文字列比較関数で使用できるワイルドカード文字を一覧表示し、各文字の説明を示します。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">文字</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><code class="literal">%</code></td><td>0 個の文字も含めて、任意の数の文字に一致します</td></tr><tr><td scope="row"><code class="literal">_</code></td><td>正確に 1 つの文字に一致します</td></tr></tbody></table></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE 'David_';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE '%D%v%';</code></strong>
        -&gt; 1
</pre><p>
            ワイルドカード文字のリテラルインスタンスをテストするには、その前にエスケープ文字を指定します。<code class="literal">ESCAPE</code> 文字を指定しない場合は、<span class="quote">「<span class="quote"><code class="literal">\</code></span>」</span> と仮定されます。
          </p><div class="informaltable"><table summary="この表には、ワイルドカード文字のリテラルインスタンスをテストする際、ESCAPE 文字を指定しない場合に仮定される文字列を一覧表示されます。各文字列の説明は提供されていません。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">文字列</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><code class="literal">\%</code></td><td>1 つの <span class="quote">「<span class="quote"><code class="literal">%</code></span>」</span> 文字に一致します</td></tr><tr><td scope="row"><code class="literal">\_</code></td><td>1 つの <span class="quote">「<span class="quote"><code class="literal">_</code></span>」</span> 文字に一致します</td></tr></tbody></table></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE 'David\_';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'David_' LIKE 'David\_';</code></strong>
        -&gt; 1
</pre><p>
            別のエスケープ文字を指定するには、<code class="literal">ESCAPE</code> 句を使用します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'David_' LIKE 'David|_' ESCAPE '|';</code></strong>
        -&gt; 1
</pre><p>
            エスケープシーケンスは空にするか、1 文字の長さにするようにしてください。実行時に、式は定数として評価される必要があります。<code class="literal">NO_BACKSLASH_ESCAPES</code> SQL モードが有効になっている場合は、シーケンスを空にできません。
          </p><p>
            次の 2 つのステートメントは、オペランドのいずれかがバイナリ文字列である場合を除いて、文字列の比較では大文字と小文字が区別されないことを示しています。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE 'ABC';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE BINARY 'ABC';</code></strong>
        -&gt; 0
</pre><p>
            MySQL では、数値式で <code class="literal">LIKE</code> が許可されます。(これは、標準 SQL の <code class="literal">LIKE</code> の拡張機能です。)
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 10 LIKE '1%';</code></strong>
        -&gt; 1
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              MySQL では文字列で C のエスケープ構文 (たとえば、改行文字を表すために <span class="quote">「<span class="quote"><code class="literal">\n</code></span>」</span>) が使用されているため、<code class="literal">LIKE</code> 文字列で使用される <span class="quote">「<span class="quote"><code class="literal">\</code></span>」</span> はすべて二重に指定する必要があります。たとえば、<span class="quote">「<span class="quote"><code class="literal">\n</code></span>」</span> を検索するには、<span class="quote">「<span class="quote"><code class="literal">\\n</code></span>」</span> と指定します。<span class="quote">「<span class="quote"><code class="literal">\</code></span>」</span> を検索するには、<span class="quote">「<span class="quote"><code class="literal">\\\\</code></span>」</span> と指定します。これは、バックスラッシュはパーサーによって一度削除され、パターン一致が実行されるときにも再度削除される結果、一致対象のバックスラッシュは 1 つしか残らないためです。
            </p><p>
              例外: パターン文字列の末尾では、バックスラッシュを <span class="quote">「<span class="quote"><code class="literal">\\</code></span>」</span> と指定できます。文字列の末尾では、エスケープの後ろに何もないため、バックスラッシュはそれ自体を表します。テーブルに次の値が含まれると仮定します。
            </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT filename FROM t1;</code></strong>
+--------------+
| filename     |
+--------------+
| C:           | 
| C:\          | 
| C:\Programs  | 
| C:\Programs\ | 
+--------------+
</pre><p>
              バックスラッシュで終わる値をテストするには、次のパターンのいずれかを使用すると値をマッチングできます。
            </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT filename, filename LIKE '%\\' FROM t1;</code></strong>
+--------------+---------------------+
| filename     | filename LIKE '%\\' |
+--------------+---------------------+
| C:           |                   0 | 
| C:\          |                   1 | 
| C:\Programs  |                   0 | 
| C:\Programs\ |                   1 | 
+--------------+---------------------+

mysql&gt; <strong class="userinput"><code>SELECT filename, filename LIKE '%\\\\' FROM t1;</code></strong>
+--------------+-----------------------+
| filename     | filename LIKE '%\\\\' |
+--------------+-----------------------+
| C:           |                     0 | 
| C:\          |                     1 | 
| C:\Programs  |                     0 | 
| C:\Programs\ |                     1 | 
+--------------+-----------------------+
</pre></div></li><li class="listitem"><a name="operator_not-like"></a><p>
            <a class="indexterm" name="idm139979098261408"></a> <code class="literal"><em class="replaceable"><code>expr</code></em> NOT LIKE <em class="replaceable"><code>pat</code></em> [ESCAPE '<em class="replaceable"><code>escape_char</code></em>']</code>
          </p><p>
            これは、<code class="literal">NOT (<em class="replaceable"><code>expr</code></em> LIKE <em class="replaceable"><code>pat</code></em> [ESCAPE '<em class="replaceable"><code>escape_char</code></em>'])</code> と同じです。
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              <code class="literal">NULL</code> を含むカラムとの <code class="literal">NOT LIKE</code> 比較を伴う集計クエリーでは、予想外の結果が生成される可能性があります。たとえば、次のテーブルとデータを検討してください。
            </p><pre class="programlisting">
CREATE TABLE foo (bar VARCHAR(10));

INSERT INTO foo VALUES (NULL), (NULL);
</pre><p>
              クエリー <code class="literal">SELECT COUNT(*) FROM foo WHERE bar LIKE '%baz%';</code> は <code class="literal">0</code> を返します。<code class="literal">SELECT COUNT(*) FROM foo WHERE bar NOT LIKE '%baz%';</code> は <code class="literal">2</code> を返すと想定しています。ただし、事実は異なります。2 番目のクエリーは <code class="literal">0</code> を返します。これは、<em class="replaceable"><code>expr</code></em> の値に関係なく、<code class="literal">NULL NOT LIKE <em class="replaceable"><code>expr</code></em></code> は常に <code class="literal">NULL</code> を返すためです。<code class="literal">NULL</code> を伴う集計クエリー、および <code class="literal">NOT RLIKE</code> または <code class="literal">NOT REGEXP</code> を使用する比較でも、同じことが当てはまります。このような場合は、次に示すように、(<code class="literal">AND</code> ではなく) <code class="literal">OR</code> を使用して <code class="literal">NOT NULL</code> を明示的にテストする必要があります。
            </p><pre class="programlisting">
SELECT COUNT(*) FROM foo WHERE bar NOT LIKE '%baz%' OR bar IS NULL;
</pre></div></li><li class="listitem"><a name="function_strcmp"></a><p>
            <a class="indexterm" name="idm139979098234288"></a> <code class="literal">STRCMP(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
          </p><p>
            <code class="literal">STRCMP()</code> は、文字列が同じ場合は <code class="literal">0</code> を返し、現在のソート順に従って 1 番目の引数が 2 番目よりも小さい場合は <code class="literal">-1</code>、それ以外の場合は <code class="literal">1</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text', 'text2');</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text2', 'text');</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text', 'text');</code></strong>
        -&gt; 0
</pre><p>
            <code class="literal">STRCMP()</code> は、引数の照合順序を使用して比較を実行します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @s1 = _latin1 'x' COLLATE latin1_general_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s2 = _latin1 'X' COLLATE latin1_general_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s3 = _latin1 'x' COLLATE latin1_general_cs;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s4 = _latin1 'X' COLLATE latin1_general_cs;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s2), STRCMP(@s3, @s4);</code></strong>
+------------------+------------------+
| STRCMP(@s1, @s2) | STRCMP(@s3, @s4) |
+------------------+------------------+
|                0 |                1 |
+------------------+------------------+
</pre><p>
            照合順序の互換性がない場合は、その他との互換性を保つために、引数のいずれかを変換する必要があります。<a class="xref" href="globalization.html#charset-collation-expressions" title="10.1.7.5 式の照合順序">セクション10.1.7.5「式の照合順序」</a>を参照してください。
          </p><pre class="programlisting">

mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s3);</code></strong>
ERROR 1267 (HY000): Illegal mix of collations (latin1_general_ci,IMPLICIT) and (latin1_general_cs,IMPLICIT) for operation 'strcmp'
mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s3 COLLATE latin1_general_ci);</code></strong>
+--------------------------------------------+
| STRCMP(@s1, @s3 COLLATE latin1_general_ci) |
+--------------------------------------------+
|                                          0 |
+--------------------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="regexp"></a>12.5.2 正規表現</h3></div></div></div><a class="indexterm" name="idm139979098210576"></a><a class="indexterm" name="idm139979098209104"></a><a class="indexterm" name="idm139979098207728"></a><a class="indexterm" name="idm139979098206368"></a><div class="table"><a name="idm139979098204320"></a><p class="title"><b>表 12.9 文字列正規表現演算子</b></p><div class="table-contents"><table summary="文字列正規表現演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td><td>
      REGEXP の否定
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td><td>
      正規表現を使用したパターン一致
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a></td><td>
      REGEXP のシノニムです
    </td></tr></tbody></table></div></div><br class="table-break"><p>
        正規表現は、複雑な検索でパターンを指定する強力な方法です。
      </p><p>
        MySQL では、POSIX 1003.2 に準拠することを目的とした Henry Spencer 氏による正規表現の実装が使用されます。MySQL では、SQL ステートメントで <code class="literal">REGEXP</code> 演算子とともに実行されるパターンマッチング演算をサポートするために、拡張バージョンが使用されています。
      </p><p>
        このセクションでは、MySQL の <code class="literal">REGEXP</code> 演算で使用できる特殊な文字や構造を例を示して要約しています。Henry Spencer 氏の <code class="literal">regex(7)</code> マニュアルページで検索できる詳細がすべて含まれているわけではありません。そのマニュアルページは、MySQL のソース配布の <code class="filename">regex</code> ディレクトリにある <code class="filename">regex.7</code> ファイルに含まれています。<a class="xref" href="tutorial.html#pattern-matching" title="3.3.4.7 パターンマッチング">セクション3.3.4.7「パターンマッチング」</a>も参照してください。
      </p><h4><a name="idm139979098187168"></a>正規表現演算子</h4><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_not-regexp"></a><p>
            <a class="indexterm" name="idm139979098184096"></a> <code class="literal"><em class="replaceable"><code>expr</code></em> NOT REGEXP <em class="replaceable"><code>pat</code></em></code>, <code class="literal"><em class="replaceable"><code>expr</code></em> NOT RLIKE <em class="replaceable"><code>pat</code></em></code>
          </p><p>
            これは、<code class="literal">NOT (<em class="replaceable"><code>expr</code></em> REGEXP <em class="replaceable"><code>pat</code></em>)</code> と同じです。
          </p></li><li class="listitem"><a name="operator_regexp"></a><p>
            <a class="indexterm" name="idm139979098172400"></a> <a class="indexterm" name="idm139979098170896"></a> <a class="indexterm" name="idm139979098168864"></a> <a class="indexterm" name="idm139979098167632"></a> <code class="literal"><em class="replaceable"><code>expr</code></em> REGEXP <em class="replaceable"><code>pat</code></em></code>、<code class="literal"><em class="replaceable"><code>expr</code></em> RLIKE <em class="replaceable"><code>pat</code></em></code>
          </p><p>
            パターン <em class="replaceable"><code>pat</code></em> と比較して、文字列式 <em class="replaceable"><code>expr</code></em> のパターン一致を実行します。パターンは、拡張正規表現にすることができます。構文については、このセクションの後半で説明します。<em class="replaceable"><code>expr</code></em> が <em class="replaceable"><code>pat</code></em> と一致する場合は <code class="literal">1</code> を返し、それ以外の場合は <code class="literal">0</code> を返します。<em class="replaceable"><code>expr</code></em> または <em class="replaceable"><code>pat</code></em> のいずれかが <code class="literal">NULL</code> である場合は、結果も <code class="literal">NULL</code> になります。<code class="literal">RLIKE</code> は、<code class="literal">mSQL</code> との互換性を確保するために用意された <code class="literal">REGEXP</code> のシノニムです。
          </p><p>
            パターンはリテラル文字列である必要はありません。たとえば、文字列式やテーブルカラムとして指定できます。
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              MySQL では文字列で C のエスケープ構文 (たとえば、改行文字を表すために <span class="quote">「<span class="quote"><code class="literal">\n</code></span>」</span>) が使用されているため、<code class="literal">REGEXP</code> 文字列で使用される <span class="quote">「<span class="quote"><code class="literal">\</code></span>」</span> はすべて二重に指定する必要があります。
            </p></div><p>
            <code class="literal">REGEXP</code> では、バイナリ文字列で使用される場合を除いて、大文字と小文字が区別されません。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'Monty!' REGEXP '.*';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'new*\n*line' REGEXP 'new\\*.\\*line';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'a' REGEXP 'A', 'a' REGEXP BINARY 'A';</code></strong>
        -&gt; 1  0
mysql&gt; <strong class="userinput"><code>SELECT 'a' REGEXP '^[a-d]';</code></strong>
        -&gt; 1
</pre><p>
            <code class="literal">REGEXP</code> および <code class="literal">RLIKE</code> では、文字の型を決定する際および比較を実行する際に、引数の文字セットおよび照合順序が使用されます。引数にさまざまな文字セットまたは照合順序が含まれる場合は、<a class="xref" href="globalization.html#charset-collation-expressions" title="10.1.7.5 式の照合順序">セクション10.1.7.5「式の照合順序」</a>で説明するとおりに、型変換属性ルールが適用されます。
          </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">警告</div><p>
              <code class="literal">REGEXP</code> および <code class="literal">RLIKE</code> 演算子はバイト単位で機能するため、マルチバイトセーフではなく、マルチバイト文字セットを使用すると想定外の結果が生成される可能性があります。さらに、これらの演算子ではそのバイト値に基づいて文字が比較されるため、アクセント記号付き文字は、指定された照合順序では等しいとみなされた場合でも、等しいとして比較されない可能性があります。
            </p></div></li></ul></div><h4><a name="idm139979098133360"></a>正規表現の構文</h4><p>
        正規表現では、文字列のセットが記述されます。もっとも単純な正規表現は、特殊文字を使用していないものです。たとえば、正規表現 <code class="literal">hello</code> は <code class="literal">hello</code> にのみ一致します。
      </p><p>
        重要な正規表現では、複数の文字列に一致できるように特定の特殊構造が使用されます。たとえば、正規表現 <code class="literal">hello|word</code> は、文字列 <code class="literal">hello</code> または文字列 <code class="literal">word</code> に一致します。
      </p><p>
        さらに複雑な例として、正規表現 <code class="literal">B[an]*s</code> は、文字列 <code class="literal">Bananas</code>、<code class="literal">Baaaaas</code>、<code class="literal">Bs</code> のいずれか、および <code class="literal">B</code> で始まり、<code class="literal">s</code> で終わり、その間に任意の数字の <code class="literal">a</code> または <code class="literal">n</code> 文字が含まれるその他の文字列に一致します。
      </p><p>
        <code class="literal">REGEXP</code> 演算子の正規表現では、次の特殊文字および構造のいずれかが使用される場合があります。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">^</code>
          </p><p>
            文字列の先頭に一致します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'fo\nfo' REGEXP '^fo$';</code></strong>                   -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'fofo' REGEXP '^fo';</code></strong>                      -&gt; 1
</pre></li><li class="listitem"><p>
            <code class="literal">$</code>
          </p><p>
            文字列の末尾に一致します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'fo\no' REGEXP '^fo\no$';</code></strong>                 -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'fo\no' REGEXP '^fo$';</code></strong>                    -&gt; 0
</pre></li><li class="listitem"><p>
            <code class="literal">.</code>
          </p><p>
            任意の文字 (復帰改行および改行を含む) に一致します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'fofo' REGEXP '^f.*$';</code></strong>                    -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'fo\r\nfo' REGEXP '^f.*$';</code></strong>                -&gt; 1
</pre></li><li class="listitem"><p>
            <code class="literal">a*</code>
          </p><p>
            ゼロ個以上の <code class="literal">a</code> 文字のシーケンスに一致します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'Ban' REGEXP '^Ba*n';</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'Baaan' REGEXP '^Ba*n';</code></strong>                   -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'Bn' REGEXP '^Ba*n';</code></strong>                      -&gt; 1
</pre></li><li class="listitem"><p>
            <code class="literal">a+</code>
          </p><p>
            1 個以上の <code class="literal">a</code> 文字のシーケンスに一致します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'Ban' REGEXP '^Ba+n';</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'Bn' REGEXP '^Ba+n';</code></strong>                      -&gt; 0
</pre></li><li class="listitem"><p>
            <code class="literal">a?</code>
          </p><p>
            ゼロまたは 1 個の <code class="literal">a</code> 文字に一致します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'Bn' REGEXP '^Ba?n';</code></strong>                      -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'Ban' REGEXP '^Ba?n';</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'Baan' REGEXP '^Ba?n';</code></strong>                    -&gt; 0
</pre></li><li class="listitem"><p>
            <code class="literal">de|abc</code>
          </p><p>
            シーケンス <code class="literal">de</code> または <code class="literal">abc</code> のいずれかに一致します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'pi' REGEXP 'pi|apa';</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'axe' REGEXP 'pi|apa';</code></strong>                    -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'apa' REGEXP 'pi|apa';</code></strong>                    -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'apa' REGEXP '^(pi|apa)$';</code></strong>                -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'pi' REGEXP '^(pi|apa)$';</code></strong>                 -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'pix' REGEXP '^(pi|apa)$';</code></strong>                -&gt; 0
</pre></li><li class="listitem"><p>
            <code class="literal">(abc)*</code>
          </p><p>
            シーケンス <code class="literal">abc</code> のゼロ個以上のインスタンスに一致します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'pi' REGEXP '^(pi)*$';</code></strong>                    -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'pip' REGEXP '^(pi)*$';</code></strong>                   -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'pipi' REGEXP '^(pi)*$';</code></strong>                  -&gt; 1
</pre></li><li class="listitem"><p>
            <code class="literal">{1}</code>, <code class="literal">{2,3}</code>
          </p><p>
            <code class="literal">{n}</code> または <code class="literal">{m,n}</code> 注釈では、パターンの前の原子 (または<span class="quote">「<span class="quote">部分</span>」</span>) の数多くの出現に一致する正規表現を記述するより一般的な方法が提供されます。<code class="literal">m</code> および <code class="literal">n</code> は整数です。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">a*</code>
              </p><p>
                <code class="literal">a{0,}</code> と記述できます。
              </p></li><li class="listitem"><p>
                <code class="literal">a+</code>
              </p><p>
                <code class="literal">a{1,}</code> と記述できます。
              </p></li><li class="listitem"><p>
                <code class="literal">a?</code>
              </p><p>
                <code class="literal">a{0,1}</code> と記述できます。
              </p></li></ul></div><p>
            より厳密に言えば、<code class="literal">a{n}</code> は、<code class="literal">a</code> の正確に <code class="literal">n</code> 個のインスタンスに一致します。<code class="literal">a{n,}</code> は、<code class="literal">a</code> の <code class="literal">n</code> 個以上のインスタンスに一致します。<code class="literal">a{m,n}</code> は、<code class="literal">a</code> の <code class="literal">m</code> 個から <code class="literal">n</code> 個までのインスタンスに一致します。
          </p><p>
            <code class="literal">m</code> および <code class="literal">n</code> は、<code class="literal">0</code> から <code class="literal">RE_DUP_MAX</code> (デフォルトは 255) までの範囲内である必要があります。<code class="literal">m</code> および <code class="literal">n</code> の両方が指定されている場合は、<code class="literal">m</code> を <code class="literal">n</code> 以下にする必要があります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'abcde' REGEXP 'a[bcd]{2}e';</code></strong>              -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'abcde' REGEXP 'a[bcd]{3}e';</code></strong>              -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'abcde' REGEXP 'a[bcd]{1,10}e';</code></strong>           -&gt; 1
</pre></li><li class="listitem"><p>
            <code class="literal">[a-dX]</code>, <code class="literal">[^a-dX]</code>
          </p><p>
            <code class="literal">a</code>、<code class="literal">b</code>、<code class="literal">c</code>、<code class="literal">d</code>、または <code class="literal">X</code> である (^ が使用されている場合はそれ以外の) 任意の文字に一致します。2 つの文字の間の <code class="literal">-</code> 文字によって、1 番目の文字から 2 番目の文字までのすべての文字に一致する範囲が形成されます。たとえば、<code class="literal">[0-9]</code> は任意の 10 進数に一致します。リテラル文字 <code class="literal">]</code> を含めるには、左括弧 <code class="literal">[</code> の直後に記述する必要があります。リテラル文字 <code class="literal">-</code> を含めるには、先頭または末尾に記述する必要があります。<code class="literal">[]</code> ペアの内側に定義された特殊な意味を持たない文字は、それ自体としか一致しません。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'aXbc' REGEXP '[a-dXYZ]';</code></strong>                 -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'aXbc' REGEXP '^[a-dXYZ]$';</code></strong>               -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'aXbc' REGEXP '^[a-dXYZ]+$';</code></strong>              -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'aXbc' REGEXP '^[^a-dXYZ]+$';</code></strong>             -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'gheis' REGEXP '^[^a-dXYZ]+$';</code></strong>            -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'gheisa' REGEXP '^[^a-dXYZ]+$';</code></strong>           -&gt; 0
</pre></li><li class="listitem"><p>
            <code class="literal">[.characters.]</code>
          </p><p>
            (<code class="literal">[</code> と <code class="literal">]</code> を使用して記述された) 括弧式内で、その照合要素の文字シーケンスに一致します。<code class="literal">characters</code> は、単一の文字または <code class="literal">newline</code> などの文字名です。次の表には、許可されている文字名を一覧表示します。
          </p><p>
            次の表には、許可されている文字名および一致する文字を表示します。数値として指定された文字では、値が 8 進数で表記されます。
          </p><div class="informaltable"><table summary="この表には、許可されている文字名および一致する文字を表示します。スペースを節約するために、「名前」と「文字」をペアにしたカラムが 4 つのカラムテーブル書式で、「名前」、「文字」、「名前」、「文字」の順に表示されています。数値として指定された文字では、値が 8 進数で表記されます。" border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th scope="col">名前</th><th scope="col">文字</th><th scope="col">名前</th><th scope="col">文字</th></tr></thead><tbody><tr><td scope="row"><code class="literal">NUL</code></td><td><code class="literal">0</code></td><td><code class="literal">SOH</code></td><td><code class="literal">001</code></td></tr><tr><td scope="row"><code class="literal">STX</code></td><td><code class="literal">002</code></td><td><code class="literal">ETX</code></td><td><code class="literal">003</code></td></tr><tr><td scope="row"><code class="literal">EOT</code></td><td><code class="literal">004</code></td><td><code class="literal">ENQ</code></td><td><code class="literal">005</code></td></tr><tr><td scope="row"><code class="literal">ACK</code></td><td><code class="literal">006</code></td><td><code class="literal">BEL</code></td><td><code class="literal">007</code></td></tr><tr><td scope="row"><code class="literal">alert</code></td><td><code class="literal">007</code></td><td><code class="literal">BS</code></td><td><code class="literal">010</code></td></tr><tr><td scope="row"><code class="literal">backspace</code></td><td><code class="literal">'\b'</code></td><td><code class="literal">HT</code></td><td><code class="literal">011</code></td></tr><tr><td scope="row"><code class="literal">tab</code></td><td><code class="literal">'\t'</code></td><td><code class="literal">LF</code></td><td><code class="literal">012</code></td></tr><tr><td scope="row"><code class="literal">newline</code></td><td><code class="literal">'\n'</code></td><td><code class="literal">VT</code></td><td><code class="literal">013</code></td></tr><tr><td scope="row"><code class="literal">vertical-tab</code></td><td><code class="literal">'\v'</code></td><td><code class="literal">FF</code></td><td><code class="literal">014</code></td></tr><tr><td scope="row"><code class="literal">form-feed</code></td><td><code class="literal">'\f'</code></td><td><code class="literal">CR</code></td><td><code class="literal">015</code></td></tr><tr><td scope="row"><code class="literal">carriage-return</code></td><td><code class="literal">'\r'</code></td><td><code class="literal">SO</code></td><td><code class="literal">016</code></td></tr><tr><td scope="row"><code class="literal">SI</code></td><td><code class="literal">017</code></td><td><code class="literal">DLE</code></td><td><code class="literal">020</code></td></tr><tr><td scope="row"><code class="literal">DC1</code></td><td><code class="literal">021</code></td><td><code class="literal">DC2</code></td><td><code class="literal">022</code></td></tr><tr><td scope="row"><code class="literal">DC3</code></td><td><code class="literal">023</code></td><td><code class="literal">DC4</code></td><td><code class="literal">024</code></td></tr><tr><td scope="row"><code class="literal">NAK</code></td><td><code class="literal">025</code></td><td><code class="literal">SYN</code></td><td><code class="literal">026</code></td></tr><tr><td scope="row"><code class="literal">ETB</code></td><td><code class="literal">027</code></td><td><code class="literal">CAN</code></td><td><code class="literal">030</code></td></tr><tr><td scope="row"><code class="literal">EM</code></td><td><code class="literal">031</code></td><td><code class="literal">SUB</code></td><td><code class="literal">032</code></td></tr><tr><td scope="row"><code class="literal">ESC</code></td><td><code class="literal">033</code></td><td><code class="literal">IS4</code></td><td><code class="literal">034</code></td></tr><tr><td scope="row"><code class="literal">FS</code></td><td><code class="literal">034</code></td><td><code class="literal">IS3</code></td><td><code class="literal">035</code></td></tr><tr><td scope="row"><code class="literal">GS</code></td><td><code class="literal">035</code></td><td><code class="literal">IS2</code></td><td><code class="literal">036</code></td></tr><tr><td scope="row"><code class="literal">RS</code></td><td><code class="literal">036</code></td><td><code class="literal">IS1</code></td><td><code class="literal">037</code></td></tr><tr><td scope="row"><code class="literal">US</code></td><td><code class="literal">037</code></td><td><code class="literal">space</code></td><td><code class="literal">' '</code></td></tr><tr><td scope="row"><code class="literal">exclamation-mark</code></td><td><code class="literal">'!'</code></td><td><code class="literal">quotation-mark</code></td><td><code class="literal">'"'</code></td></tr><tr><td scope="row"><code class="literal">number-sign</code></td><td><code class="literal">'#'</code></td><td><code class="literal">dollar-sign</code></td><td><code class="literal">'$'</code></td></tr><tr><td scope="row"><code class="literal">percent-sign</code></td><td><code class="literal">'%'</code></td><td><code class="literal">ampersand</code></td><td><code class="literal">'&amp;'</code></td></tr><tr><td scope="row"><code class="literal">apostrophe</code></td><td><code class="literal">'\''</code></td><td><code class="literal">left-parenthesis</code></td><td><code class="literal">'('</code></td></tr><tr><td scope="row"><code class="literal">right-parenthesis</code></td><td><code class="literal">')'</code></td><td><code class="literal">asterisk</code></td><td><code class="literal">'*'</code></td></tr><tr><td scope="row"><code class="literal">plus-sign</code></td><td><code class="literal">'+'</code></td><td><code class="literal">comma</code></td><td><code class="literal">','</code></td></tr><tr><td scope="row"><code class="literal">hyphen</code></td><td><code class="literal">'-'</code></td><td><code class="literal">hyphen-minus</code></td><td><code class="literal">'-'</code></td></tr><tr><td scope="row"><code class="literal">period</code></td><td><code class="literal">'.'</code></td><td><code class="literal">full-stop</code></td><td><code class="literal">'.'</code></td></tr><tr><td scope="row"><code class="literal">slash</code></td><td><code class="literal">'/'</code></td><td><code class="literal">solidus</code></td><td><code class="literal">'/'</code></td></tr><tr><td scope="row"><code class="literal">zero</code></td><td><code class="literal">'0'</code></td><td><code class="literal">one</code></td><td><code class="literal">'1'</code></td></tr><tr><td scope="row"><code class="literal">two</code></td><td><code class="literal">'2'</code></td><td><code class="literal">three</code></td><td><code class="literal">'3'</code></td></tr><tr><td scope="row"><code class="literal">four</code></td><td><code class="literal">'4'</code></td><td><code class="literal">five</code></td><td><code class="literal">'5'</code></td></tr><tr><td scope="row"><code class="literal">six</code></td><td><code class="literal">'6'</code></td><td><code class="literal">seven</code></td><td><code class="literal">'7'</code></td></tr><tr><td scope="row"><code class="literal">eight</code></td><td><code class="literal">'8'</code></td><td><code class="literal">nine</code></td><td><code class="literal">'9'</code></td></tr><tr><td scope="row"><code class="literal">colon</code></td><td><code class="literal">':'</code></td><td><code class="literal">semicolon</code></td><td><code class="literal">';'</code></td></tr><tr><td scope="row"><code class="literal">less-than-sign</code></td><td><code class="literal">'&lt;'</code></td><td><code class="literal">equals-sign</code></td><td><code class="literal">'='</code></td></tr><tr><td scope="row"><code class="literal">greater-than-sign</code></td><td><code class="literal">'&gt;'</code></td><td><code class="literal">question-mark</code></td><td><code class="literal">'?'</code></td></tr><tr><td scope="row"><code class="literal">commercial-at</code></td><td><code class="literal">'@'</code></td><td><code class="literal">left-square-bracket</code></td><td><code class="literal">'['</code></td></tr><tr><td scope="row"><code class="literal">backslash</code></td><td><code class="literal">'\\'</code></td><td><code class="literal">reverse-solidus</code></td><td><code class="literal">'\\'</code></td></tr><tr><td scope="row"><code class="literal">right-square-bracket</code></td><td><code class="literal">']'</code></td><td><code class="literal">circumflex</code></td><td><code class="literal">'^'</code></td></tr><tr><td scope="row"><code class="literal">circumflex-accent</code></td><td><code class="literal">'^'</code></td><td><code class="literal">underscore</code></td><td><code class="literal">'_'</code></td></tr><tr><td scope="row"><code class="literal">low-line</code></td><td><code class="literal">'_'</code></td><td><code class="literal">grave-accent</code></td><td><code class="literal">'`'</code></td></tr><tr><td scope="row"><code class="literal">left-brace</code></td><td><code class="literal">'{'</code></td><td><code class="literal">left-curly-bracket</code></td><td><code class="literal">'{'</code></td></tr><tr><td scope="row"><code class="literal">vertical-line</code></td><td><code class="literal">'|'</code></td><td><code class="literal">right-brace</code></td><td><code class="literal">'}'</code></td></tr><tr><td scope="row"><code class="literal">right-curly-bracket</code></td><td><code class="literal">'}'</code></td><td><code class="literal">tilde</code></td><td><code class="literal">'~'</code></td></tr><tr><td scope="row"><code class="literal">DEL</code></td><td><code class="literal">177</code></td><td> </td><td> </td></tr></tbody></table></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT '~' REGEXP '[[.~.]]';</code></strong>                     -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT '~' REGEXP '[[.tilde.]]';</code></strong>                 -&gt; 1
</pre></li><li class="listitem"><p>
            <code class="literal">[=character_class=]</code>
          </p><p>
            (<code class="literal">[</code> と <code class="literal">]</code> 使用して記述された) 括弧式内の <code class="literal">[=character_class=]</code> は、等価クラスを表します。これは、同じ照合順序値を持つすべての文字 (それ自体を含む) に一致します。たとえば、<code class="literal">o</code> および <code class="literal">(+)</code> が等価クラスのメンバーである場合、<code class="literal">[[=o=]]</code>、<code class="literal">[[=(+)=]]</code>、および <code class="literal">[o(+)]</code> はすべてシノニムです。等価クラスは、範囲の終点として使用できない場合もあります。
          </p></li><li class="listitem"><p>
            <code class="literal">[:character_class:]</code>
          </p><p>
            (<code class="literal">[</code> と <code class="literal">]</code> を使用して記述された)括弧式内の <code class="literal">[:character_class:]</code> は、そのクラスに属するすべての文字と一致する文字クラスを表します。次の表には、標準のクラス名を一覧表示します。これらの名前は、<code class="literal">ctype(3)</code> のマニュアルページで定義されている文字クラスを表しています。特定のロケールでは、ほかのクラス名が提供される場合もあります。文字クラスは、範囲の終点として使用できない場合もあります。
          </p><div class="informaltable"><table summary="この表には、文字クラス名を一覧表示し、それぞれの意味について説明します。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">文字クラス名</th><th scope="col">意味</th></tr></thead><tbody><tr><td scope="row"><code class="literal">alnum</code></td><td>英数文字</td></tr><tr><td scope="row"><code class="literal">alpha</code></td><td>アルファベット文字</td></tr><tr><td scope="row"><code class="literal">blank</code></td><td>空白文字</td></tr><tr><td scope="row"><code class="literal">cntrl</code></td><td>制御文字</td></tr><tr><td scope="row"><code class="literal">digit</code></td><td>数字文字</td></tr><tr><td scope="row"><code class="literal">graph</code></td><td>図形文字</td></tr><tr><td scope="row"><code class="literal">lower</code></td><td>小文字アルファベット文字</td></tr><tr><td scope="row"><code class="literal">print</code></td><td>図形または空白文字</td></tr><tr><td scope="row"><code class="literal">punct</code></td><td>句読点文字</td></tr><tr><td scope="row"><code class="literal">space</code></td><td>空白、タブ、改行、および復帰改行</td></tr><tr><td scope="row"><code class="literal">upper</code></td><td>大文字アルファベット文字</td></tr><tr><td scope="row"><code class="literal">xdigit</code></td><td>16 進数文字</td></tr></tbody></table></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'justalnums' REGEXP '[[:alnum:]]+';</code></strong>       -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT '!!' REGEXP '[[:alnum:]]+';</code></strong>               -&gt; 0
</pre></li><li class="listitem"><p>
            <code class="literal">[[:&lt;:]]</code>, <code class="literal">[[:&gt;:]]</code>
          </p><p>
            これらのマーカーは、単語境界を表します。単語の先頭と末尾にそれぞれ一致します。単語とは、前後に単語文字が存在しない単語文字のシーケンスです。単語文字とは、<code class="literal">alnum</code> クラス内の英数文字またはアンダースコア (<code class="literal">_</code>) です。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'a word a' REGEXP '[[:&lt;:]]word[[:&gt;:]]';</code></strong>   -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 'a xword a' REGEXP '[[:&lt;:]]word[[:&gt;:]]';</code></strong>  -&gt; 0
</pre></li></ul></div><p>
        正規表現で特殊文字のリテラルインスタンスを使用するには、前に 2 つのバックスラッシュ (\) 文字を付けます。MySQL パーサーが 2 つのバックスラッシュの一方を解釈し、正規表現ライブラリがもう一方を解釈します。たとえば、特殊文字 <code class="literal">+</code> を含む文字列 <code class="literal">1+2</code> に一致する正規表現は、次のうちで最後のものだけです。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT '1+2' REGEXP '1+2';</code></strong>                       -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT '1+2' REGEXP '1\+2';</code></strong>                      -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT '1+2' REGEXP '1\\+2';</code></strong>                     -&gt; 1
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="numeric-functions"></a>12.6 数値関数と演算子</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#arithmetic-functions">12.6.1 算術演算子</a></span></dt><dt><span class="section"><a href="functions.html#mathematical-functions">12.6.2 数学関数</a></span></dt></dl></div><div class="table"><a name="idm139979097784240"></a><p class="title"><b>表 12.10 数値関数と演算子</b></p><div class="table-contents"><table summary="数値関数と演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></td><td>
      絶対値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></td><td>
      アークコサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></td><td>
      アークサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></td><td>
      2 つの引数のアークタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></td><td>
      アークタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></td><td>
      引数以上のもっとも小さな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></td><td>
      引数以上のもっとも小さな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></td><td>
      数値を異なる基数間で変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></td><td>
      コサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></td><td>
      コタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></td><td>
      巡回冗長検査値を計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></td><td>
      ラジアンを角度に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td><td>
      整数除算
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td><td>
      除算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></td><td>
      累乗します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></td><td>
      引数以下のもっとも大きな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></td><td>
      引数の自然対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></td><td>
      引数の底 10 の対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></td><td>
      引数の底 2 の対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></td><td>
      最初の引数の自然対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td><td>
      減算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mod"><code class="literal">MOD()</code></a></td><td>
      余りを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_mod"><code class="literal">%</code>, <code class="literal">MOD</code></a></td><td>
      モジュロ演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></td><td>
      pi の値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td><td>
      加算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></td><td>
      指定した指数で累乗された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></td><td>
      指定した指数で累乗された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></td><td>
      ラジアンに変換された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td><td>
      ランダムな浮動小数点値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></td><td>
      引数を丸めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></td><td>
      引数の符号を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></td><td>
      引数のサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></td><td>
      引数の平方根を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></td><td>
      引数のタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td><td>
      乗算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></td><td>
      指定された小数点以下の桁数に切り捨てます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td><td>
      引数の符号を変更します
    </td></tr></tbody></table></div></div><br class="table-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="arithmetic-functions"></a>12.6.1 算術演算子</h3></div></div></div><a class="indexterm" name="idm139979097706304"></a><div class="table"><a name="idm139979097704160"></a><p class="title"><b>表 12.11 算術演算子</b></p><div class="table-contents"><table summary="算術演算子" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td><td>
      整数除算
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td><td>
      除算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td><td>
      減算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_mod"><code class="literal">%</code>, <code class="literal">MOD</code></a></td><td>
      モジュロ演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td><td>
      加算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td><td>
      乗算演算子
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td><td>
      引数の符号を変更します
    </td></tr></tbody></table></div></div><br class="table-break"><p>
        通常の算術演算子を使用できます。結果は次のルールに従って決定されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">-</code>、<code class="literal">+</code>、および <code class="literal">*</code> の場合は、両方のオペランドが整数であれば、結果が <code class="literal">BIGINT</code> (64 ビット) 精度で計算されます。
          </p></li><li class="listitem"><p>
            両方のオペランドが整数で、いずれかが符合なしの場合は、結果が符合なし整数になります。減算では、<code class="literal">NO_UNSIGNED_SUBTRACTION</code> SQL モードが有効になっている場合は、オペランドのいずれかが符号なしでも、結果が符号付きになります。
          </p></li><li class="listitem"><p>
            <code class="literal">+</code>、<code class="literal">-</code>、<code class="literal">/</code>、<code class="literal">*</code>、<code class="literal">%</code> のオペランドのいずれかが実数値または文字列値である場合は、結果の精度が、最大の精度を持つオペランドの精度になります。
          </p></li><li class="listitem"><p>
            <code class="literal">/</code> を使用して実行される除算では、2 つの正確な値のオペランドを使用したときの結果のスケールが、1 番目のオペランドに <code class="literal">div_precision_increment</code> システム変数 (デフォルトでは 4) の値を加えた値になります。たとえば、式 <code class="literal">5.05 / 0.014</code> の結果のスケールは、小数点以下 6 桁になります (<code class="literal">360.714286</code>)。
          </p></li></ul></div><p>
        ネストされた計算が各コンポーネントの精度を暗黙的に示すように、これらのルールは演算ごとに適用されます。したがって、<code class="literal">(14620 / 9432456) / (24250 / 9432456)</code> では、まず <code class="literal">(0.0014) / (0.0026)</code> に解かれて、最終的な結果は小数点以下 8 桁 (<code class="literal">0.60288653</code>) になります。
      </p><p>
        このようなルールおよびそれらが適用される方法があるため、計算のコンポーネントおよびサブコンポーネントで適切な精度レベルが使用されていることを慎重に確認してください。<a class="xref" href="functions.html#cast-functions" title="12.10 キャスト関数と演算子">セクション12.10「キャスト関数と演算子」</a>を参照してください。
      </p><p>
        数値式評価でのオーバーフロー処理については、<a class="xref" href="data-types.html#out-of-range-and-overflow" title="11.2.6 範囲外およびオーバーフローの処理">セクション11.2.6「範囲外およびオーバーフローの処理」</a>を参照してください。
      </p><p>
        算術演算子は数字に適用されます。その他の型の値では、代替の演算が使用できる場合もあります。たとえば、日付値を追加するには、<code class="literal">DATE_ADD()</code> を使用します。<a class="xref" href="functions.html#date-and-time-functions" title="12.7 日付および時間関数">セクション12.7「日付および時間関数」</a>を参照してください。
      </p><a class="indexterm" name="idm139979097656464"></a><a class="indexterm" name="idm139979097654352"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_plus"></a><p>
            <a class="indexterm" name="idm139979097650688"></a> <a class="indexterm" name="idm139979097649232"></a> <code class="literal">+</code>
          </p><p>
            加算:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 3+5;</code></strong>
        -&gt; 8
</pre></li><li class="listitem"><a name="operator_minus"></a><p>
            <a class="indexterm" name="idm139979097640384"></a> <a class="indexterm" name="idm139979097638928"></a> <code class="literal">-</code>
          </p><p>
            減算:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 3-5;</code></strong>
        -&gt; -2
</pre></li><li class="listitem"><a name="operator_unary-minus"></a><p>
            <a class="indexterm" name="idm139979097630016"></a> <a class="indexterm" name="idm139979097628512"></a> <a class="indexterm" name="idm139979097626480"></a> <code class="literal">-</code>
          </p><p>
            単項マイナス。この演算子は、オペランドの符号を変更します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT - 2;</code></strong>
        -&gt; -2
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              この演算子が <code class="literal">BIGINT</code> で使用される場合は、戻り値も <code class="literal">BIGINT</code> になります。つまり、値 −2<sup>63</sup> を持つ可能性のある整数では、<code class="literal">-</code> の使用を避けるべきです。
            </p></div></li><li class="listitem"><a name="operator_times"></a><p>
            <a class="indexterm" name="idm139979097613216"></a> <a class="indexterm" name="idm139979097611760"></a> <code class="literal">*</code>
          </p><p>
            乗算:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 3*5;</code></strong>
        -&gt; 15
mysql&gt; <strong class="userinput"><code>SELECT 18014398509481984*18014398509481984.0;</code></strong>
        -&gt; 324518553658426726783156020576256.0
mysql&gt; <strong class="userinput"><code>SELECT 18014398509481984*18014398509481984;</code></strong>
        -&gt; out-of-range error
</pre><p>
            最後の式では、整数乗算の結果が 64 ビット範囲の <code class="literal">BIGINT</code> 計算を超過するため、エラーが生成されます。(<a class="xref" href="data-types.html#numeric-types" title="11.2 数値型">セクション11.2「数値型」</a>を参照してください。)
          </p></li><li class="listitem"><a name="operator_divide"></a><p>
            <a class="indexterm" name="idm139979097598832"></a> <a class="indexterm" name="idm139979097597376"></a> <code class="literal">/</code>
          </p><p>
            除算:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 3/5;</code></strong>
        -&gt; 0.60
</pre><p>
            ゼロによる除算では、<code class="literal">NULL</code> の結果が生成されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 102/(1-1);</code></strong>
        -&gt; NULL
</pre><p>
            結果が整数に変換されるコンテキストで実行される場合にのみ、除算は <code class="literal">BIGINT</code> 算術を使用して計算されます。
          </p></li><li class="listitem"><a name="operator_div"></a><p>
            <a class="indexterm" name="idm139979097583392"></a> <code class="literal">DIV</code>
          </p><p>
            整数除算。<code class="literal">FLOOR()</code> に類似していますが、<code class="literal">BIGINT</code> 値でも安全です。
          </p><p>
            MySQL 5.6 では、オペランドのいずれかが整数以外の型である場合は、結果が <code class="literal">BIGINT</code> に変換される前に、オペランドが <code class="literal">DECIMAL</code> に変換され、<code class="literal">DECIMAL</code> 算術を使用して除算されます。結果が <code class="literal">BIGINT</code> の範囲を超過する場合は、エラーが発生します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 5 DIV 2;</code></strong>
        -&gt; 2
</pre></li><li class="listitem"><a name="operator_mod"></a><p>
            <a class="indexterm" name="idm139979097567280"></a> <code class="literal"><em class="replaceable"><code>N</code></em> % <em class="replaceable"><code>M</code></em></code>, <code class="literal"><em class="replaceable"><code>N</code></em> MOD <em class="replaceable"><code>M</code></em></code>
          </p><p>
            モジュロ演算。<em class="replaceable"><code>M</code></em> で除算された <em class="replaceable"><code>N</code></em> の余りを返します。詳細は、<a class="xref" href="functions.html#mathematical-functions" title="12.6.2 数学関数">セクション12.6.2「数学関数」</a>の <code class="literal">MOD()</code> 関数に関する説明を参照してください。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mathematical-functions"></a>12.6.2 数学関数</h3></div></div></div><div class="table"><a name="idm139979097556128"></a><p class="title"><b>表 12.12 数学関数</b></p><div class="table-contents"><table summary="数学関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></td><td>
      絶対値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></td><td>
      アークコサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></td><td>
      アークサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></td><td>
      2 つの引数のアークタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></td><td>
      アークタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></td><td>
      引数以上のもっとも小さな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></td><td>
      引数以上のもっとも小さな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></td><td>
      数値を異なる基数間で変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></td><td>
      コサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></td><td>
      コタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></td><td>
      巡回冗長検査値を計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></td><td>
      ラジアンを角度に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></td><td>
      累乗します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></td><td>
      引数以下のもっとも大きな整数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></td><td>
      引数の自然対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></td><td>
      引数の底 10 の対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></td><td>
      引数の底 2 の対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></td><td>
      最初の引数の自然対数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mod"><code class="literal">MOD()</code></a></td><td>
      余りを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></td><td>
      pi の値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></td><td>
      指定した指数で累乗された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></td><td>
      指定した指数で累乗された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></td><td>
      ラジアンに変換された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td><td>
      ランダムな浮動小数点値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></td><td>
      引数を丸めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></td><td>
      引数の符号を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></td><td>
      引数のサインを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></td><td>
      引数の平方根を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></td><td>
      引数のタンジェントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></td><td>
      指定された小数点以下の桁数に切り捨てます
    </td></tr></tbody></table></div></div><br class="table-break"><p>
        すべての数学関数は、エラーの発生時に <code class="literal">NULL</code> を返します。
      </p><a class="indexterm" name="idm139979097490944"></a><a class="indexterm" name="idm139979097489472"></a><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_abs"></a><p>
            <a class="indexterm" name="idm139979097485056"></a> <code class="literal">ABS(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> の絶対値を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ABS(2);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT ABS(-32);</code></strong>
        -&gt; 32
</pre><p>
            この関数は、<code class="literal">BIGINT</code> 値でも安全に使用できます。
          </p></li><li class="listitem"><a name="function_acos"></a><p>
            <a class="indexterm" name="idm139979097473232"></a> <code class="literal">ACOS(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> のアークコサイン (つまり、コサインが <em class="replaceable"><code>X</code></em> である値) を返します。<em class="replaceable"><code>X</code></em> が <code class="literal">-1</code> から <code class="literal">1</code> までの範囲内にない場合は、<code class="literal">NULL</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ACOS(1);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT ACOS(1.0001);</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT ACOS(0);</code></strong>
        -&gt; 1.5707963267949
</pre></li><li class="listitem"><a name="function_asin"></a><p>
            <a class="indexterm" name="idm139979097459040"></a> <code class="literal">ASIN(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> のアークサイン (つまり、サインが <em class="replaceable"><code>X</code></em> である値) を返します。<em class="replaceable"><code>X</code></em> が <code class="literal">-1</code> から <code class="literal">1</code> までの範囲内にない場合は、<code class="literal">NULL</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ASIN(0.2);</code></strong>
        -&gt; 0.20135792079033
mysql&gt; <strong class="userinput"><code>SELECT ASIN('foo');</code></strong>

+-------------+
| ASIN('foo') |
+-------------+
|           0 |
+-------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+-----------------------------------------+
| Level   | Code | Message                                 |
+---------+------+-----------------------------------------+
| Warning | 1292 | Truncated incorrect DOUBLE value: 'foo' |
+---------+------+-----------------------------------------+
</pre></li><li class="listitem"><a name="function_atan"></a><p>
            <a class="indexterm" name="idm139979097444288"></a> <code class="literal">ATAN(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> のアークタンジェント (つまり、タンジェントが <em class="replaceable"><code>X</code></em> である値) を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ATAN(2);</code></strong>
        -&gt; 1.1071487177941
mysql&gt; <strong class="userinput"><code>SELECT ATAN(-2);</code></strong>
        -&gt; -1.1071487177941
</pre></li><li class="listitem"><a name="function_atan2"></a><p>
            <a class="indexterm" name="idm139979097433280"></a> <code class="literal">ATAN(<em class="replaceable"><code>Y</code></em>,<em class="replaceable"><code>X</code></em>)</code>, <code class="literal">ATAN2(<em class="replaceable"><code>Y</code></em>,<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            2 つの変数 <em class="replaceable"><code>X</code></em> および <em class="replaceable"><code>Y</code></em> のアークタンジェントを返します。これは、両方の引数の符号が結果の象限の判定に使用される点を除いて、<code class="literal"><em class="replaceable"><code>Y</code></em> / <em class="replaceable"><code>X</code></em></code> のアークタンジェントの計算と同様です。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ATAN(-2,2);</code></strong>
        -&gt; -0.78539816339745
mysql&gt; <strong class="userinput"><code>SELECT ATAN2(PI(),0);</code></strong>
        -&gt; 1.5707963267949
</pre></li><li class="listitem"><a name="function_ceil"></a><p>
            <a class="indexterm" name="idm139979097417680"></a> <code class="literal">CEIL(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <code class="literal">CEIL()</code> は <code class="literal">CEILING()</code> のシノニムです。
          </p></li><li class="listitem"><a name="function_ceiling"></a><p>
            <a class="indexterm" name="idm139979097407744"></a> <code class="literal">CEILING(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> 以上で最小の整数値を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CEILING(1.23);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT CEILING(-1.23);</code></strong>
        -&gt; -1
</pre><p>
            引数が厳密値数値の場合は、戻り値の型も厳密値数値になります。引数が文字列または浮動小数点の場合は、戻り値の型が浮動小数点になります。
          </p></li><li class="listitem"><a name="function_conv"></a><p>
            <a class="indexterm" name="idm139979097396544"></a> <code class="literal">CONV(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>from_base</code></em>,<em class="replaceable"><code>to_base</code></em>)</code>
          </p><p>
            数値を異なる基数間で変換します。基数 <em class="replaceable"><code>from_base</code></em> から基数 <em class="replaceable"><code>to_base</code></em> に変換された数値 <em class="replaceable"><code>N</code></em> の文字列表現を返します。引数のいずれかが <code class="literal">NULL</code> である場合は、<code class="literal">NULL</code> を返します。引数 <em class="replaceable"><code>N</code></em> は整数として解釈されますが、整数または文字列として指定される場合もあります。最小の基数は <code class="literal">2</code> で、最大の基数は <code class="literal">36</code> です。<em class="replaceable"><code>to_base</code></em> が負の数字である場合は、<em class="replaceable"><code>N</code></em> は符号付きの数字とみなされます。それ以外の場合は、<em class="replaceable"><code>N</code></em> は符号なしとみなされます。<code class="literal">CONV()</code> は 64 ビット精度で動作します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CONV('a',16,2);</code></strong>
        -&gt; '1010'
mysql&gt; <strong class="userinput"><code>SELECT CONV('6E',18,8);</code></strong>
        -&gt; '172'
mysql&gt; <strong class="userinput"><code>SELECT CONV(-17,10,-18);</code></strong>
        -&gt; '-H'
mysql&gt; <strong class="userinput"><code>SELECT CONV(10+'10'+'10'+0xa,10,10);</code></strong>
        -&gt; '40'
</pre></li><li class="listitem"><a name="function_cos"></a><p>
            <a class="indexterm" name="idm139979097376400"></a> <code class="literal">COS(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> のコサインを返します。<em class="replaceable"><code>X</code></em> はラジアンで指定されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT COS(PI());</code></strong>
        -&gt; -1
</pre></li><li class="listitem"><a name="function_cot"></a><p>
            <a class="indexterm" name="idm139979097366336"></a> <code class="literal">COT(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> のコタンジェントを返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT COT(12);</code></strong>
        -&gt; -1.5726734063977
mysql&gt; <strong class="userinput"><code>SELECT COT(0);</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_crc32"></a><p>
            <a class="indexterm" name="idm139979097355936"></a> <code class="literal">CRC32(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            巡回冗長検査値を計算し、32 ビット値の符号なし値を返します。引数が <code class="literal">NULL</code> である場合は、結果も <code class="literal">NULL</code> になります。引数は文字列であると想定され、(可能な場合は) 文字列でない場合でも文字列として処理されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CRC32('MySQL');</code></strong>
        -&gt; 3259397556
mysql&gt; <strong class="userinput"><code>SELECT CRC32('mysql');</code></strong>
        -&gt; 2501908538
</pre></li><li class="listitem"><a name="function_degrees"></a><p>
            <a class="indexterm" name="idm139979097344016"></a> <code class="literal">DEGREES(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            ラジアンからディグリーに変換された引数 <em class="replaceable"><code>X</code></em> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DEGREES(PI());</code></strong>
        -&gt; 180
mysql&gt; <strong class="userinput"><code>SELECT DEGREES(PI() / 2);</code></strong>
        -&gt; 90
</pre></li><li class="listitem"><a name="function_exp"></a><p>
            <a class="indexterm" name="idm139979097333520"></a> <code class="literal">EXP(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <span class="emphasis"><em>e</em></span> (自然対数の底) の <em class="replaceable"><code>X</code></em> 乗の値を返します。この関数の逆は、(単一の引数のみを使用する) <code class="literal">LOG()</code> または <code class="literal">LN()</code> です。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT EXP(2);</code></strong>
        -&gt; 7.3890560989307
mysql&gt; <strong class="userinput"><code>SELECT EXP(-2);</code></strong>
        -&gt; 0.13533528323661
mysql&gt; <strong class="userinput"><code>SELECT EXP(0);</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="function_floor"></a><p>
            <a class="indexterm" name="idm139979097319856"></a> <code class="literal">FLOOR(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> 以下で最大の整数値を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FLOOR(1.23);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT FLOOR(-1.23);</code></strong>
        -&gt; -2
</pre><p>
            引数が厳密値数値の場合は、戻り値の型も厳密値数値になります。引数が文字列または浮動小数点の場合は、戻り値の型が浮動小数点になります。
          </p></li><li class="listitem"><p>
            <code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code>
          </p><p>
            数値 <em class="replaceable"><code>X</code></em> を <code class="literal">'#,###,###.##'</code> のような書式に変換し、小数点第 <em class="replaceable"><code>D</code></em> 位に丸めて、その結果を文字列として返します。詳細は、<a class="xref" href="functions.html#string-functions" title="12.5 文字列関数">セクション12.5「文字列関数」</a>を参照してください。
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139979097303264"></a> <code class="literal">HEX(N_or_S)</code>
          </p><p>
            この関数を使用すると、10 進数または文字列の 16 進表現を取得できます。その方法は、引数の型によって異なります。詳細は、<a class="xref" href="functions.html#string-functions" title="12.5 文字列関数">セクション12.5「文字列関数」</a>で、この関数の説明を参照してください。
          </p></li><li class="listitem"><a name="function_ln"></a><p>
            <a class="indexterm" name="idm139979097296960"></a> <code class="literal">LN(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> の自然対数 (つまり、<em class="replaceable"><code>X</code></em> の底 <span class="emphasis"><em>e</em></span> の対数) を返します。<em class="replaceable"><code>X</code></em> が 0 以下である場合は、<code class="literal">NULL</code> が返されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LN(2);</code></strong>
        -&gt; 0.69314718055995
mysql&gt; <strong class="userinput"><code>SELECT LN(-2);</code></strong>
        -&gt; NULL
</pre><p>
            この関数は <code class="literal">LOG(<em class="replaceable"><code>X</code></em>)</code> のシノニムです。この関数の逆は、<code class="literal">EXP()</code> 関数です。
          </p></li><li class="listitem"><a name="function_log"></a><p>
            <a class="indexterm" name="idm139979097281584"></a> <code class="literal">LOG(<em class="replaceable"><code>X</code></em>)</code>, <code class="literal">LOG(<em class="replaceable"><code>B</code></em>,<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            1 つのパラメータで呼び出される場合、この関数は <em class="replaceable"><code>X</code></em> の自然対数を返します。<em class="replaceable"><code>X</code></em> が 0 以下である場合は、<code class="literal">NULL</code> が返されます。
          </p><p>
            この関数 (単一の引数で呼び出された場合) の逆は、<code class="literal">EXP()</code> 関数です。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOG(2);</code></strong>
        -&gt; 0.69314718055995
mysql&gt; <strong class="userinput"><code>SELECT LOG(-2);</code></strong>
        -&gt; NULL
</pre><p>
            この関数が 2 つのパラメータで呼び出される場合は、<em class="replaceable"><code>B</code></em> を底とする <em class="replaceable"><code>X</code></em> の対数が返されます。<em class="replaceable"><code>X</code></em> が 0 以下である場合、または <em class="replaceable"><code>B</code></em> が 1 以下である場合は、<code class="literal">NULL</code> が返されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOG(2,65536);</code></strong>
        -&gt; 16
mysql&gt; <strong class="userinput"><code>SELECT LOG(10,100);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT LOG(1,100);</code></strong>
        -&gt; NULL
</pre><p>
            <code class="literal">LOG(<em class="replaceable"><code>B</code></em>,<em class="replaceable"><code>X</code></em>)</code> は <code class="literal">LOG(<em class="replaceable"><code>X</code></em>) / LOG(<em class="replaceable"><code>B</code></em>)</code> と同等です。
          </p></li><li class="listitem"><a name="function_log2"></a><p>
            <a class="indexterm" name="idm139979097256560"></a> <code class="literal">LOG2(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <code class="literal"><em class="replaceable"><code>X</code></em></code> の底 2 の対数を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOG2(65536);</code></strong>
        -&gt; 16
mysql&gt; <strong class="userinput"><code>SELECT LOG2(-100);</code></strong>
        -&gt; NULL
</pre><p>
            <code class="literal">LOG2()</code> は、格納に必要なビット数を調べる際に役立ちます。この関数は式 <code class="literal">LOG(<em class="replaceable"><code>X</code></em>) / LOG(2)</code> と同等です。
          </p></li><li class="listitem"><a name="function_log10"></a><p>
            <a class="indexterm" name="idm139979097242816"></a> <code class="literal">LOG10(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> の底 10 の対数を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOG10(2);</code></strong>
        -&gt; 0.30102999566398
mysql&gt; <strong class="userinput"><code>SELECT LOG10(100);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT LOG10(-100);</code></strong>
        -&gt; NULL
</pre><p>
            <code class="literal">LOG10(<em class="replaceable"><code>X</code></em>)</code> は <code class="literal">LOG(10,<em class="replaceable"><code>X</code></em>)</code> と同等です。
          </p></li><li class="listitem"><a name="function_mod"></a><p>
            <a class="indexterm" name="idm139979097227824"></a> <a class="indexterm" name="idm139979097226512"></a> <a class="indexterm" name="idm139979097225040"></a> <a class="indexterm" name="idm139979097223680"></a> <a class="indexterm" name="idm139979097222336"></a> <code class="literal">MOD(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>M</code></em>)</code>、<code class="literal"><em class="replaceable"><code>N</code></em> % <em class="replaceable"><code>M</code></em></code>、<code class="literal"><em class="replaceable"><code>N</code></em> MOD <em class="replaceable"><code>M</code></em></code>
          </p><p>
            モジュロ演算。<em class="replaceable"><code>M</code></em> で除算された <em class="replaceable"><code>N</code></em> の余りを返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MOD(234, 10);</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT 253 % 7;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT 29 MOD 9;</code></strong>
        -&gt; 2
</pre><p>
            この関数は、<code class="literal">BIGINT</code> 値でも安全に使用できます。
          </p><p>
            <code class="literal">MOD()</code> は、小数部を持つ値でも機能し、除算後の正確な余りを返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MOD(34.5,3);</code></strong>
        -&gt; 1.5
</pre><p>
            <code class="literal">MOD(<em class="replaceable"><code>N</code></em>,0)</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_pi"></a><p>
            <a class="indexterm" name="idm139979097199376"></a> <code class="literal">PI()</code>
          </p><p>
            π (pi) の値を返します。表示されるデフォルトの小数点以下の桁数は 7 ですが、MySQL では内部的に全倍精度値が使用されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT PI();</code></strong>
        -&gt; 3.141593
mysql&gt; <strong class="userinput"><code>SELECT PI()+0.000000000000000000;</code></strong>
        -&gt; 3.141592653589793116
</pre></li><li class="listitem"><a name="function_pow"></a><p>
            <a class="indexterm" name="idm139979097188736"></a> <code class="literal">POW(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>Y</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> の <em class="replaceable"><code>Y</code></em> 乗の値を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT POW(2,2);</code></strong>
        -&gt; 4
mysql&gt; <strong class="userinput"><code>SELECT POW(2,-2);</code></strong>
        -&gt; 0.25
</pre></li><li class="listitem"><a name="function_power"></a><p>
            <a class="indexterm" name="idm139979097177008"></a> <code class="literal">POWER(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>Y</code></em>)</code>
          </p><p>
            これは <code class="literal">POW()</code> のシノニムです。
          </p></li><li class="listitem"><a name="function_radians"></a><p>
            <a class="indexterm" name="idm139979097168384"></a> <code class="literal">RADIANS(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            ディグリーからラジアンに変換された引数 <em class="replaceable"><code>X</code></em> を返します。
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              π ラジアンは、180 ディグリーと同等です。
            </p></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT RADIANS(90);</code></strong>
        -&gt; 1.5707963267949
</pre></li><li class="listitem"><a name="function_rand"></a><p>
            <a class="indexterm" name="idm139979097157616"></a> <code class="literal">RAND()</code>, <code class="literal">RAND(<em class="replaceable"><code>N</code></em>)</code>
          </p><p>
            <code class="literal">0</code> &lt;= <em class="replaceable"><code>v</code></em> &lt; <code class="literal">1.0</code> の範囲内で、ランダムな浮動小数点値 <em class="replaceable"><code>v</code></em> を返します。定数整数引数 <em class="replaceable"><code>N</code></em> が指定されている場合は、カラム値の反復可能なシーケンスを生成するシード値として使用されます。次の例では、<code class="literal">RAND(3)</code> で生成される値のシーケンスが、発生した両方の場所で同じです。
          </p><pre class="programlisting">

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i INT);</code></strong>
Query OK, 0 rows affected (0.42 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(1),(2),(3);</code></strong>
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT i, RAND() FROM t;</code></strong>
+------+------------------+
| i    | RAND()           |
+------+------------------+
|    1 | 0.61914388706828 |
|    2 | 0.93845168309142 |
|    3 | 0.83482678498591 |
+------+------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i, RAND(3) FROM t;</code></strong>
+------+------------------+
| i    | RAND(3)          |
+------+------------------+
|    1 | 0.90576975597606 |
|    2 | 0.37307905813035 |
|    3 | 0.14808605345719 |
+------+------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i, RAND() FROM t;</code></strong>
+------+------------------+
| i    | RAND()           |
+------+------------------+
|    1 | 0.35877890638893 |
|    2 | 0.28941420772058 |
|    3 | 0.37073435016976 |
+------+------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i, RAND(3) FROM t;</code></strong>
+------+------------------+
| i    | RAND(3)          |
+------+------------------+
|    1 | 0.90576975597606 |
|    2 | 0.37307905813035 |
|    3 | 0.14808605345719 |
+------+------------------+
3 rows in set (0.01 sec)
</pre><p>
            定数イニシャライザを使用すると、シードは実行される前に、ステートメントのコンパイル時に一度初期化されます。引数として非定数イニシャライザ (カラム名など) が使用される場合は、<code class="literal">RAND()</code> が起動されるたびに、その値でシードが初期化されます。(引数値が等しい場合は、<code class="literal">RAND()</code> で毎回同じ値が返されることを示しています。)
          </p><p>
            <em class="replaceable"><code>i</code></em> &lt;= <em class="replaceable"><code>R</code></em> &lt; <em class="replaceable"><code>j</code></em> の範囲内でランダムな整数 <em class="replaceable"><code>R</code></em> を取得するには、式 <code class="literal">FLOOR(<em class="replaceable"><code>i</code></em> + RAND() * (<em class="replaceable"><code>j</code></em></code> − <code class="literal"><em class="replaceable"><code>i</code></em>))</code> を使用します。たとえば、<code class="literal">7</code> &lt;= <em class="replaceable"><code>R</code></em> &lt; <code class="literal">12</code> の範囲内でランダムな整数を取得するには、次のようなステートメントを使用します。
          </p><pre class="programlisting">
SELECT FLOOR(7 + (RAND() * 5));
</pre><p>
            <code class="literal">WHERE</code> 句内の <code class="literal">RAND()</code> は、<code class="literal">WHERE</code> が実行されるたびに再評価されます。
          </p><p>
            <code class="literal">ORDER BY</code> ではカラムが複数回評価されるため、<code class="literal">ORDER BY</code> 句内では <code class="literal">RAND()</code> 値を持つカラムを使用できません。ただし、次のようにランダムな順序で行を取得できます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> ORDER BY RAND();</code></strong>
</pre><p>
            <code class="literal">LIMIT</code> と組み合わせて <code class="literal">ORDER BY RAND()</code> を使用すれば、行のセットからランダムなサンプルを選択する際に役立ちます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM table1, table2 WHERE a=b AND c&lt;d</code></strong> -&gt; <strong class="userinput"><code>ORDER BY RAND() LIMIT 1000;</code></strong>
</pre><p>
            <code class="literal">RAND()</code> は、完全なランダムジェネレータとしては設計されていません。要求に応じてランダムな数字をすばやく生成する方法であり、同じ MySQL バージョンのプラットフォーム間で移植可能です。
          </p><p>
            この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。(Bug #49222)
          </p></li><li class="listitem"><a name="function_round"></a><p>
            <a class="indexterm" name="idm139979097110400"></a> <code class="literal">ROUND(<em class="replaceable"><code>X</code></em>)</code>, <code class="literal">ROUND(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code>
          </p><p>
            引数 <em class="replaceable"><code>X</code></em> を <em class="replaceable"><code>D</code></em> 小数点に丸めます。丸めアルゴリズムは、<em class="replaceable"><code>X</code></em> のデータ型に依存します。<em class="replaceable"><code>D</code></em> が指定されていない場合は、デフォルトで 0 に設定されます。<em class="replaceable"><code>D</code></em> を負の数に指定すると、値 <em class="replaceable"><code>X</code></em> の小数点左側の <em class="replaceable"><code>D</code></em> 桁をゼロにすることができます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ROUND(-1.23);</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT ROUND(-1.58);</code></strong>
        -&gt; -2
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.58);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.298, 1);</code></strong>
        -&gt; 1.3
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.298, 0);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT ROUND(23.298, -1);</code></strong>
        -&gt; 20
</pre><p>
            戻り型は、(整数、重複、または 10 進数と仮定すると) 1 番目の引数と同じ型です。つまり、引数が整数の場合は、結果が整数 (小数点なし) になります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ROUND(150.000,2), ROUND(150,2);</code></strong>
+------------------+--------------+
| ROUND(150.000,2) | ROUND(150,2) |
+------------------+--------------+
|           150.00 |          150 |
+------------------+--------------+
</pre><p>
            <code class="literal">ROUND()</code> では、第 1 引数の型に応じて次のルールが使用されます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                真値の数字の場合、<code class="literal">ROUND()</code> では<span class="quote">「<span class="quote">四捨五入</span>」</span>または<span class="quote">「<span class="quote">切り捨て (切り上げ)</span>」</span> ルールが使用されます。0.5 以上の小数部を持つ値は、正の場合は次の整数に切り上げられ、負の場合は次の整数に切り下げられます。(つまり、ゼロから遠い方に丸められます。)0.5 未満の小数部を持つ値は、正の場合は次の整数に切り下げられ、負の場合は次の整数に切り上げられます。
              </p></li><li class="listitem"><p>
                近似値の数字の場合、結果は C ライブラリによって異なります。多くのシステムでは、これは、<code class="literal">ROUND()</code> で「偶数丸め」ルールが使用されることを意味します。任意の小数部を持つ値は、もっとも近い偶数の整数に丸められます。
              </p></li></ul></div><p>
            次の例では、正確な値の丸めと近似値の丸めの相違点を示します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5), ROUND(25E-1);</code></strong>
+------------+--------------+
| ROUND(2.5) | ROUND(25E-1) |
+------------+--------------+
| 3          |            2 |
+------------+--------------+
</pre><p>
            詳細は、<a class="xref" href="functions.html#precision-math" title="12.20 高精度計算">セクション12.20「高精度計算」</a>を参照してください。
          </p></li><li class="listitem"><a name="function_sign"></a><p>
            <a class="indexterm" name="idm139979097079024"></a> <code class="literal">SIGN(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> が負、ゼロ、または正のいずれであるのかに応じて、引数の符号を <code class="literal">-1</code>、<code class="literal">0</code>、または <code class="literal">1</code> として返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SIGN(-32);</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT SIGN(0);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT SIGN(234);</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="function_sin"></a><p>
            <a class="indexterm" name="idm139979097065728"></a> <code class="literal">SIN(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> のサインを返します。<em class="replaceable"><code>X</code></em> はラジアンで指定されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SIN(PI());</code></strong>
        -&gt; 1.2246063538224e-16
mysql&gt; <strong class="userinput"><code>SELECT ROUND(SIN(PI()));</code></strong>
        -&gt; 0
</pre></li><li class="listitem"><a name="function_sqrt"></a><p>
            <a class="indexterm" name="idm139979097054864"></a> <code class="literal">SQRT(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            負ではない数字 <em class="replaceable"><code>X</code></em> の平方根を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SQRT(4);</code></strong>
        -&gt; 2
mysql&gt; <strong class="userinput"><code>SELECT SQRT(20);</code></strong>
        -&gt; 4.4721359549996
mysql&gt; <strong class="userinput"><code>SELECT SQRT(-16);</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_tan"></a><p>
            <a class="indexterm" name="idm139979097043712"></a> <code class="literal">TAN(<em class="replaceable"><code>X</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>X</code></em> のタンジェントを返します。<em class="replaceable"><code>X</code></em> はラジアンで指定されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TAN(PI());</code></strong>
        -&gt; -1.2246063538224e-16
mysql&gt; <strong class="userinput"><code>SELECT TAN(PI()+1);</code></strong>
        -&gt; 1.5574077246549
</pre></li><li class="listitem"><a name="function_truncate"></a><p>
            <a class="indexterm" name="idm139979097032784"></a> <code class="literal">TRUNCATE(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>D</code></em> 小数点に切り捨てて、数字 <em class="replaceable"><code>X</code></em> を返します。<em class="replaceable"><code>D</code></em> が <code class="literal">0</code> の場合は、結果に小数点または小数部が含まれません。<em class="replaceable"><code>D</code></em> を負の数に指定すると、値 <em class="replaceable"><code>X</code></em> の小数点左側の <em class="replaceable"><code>D</code></em> 桁をゼロにすることができます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.223,1);</code></strong>
        -&gt; 1.2
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.999,1);</code></strong>
        -&gt; 1.9
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.999,0);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(-1.999,1);</code></strong>
        -&gt; -1.9
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(122,-2);</code></strong>
       -&gt; 100
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(10.28*100,0);</code></strong>
       -&gt; 1028
</pre><p>
            すべての数字は、ゼロ方向に丸められます。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="date-and-time-functions"></a>12.7 日付および時間関数</h2></div></div></div><a class="indexterm" name="idm139979097015296"></a><a class="indexterm" name="idm139979097013824"></a><p>
      このセクションでは、時間値の処理に使用できる関数について説明します。各日付日時型が持つ値の範囲、および値を指定する際の有効な書式については、<a class="xref" href="data-types.html#date-and-time-types" title="11.3 日付と時間型">セクション11.3「日付と時間型」</a>を参照してください。
    </p><div class="table"><a name="idm139979097010352"></a><p class="title"><b>表 12.13 日付/時間関数</b></p><div class="table-contents"><table summary="日付/時間関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE()</code></a></td><td>
      日付値に時間値 (間隔) を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_addtime"><code class="literal">ADDTIME()</code></a></td><td>
      時間を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a></td><td>
      あるタイムゾーンから別のタイムゾーンに変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a></td><td>
      現在の日付を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code>, <code class="literal">CURRENT_DATE</code></a></td><td>
      CURDATE() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME()</code>, <code class="literal">CURRENT_TIME</code></a></td><td>
      CURTIME() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP()</code>, <code class="literal">CURRENT_TIMESTAMP</code></a></td><td>
      NOW() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME()</code></a></td><td>
      現在の時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a></td><td>
      日付値に時間値 (間隔) を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a></td><td>
      日付を指定された書式に設定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a></td><td>
      日付から時間値 (間隔) を引きます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_date"><code class="literal">DATE()</code></a></td><td>
      日付または日付時間式の日付部分を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_datediff"><code class="literal">DATEDIFF()</code></a></td><td>
      2 つの日付の差を求めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_day"><code class="literal">DAY()</code></a></td><td>
      DAYOFMONTH() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dayname"><code class="literal">DAYNAME()</code></a></td><td>
      曜日の名前を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofmonth"><code class="literal">DAYOFMONTH()</code></a></td><td>
      月の日を返します (0 - 31)
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofweek"><code class="literal">DAYOFWEEK()</code></a></td><td>
      引数の曜日インデックスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofyear"><code class="literal">DAYOFYEAR()</code></a></td><td>
      年の日を返します (1 - 366)
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT()</code></a></td><td>
      日付の一部を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_from-days"><code class="literal">FROM_DAYS()</code></a></td><td>
      日数を日付に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a></td><td>
      UNIX タイムスタンプを日付として書式設定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT()</code></a></td><td>
      日付書式文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_hour"><code class="literal">HOUR()</code></a></td><td>
      時を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_last-day"><code class="literal">LAST_DAY</code></a></td><td>
      引数の月の最終日を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME()</code>, <code class="literal">LOCALTIME</code></a></td><td>
      NOW() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP</code>, <code class="literal">LOCALTIMESTAMP()</code></a></td><td>
      NOW() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_makedate"><code class="literal">MAKEDATE()</code></a></td><td>
      年と年間通算日から日付を作成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_maketime"><code class="literal">MAKETIME()</code></a></td><td>
      時、分、秒から時間を作成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_microsecond"><code class="literal">MICROSECOND()</code></a></td><td>
      引数からマイクロ秒を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_minute"><code class="literal">MINUTE()</code></a></td><td>
      引数から分を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_month"><code class="literal">MONTH()</code></a></td><td>
      渡された日付から月を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_monthname"><code class="literal">MONTHNAME()</code></a></td><td>
      月の名前を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a></td><td>
      現在の日付と時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_period-add"><code class="literal">PERIOD_ADD()</code></a></td><td>
      年月に期間を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_period-diff"><code class="literal">PERIOD_DIFF()</code></a></td><td>
      期間内の月数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_quarter"><code class="literal">QUARTER()</code></a></td><td>
      日付引数から四半期を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sec-to-time"><code class="literal">SEC_TO_TIME()</code></a></td><td>
      秒を「HH:MM:SS」形式に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_second"><code class="literal">SECOND()</code></a></td><td>
      秒 (0-59) を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a></td><td>
      文字列を日付に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE()</code></a></td><td>
      3 つの引数で呼び出されるときは DATE_SUB()
      のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_subtime"><code class="literal">SUBTIME()</code></a></td><td>
      時間の差を求めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a></td><td>
      この関数が実行される時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT()</code></a></td><td>
      時間として書式設定します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_time-to-sec"><code class="literal">TIME_TO_SEC()</code></a></td><td>
      秒に変換された引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_time"><code class="literal">TIME()</code></a></td><td>
      渡された式の時部分を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_timediff"><code class="literal">TIMEDIFF()</code></a></td><td>
      時間の差を求めます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP()</code></a></td><td>
      引数が 1
      つの場合、この関数は日付または日付時間式を返します。引数が
      2 つの場合、引数の合計を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_timestampadd"><code class="literal">TIMESTAMPADD()</code></a></td><td>
      日付時間式に間隔を加算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF()</code></a></td><td>
      日付時間式から間隔を減算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a></td><td>
      日に変換された日付引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS()</code></a></td><td>
      0
      年以降の秒数に変換された日付または日付時間引数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a></td><td>
      UNIX タイムスタンプを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE()</code></a></td><td>
      現在の UTC 日付を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME()</code></a></td><td>
      現在の UTC 時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP()</code></a></td><td>
      現在の UTC 日付と時間を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a></td><td>
      週番号を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_weekday"><code class="literal">WEEKDAY()</code></a></td><td>
      曜日インデックスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR()</code></a></td><td>
      日付の暦週を返します (0 - 53)
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_year"><code class="literal">YEAR()</code></a></td><td>
      年を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a></td><td>
      年と週を返します
    </td></tr></tbody></table></div></div><br class="table-break"><p>
      次に、日付関数の使用例を示します。次のクエリーは、過去 30 日以内の <em class="replaceable"><code>date_col</code></em> 値を含むすべての行を選択します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT <em class="replaceable"><code>something</code></em> FROM <em class="replaceable"><code>tbl_name</code></em></code></strong>
    -&gt; <strong class="userinput"><code>WHERE DATE_SUB(CURDATE(),INTERVAL 30 DAY) &lt;= <em class="replaceable"><code>date_col</code></em>;</code></strong>
</pre><p>
      このクエリーは、将来の日付を持つ行も選択します。
    </p><p>
      通常、日付値が要求される関数では、日付時間値が受け入れられ、時間の部分は無視されます。通常、時間値が要求される関数では、日付時間値が受け入れられ、日付の部分は無視されます。
    </p><p>
      現在の日付または時間をそれぞれ返す関数は、クエリー実行の開始時にクエリーごとに 1 回だけ評価されます。つまり、<code class="literal">NOW()</code> などの関数が単一クエリー内で複数回参照されても、常に同じ結果が生成されます。(設計上、単一クエリーにはストアドプログラム (ストアドルーチン、トリガー、またはイベント) の呼び出し、およびそのプログラムによって呼び出されるすべてのサブプログラムも含まれています。)この原則は、<code class="literal">CURDATE()</code>、<code class="literal">CURTIME()</code>、<code class="literal">UTC_DATE()</code>、<code class="literal">UTC_TIME()</code>、<code class="literal">UTC_TIMESTAMP()</code>、およびそれらのシノニムにも適用されます。
    </p><p>
      <code class="literal">CURRENT_TIMESTAMP()</code>、<code class="literal">CURRENT_TIME()</code>、<code class="literal">CURRENT_DATE()</code>、および <code class="literal">FROM_UNIXTIME()</code> 関数は、<code class="literal">time_zone</code> システム環境変数の値として使用できる接続の現在のタイムゾーンで値を返します。さらに、<code class="literal">UNIX_TIMESTAMP()</code> では、その引数が現在のタイムゾーンでの日付時間値であるとみなされます。<a class="xref" href="globalization.html#time-zone-support" title="10.6 MySQL Server でのタイムゾーンのサポート">セクション10.6「MySQL Server でのタイムゾーンのサポート」</a>を参照してください。
    </p><p>
      <span class="quote">「<span class="quote">zero</span>」</span> 日付または <code class="literal">'2001-11-00'</code> のような不完全な日付とともに使用できる日付関数もありますが、使用できない日付関数もあります。通常、日付の一部を抽出する関数は不完全な日付でも正しく機能するため、ゼロ以外の値が要求される場合に 0 を返すことができます。例:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DAYOFMONTH('2001-11-00'), MONTH('2005-00-00');</code></strong>
        -&gt; 0, 0
</pre><p>
      その他の関数では完全な日付が要求され、日付が不完全な場合は <code class="literal">NULL</code> が返されます。これらには、日付演算を実行する関数や日付の一部を名前にマップする関数が含まれます。例:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2006-05-00',INTERVAL 1 DAY);</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT DAYNAME('2006-05-00');</code></strong>
        -&gt; NULL
</pre><p>
      MySQL 5.6.4 の時点では、いくつかの関数は引数として <code class="literal">DATE()</code> 関数の値を渡す際により厳密になったため、ゼロの日付部分を持つ不完全な日付は拒否されます。<code class="literal">CONVERT_TZ()</code>、<code class="literal">DATE_ADD()</code>、<code class="literal">DATE_SUB()</code>、<code class="literal">DAYOFYEAR()</code>、<code class="literal">LAST_DAY()</code>、<code class="literal">TIMESTAMPDIFF()</code>、<code class="literal">TO_DAYS()</code>、<code class="literal">TO_SECONDS()</code>、<code class="literal">WEEK()</code>、<code class="literal">WEEKDAY()</code>、<code class="literal">WEEKOFYEAR()</code>、<code class="literal">YEARWEEK()</code> 関数が影響を受けます。5.6.5 の <code class="literal">LAST_DAY()</code> では、この制限は緩やかで、ゼロの日付部分は許可されていました。
    </p><p>
      MySQL 5.6.4 以上では、マイクロ秒までの精度を持つ小数秒が <code class="literal">TIME</code>、<code class="literal">DATETIME</code>、および <code class="literal">TIMESTAMP</code> 値でサポートされています。時間引数を取る関数は、小数秒を含む値を受け入れます。時間関数からの戻り値には、必要に応じて小数秒が含まれます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_adddate"></a><p>
          <a class="indexterm" name="idm139979096836768"></a> <code class="literal">ADDDATE(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>、<code class="literal">ADDDATE(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>days</code></em>)</code>
        </p><p>
          <code class="literal">INTERVAL</code> 形式の 2 番目の引数を付けて呼び出されると、<code class="literal">ADDDATE()</code> は <code class="literal">DATE_ADD()</code> のシノニムになります。関連する関数 <code class="literal">SUBDATE()</code> は <code class="literal">DATE_SUB()</code> のシノニムです。<code class="literal">INTERVAL</code> <em class="replaceable"><code>unit</code></em> 引数については、<code class="literal">DATE_ADD()</code> の説明を参照してください。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2008-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '2008-02-02'
mysql&gt; <strong class="userinput"><code>SELECT ADDDATE('2008-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '2008-02-02'
</pre><p>
          <em class="replaceable"><code>days</code></em> 形式の 2 番目の引数を付けて呼び出されると、MySQL では <em class="replaceable"><code>expr</code></em> に加算される整数の日数として処理されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ADDDATE('2008-01-02', 31);</code></strong>
        -&gt; '2008-02-02'
</pre></li><li class="listitem"><a name="function_addtime"></a><p>
          <a class="indexterm" name="idm139979096813808"></a> <code class="literal">ADDTIME(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><p>
          <code class="literal">ADDTIME()</code> は <em class="replaceable"><code>expr2</code></em> と <em class="replaceable"><code>expr1</code></em> を加算し、その結果を返します。<em class="replaceable"><code>expr1</code></em> は時間または日付時間式であり、<em class="replaceable"><code>expr2</code></em> は時間式です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ADDTIME('2007-12-31 23:59:59.999999', '1 1:1:1.000002');</code></strong>
        -&gt; '2008-01-02 01:01:01.000001'
mysql&gt; <strong class="userinput"><code>SELECT ADDTIME('01:00:00.999999', '02:00:00.999998');</code></strong>
        -&gt; '03:00:01.999997'
</pre></li><li class="listitem"><a name="function_convert-tz"></a><p>
          <a class="indexterm" name="idm139979096800288"></a> <code class="literal">CONVERT_TZ(<em class="replaceable"><code>dt</code></em>,<em class="replaceable"><code>from_tz</code></em>,<em class="replaceable"><code>to_tz</code></em>)</code>
        </p><p>
          <code class="literal">CONVERT_TZ()</code> は、日付時間値 <em class="replaceable"><code>dt</code></em> を <em class="replaceable"><code>from_tz</code></em> で指定されたタイムゾーンから、<em class="replaceable"><code>to_tz</code></em> で指定されたタイムゾーンに変換し、結果の値を返します。タイムゾーンは、<a class="xref" href="globalization.html#time-zone-support" title="10.6 MySQL Server でのタイムゾーンのサポート">セクション10.6「MySQL Server でのタイムゾーンのサポート」</a>で説明されているように指定されます。引数が無効な場合、この関数は <code class="literal">NULL</code> を返します。
        </p><p>
          <em class="replaceable"><code>from_tz</code></em> から UTC に変換される際に、値が <code class="literal">TIMESTAMP</code> でサポートされている範囲から外れている場合は、変換が実行されません。<code class="literal">TIMESTAMP</code> の範囲については、<a class="xref" href="data-types.html#date-and-time-type-overview" title="11.1.2 日付と時間型の概要">セクション11.1.2「日付と時間型の概要」</a>で説明されています。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CONVERT_TZ('2004-01-01 12:00:00','GMT','MET');</code></strong>
        -&gt; '2004-01-01 13:00:00'
mysql&gt; <strong class="userinput"><code>SELECT CONVERT_TZ('2004-01-01 12:00:00','+00:00','+10:00');</code></strong>
        -&gt; '2004-01-01 22:00:00'
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            名前付きタイムゾーン (<code class="literal">'MET'</code> または <code class="literal">'Europe/Moscow'</code> など) を使用するには、タイムゾーンテーブルが正しく設定されている必要があります。手順については、<a class="xref" href="globalization.html#time-zone-support" title="10.6 MySQL Server でのタイムゾーンのサポート">セクション10.6「MySQL Server でのタイムゾーンのサポート」</a>を参照してください。
          </p></div></li><li class="listitem"><a name="function_curdate"></a><p>
          <a class="indexterm" name="idm139979096778048"></a> <code class="literal">CURDATE()</code>
        </p><p>
          関数が文字列と数値コンテキストのどちらで使用されているのかに応じて、現在の日付を <code class="literal">'YYYY-MM-DD'</code> または <code class="literal">YYYYMMDD</code> 書式の値として返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CURDATE();</code></strong>
        -&gt; '2008-06-13'
mysql&gt; <strong class="userinput"><code>SELECT CURDATE() + 0;</code></strong>
        -&gt; 20080613
</pre></li><li class="listitem"><a name="function_current-date"></a><p>
          <a class="indexterm" name="idm139979096766784"></a> <code class="literal">CURRENT_DATE</code>、<code class="literal">CURRENT_DATE()</code>
        </p><p>
          <code class="literal">CURRENT_DATE</code> および <code class="literal">CURRENT_DATE()</code> は <code class="literal">CURDATE()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_current-time"></a><p>
          <a class="indexterm" name="idm139979096756032"></a> <code class="literal">CURRENT_TIME</code>、<code class="literal">CURRENT_TIME([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          <code class="literal">CURRENT_TIME</code> および <code class="literal">CURRENT_TIME()</code> は <code class="literal">CURTIME()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_current-timestamp"></a><p>
          <a class="indexterm" name="idm139979096744752"></a> <code class="literal">CURRENT_TIMESTAMP</code>、<code class="literal">CURRENT_TIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          <code class="literal">CURRENT_TIMESTAMP</code> および <code class="literal">CURRENT_TIMESTAMP()</code> は <code class="literal">NOW()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_curtime"></a><p>
          <a class="indexterm" name="idm139979096733552"></a> <code class="literal">CURTIME([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          関数が文字列と数値コンテキストのどちらで使用されているのかに応じて、現在の時間を <code class="literal">'HH:MM:SS'</code> または <code class="literal">HHMMSS</code> 書式の値で返します。値は、現在のタイムゾーンで表現されています。
        </p><p>
          MySQL 5.6.4 の時点では、0 から 6 までの小数秒の精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合は、その桁数の小数秒部分が戻り値に含まれます。5.6.4 よりも前では、すべての引数が無視されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CURTIME();</code></strong>
        -&gt; '23:50:26'
mysql&gt; <strong class="userinput"><code>SELECT CURTIME() + 0;</code></strong>
        -&gt; 235026.000000
</pre></li><li class="listitem"><a name="function_date"></a><p>
          <a class="indexterm" name="idm139979096719632"></a> <code class="literal">DATE(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          日付または日付時間式 <em class="replaceable"><code>expr</code></em> の日付部分を抽出します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE('2003-12-31 01:02:03');</code></strong>
        -&gt; '2003-12-31'
</pre></li><li class="listitem"><a name="function_datediff"></a><p>
          <a class="indexterm" name="idm139979096709776"></a> <code class="literal">DATEDIFF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><p>
          <code class="literal">DATEDIFF()</code> は、ある日付から別の日付までの日数の値として表現された <em class="replaceable"><code>expr1</code></em> − <em class="replaceable"><code>expr2</code></em> を返します。<em class="replaceable"><code>expr1</code></em> および <em class="replaceable"><code>expr2</code></em> は、日付または日付時間式です。値の日付部分のみが計算に使用されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATEDIFF('2007-12-31 23:59:59','2007-12-30');</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT DATEDIFF('2010-11-30 23:59:59','2010-12-31');</code></strong>
        -&gt; -31
</pre></li><li class="listitem"><a name="function_date-add"></a><p>
          <a class="indexterm" name="idm139979096695472"></a> <a class="indexterm" name="idm139979096694128"></a> <code class="literal">DATE_ADD(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>, <code class="literal">DATE_SUB(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>
        </p><p>
          これらの関数は日付演算を実行します。<em class="replaceable"><code>date</code></em> 引数は、開始日付値または開始日付時間値を指定します。<em class="replaceable"><code>expr</code></em> は、開始日付から加算または減算される間隔値を指定する式です。<em class="replaceable"><code>expr</code></em> は文字列であり、負の間隔の場合は <span class="quote">「<span class="quote"><code class="literal">-</code></span>」</span> で始めることができます。<em class="replaceable"><code>unit</code></em> は、式を解釈する際の単位を示すキーワードです。
        </p><p>
          <code class="literal">INTERVAL</code> キーワードおよび <em class="replaceable"><code>unit</code></em> 指定子では、大文字と小文字が区別されません。
        </p><p>
          次の表には、<em class="replaceable"><code>unit</code></em> 値ごとに要求される形式の <em class="replaceable"><code>expr</code></em> 引数を表示します。
        </p><div class="informaltable"><table summary="この表には、unit 値およびそれぞれで要求される expr 引数を一覧表示します。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col"><em class="replaceable"><code>unit</code></em> 値</th><th scope="col">要求される <em class="replaceable"><code>expr</code></em> 書式</th></tr></thead><tbody><tr><td scope="row"><code class="literal">MICROSECOND</code></td><td><code class="literal">MICROSECONDS</code></td></tr><tr><td scope="row"><code class="literal">SECOND</code></td><td><code class="literal">SECONDS</code></td></tr><tr><td scope="row"><code class="literal">MINUTE</code></td><td><code class="literal">MINUTES</code></td></tr><tr><td scope="row"><code class="literal">HOUR</code></td><td><code class="literal">HOURS</code></td></tr><tr><td scope="row"><code class="literal">DAY</code></td><td><code class="literal">DAYS</code></td></tr><tr><td scope="row"><code class="literal">WEEK</code></td><td><code class="literal">WEEKS</code></td></tr><tr><td scope="row"><code class="literal">MONTH</code></td><td><code class="literal">MONTHS</code></td></tr><tr><td scope="row"><code class="literal">QUARTER</code></td><td><code class="literal">QUARTERS</code></td></tr><tr><td scope="row"><code class="literal">YEAR</code></td><td><code class="literal">YEARS</code></td></tr><tr><td scope="row"><code class="literal">SECOND_MICROSECOND</code></td><td><code class="literal">'SECONDS.MICROSECONDS'</code></td></tr><tr><td scope="row"><code class="literal">MINUTE_MICROSECOND</code></td><td><code class="literal">'MINUTES:SECONDS.MICROSECONDS'</code></td></tr><tr><td scope="row"><code class="literal">MINUTE_SECOND</code></td><td><code class="literal">'MINUTES:SECONDS'</code></td></tr><tr><td scope="row"><code class="literal">HOUR_MICROSECOND</code></td><td><code class="literal">'HOURS:MINUTES:SECONDS.MICROSECONDS'</code></td></tr><tr><td scope="row"><code class="literal">HOUR_SECOND</code></td><td><code class="literal">'HOURS:MINUTES:SECONDS'</code></td></tr><tr><td scope="row"><code class="literal">HOUR_MINUTE</code></td><td><code class="literal">'HOURS:MINUTES'</code></td></tr><tr><td scope="row"><code class="literal">DAY_MICROSECOND</code></td><td><code class="literal">'DAYS HOURS:MINUTES:SECONDS.MICROSECONDS'</code></td></tr><tr><td scope="row"><code class="literal">DAY_SECOND</code></td><td><code class="literal">'DAYS HOURS:MINUTES:SECONDS'</code></td></tr><tr><td scope="row"><code class="literal">DAY_MINUTE</code></td><td><code class="literal">'DAYS HOURS:MINUTES'</code></td></tr><tr><td scope="row"><code class="literal">DAY_HOUR</code></td><td><code class="literal">'DAYS HOURS'</code></td></tr><tr><td scope="row"><code class="literal">YEAR_MONTH</code></td><td><code class="literal">'YEARS-MONTHS'</code></td></tr></tbody></table></div><p>
          戻り値は引数によって異なります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              第 1 引数が <code class="literal">DATETIME</code> (または <code class="literal">TIMESTAMP</code>) 値である場合と、第 1 引数が <code class="literal">DATE</code> で、<em class="replaceable"><code>unit</code></em> 値に <code class="literal">HOURS</code>、<code class="literal">MINUTES</code>、または <code class="literal">SECONDS</code> が使用されている場合は、<code class="literal">DATETIME</code> です。
            </p></li><li class="listitem"><p>
              それ以外の場合は文字列です。
            </p></li></ul></div><p>
          必ず結果が <code class="literal">DATETIME</code> になるようにするには、<code class="literal">CAST()</code> を使用すれば、第 1 引数を <code class="literal">DATETIME</code> に変換できます。
        </p><p>
          MySQL では、<em class="replaceable"><code>expr</code></em> 書式の句読点区切り文字が許可されます。表には、提案される区切り文字を表示します。<em class="replaceable"><code>date</code></em> 引数が <code class="literal">DATE</code> 値であり、計算に <code class="literal">YEAR</code>、<code class="literal">MONTH</code>、および <code class="literal">DAY</code> 部分のみが含まれる (つまり、時間部分は含まれない) 場合は、結果が <code class="literal">DATE</code> 値になります。その他の場合は、結果が <code class="literal">DATETIME</code> 値になります。
        </p><p>
          また、日付演算は、<code class="literal">+</code> または <code class="literal">-</code> 演算子とともに <code class="literal">INTERVAL</code> を使用して実行することもできます。
        </p><pre class="programlisting">
<code class="literal">date</code> + INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>
<code class="literal">date</code> - INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>
</pre><p>
          <code class="literal">INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em></code> は、他方の側の式が日付または日付間値である場合に、<code class="literal">+</code> 演算子の一方の側で許可されます。<code class="literal">-</code> 演算子では、間隔から日付または日付間値を抽出しても意味がないため、<code class="literal">INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em></code> は右側でのみ許可されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT '2008-12-31 23:59:59' + INTERVAL 1 SECOND;</code></strong>
        -&gt; '2009-01-01 00:00:00'
mysql&gt; <strong class="userinput"><code>SELECT INTERVAL 1 DAY + '2008-12-31';</code></strong>
        -&gt; '2009-01-01'
mysql&gt; <strong class="userinput"><code>SELECT '2005-01-01' - INTERVAL 1 SECOND;</code></strong>
        -&gt; '2004-12-31 23:59:59'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2000-12-31 23:59:59',</code></strong>
    -&gt; <strong class="userinput"><code>                INTERVAL 1 SECOND);</code></strong>
        -&gt; '2001-01-01 00:00:00'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2010-12-31 23:59:59',</code></strong>
    -&gt; <strong class="userinput"><code>                INTERVAL 1 DAY);</code></strong>
        -&gt; '2011-01-01 23:59:59'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2100-12-31 23:59:59',</code></strong>
    -&gt; <strong class="userinput"><code>                INTERVAL '1:1' MINUTE_SECOND);</code></strong>
        -&gt; '2101-01-01 00:01:00'
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('2005-01-01 00:00:00',</code></strong>
    -&gt; <strong class="userinput"><code>                INTERVAL '1 1:1:1' DAY_SECOND);</code></strong>
        -&gt; '2004-12-30 22:58:59'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('1900-01-01 00:00:00',</code></strong>
    -&gt; <strong class="userinput"><code>                INTERVAL '-1 10' DAY_HOUR);</code></strong>
        -&gt; '1899-12-30 14:00:00'
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('1998-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '1997-12-02'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('1992-12-31 23:59:59.000002',</code></strong>
    -&gt;            <strong class="userinput"><code>INTERVAL '1.999999' SECOND_MICROSECOND);</code></strong>
        -&gt; '1993-01-01 00:00:01.000001'
</pre><p>
          指定した間隔値 (<em class="replaceable"><code>unit</code></em> キーワードから要求されるすべての間隔部分は含まれません) が短すぎる場合は、MySQL では間隔値の左端部分が省略されているとみなされます。たとえば、<code class="literal">DAY_SECOND</code> の <em class="replaceable"><code>unit</code></em> を指定した場合は、<em class="replaceable"><code>expr</code></em> の値には日、時間、分、秒の部分が含まれるとみなされます。<code class="literal">'1:10'</code> のような値を指定すると、MySQL では日と時間の部分が欠落していて、値は分と秒を表しているとみなされます。つまり、<code class="literal">'1:10' DAY_SECOND</code> は、<code class="literal">'1:10' MINUTE_SECOND</code> と同等の方法で解釈されます。これは、MySQL で <code class="literal">TIME</code> 値が時間ではなく経過時間を表していると解釈される方法に類似しています。
        </p><p>
          <em class="replaceable"><code>expr</code></em> は文字列として処理されるため、<code class="literal">INTERVAL</code> に文字列以外の値を指定する場合は注意してください。たとえば、間隔指定子が <code class="literal">HOUR_MINUTE</code> の場合は、<code class="literal">6/4</code> が <code class="literal">1.5000</code> に評価され、1 時間 5000 分として処理されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 6/4;</code></strong>
        -&gt; 1.5000
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2009-01-01', INTERVAL 6/4 HOUR_MINUTE);</code></strong>
        -&gt; '2009-01-04 12:20:00'
</pre><p>
          間隔値が予想どおりに解釈されるようにするには、<code class="literal">CAST()</code> 演算を使用します。<code class="literal">6/4</code> を 1 時間 5 分として処理するには、小数点以下の桁数が 1 桁の <code class="literal">DECIMAL</code> 値にキャストします。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CAST(6/4 AS DECIMAL(3,1));</code></strong>
        -&gt; 1.5
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('1970-01-01 12:00:00',</code></strong>
    -&gt; <strong class="userinput"><code>                INTERVAL CAST(6/4 AS DECIMAL(3,1)) HOUR_MINUTE);</code></strong>
        -&gt; '1970-01-01 13:05:00'
</pre><p>
          時間部分が含まれるものを日付値に加算したり、日付値から減算したりすると、自動的に結果が日付時間値に変換されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2013-01-01', INTERVAL 1 DAY);</code></strong>
        -&gt; '2013-01-02'
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2013-01-01', INTERVAL 1 HOUR);</code></strong>
        -&gt; '2013-01-01 01:00:00'
</pre><p>
          <code class="literal">MONTH</code>、<code class="literal">YEAR_MONTH</code>、または <code class="literal">YEAR</code> を加算した結果の日付に、新しい月の最大日数よりも大きな日が含まれる場合は、その日が新しい月の最大日数に調整されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2009-01-30', INTERVAL 1 MONTH);</code></strong>
        -&gt; '2009-02-28'
</pre><p>
          日付算術演算では、完全な日付が必須であるため、<code class="literal">'2006-07-00'</code> のような不完全な日付や、誤った形式の日付では正常に機能しません。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2006-07-00', INTERVAL 1 DAY);</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT '2005-03-32' + INTERVAL 1 MONTH;</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_date-format"></a><p>
          <a class="indexterm" name="idm139979096551600"></a> <code class="literal">DATE_FORMAT(<em class="replaceable"><code>date</code></em>,<em class="replaceable"><code>format</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>format</code></em> 文字列に従って、<em class="replaceable"><code>date</code></em> 値を書式設定します。
        </p><p>
          次の指定子が <em class="replaceable"><code>format</code></em> 文字列で使用されている場合があります。書式指定子文字の前には、<span class="quote">「<span class="quote"><code class="literal">%</code></span>」</span> 文字を付ける必要があります。
        </p><div class="informaltable"><table summary="この表には、format 文字列で使用される可能性のある DATE_FORMAT 関数の指定子文字を一覧表示し、各指定子文字の説明を示します。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">指定子</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><code class="literal">%a</code></td><td>簡略曜日名 (<code class="literal">Sun</code>..<code class="literal">Sat</code>)</td></tr><tr><td scope="row"><code class="literal">%b</code></td><td>簡略月名 (<code class="literal">Jan</code>..<code class="literal">Dec</code>)</td></tr><tr><td scope="row"><code class="literal">%c</code></td><td>月、数字 (<code class="literal">0</code>..<code class="literal">12</code>)</td></tr><tr><td scope="row"><code class="literal">%D</code></td><td>英語のサフィクスを持つ日付 (<code class="literal">0th</code>, <code class="literal">1st</code>, <code class="literal">2nd</code>, <code class="literal">3rd</code>, …)</td></tr><tr><td scope="row"><code class="literal">%d</code></td><td>日、数字 (<code class="literal">00</code>..<code class="literal">31</code>)</td></tr><tr><td scope="row"><code class="literal">%e</code></td><td>日、数字 (<code class="literal">0</code>..<code class="literal">31</code>)</td></tr><tr><td scope="row"><code class="literal">%f</code></td><td>マイクロ秒 (<code class="literal">000000</code>..<code class="literal">999999</code>)</td></tr><tr><td scope="row"><code class="literal">%H</code></td><td>時間 (<code class="literal">00</code>..<code class="literal">23</code>)</td></tr><tr><td scope="row"><code class="literal">%h</code></td><td>時間 (<code class="literal">01</code>..<code class="literal">12</code>)</td></tr><tr><td scope="row"><code class="literal">%I</code></td><td>時間 (<code class="literal">01</code>..<code class="literal">12</code>)</td></tr><tr><td scope="row"><code class="literal">%i</code></td><td>分、数字 (<code class="literal">00</code>..<code class="literal">59</code>)</td></tr><tr><td scope="row"><code class="literal">%j</code></td><td>年間通算日 (<code class="literal">001</code>..<code class="literal">366</code>)</td></tr><tr><td scope="row"><code class="literal">%k</code></td><td>時 (<code class="literal">0</code>..<code class="literal">23</code>)</td></tr><tr><td scope="row"><code class="literal">%l</code></td><td>時 (<code class="literal">1</code>..<code class="literal">12</code>)</td></tr><tr><td scope="row"><code class="literal">%M</code></td><td>月名 (<code class="literal">January</code>..<code class="literal">December</code>)</td></tr><tr><td scope="row"><code class="literal">%m</code></td><td>月、数字 (<code class="literal">00</code>..<code class="literal">12</code>)</td></tr><tr><td scope="row"><code class="literal">%p</code></td><td><code class="literal">AM</code> または <code class="literal">PM</code></td></tr><tr><td scope="row"><code class="literal">%r</code></td><td>時間、12 時間単位 (<code class="literal">hh:mm:ss</code> に <code class="literal">AM</code> または <code class="literal">PM</code> が続く)</td></tr><tr><td scope="row"><code class="literal">%S</code></td><td>秒 (<code class="literal">00</code>..<code class="literal">59</code>)</td></tr><tr><td scope="row"><code class="literal">%s</code></td><td>秒 (<code class="literal">00</code>..<code class="literal">59</code>)</td></tr><tr><td scope="row"><code class="literal">%T</code></td><td>時間、24 時間単位 (<code class="literal">hh:mm:ss</code>)</td></tr><tr><td scope="row"><code class="literal">%U</code></td><td>週 (<code class="literal">00</code>..<code class="literal">53</code>)、日曜日が週の初日、<code class="literal">WEEK()</code> モード 0</td></tr><tr><td scope="row"><code class="literal">%u</code></td><td>週 (<code class="literal">00</code>..<code class="literal">53</code>)、月曜日が週の初日、<code class="literal">WEEK()</code> モード 1</td></tr><tr><td scope="row"><code class="literal">%V</code></td><td>週 (<code class="literal">01</code>..<code class="literal">53</code>)、日曜日が週の初日、<code class="literal">WEEK()</code> モード 2、<code class="literal">%X</code> とともに使用</td></tr><tr><td scope="row"><code class="literal">%v</code></td><td>週 (<code class="literal">01</code>..<code class="literal">53</code>)、月曜日が週の初日、<code class="literal">WEEK()</code> モード 3、<code class="literal">%x</code> とともに使用</td></tr><tr><td scope="row"><code class="literal">%W</code></td><td>曜日名 (<code class="literal">Sunday</code>..<code class="literal">Saturday</code>)</td></tr><tr><td scope="row"><code class="literal">%w</code></td><td>曜日 (<code class="literal">0</code>=Sunday..<code class="literal">6</code>=Saturday)</td></tr><tr><td scope="row"><code class="literal">%X</code></td><td>年間の週、日曜日が週の初日、数字、4 桁、<code class="literal">%V</code> とともに使用</td></tr><tr><td scope="row"><code class="literal">%x</code></td><td>年間の週、月曜日が週の初日、数字、4 桁、<code class="literal">%v</code> とともに使用</td></tr><tr><td scope="row"><code class="literal">%Y</code></td><td>年、数字、4 桁</td></tr><tr><td scope="row"><code class="literal">%y</code></td><td>年、数字 (2 桁)</td></tr><tr><td scope="row"><code class="literal">%%</code></td><td>リテラル <span class="quote">「<span class="quote"><code class="literal">%</code></span>」</span> 文字</td></tr><tr><td scope="row"><code class="literal">%<em class="replaceable"><code>x</code></em></code></td><td><em class="replaceable"><code>x</code></em> (上記にないすべての <span class="quote">「<span class="quote"><em class="replaceable"><code>x</code></em></span>」</span>)</td></tr></tbody></table></div><p>
          MySQL では <code class="literal">'2014-00-00'</code> などの不完全な日付の格納が許可されるため、月および日の指定子の範囲はゼロから始まります。
        </p><p>
          日および月の名前と略語に使用される言語は、<code class="literal">lc_time_names</code> システム変数 (<a class="xref" href="globalization.html#locale-support" title="10.7 MySQL Server のロケールサポート">セクション10.7「MySQL Server のロケールサポート」</a>) の値で制御されます。
        </p><p>
          <code class="literal">%U</code>、<code class="literal">%u</code>、<code class="literal">%V</code>、および <code class="literal">%v</code> 指定子のモード値については、<code class="literal">WEEK()</code> 関数の説明を参照してください。モードによって、週番号が付与される方法が影響を受けます。
        </p><p>
          <code class="literal">DATE_FORMAT()</code> は、ASCII 以外の文字を含む月および週の名前を返すことができるように、<code class="literal">character_set_connection</code> および <code class="literal">collation_connection</code> で指定された文字セットおよび照合順序を含む文字列を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2009-10-04 22:23:00', '%W %M %Y');</code></strong>
        -&gt; 'Sunday October 2009'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2007-10-04 22:23:00', '%H:%i:%s');</code></strong>
        -&gt; '22:23:00'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1900-10-04 22:23:00',</code></strong>
    -&gt; <strong class="userinput"><code>                '%D %y %a %d %m %b %j');</code></strong>
        -&gt; '4th 00 Thu 04 10 Oct 277'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1997-10-04 22:23:00',</code></strong>
    -&gt; <strong class="userinput"><code>                '%H %k %I %r %T %S %w');</code></strong>
        -&gt; '22 22 10 10:23:00 PM 22:23:00 00 6'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1999-01-01', '%X %V');</code></strong>
        -&gt; '1998 52'
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2006-06-00', '%d');</code></strong>
        -&gt; '00'
</pre></li><li class="listitem"><a name="function_date-sub"></a><p>
          <a class="indexterm" name="idm139979096414816"></a> <code class="literal">DATE_SUB(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>
        </p><p>
          <code class="literal">DATE_ADD()</code> の説明を参照してください。
        </p></li><li class="listitem"><a name="function_day"></a><p>
          <a class="indexterm" name="idm139979096405696"></a> <code class="literal">DAY(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <code class="literal">DAY()</code> は <code class="literal">DAYOFMONTH()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_dayname"></a><p>
          <a class="indexterm" name="idm139979096396480"></a> <code class="literal">DAYNAME(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>date</code></em> に対応する曜日の名前を返します。名前に使用される言語は、<code class="literal">lc_time_names</code> システム変数 (<a class="xref" href="globalization.html#locale-support" title="10.7 MySQL Server のロケールサポート">セクション10.7「MySQL Server のロケールサポート」</a>) の値で制御されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DAYNAME('2007-02-03');</code></strong>
        -&gt; 'Saturday'
</pre></li><li class="listitem"><a name="function_dayofmonth"></a><p>
          <a class="indexterm" name="idm139979096385008"></a> <code class="literal">DAYOFMONTH(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <code class="literal">1</code> から <code class="literal">31</code> までの範囲内で <em class="replaceable"><code>date</code></em> に対応する日を返します。<code class="literal">'0000-00-00'</code> や <code class="literal">'2008-00-00'</code> のように日の部分がゼロの場合は、<code class="literal">0</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DAYOFMONTH('2007-02-03');</code></strong>
        -&gt; 3
</pre></li><li class="listitem"><a name="function_dayofweek"></a><p>
          <a class="indexterm" name="idm139979096371664"></a> <code class="literal">DAYOFWEEK(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>date</code></em> の曜日インデックス (<code class="literal">1</code> = Sunday、<code class="literal">2</code> = Monday、…、<code class="literal">7</code> = Saturday) を返します。これらのインデックス値は、ODBC 標準に対応しています。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DAYOFWEEK('2007-02-03');</code></strong>
        -&gt; 7
</pre></li><li class="listitem"><a name="function_dayofyear"></a><p>
          <a class="indexterm" name="idm139979096359744"></a> <code class="literal">DAYOFYEAR(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <code class="literal">1</code> から <code class="literal">366</code> までの範囲内で <em class="replaceable"><code>date</code></em> に対応する通日を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DAYOFYEAR('2007-02-03');</code></strong>
        -&gt; 34
</pre></li><li class="listitem"><a name="function_extract"></a><p>
          <a class="indexterm" name="idm139979096348640"></a> <code class="literal">EXTRACT(<em class="replaceable"><code>unit</code></em> FROM <em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <code class="literal">EXTRACT()</code> 関数では、<code class="literal">DATE_ADD()</code> または <code class="literal">DATE_SUB()</code> と同じ単位指定子が使用されますが、データ演算が実行されるのではなく、データから一部が抽出されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(YEAR FROM '2009-07-02');</code></strong>
       -&gt; 2009
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(YEAR_MONTH FROM '2009-07-02 01:02:03');</code></strong>
       -&gt; 200907
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(DAY_MINUTE FROM '2009-07-02 01:02:03');</code></strong>
       -&gt; 20102
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(MICROSECOND</code></strong>
    -&gt;                <strong class="userinput"><code>FROM '2003-01-02 10:30:00.000123');</code></strong>
        -&gt; 123
</pre></li><li class="listitem"><a name="function_from-days"></a><p>
          <a class="indexterm" name="idm139979096332640"></a> <code class="literal">FROM_DAYS(<em class="replaceable"><code>N</code></em>)</code>
        </p><p>
          日数 <em class="replaceable"><code>N</code></em> が指定され、<code class="literal">DATE</code> 値を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FROM_DAYS(730669);</code></strong>
        -&gt; '2007-07-03'
</pre><p>
          古い日付では、<code class="literal">FROM_DAYS()</code> を慎重に使用してください。グレゴリオ暦 (1582) の出現よりも前の値とともに使用することを目的に設計されていません。<a class="xref" href="functions.html#mysql-calendar" title="12.8 MySQL で使用されるカレンダー">セクション12.8「MySQL で使用されるカレンダー」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_from-unixtime"></a><p>
          <a class="indexterm" name="idm139979096319344"></a> <code class="literal">FROM_UNIXTIME(<em class="replaceable"><code>unix_timestamp</code></em>)</code>, <code class="literal">FROM_UNIXTIME(<em class="replaceable"><code>unix_timestamp</code></em>,<em class="replaceable"><code>format</code></em>)</code>
        </p><p>
          関数が文字列と数値のどちらのコンテキストで使用されたのかに応じて、<em class="replaceable"><code>unix_timestamp</code></em> 引数の表現を <code class="literal">'YYYY-MM-DD HH:MM:SS'</code> または <code class="literal">YYYYMMDDHHMMSS</code> 書式の値として返します。値は、現在のタイムゾーンで表現されています。<em class="replaceable"><code>unix_timestamp</code></em> は、<code class="literal">UNIX_TIMESTAMP()</code> 関数で生成されるような内部タイムスタンプ値です。
        </p><p>
          <em class="replaceable"><code>format</code></em> が指定されている場合は、<code class="literal">DATE_FORMAT()</code> 関数のエントリで一覧表示される場合と同じ方法で使用される <em class="replaceable"><code>format</code></em> 文字列に従って、結果が書式設定されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1196440219);</code></strong>
        -&gt; '2007-11-30 10:30:19'
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1196440219) + 0;</code></strong>
        -&gt; 20071130103019.000000
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(UNIX_TIMESTAMP(),</code></strong>
    -&gt;                      <strong class="userinput"><code>'%Y %D %M %h:%i:%s %x');</code></strong>
        -&gt; '2007 30th November 10:30:59 2007'
</pre><p>
          注: <code class="literal">UNIX_TIMESTAMP()</code> および <code class="literal">FROM_UNIXTIME()</code> を使用して <code class="literal">TIMESTAMP</code> 値と Unix タイムスタンプ値とを変換する場合は、どちらの方向でもマッピングが 1 対 1 ではないため、変換は不可逆です。詳細は <code class="literal">UNIX_TIMESTAMP()</code> 関数の説明を参照してください。
        </p></li><li class="listitem"><a name="function_get-format"></a><p>
          <a class="indexterm" name="idm139979096294512"></a> <code class="literal">GET_FORMAT({DATE|TIME|DATETIME}, {'EUR'|'USA'|'JIS'|'ISO'|'INTERNAL'})</code>
        </p><p>
          書式文字列を返します。この関数は、<code class="literal">DATE_FORMAT()</code> および<code class="literal">STR_TO_DATE()</code> 関数と組み合わせて使用すると便利です。
        </p><p>
          1 番目と 2 番目の引数に値を指定できるため、複数の書式文字列を生成できます (使用される指定子については、<code class="literal">DATE_FORMAT()</code> 関数の説明で示す表を参照してください)。ISO 書式は ISO 8601 ではなく、ISO 9075 を参照しています。
        </p><div class="informaltable"><table summary="この表には、GET_FORMAT 関数の関数呼び出しを、各関数呼び出しの結果とともに一覧表示します。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">関数呼び出し</th><th scope="col">結果</th></tr></thead><tbody><tr><td scope="row"><code class="literal">GET_FORMAT(DATE,'USA')</code></td><td><code class="literal">'%m.%d.%Y'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATE,'JIS')</code></td><td><code class="literal">'%Y-%m-%d'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATE,'ISO')</code></td><td><code class="literal">'%Y-%m-%d'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATE,'EUR')</code></td><td><code class="literal">'%d.%m.%Y'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATE,'INTERNAL')</code></td><td><code class="literal">'%Y%m%d'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATETIME,'USA')</code></td><td><code class="literal">'%Y-%m-%d %H.%i.%s'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATETIME,'JIS')</code></td><td><code class="literal">'%Y-%m-%d %H:%i:%s'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATETIME,'ISO')</code></td><td><code class="literal">'%Y-%m-%d %H:%i:%s'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATETIME,'EUR')</code></td><td><code class="literal">'%Y-%m-%d %H.%i.%s'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(DATETIME,'INTERNAL')</code></td><td><code class="literal">'%Y%m%d%H%i%s'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(TIME,'USA')</code></td><td><code class="literal">'%h:%i:%s %p'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(TIME,'JIS')</code></td><td><code class="literal">'%H:%i:%s'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(TIME,'ISO')</code></td><td><code class="literal">'%H:%i:%s'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(TIME,'EUR')</code></td><td><code class="literal">'%H.%i.%s'</code></td></tr><tr><td scope="row"><code class="literal">GET_FORMAT(TIME,'INTERNAL')</code></td><td><code class="literal">'%H%i%s'</code></td></tr></tbody></table></div><p>
          <code class="literal">TIMESTAMP</code> は、<code class="literal">GET_FORMAT()</code> への 1 番目の引数としても使用できます。その場合、関数は <code class="literal">DATETIME</code> の場合と同じ値を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2003-10-03',GET_FORMAT(DATE,'EUR'));</code></strong>
        -&gt; '03.10.2003'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('10.31.2003',GET_FORMAT(DATE,'USA'));</code></strong>
        -&gt; '2003-10-31'
</pre></li><li class="listitem"><a name="function_hour"></a><p>
          <a class="indexterm" name="idm139979096235232"></a> <code class="literal">HOUR(<em class="replaceable"><code>time</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>time</code></em> に対応する時を返します。戻り値の範囲は、日付時間値の <code class="literal">0</code> から <code class="literal">23</code> までです。ただし、<code class="literal">TIME</code> 値の範囲は実際にはもっと大きいため、<code class="literal">HOUR</code> は <code class="literal">23</code> よりも大きい値を返すことができます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HOUR('10:05:03');</code></strong>
        -&gt; 10
mysql&gt; <strong class="userinput"><code>SELECT HOUR('272:59:59');</code></strong>
        -&gt; 272
</pre></li><li class="listitem"><a name="function_last-day"></a><p>
          <a class="indexterm" name="idm139979096220704"></a> <code class="literal">LAST_DAY(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          日付または日付時間の値が指定され、月の最終日に対応する値を返します。引数が無効である場合は、<code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2003-02-05');</code></strong>
        -&gt; '2003-02-28'
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2004-02-05');</code></strong>
        -&gt; '2004-02-29'
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2004-01-01 01:01:01');</code></strong>
        -&gt; '2004-01-31'
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2003-03-32');</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_localtime"></a><p>
          <a class="indexterm" name="idm139979096208048"></a> <code class="literal">LOCALTIME</code>, <code class="literal">LOCALTIME([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          <code class="literal">LOCALTIME</code> および <code class="literal">LOCALTIME()</code> は <code class="literal">NOW()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_localtimestamp"></a><p>
          <a class="indexterm" name="idm139979096196944"></a> <code class="literal">LOCALTIMESTAMP</code>, <code class="literal">LOCALTIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          <code class="literal">LOCALTIMESTAMP</code> および <code class="literal">LOCALTIMESTAMP()</code> は <code class="literal">NOW()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_makedate"></a><p>
          <a class="indexterm" name="idm139979096185840"></a> <code class="literal">MAKEDATE(<em class="replaceable"><code>year</code></em>,<em class="replaceable"><code>dayofyear</code></em>)</code>
        </p><p>
          指定された年と年間通算値から、日付を返します。<em class="replaceable"><code>dayofyear</code></em> は 0 よりも大きくする必要があり、それ以外の場合は結果が <code class="literal">NULL</code> になります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,31), MAKEDATE(2011,32);</code></strong>
        -&gt; '2011-01-31', '2011-02-01'
mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,365), MAKEDATE(2014,365);</code></strong>
        -&gt; '2011-12-31', '2014-12-31'
mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,0);</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_maketime"></a><p>
          <a class="indexterm" name="idm139979096173024"></a> <code class="literal">MAKETIME(<em class="replaceable"><code>hour</code></em>,<em class="replaceable"><code>minute</code></em>,<em class="replaceable"><code>second</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>hour</code></em>、<em class="replaceable"><code>minute</code></em>、および <em class="replaceable"><code>second</code></em> 引数から計算された時間値を返します。
        </p><p>
          MySQL 5.6.4 の時点では、<em class="replaceable"><code>second</code></em> 引数に小数部を含めることができます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MAKETIME(12,15,30);</code></strong>
        -&gt; '12:15:30'
</pre></li><li class="listitem"><a name="function_microsecond"></a><p>
          <a class="indexterm" name="idm139979096160528"></a> <code class="literal">MICROSECOND(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          <code class="literal">0</code> から <code class="literal">999999</code> までの範囲内の数値として、時間または日付時間式 <em class="replaceable"><code>expr</code></em> からのマイクロ秒を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MICROSECOND('12:00:00.123456');</code></strong>
        -&gt; 123456
mysql&gt; <strong class="userinput"><code>SELECT MICROSECOND('2009-12-31 23:59:59.000010');</code></strong>
        -&gt; 10
</pre></li><li class="listitem"><a name="function_minute"></a><p>
          <a class="indexterm" name="idm139979096148528"></a> <code class="literal">MINUTE(<em class="replaceable"><code>time</code></em>)</code>
        </p><p>
          <code class="literal">0</code> から <code class="literal">59</code> までの範囲内で、<em class="replaceable"><code>time</code></em> に対応する分を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MINUTE('2008-02-03 10:05:03');</code></strong>
        -&gt; 5
</pre></li><li class="listitem"><a name="function_month"></a><p>
          <a class="indexterm" name="idm139979096137488"></a> <code class="literal">MONTH(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <code class="literal">1</code> (1 月) から <code class="literal">12</code> (12 月) の範囲内で、<em class="replaceable"><code>date</code></em> に対応する月を返します。<code class="literal">'0000-00-00'</code> や <code class="literal">'2008-00-00'</code> のように月の部分がゼロの場合は、<code class="literal">0</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MONTH('2008-02-03');</code></strong>
        -&gt; 2
</pre></li><li class="listitem"><a name="function_monthname"></a><p>
          <a class="indexterm" name="idm139979096124112"></a> <code class="literal">MONTHNAME(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>date</code></em> に対応する月の完全名を返します。名前に使用される言語は、<code class="literal">lc_time_names</code> システム変数 (<a class="xref" href="globalization.html#locale-support" title="10.7 MySQL Server のロケールサポート">セクション10.7「MySQL Server のロケールサポート」</a>) の値で制御されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MONTHNAME('2008-02-03');</code></strong>
        -&gt; 'February'
</pre></li><li class="listitem"><a name="function_now"></a><p>
          <a class="indexterm" name="idm139979096112672"></a> <code class="literal">NOW([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          関数が文字列と数値のどちらのコンテキストで使用されているのかに応じて、現在の日付と時間を <code class="literal">'YYYY-MM-DD HH:MM:SS'</code> または <code class="literal">YYYYMMDDHHMMSS</code> 書式の値として返します。値は、現在のタイムゾーンで表現されています。
        </p><p>
          MySQL 5.6.4 の時点では、0 から 6 までの小数秒の精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合は、その桁数の小数秒部分が戻り値に含まれます。5.6.4 よりも前では、すべての引数が無視されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NOW();</code></strong>
        -&gt; '2007-12-15 23:50:26'
mysql&gt; <strong class="userinput"><code>SELECT NOW() + 0;</code></strong>
        -&gt; 20071215235026.000000
</pre><p>
          <code class="literal">NOW()</code> は、ステートメントが実行を開始する時刻を示す定数時間を返します。(ストアドファンクションまたはトリガーでは、<code class="literal">NOW()</code> は関数またはトリガーステートメントが実行を開始する時間を返します。)これは、正確な実行時間を返す <code class="literal">SYSDATE()</code> の動作とは異なります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NOW(), SLEEP(2), NOW();</code></strong>
+---------------------+----------+---------------------+
| NOW()               | SLEEP(2) | NOW()               |
+---------------------+----------+---------------------+
| 2006-04-12 13:47:36 |        0 | 2006-04-12 13:47:36 |
+---------------------+----------+---------------------+

mysql&gt; <strong class="userinput"><code>SELECT SYSDATE(), SLEEP(2), SYSDATE();</code></strong>
+---------------------+----------+---------------------+
| SYSDATE()           | SLEEP(2) | SYSDATE()           |
+---------------------+----------+---------------------+
| 2006-04-12 13:47:44 |        0 | 2006-04-12 13:47:46 |
+---------------------+----------+---------------------+
</pre><p>
          さらに、<code class="literal">SET TIMESTAMP</code> ステートメントによって、<code class="literal">NOW()</code> で返された値は影響を受けますが、<code class="literal">SYSDATE()</code> で返された値は影響を受けません。つまり、バイナリログのタイムスタンプ設定は、<code class="literal">SYSDATE()</code> の呼び出しに影響しないことを意味します。タイムスタンプをゼロ以外の値に設定すると、後続の <code class="literal">NOW()</code> が起動されるたびに、その値が返されます。タイムスタンプをゼロに設定すると、この効果が取り消され、再度 <code class="literal">NOW()</code> が現在の日付と時間を返すようになります。
        </p><p>
          2 つの関数の相違点についての詳細は、<code class="literal">SYSDATE()</code> の説明を参照してください。
        </p></li><li class="listitem"><a name="function_period-add"></a><p>
          <a class="indexterm" name="idm139979096083616"></a> <code class="literal">PERIOD_ADD(<em class="replaceable"><code>P</code></em>,<em class="replaceable"><code>N</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>N</code></em> 月を期間 <em class="replaceable"><code>P</code></em> に (<code class="literal">YYMM</code> または <code class="literal">YYYYMM</code> の書式で) 加算します。<code class="literal">YYYYMM</code> の書式で値を返します。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            期間引数 <em class="replaceable"><code>P</code></em> は、日付値では<span class="emphasis"><em>ありません</em></span>。
          </p></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT PERIOD_ADD(200801,2);</code></strong>
        -&gt; 200803
</pre></li><li class="listitem"><a name="function_period-diff"></a><p>
          <a class="indexterm" name="idm139979096069248"></a> <code class="literal">PERIOD_DIFF(<em class="replaceable"><code>P1</code></em>,<em class="replaceable"><code>P2</code></em>)</code>
        </p><p>
          期間 <em class="replaceable"><code>P1</code></em> と <em class="replaceable"><code>P2</code></em> 間の月数を返します。<em class="replaceable"><code>P1</code></em> および <em class="replaceable"><code>P2</code></em> は、<code class="literal">YYMM</code> または <code class="literal">YYYYMM</code> の書式にする必要があります。期間引数 <em class="replaceable"><code>P1</code></em> および <em class="replaceable"><code>P2</code></em> は日付値では<span class="emphasis"><em>ない</em></span>ことに注意してください。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT PERIOD_DIFF(200802,200703);</code></strong>
        -&gt; 11
</pre></li><li class="listitem"><a name="function_quarter"></a><p>
          <a class="indexterm" name="idm139979096055008"></a> <code class="literal">QUARTER(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <code class="literal">1</code> から <code class="literal">4</code> までの範囲内で <em class="replaceable"><code>date</code></em> に対応する四半期を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT QUARTER('2008-04-01');</code></strong>
        -&gt; 2
</pre></li><li class="listitem"><a name="function_second"></a><p>
          <a class="indexterm" name="idm139979096043888"></a> <code class="literal">SECOND(<em class="replaceable"><code>time</code></em>)</code>
        </p><p>
          <code class="literal">0</code> から <code class="literal">59</code> までの範囲内で、<em class="replaceable"><code>time</code></em> に対応する秒数を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SECOND('10:05:03');</code></strong>
        -&gt; 3
</pre></li><li class="listitem"><a name="function_sec-to-time"></a><p>
          <a class="indexterm" name="idm139979096032784"></a> <code class="literal">SEC_TO_TIME(<em class="replaceable"><code>seconds</code></em>)</code>
        </p><p>
          <code class="literal">TIME</code> 値として、時、分、秒に変換された <em class="replaceable"><code>seconds</code></em> 引数を返します。結果の範囲は、<code class="literal">TIME</code> データ型の範囲に制約されます。引数がその範囲外の値に対応している場合は、警告が発行されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SEC_TO_TIME(2378);</code></strong>
        -&gt; '00:39:38'
mysql&gt; <strong class="userinput"><code>SELECT SEC_TO_TIME(2378) + 0;</code></strong>
        -&gt; 3938
</pre></li><li class="listitem"><a name="function_str-to-date"></a><p>
          <a class="indexterm" name="idm139979096019936"></a> <code class="literal">STR_TO_DATE(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>format</code></em>)</code>
        </p><p>
          これは <code class="literal">DATE_FORMAT()</code> 関数の逆です。文字列 <em class="replaceable"><code>str</code></em> と書式文字列 <em class="replaceable"><code>format</code></em> が指定されます。<code class="literal">STR_TO_DATE()</code> は、書式文字列に日付と時間の両方の部分が含まれる場合は <code class="literal">DATETIME</code> 値を返し、文字列に日付と時間の部分の一方のみが含まれる場合は <code class="literal">DATE</code> または <code class="literal">TIME</code> 値を返します。<em class="replaceable"><code>str</code></em> から抽出された日付値、時間値、または日付時間値が不正な場合は、<code class="literal">STR_TO_DATE()</code> によって <code class="literal">NULL</code> が返され、警告が発行されます。
        </p><p>
          サーバーは <em class="replaceable"><code>str</code></em> をスキャンすることで、<em class="replaceable"><code>format</code></em> の一致を試みます。書式文字列には、リテラル文字と <code class="literal">%</code> で始まる書式指定子を含めることができます。<em class="replaceable"><code>format</code></em> 内のリテラル文字は、<em class="replaceable"><code>str</code></em> 内と完全に一致する必要があります。<em class="replaceable"><code>format</code></em> 内の書式指定子は、<em class="replaceable"><code>str</code></em> 内の日付または時間の部分に一致する必要があります。<em class="replaceable"><code>format</code></em> で使用できる指定子については、<code class="literal">DATE_FORMAT()</code> 関数の説明を参照してください。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('01,5,2013','%d,%m,%Y');</code></strong>
        -&gt; '2013-05-01'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('May 1, 2013','%M %d,%Y');</code></strong>
        -&gt; '2013-05-01'
</pre><p>
          <em class="replaceable"><code>str</code></em> の先頭からスキャンが開始され、一致しない <em class="replaceable"><code>format</code></em> が見つかった場合は失敗します。<em class="replaceable"><code>str</code></em> の末尾にある余分な文字は、無視されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('a09:30:17','a%h:%i:%s');</code></strong>
        -&gt; '09:30:17'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('a09:30:17','%h:%i:%s');</code></strong>
        -&gt; NULL
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('09:30:17a','%h:%i:%s');</code></strong>
        -&gt; '09:30:17'
</pre><p>
          指定されていない日付または時間の部分の値は 0 になるため、<em class="replaceable"><code>str</code></em> に指定された値が不完全な場合は、結果の一部または全部が 0 に設定されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('abc','abc');</code></strong>
        -&gt; '0000-00-00'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('9','%m');</code></strong>
        -&gt; '0000-09-00'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('9','%s');</code></strong>
        -&gt; '00:00:09'
</pre><p>
          日付値の部分をチェックする範囲は、<a class="xref" href="data-types.html#datetime" title="11.3.1 DATE、DATETIME、および TIMESTAMP 型">セクション11.3.1「DATE、DATETIME、および TIMESTAMP 型」</a>の説明どおりです。たとえば、<span class="quote">「<span class="quote">ゼロ</span>」</span>の日付または部分値が 0 の日付は、このような値が許可されないように SQL モードが設定されていなければ、許可されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('00/00/0000', '%m/%d/%Y');</code></strong>
        -&gt; '0000-00-00'
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('04/31/2004', '%m/%d/%Y');</code></strong>
        -&gt; '2004-04-31'
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            週が月の境界を越えた場合は、年と週の組み合わせでは年と月を一意に識別できないため、<code class="literal">"%X%V"</code> の書式を使用しても、年と週の文字列を日付に変換できません。年と週を日付に変換するには、曜日も指定する必要があります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('200442 Monday', '%X%V %W');</code></strong>
        -&gt; '2004-10-18'
</pre></div></li><li class="listitem"><a name="function_subdate"></a><p>
          <a class="indexterm" name="idm139979095978080"></a> <code class="literal">SUBDATE(<em class="replaceable"><code>date</code></em>,INTERVAL <em class="replaceable"><code>expr</code></em> <em class="replaceable"><code>unit</code></em>)</code>, <code class="literal">SUBDATE(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>days</code></em>)</code>
        </p><p>
          <code class="literal">INTERVAL</code> 形式で 2 番目の引数を付けて呼び出されると、<code class="literal">SUBDATE()</code> は <code class="literal">DATE_SUB()</code> のシノニムになります。<code class="literal">INTERVAL</code> <em class="replaceable"><code>unit</code></em> 引数については、<code class="literal">DATE_ADD()</code> の説明を参照してください。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('2008-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '2007-12-02'
mysql&gt; <strong class="userinput"><code>SELECT SUBDATE('2008-01-02', INTERVAL 31 DAY);</code></strong>
        -&gt; '2007-12-02'
</pre><p>
          2 番目の形式では、<em class="replaceable"><code>days</code></em> の整数値を使用できます。このような場合は、日付または日付時間式 <em class="replaceable"><code>expr</code></em> から日数が減算されると解釈されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SUBDATE('2008-01-02 12:00:00', 31);</code></strong>
        -&gt; '2007-12-02 12:00:00'
</pre></li><li class="listitem"><a name="function_subtime"></a><p>
          <a class="indexterm" name="idm139979095957664"></a> <code class="literal">SUBTIME(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><p>
          <code class="literal">SUBTIME()</code> は、<em class="replaceable"><code>expr1</code></em> と同じ書式で表現される <em class="replaceable"><code>expr1</code></em> と <em class="replaceable"><code>expr2</code></em> を返します。<em class="replaceable"><code>expr1</code></em> は時間または日付時間式であり、<em class="replaceable"><code>expr2</code></em> は時間式です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SUBTIME('2007-12-31 23:59:59.999999','1 1:1:1.000002');</code></strong>
        -&gt; '2007-12-30 22:58:58.999997'
mysql&gt; <strong class="userinput"><code>SELECT SUBTIME('01:00:00.999999', '02:00:00.999998');</code></strong>
        -&gt; '-00:59:59.999999'
</pre></li><li class="listitem"><a name="function_sysdate"></a><p>
          <a class="indexterm" name="idm139979095943712"></a> <code class="literal">SYSDATE([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          関数が文字列と数値のどちらのコンテキストで使用されているのかに応じて、現在の日付と時間を <code class="literal">'YYYY-MM-DD HH:MM:SS'</code> または <code class="literal">YYYYMMDDHHMMSS</code> 書式の値として返します。
        </p><p>
          MySQL 5.6.4 の時点では、0 から 6 までの小数秒の精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合は、その桁数の小数秒部分が戻り値に含まれます。5.6.4 よりも前では、すべての引数が無視されます。
        </p><p>
          <code class="literal">SYSDATE()</code> は、実行された時間を返します。これは、ステートメントが実行を開始する時間を示す定数時間を返す <code class="literal">NOW()</code> の動作とは異なります。(ストアドファンクションまたはトリガーでは、<code class="literal">NOW()</code> は関数またはトリガーステートメントが実行を開始する時間を返します。)
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NOW(), SLEEP(2), NOW();</code></strong>
+---------------------+----------+---------------------+
| NOW()               | SLEEP(2) | NOW()               |
+---------------------+----------+---------------------+
| 2006-04-12 13:47:36 |        0 | 2006-04-12 13:47:36 |
+---------------------+----------+---------------------+

mysql&gt; <strong class="userinput"><code>SELECT SYSDATE(), SLEEP(2), SYSDATE();</code></strong>
+---------------------+----------+---------------------+
| SYSDATE()           | SLEEP(2) | SYSDATE()           |
+---------------------+----------+---------------------+
| 2006-04-12 13:47:44 |        0 | 2006-04-12 13:47:46 |
+---------------------+----------+---------------------+
</pre><p>
          さらに、<code class="literal">SET TIMESTAMP</code> ステートメントによって、<code class="literal">NOW()</code> で返された値は影響を受けますが、<code class="literal">SYSDATE()</code> で返された値は影響を受けません。つまり、バイナリログのタイムスタンプ設定は、<code class="literal">SYSDATE()</code> の呼び出しに影響しないことを意味します。
        </p><p>
          <code class="literal">SYSDATE()</code> は、同じステートメント内でもさまざまな値を返すことができ、<code class="literal">SET TIMESTAMP</code> による影響も受けないため、非決定的です。そのため、ステートメントベースのバイナリロギングが使用されている場合は、レプリケーションで安全に使用できません。これが問題となる場合は、行ベースのロギングを使用できます。
        </p><p>
          また、<code class="option">--sysdate-is-now</code> オプションを使用すると、<code class="literal">SYSDATE()</code> を <code class="literal">NOW()</code> のエイリアスにすることができます。これは、オプションがマスターとスレーブの両方で使用される場合に機能します。
        </p><p>
          <code class="literal">SYSDATE()</code> に非決定的な特性があるということは、それを参照する式を評価する際にインデックスを使用できないことも意味します。
        </p></li><li class="listitem"><a name="function_time"></a><p>
          <a class="indexterm" name="idm139979095912928"></a> <code class="literal">TIME(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          時間または日付時間式 <em class="replaceable"><code>expr</code></em> の時部分を抽出し、文字列として返します。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TIME('2003-12-31 01:02:03');</code></strong>
        -&gt; '01:02:03'
mysql&gt; <strong class="userinput"><code>SELECT TIME('2003-12-31 01:02:03.000123');</code></strong>
        -&gt; '01:02:03.000123'
</pre></li><li class="listitem"><a name="function_timediff"></a><p>
          <a class="indexterm" name="idm139979095899616"></a> <code class="literal">TIMEDIFF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><p>
          <code class="literal">TIMEDIFF()</code> は、時間値として表現された <em class="replaceable"><code>expr1</code></em> − <em class="replaceable"><code>expr2</code></em> を返します。<em class="replaceable"><code>expr1</code></em> および <em class="replaceable"><code>expr2</code></em> は時間または日付時間式ですが、両方とも同じ型にする必要があります。
        </p><p>
          <code class="literal">TIMEDIFF()</code> で返される結果は、<code class="literal">TIME</code> 値で許可される範囲に制限されています。また、<code class="literal">TIMESTAMPDIFF()</code> および <code class="literal">UNIX_TIMESTAMP()</code> 関数のいずれかを使用することもできます。両方とも整数を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TIMEDIFF('2000:01:01 00:00:00',</code></strong>
    -&gt;                 <strong class="userinput"><code>'2000:01:01 00:00:00.000001');</code></strong>
        -&gt; '-00:00:00.000001'
mysql&gt; <strong class="userinput"><code>SELECT TIMEDIFF('2008-12-31 23:59:59.000001',</code></strong>
    -&gt; <strong class="userinput"><code>                '2008-12-30 01:01:01.000002');</code></strong>
        -&gt; '46:58:57.999999'
</pre></li><li class="listitem"><a name="function_timestamp"></a><p>
          <a class="indexterm" name="idm139979095879392"></a> <code class="literal">TIMESTAMP(<em class="replaceable"><code>expr</code></em>)</code>, <code class="literal">TIMESTAMP(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code>
        </p><p>
          引数を 1 つ付けると、この関数は日付または日付時間式 <em class="replaceable"><code>expr</code></em> を日付時間値として返します。引数を 2 つ付けると、時間式 <em class="replaceable"><code>expr2</code></em> を日付または日付時間式 <em class="replaceable"><code>expr1</code></em> に加算し、その結果を日付時間値として返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMP('2003-12-31');</code></strong>
        -&gt; '2003-12-31 00:00:00'
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMP('2003-12-31 12:00:00','12:00:00');</code></strong>
        -&gt; '2004-01-01 00:00:00'
</pre></li><li class="listitem"><a name="function_timestampadd"></a><p>
          <a class="indexterm" name="idm139979095865648"></a> <code class="literal">TIMESTAMPADD(<em class="replaceable"><code>unit</code></em>,<em class="replaceable"><code>interval</code></em>,<em class="replaceable"><code>datetime_expr</code></em>)</code>
        </p><p>
          整数式 <em class="replaceable"><code>interval</code></em> を日付または日付時間式 <em class="replaceable"><code>datetime_expr</code></em> に加算します。<em class="replaceable"><code>interval</code></em> の単位は、<em class="replaceable"><code>unit</code></em> 引数で指定されます。この引数は、<code class="literal">MICROSECOND</code> (マイクロ秒)、<code class="literal">SECOND</code>、<code class="literal">MINUTE</code>、<code class="literal">HOUR</code>、<code class="literal">DAY</code>、<code class="literal">WEEK</code>、<code class="literal">MONTH</code>、<code class="literal">QUARTER</code>、<code class="literal">YEAR</code> 値のいずれかにする必要があります。
        </p><p>
          <em class="replaceable"><code>unit</code></em> 値を指定するには、ここで示したキーワードのいずれかを使用するか、<code class="literal">SQL_TSI_</code> をプリフィクスとして付けます。たとえば、<code class="literal">DAY</code> と <code class="literal">SQL_TSI_DAY</code> は両方とも有効です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPADD(MINUTE,1,'2003-01-02');</code></strong>
        -&gt; '2003-01-02 00:01:00'
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPADD(WEEK,1,'2003-01-02');</code></strong>
        -&gt; '2003-01-09'
</pre></li><li class="listitem"><a name="function_timestampdiff"></a><p>
          <a class="indexterm" name="idm139979095842800"></a> <code class="literal">TIMESTAMPDIFF(<em class="replaceable"><code>unit</code></em>,<em class="replaceable"><code>datetime_expr1</code></em>,<em class="replaceable"><code>datetime_expr2</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>datetime_expr2</code></em> − <em class="replaceable"><code>datetime_expr1</code></em> を返します。<em class="replaceable"><code>datetime_expr1</code></em> と <em class="replaceable"><code>datetime_expr2</code></em> は、日付または日付時間式です。式の一方が日付で、他方が日付時間にすることもできます。日付値は、必要に応じて時間部分が <code class="literal">'00:00:00'</code> の日付時間として処理されます。結果 (整数) の単位は、<em class="replaceable"><code>unit</code></em> 引数で指定されます。<em class="replaceable"><code>unit</code></em> の有効な値は、<code class="literal">TIMESTAMPADD()</code> 関数の説明で一覧表示された値と同じです。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(MONTH,'2003-02-01','2003-05-01');</code></strong>
        -&gt; 3
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(YEAR,'2002-05-01','2001-01-01');</code></strong>
        -&gt; -1
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(MINUTE,'2003-02-01','2003-05-01 12:05:55');</code></strong>
        -&gt; 128885
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            この関数の日付または日付時間引数の順序は、<code class="literal">TIMESTAMP()</code> 関数を 2 つの引数を指定して呼び出す場合の順序と逆になります。
          </p></div></li><li class="listitem"><a name="function_time-format"></a><p>
          <a class="indexterm" name="idm139979095824032"></a> <code class="literal">TIME_FORMAT(<em class="replaceable"><code>time</code></em>,<em class="replaceable"><code>format</code></em>)</code>
        </p><p>
          これは <code class="literal">DATE_FORMAT()</code> 関数と同様に使用されますが、<em class="replaceable"><code>format</code></em> 文字列には時間、分、秒、マイクロ秒の書式指定子のみを含めることができます。その他の指定子では、<code class="literal">NULL</code> 値または <code class="literal">0</code> が生成されます。
        </p><p>
          <em class="replaceable"><code>time</code></em> 値に <code class="literal">23</code> よりも大きな時間部分が含まれる場合は、<code class="literal">%H</code> および <code class="literal">%k</code> 時間書式指定子によって、<code class="literal">0..23</code> の通常の範囲よりも大きな値が生成されます。その他の時間書式指定子では、時間値モジュロ 12 が生成されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TIME_FORMAT('100:00:00', '%H %k %h %I %l');</code></strong>
        -&gt; '100 100 04 04 4'
</pre></li><li class="listitem"><a name="function_time-to-sec"></a><p>
          <a class="indexterm" name="idm139979095806960"></a> <code class="literal">TIME_TO_SEC(<em class="replaceable"><code>time</code></em>)</code>
        </p><p>
          秒に変換された <em class="replaceable"><code>time</code></em> 引数を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TIME_TO_SEC('22:23:00');</code></strong>
        -&gt; 80580
mysql&gt; <strong class="userinput"><code>SELECT TIME_TO_SEC('00:39:38');</code></strong>
        -&gt; 2378
</pre></li><li class="listitem"><a name="function_to-days"></a><p>
          <a class="indexterm" name="idm139979095796448"></a> <code class="literal">TO_DAYS(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          日付 <em class="replaceable"><code>date</code></em> が指定され、日数 (0 年以降の日数) を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS(950501);</code></strong>
        -&gt; 728779
mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('2007-10-07');</code></strong>
        -&gt; 733321
</pre><p>
          <code class="literal">TO_DAYS()</code> は、カレンダーが変更された際に失われた日が考慮されないため、グレゴリオ暦 (1582) の出現よりも前の値とともに使用するために設計されていません。日付が 1582 よりも前の場合は (ほかのロケールでは、さらにあとの年になる可能性があります)、この関数の結果は信頼できません。詳細は <a class="xref" href="functions.html#mysql-calendar" title="12.8 MySQL で使用されるカレンダー">セクション12.8「MySQL で使用されるカレンダー」</a>を参照してください。
        </p><p>
          MySQL では <a class="xref" href="data-types.html#date-and-time-types" title="11.3 日付と時間型">セクション11.3「日付と時間型」</a> のルールを使用して、日付の 2 桁の年の値が 4 桁の形式に変換されることを忘れないでください。たとえば、<code class="literal">'2008-10-07'</code> と <code class="literal">'08-10-07'</code> は同じ日付と認識されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('2008-10-07'), TO_DAYS('08-10-07');</code></strong>
        -&gt; 733687, 733687
</pre><p>
          MySQL では、ゼロの日付は <code class="literal">'0000-00-00'</code> として定義されます。ただし、このデータ自体は無効とみなされます。つまり、<code class="literal">'0000-00-00'</code> および <code class="literal">'0000-01-01'</code> の場合、<code class="literal">TO_DAYS()</code> は次に示す値を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('0000-00-00');</code></strong>
+-----------------------+
| to_days('0000-00-00') |
+-----------------------+
|                  NULL |
+-----------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+----------------------------------------+
| Level   | Code | Message                                |
+---------+------+----------------------------------------+
| Warning | 1292 | Incorrect datetime value: '0000-00-00' |
+---------+------+----------------------------------------+
1 row in set (0.00 sec)


mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('0000-01-01');</code></strong>
+-----------------------+
| to_days('0000-01-01') |
+-----------------------+
|                     1 |
+-----------------------+
1 row in set (0.00 sec)
</pre><p>
          このことは、<code class="literal">ALLOW_INVALID_DATES</code> SQL サーバーモードが有効であるかどうかに関係なく当てはまります。
        </p></li><li class="listitem"><a name="function_to-seconds"></a><p>
          <a class="indexterm" name="idm139979095769216"></a> <code class="literal">TO_SECONDS(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          日付または日付時間の <em class="replaceable"><code>expr</code></em> が指定され、0 年以降の日数を返します。<em class="replaceable"><code>expr</code></em> が有効な日付または日付時間の値ではない場合は、<code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS(950501);</code></strong>
        -&gt; 62966505600
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('2009-11-29');</code></strong>
        -&gt; 63426672000
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('2009-11-29 13:43:32');</code></strong>
        -&gt; 63426721412
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS( NOW() );</code></strong>
        -&gt; 63426721458
</pre><p>
          <code class="literal">TO_DAYS()</code> と同様に、<code class="literal">TO_SECONDS()</code> は、カレンダーが変更された際に失われた日が考慮されないため、グレゴリオ暦 (1582) の出現よりも前の値とともに使用する目的で設計されていません。日付が 1582 よりも前の場合は (ほかのロケールでは、さらにあとの年になる可能性があります)、この関数の結果は信頼できません。詳細は <a class="xref" href="functions.html#mysql-calendar" title="12.8 MySQL で使用されるカレンダー">セクション12.8「MySQL で使用されるカレンダー」</a>を参照してください。
        </p><p>
          <code class="literal">TO_DAYS()</code> と同様に、<code class="literal">TO_SECONDS()</code> は <a class="xref" href="data-types.html#date-and-time-types" title="11.3 日付と時間型">セクション11.3「日付と時間型」</a> のルールを使用して日付の 2 桁の年の値を 4 桁の形式に変換します。
        </p><p>
          MySQL では、ゼロの日付は <code class="literal">'0000-00-00'</code> として定義されます。ただし、このデータ自体は無効とみなされます。つまり、<code class="literal">'0000-00-00'</code> および <code class="literal">'0000-01-01'</code> の場合、<code class="literal">TO_SECONDS()</code> は次に示す値を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('0000-00-00');</code></strong>
+--------------------------+
| TO_SECONDS('0000-00-00') |
+--------------------------+
|                     NULL |
+--------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+----------------------------------------+
| Level   | Code | Message                                |
+---------+------+----------------------------------------+
| Warning | 1292 | Incorrect datetime value: '0000-00-00' |
+---------+------+----------------------------------------+
1 row in set (0.00 sec)


mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('0000-01-01');</code></strong>
+--------------------------+
| TO_SECONDS('0000-01-01') |
+--------------------------+
|                    86400 |
+--------------------------+
1 row in set (0.00 sec)
</pre><p>
          このことは、<code class="literal">ALLOW_INVALID_DATES</code> SQL サーバーモードが有効であるかどうかに関係なく当てはまります。
        </p></li><li class="listitem"><a name="function_unix-timestamp"></a><p>
          <a class="indexterm" name="idm139979095739552"></a> <code class="literal">UNIX_TIMESTAMP()</code>、<code class="literal">UNIX_TIMESTAMP(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          引数なしで呼び出された場合は、Unix タイムスタンプ (<code class="literal">'1970-01-01 00:00:00'</code> UTC 以降の秒数) を符号なし整数として返します。<em class="replaceable"><code>date</code></em> 引数を付けて <code class="literal">UNIX_TIMESTAMP()</code> が呼び出された場合は、その引数の値が <code class="literal">'1970-01-01 00:00:00'</code> UTC 以降の秒数として返されます。<em class="replaceable"><code>date</code></em> には、<code class="literal">DATE</code> 文字列、<code class="literal">DATETIME</code> 文字列、<code class="literal">TIMESTAMP</code>、<code class="literal">YYMMDD</code> または <code class="literal">YYYYMMDD</code> 書式の数値を指定できます。サーバーは <em class="replaceable"><code>date</code></em> を現在のタイムゾーンの値として解釈し、UTC の内部値に変換します。クライアントは、<a class="xref" href="globalization.html#time-zone-support" title="10.6 MySQL Server でのタイムゾーンのサポート">セクション10.6「MySQL Server でのタイムゾーンのサポート」</a>で説明するとおりに、独自のタイムゾーンを設定できます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP();</code></strong>
        -&gt; 1196440210
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2007-11-30 10:30:19');</code></strong>
        -&gt; 1196440219
</pre><p>
          <code class="literal">UNIX_TIMESTAMP()</code> が <code class="literal">TIMESTAMP</code> カラムで使用されると、暗黙的に <span class="quote">「<span class="quote">string-to-Unix-timestamp</span>」</span> に変換されずに、内部タイムスタンプ値が直接返されます。<code class="literal">UNIX_TIMESTAMP()</code> に範囲外の日付を渡すと、<code class="literal">0</code> が返されます。
        </p><p>
          注: <code class="literal">UNIX_TIMESTAMP()</code> および <code class="literal">FROM_UNIXTIME()</code> を使用して <code class="literal">TIMESTAMP</code> 値と Unix タイムスタンプ値とを変換する場合は、どちらの方向でもマッピングが 1 対 1 ではないため、変換は不可逆です。たとえば、ローカルタイムゾーンを変更するための変換が原因で、2 つの <code class="literal">UNIX_TIMESTAMP()</code> で 2 つの <code class="literal">TIMESTAMP</code> 値が同じ Unix タイムスタンプ値にマップされる可能性があります。<code class="literal">FROM_UNIXTIME()</code> は、その値を元の <code class="literal">TIMESTAMP</code> 値のいずれかにのみマップし直します。次に、<code class="literal">CET</code> タイムゾーンでの <code class="literal">TIMESTAMP</code> 値の使用例を示します。
        </p><pre class="programlisting">

mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2005-03-27 03:00:00');</code></strong>
+---------------------------------------+
| UNIX_TIMESTAMP('2005-03-27 03:00:00') |
+---------------------------------------+
|                            1111885200 |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2005-03-27 02:00:00');</code></strong>
+---------------------------------------+
| UNIX_TIMESTAMP('2005-03-27 02:00:00') |
+---------------------------------------+
|                            1111885200 |
+---------------------------------------+
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1111885200);</code></strong>
+---------------------------+
| FROM_UNIXTIME(1111885200) |
+---------------------------+
| 2005-03-27 03:00:00       |
+---------------------------+
</pre><p>
          <code class="literal">UNIX_TIMESTAMP()</code> カラムを減算する場合は、結果を符号付きの整数にキャストします。<a class="xref" href="functions.html#cast-functions" title="12.10 キャスト関数と演算子">セクション12.10「キャスト関数と演算子」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_utc-date"></a><p>
          <a class="indexterm" name="idm139979095697792"></a> <code class="literal">UTC_DATE</code>、<code class="literal">UTC_DATE()</code>
        </p><p>
          関数が文字列と数値のどちらのコンテキストで使用されているのかに応じて、現在の UTC 日付を <code class="literal">'YYYY-MM-DD'</code> または <code class="literal">YYYYMMDD</code> 書式の値で返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UTC_DATE(), UTC_DATE() + 0;</code></strong>
        -&gt; '2003-08-14', 20030814
</pre></li><li class="listitem"><a name="function_utc-time"></a><p>
          <a class="indexterm" name="idm139979095686160"></a> <code class="literal">UTC_TIME</code>, <code class="literal">UTC_TIME([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          関数が文字列と数値のどちらのコンテキストで使用されているのかに応じて、現在の UTC 時間を <code class="literal">'HH:MM:SS'</code> または <code class="literal">HHMMSS</code> 書式の値で返します。
        </p><p>
          MySQL 5.6.4 の時点では、0 から 6 までの小数秒の精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合は、その桁数の小数秒部分が戻り値に含まれます。5.6.4 よりも前では、すべての引数が無視されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UTC_TIME(), UTC_TIME() + 0;</code></strong>
        -&gt; '18:07:53', 180753.000000
</pre></li><li class="listitem"><a name="function_utc-timestamp"></a><p>
          <a class="indexterm" name="idm139979095672800"></a> <code class="literal">UTC_TIMESTAMP</code>、<code class="literal">UTC_TIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code>
        </p><p>
          関数が文字列と数値のどちらのコンテキストで使用されているのかに応じて、現在の UTC 日付と時間を <code class="literal">'YYYY-MM-DD HH:MM:SS'</code> または <code class="literal">YYYYMMDDHHMMSS</code> 書式の値として返します。
        </p><p>
          MySQL 5.6.4 の時点では、0 から 6 までの小数秒の精度を指定するために <em class="replaceable"><code>fsp</code></em> 引数が指定されている場合は、その桁数の小数秒部分が戻り値に含まれます。5.6.4 よりも前では、すべての引数が無視されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UTC_TIMESTAMP(), UTC_TIMESTAMP() + 0;</code></strong>
        -&gt; '2003-08-14 18:08:04', 20030814180804.000000
</pre></li><li class="listitem"><a name="function_week"></a><p>
          <a class="indexterm" name="idm139979095659312"></a> <code class="literal">WEEK(<em class="replaceable"><code>date</code></em>[,<em class="replaceable"><code>mode</code></em>])</code>
        </p><p>
          この関数は、<em class="replaceable"><code>date</code></em> に対応する週番号を返します。2 つの引数を取る形式の <code class="literal">WEEK()</code> を使用すると、週が日曜日と月曜日のどちらから始まるのか、および戻り値が <code class="literal">0</code> から <code class="literal">53</code>までと <code class="literal">1</code> から <code class="literal">53</code> までのどちらの範囲内であるのかを指定できます。<em class="replaceable"><code>mode</code></em> 引数が省略された場合は、<code class="literal">default_week_format</code> システム変数の値が使用されます。<a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 サーバーシステム変数">セクション5.1.4「サーバーシステム変数」</a>を参照してください。
        </p><p>
          次の表では、<em class="replaceable"><code>mode</code></em> 引数がどのように機能するのかについて説明します。
        </p><div class="informaltable"><table summary="この表では、WEEK 関数の mode 引数がどのように機能するのかについて説明します。この表には、モード値ごとに、週の 1 日目、範囲、および第 1 週の説明を一覧表示します。" border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th scope="col">モード</th><th scope="col">週の 1 日目</th><th scope="col">範囲</th><th scope="col">第 1 週は次の条件を満たす最初の週</th></tr></thead><tbody><tr><td scope="row">0</td><td>日曜日</td><td>0-53</td><td>本年の日曜日を含む</td></tr><tr><td scope="row">1</td><td>月曜日</td><td>0-53</td><td>本年の 4 日以上を含む</td></tr><tr><td scope="row">2</td><td>日曜日</td><td>1-53</td><td>本年の日曜日を含む</td></tr><tr><td scope="row">3</td><td>月曜日</td><td>1-53</td><td>本年の 4 日以上を含む</td></tr><tr><td scope="row">4</td><td>日曜日</td><td>0-53</td><td>本年の 4 日以上を含む</td></tr><tr><td scope="row">5</td><td>月曜日</td><td>0-53</td><td>本年の月曜日を含む</td></tr><tr><td scope="row">6</td><td>日曜日</td><td>1-53</td><td>本年の 4 日以上を含む</td></tr><tr><td scope="row">7</td><td>月曜日</td><td>1-53</td><td>本年の月曜日を含む</td></tr></tbody></table></div><p>
          <span class="quote">「<span class="quote">本年の 4 日以上を含む</span>」</span>という意味を持つ <em class="replaceable"><code>mode</code></em> 値では、ISO 8601:1988 に従って週番が付けられます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              1 月 1 日を含む週に新年の 4 日以上が含まれる場合は、その週が第 1 週です。
            </p></li><li class="listitem"><p>
              それ以外の場合は、前年の最終週となり、次の週が第 1 週です。
            </p></li></ul></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT WEEK('2008-02-20');</code></strong>
        -&gt; 7
mysql&gt; <strong class="userinput"><code>SELECT WEEK('2008-02-20',0);</code></strong>
        -&gt; 7
mysql&gt; <strong class="userinput"><code>SELECT WEEK('2008-02-20',1);</code></strong>
        -&gt; 8
mysql&gt; <strong class="userinput"><code>SELECT WEEK('2008-12-31',1);</code></strong>
        -&gt; 53
</pre><p>
          日付が前年の最終週に入っている場合は、オプションの <em class="replaceable"><code>mode</code></em> 引数として<code class="literal">2</code>、<code class="literal">3</code>、<code class="literal">6</code>、または <code class="literal">7</code> を使用しなければ、MySQL によって <code class="literal">0</code> が返されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT YEAR('2000-01-01'), WEEK('2000-01-01',0);</code></strong>
        -&gt; 2000, 0
</pre><p>
          指定された日付は実際には 1999 年の第 52 週に発生するため、<code class="literal">WEEK()</code> は <code class="literal">52</code> を返す必要があると議論されることもあります。代わりに <code class="literal">WEEK()</code> は、戻り値が<span class="quote">「<span class="quote">指定された年の週番号</span>」</span>となるように <code class="literal">0</code> を返します。これにより、日付から日付部分を抽出するその他の関数と組み合わせると、<code class="literal">WEEK()</code> 関数を信頼して使用できるようになります。
        </p><p>
          指定された日付に対応する週の 1 日目を含む年について評価された結果を優先する場合は、オプションの <em class="replaceable"><code>mode</code></em> 引数として <code class="literal">0</code>、<code class="literal">2</code>、<code class="literal">5</code>、または <code class="literal">7</code> を使用します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT WEEK('2000-01-01',2);</code></strong>
        -&gt; 52
</pre><p>
          または、<code class="literal">YEARWEEK()</code> 関数を使用します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT YEARWEEK('2000-01-01');</code></strong>
        -&gt; 199952
mysql&gt; <strong class="userinput"><code>SELECT MID(YEARWEEK('2000-01-01'),5,2);</code></strong>
        -&gt; '52'
</pre></li><li class="listitem"><a name="function_weekday"></a><p>
          <a class="indexterm" name="idm139979095589968"></a> <code class="literal">WEEKDAY(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>date</code></em> に対応する曜日インデックス (<code class="literal">0</code> = Monday、<code class="literal">1</code> = Tuesday、…<code class="literal">6</code> = Sunday) を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT WEEKDAY('2008-02-03 22:23:00');</code></strong>
        -&gt; 6
mysql&gt; <strong class="userinput"><code>SELECT WEEKDAY('2007-11-06');</code></strong>
        -&gt; 1
</pre></li><li class="listitem"><a name="function_weekofyear"></a><p>
          <a class="indexterm" name="idm139979095577456"></a> <code class="literal">WEEKOFYEAR(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <code class="literal">1</code> から <code class="literal">53</code> までの範囲内で、日付の暦週を返します。<code class="literal">WEEKOFYEAR()</code> は <code class="literal">WEEK(<em class="replaceable"><code>date</code></em>,3)</code> に同等の互換性のある関数です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT WEEKOFYEAR('2008-02-20');</code></strong>
        -&gt; 8
</pre></li><li class="listitem"><a name="function_year"></a><p>
          <a class="indexterm" name="idm139979095564336"></a> <code class="literal">YEAR(<em class="replaceable"><code>date</code></em>)</code>
        </p><p>
          <code class="literal">1000</code> から <code class="literal">9999</code> までの範囲内で、<em class="replaceable"><code>date</code></em> に対応する年を返します。日付が<span class="quote">「<span class="quote">ゼロ</span>」</span>の場合は、<code class="literal">0</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT YEAR('1987-01-01');</code></strong>
        -&gt; 1987
</pre></li><li class="listitem"><a name="function_yearweek"></a><p>
          <a class="indexterm" name="idm139979095551984"></a> <code class="literal">YEARWEEK(<em class="replaceable"><code>date</code></em>)</code>、<code class="literal">YEARWEEK(<em class="replaceable"><code>date</code></em>,<em class="replaceable"><code>mode</code></em>)</code>
        </p><p>
          日付に対応する年と週を返します。<em class="replaceable"><code>mode</code></em> 引数は、<code class="literal">WEEK()</code> への <em class="replaceable"><code>mode</code></em> 引数とまったく同様に機能します。結果の年と日付引数の年では、その年の最初と最後の週が異なる可能性があります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT YEARWEEK('1987-01-01');</code></strong>
        -&gt; 198653
</pre><p>
          <code class="literal">WEEK()</code> はその後、指定された年のコンテキストで週を返すため、週番号はオプションの引数 <code class="literal">0</code> または <code class="literal">1</code> を付けた場合に <code class="literal">WEEK()</code> 関数で返される数字 (<code class="literal">0</code>) とは異なります。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-calendar"></a>12.8 MySQL で使用されるカレンダー</h2></div></div></div><a class="indexterm" name="idm139979095534720"></a><p>
      MySQL では、<em class="firstterm">先発グレゴリオ暦</em>と呼ばれるものが使用されています。
    </p><p>
      ユリウス暦からグレゴリオ暦に切り替えた国はすべて、切り替え時に少なくとも 10 日間を破棄する必要がありました。この動作を確認するために、最初にユリウス暦からグレゴリオ暦への切り替えが発生した 1582 年 10 月を考えてください。
    </p><div class="informaltable"><table summary="この表には、最初にユリウス暦からグレゴリオ暦への切り替えが発生した 1582 年の月を示します。表の見出しは曜日であり、表の行には曜日ごとの日付が一覧表示されています。この表の目的は、10 月 4 日から 10 月 15 の間の日付がないことを示すことです。" border="1"><colgroup><col><col><col><col><col><col><col></colgroup><thead><tr><th scope="col">月曜日</th><th scope="col">火曜日</th><th scope="col">水曜日</th><th scope="col">木曜日</th><th scope="col">金曜日</th><th scope="col">土曜日</th><th scope="col">日曜日</th></tr></thead><tbody><tr><td scope="row">1</td><td>2</td><td>3</td><td>4</td><td>15</td><td>16</td><td>17</td></tr><tr><td scope="row">18</td><td>19</td><td>20</td><td>21</td><td>22</td><td>23</td><td>24</td></tr><tr><td scope="row">25</td><td>26</td><td>27</td><td>28</td><td>29</td><td>30</td><td>31</td></tr></tbody></table></div><p>
      10 月 4 日から 10 月 15 日の間には日付がありません。この不連続性は<em class="firstterm">カットオーバー</em>と呼ばれます。カットオーバー前の日付はユリウス暦で、カットオーバー後の日付はグレゴリオ暦です。カットオーバー中の日付は存在しません。
    </p><p>
      実際に使用されていなかった日付に適用されるカレンダーは、<em class="firstterm">先発</em>と呼ばれます。したがって、カットオーバーが発生せず、常にグレゴリオ暦のルールで制御されていると考えられる場合は、先発グレゴリオ暦が使用されています。これが MySQL で使用されるものであり、標準 SQL でも必須です。そのため、MySQL <code class="literal">DATE</code> または <code class="literal">DATETIME</code> 値として格納されたカットオーバー前の日付は、その違いが補正されるように調整する必要があります。すべての国で同時にカットオーバーが発生しなかったこと、および発生が遅くなるほど失われる日数も多かったことに気付くことが重要です。たとえば、イギリスでは 1752 年に発生し、9 月 2 日水曜日の翌日が 9 月 14 日木曜日になりました。ロシアでは 1918 年までユリウス暦のままでしたが、その過程で 13 日間が失われました。<span class="quote">「<span class="quote">10 月革命</span>」</span>として知られる有名な事件は、グレゴリオ暦に従うと 11 月に発生しました。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="fulltext-search"></a>12.9 全文検索関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#fulltext-natural-language">12.9.1 自然言語全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-boolean">12.9.2 ブール全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-query-expansion">12.9.3 クエリー拡張を使用した全文検索</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-stopwords">12.9.4 全文ストップワード</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-restrictions">12.9.5 全文制限</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-fine-tuning">12.9.6 MySQL の全文検索の微調整</a></span></dt><dt><span class="section"><a href="functions.html#full-text-adding-collation">12.9.7 全文インデックス作成用の照合順序の追加</a></span></dt></dl></div><a class="indexterm" name="idm139979095504016"></a><a class="indexterm" name="idm139979095501872"></a><a class="indexterm" name="idm139979095500512"></a><a class="indexterm" name="idm139979095499280"></a><p><a name="function_match"></a>
      <code class="literal">MATCH (<em class="replaceable"><code>col1</code></em>,<em class="replaceable"><code>col2</code></em>,...) AGAINST (<em class="replaceable"><code>expr</code></em> [<em class="replaceable"><code>search_modifier</code></em>])</code>
    </p><pre class="programlisting">
<em class="replaceable"><code>search_modifier:</code></em>
  {
       IN NATURAL LANGUAGE MODE
     | IN NATURAL LANGUAGE MODE WITH QUERY EXPANSION
     | IN BOOLEAN MODE
     | WITH QUERY EXPANSION
  }
</pre><p>
      MySQL では、次のような全文インデックス設定および検索がサポートされています。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          MySQL の全文インデックスは、型 <code class="literal">FULLTEXT</code> のインデックスです。
        </p></li><li class="listitem"><p>
          全文インデックスは、<code class="literal">InnoDB</code> または <code class="literal">MyISAM</code> テーブルでのみ使用でき、<code class="literal">CHAR</code>、<code class="literal">VARCHAR</code>、または <code class="literal">TEXT</code> カラムにのみ作成できます。
        </p></li><li class="listitem"><p>
          <code class="literal">FULLTEXT</code> インデックスの定義は、テーブルの作成時に <code class="literal">CREATE TABLE</code> ステートメントで指定することも、あとで <code class="literal">ALTER TABLE</code> または <code class="literal">CREATE INDEX</code> を使用して追加することもできます。
        </p></li><li class="listitem"><p>
          データセットが大きい場合は、<code class="literal">FULLTEXT</code> インデックスが付いていないテーブルにロードしてから、そのあとでインデックスを作成した方が、既存の<code class="literal">FULLTEXT</code> インデックスが付いているテーブルにロードするよりも断然速いです。
        </p></li></ul></div><p>
      全文検索は、<code class="literal">MATCH() ... AGAINST</code> 構文を使用して実行されます。<code class="literal">MATCH()</code> には、検索対象のカラム名をカンマで区切ったリストを指定します。<code class="literal">AGAINST</code> には、検索する文字列と、実行する検索のタイプを示すオプションの修飾子を指定します。検索文字列は、クエリー評価時に定数である文字列値にする必要があります。たとえば、テーブルカラムは、行ごとに異なる可能性があるため除外されます。
    </p><p>
      全文検索には、次の 3 つの種類があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          自然言語の検索では、検索文字列が人間の自然な言語でのフレーズ (フリーテキストのフレーズ) として解釈されます。特別な演算子はありません。ストップワードリストが適用されます。これらは、<code class="literal">InnoDB</code> 検索インデックスの場合は <code class="literal">innodb_ft_enable_stopword</code>、<code class="literal">innodb_ft_server_stopword_table</code>、および <code class="literal">innodb_ft_user_stopword_table</code>、<code class="literal">MyISAM</code> 検索インデックスの場合は <code class="literal">ft_stopword_file</code> によって制御されます。詳細は、<a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4 全文ストップワード">セクション12.9.4「全文ストップワード」</a>を参照してください。
        </p><p>
          <code class="literal">IN NATURAL LANGUAGE MODE</code> 修飾子が指定されている場合または修飾子がまったく指定されていない場合は、全文検索が自然言語検索になります。詳細は、<a class="xref" href="functions.html#fulltext-natural-language" title="12.9.1 自然言語全文検索">セクション12.9.1「自然言語全文検索」</a>を参照してください。
        </p></li><li class="listitem"><p>
          ブール検索では、特別なクエリー言語のルールを使用して検索文字列が解釈されます。文字列には、検索対象の単語が含まれます。また、一致する行に単語が存在しなければならない、または存在してはならないように、あるいは通常よりも単語の重みが高くまたは低くなるように、要件を指定する演算子を含めることもできます。特定の共通単語 (ストップワード) は、検索インデックスから省略され、検索文字列に存在しない場合は一致が行われません。<code class="literal">IN BOOLEAN MODE</code> 修飾子は、ブール検索を指定します。詳細は、<a class="xref" href="functions.html#fulltext-boolean" title="12.9.2 ブール全文検索">セクション12.9.2「ブール全文検索」</a>を参照してください。
        </p></li><li class="listitem"><p>
          クエリー拡張検索は、自然言語検索を改善したものです。自然言語検索を実行する際は、検索文字列が使用されます。その後、検索で返されたもっとも関連性の高い行からの単語が検索文字列に追加され、再度検索が実行されます。クエリーでは、2 回目の検索からの行が返されます。<code class="literal">IN NATURAL LANGUAGE MODE WITH QUERY EXPANSION</code> または <code class="literal">WITH QUERY EXPANSION</code> 修飾子は、クエリー拡張検索を指定します。詳細は、<a class="xref" href="functions.html#fulltext-query-expansion" title="12.9.3 クエリー拡張を使用した全文検索">セクション12.9.3「クエリー拡張を使用した全文検索」</a>を参照してください。
        </p></li></ul></div><p>
      <code class="literal">FULLTEXT</code> クエリーのパフォーマンスについては、<a class="xref" href="optimization.html#column-indexes" title="8.3.4 カラムインデックス">セクション8.3.4「カラムインデックス」</a>を参照してください。
    </p><p>
      <code class="literal">InnoDB</code> <code class="literal">FULLTEXT</code> インデックスの処理に関するより技術的な詳細は、<a class="xref" href="innodb-storage-engine.html#innodb-fulltext-index" title="14.2.13.3 FULLTEXT インデックス">セクション14.2.13.3「FULLTEXT インデックス」</a>を参照してください。
    </p><p>
      全文検索上の制約については、<a class="xref" href="functions.html#fulltext-restrictions" title="12.9.5 全文制限">セクション12.9.5「全文制限」</a>に一覧表示されています。
    </p><p>
      <span class="command"><strong>myisam_ftdump</strong></span> ユーティリティーは、<code class="literal">MyISAM</code> 全文インデックスの内容をダンプします。これは、全文クエリーのデバッグ時に役立つことがあります。<a class="xref" href="programs.html#myisam-ftdump" title="4.6.2 myisam_ftdump — 全文インデックス情報の表示">セクション4.6.2「<span class="command"><strong>myisam_ftdump</strong></span> — 全文インデックス情報の表示」</a>を参照してください。
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-natural-language"></a>12.9.1 自然言語全文検索</h3></div></div></div><p>
        デフォルトの場合や <code class="literal">IN NATURAL LANGUAGE MODE</code> 修飾子が指定された場合は、<code class="literal">MATCH()</code> 関数は、<em class="firstterm">テキストコレクション</em>に対して文字列の自然言語検索を実行します。コレクションは、<code class="literal">FULLTEXT</code> インデックスに含まれる 1 つ以上のカラムのセットです。検索文字列は、<code class="literal">AGAINST()</code> への引数として指定されます。<code class="literal">MATCH()</code> は、テーブルの行ごとに関連性の値を返します。つまり、検索文字列と、<code class="literal">MATCH()</code> リストで名前が指定されたカラムの該当行のテキスト間で類似性が評価されます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE articles (</code></strong>
    <strong class="userinput"><code>  id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,</code></strong>
    <strong class="userinput"><code>  title VARCHAR(200),</code></strong>
    <strong class="userinput"><code>  body TEXT,</code></strong>
    <strong class="userinput"><code>  FULLTEXT (title,body)</code></strong>
    <strong class="userinput"><code>) ENGINE=InnoDB;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO articles (title,body) VALUES</code></strong>
    <strong class="userinput"><code>('MySQL Tutorial','DBMS stands for DataBase ...'),</code></strong>
    <strong class="userinput"><code>('How To Use MySQL Well','After you went through a ...'),</code></strong>
    <strong class="userinput"><code>('Optimizing MySQL','In this tutorial we will show ...'),</code></strong>
    <strong class="userinput"><code>('1001 MySQL Tricks','1. Never run mysqld as root. 2. ...'),</code></strong>
    <strong class="userinput"><code>('MySQL vs. YourSQL','In the following database comparison ...'),</code></strong>
    <strong class="userinput"><code>('MySQL Security','When configured properly, MySQL ...');</code></strong>
Query OK, 6 rows affected (0.00 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong>
+----+-------------------+------------------------------------------+
| id | title             | body                                     |
+----+-------------------+------------------------------------------+
|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |
|  5 | MySQL vs. YourSQL | In the following database comparison ... |
+----+-------------------+------------------------------------------+
2 rows in set (0.00 sec)
</pre><p>
        デフォルトでは、大文字と小文字が区別される方法で検索が実行されます。大文字と大文字が区別された全文検索を実行するには、インデックス付きカラムのバイナリ照合順序を使用します。たとえば、全文検索で大文字と小文字が区別されるように、<code class="literal">latin1</code> 文字セットが使用されているカラムに <code class="literal">latin1_bin</code> の照合順序を割り当てることができます。
      </p><p>
        以前に例で示したように、<code class="literal">MATCH()</code> が <code class="literal">WHERE</code> 句で使用されると、もっとも関連性の高い行が 1 番目に返されるように、自動的にソートされます。関連性の値は、負ではない浮動小数点数です。ゼロの関連性は、類似性がないという意味です。関連性は、行内の単語の数、該当行内の一意な単語の数、コレクション内の単語の合計数、および特定の単語を含むドキュメント (行) の数に基づいて計算されます。
      </p><p>
        単に一致をカウントするには、次のようなクエリーを使用してください。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT COUNT(*) FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong>
+----------+
| COUNT(*) |
+----------+
|        2 |
+----------+
1 row in set (0.00 sec)
</pre><p>
        次のように、クエリーを再作成した方が早い場合もあります。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    <strong class="userinput"><code>COUNT(IF(MATCH (title,body) AGAINST ('database' IN NATURAL LANGUAGE MODE), 1, NULL))</code></strong>
    <strong class="userinput"><code>AS count</code></strong>
    <strong class="userinput"><code>FROM articles;</code></strong>
+-------+
| count |
+-------+
|     2 |
+-------+
1 row in set (0.03 sec)
</pre><p>
        1 つ目のクエリーでは、いくつかの追加作業 (関連性別の結果のソート) が実行されますが、<code class="literal">WHERE</code> 句に基づくインデックス検索を使用することもできます。インデックス検索では、検索でほとんど行が一致しない場合に、最初のクエリーが速くなる可能性があります。2 つ目のクエリーではテーブルの完全スキャンが実行され、ほとんどの行に検索語句が存在した場合に、インデックス検索よりも高速になる可能性があります。
      </p><p>
        自然言語による全文検索では、<code class="literal">MATCH()</code> 関数で名前が指定されたカラムは、テーブル内の一部の <code class="literal">FULLTEXT</code> インデックスに含まれるカラムと同じである必要があります。上記のクエリーでは、<code class="literal">MATCH()</code> 関数で名前が指定されたカラム (<code class="literal">title</code> と <code class="literal">body</code>) は、<code class="literal">article</code> テーブルの <code class="literal">FULLTEXT</code> インデックスの定義で名前が指定されたカラムと同じです。<code class="literal">title</code> または <code class="literal">body</code> を個別に検索するには、カラムごとに個別の <code class="literal">FULLTEXT</code> インデックスを作成します。
      </p><p>
        ブール検索やクエリー拡張を使用した検索を実行することもできます。これらの検索タイプについては、<a class="xref" href="functions.html#fulltext-boolean" title="12.9.2 ブール全文検索">セクション12.9.2「ブール全文検索」</a>および<a class="xref" href="functions.html#fulltext-query-expansion" title="12.9.3 クエリー拡張を使用した全文検索">セクション12.9.3「クエリー拡張を使用した全文検索」</a>で説明されています。
      </p><p>
        インデックスを使用した全文検索では、インデックスが複数のテーブルに及ぶ可能性はないため、<code class="literal">MATCH()</code> 句の単一テーブルにあるカラムにしか名前を付けることができません。<code class="literal">MyISAM</code> テーブルでは、インデックスが存在しない場合でも、ブール検索を実行できます (ただし、低速になります)。この場合、複数のテーブルのカラムに名前を指定できます。
      </p><p>
        上記の例では、関連性の降順で行が返される <code class="literal">MATCH()</code> 関数の使用方法について簡単に説明しました。次の例では、関連性の値を明示的に取得する方法を示します。<code class="literal">SELECT</code> ステートメントには <code class="literal">WHERE</code> 句も <code class="literal">ORDER BY</code> 句も含まれていないため、返される行は順序付けられません。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT id, MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('Tutorial' IN NATURAL LANGUAGE MODE) AS score</code></strong>
    <strong class="userinput"><code>FROM articles;</code></strong>
+----+---------------------+
| id | score               |
+----+---------------------+
|  1 | 0.22764469683170319 |
|  2 |                   0 |
|  3 | 0.22764469683170319 |
|  4 |                   0 |
|  5 |                   0 |
|  6 |                   0 |
+----+---------------------+
6 rows in set (0.00 sec)
</pre><p>
        次の例はさらに複雑です。このクエリーでは関連性の値が返され、関連性の降順での行のソートも行われます。この結果を実現するには、<code class="literal">MATCH()</code> を 2 回 (1 回は <code class="literal">SELECT</code> リストに、もう 1 回は <code class="literal">WHERE</code> 句に) 指定します。MySQL オプティマイザによって、2 回の <code class="literal">MATCH()</code> 呼び出しが同じであり、全文検索コードが 1 回のみ起動されることが検出されるため、追加のオーバーヘッドは発生しません。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT id, body, MATCH (title,body) AGAINST</code></strong>
    <strong class="userinput"><code>('Security implications of running MySQL as root'</code></strong>
    <strong class="userinput"><code>IN NATURAL LANGUAGE MODE) AS score</code></strong>
    <strong class="userinput"><code>FROM articles WHERE MATCH (title,body) AGAINST</code></strong>
    <strong class="userinput"><code>('Security implications of running MySQL as root'</code></strong>
    <strong class="userinput"><code>IN NATURAL LANGUAGE MODE);</code></strong>
+----+-------------------------------------+-----------------+
| id | body                                | score           |
+----+-------------------------------------+-----------------+
|  4 | 1. Never run mysqld as root. 2. ... | 1.5219271183014 |
|  6 | When configured properly, MySQL ... | 1.3114095926285 |
+----+-------------------------------------+-----------------+
2 rows in set (0.00 sec)
</pre><p>
        MySQL <code class="literal">FULLTEXT</code> の実装では、トゥルーワード文字 (文字、数字、およびアンダースコア) のシーケンスが単語とみなされます。そのシーケンスには、アポストロフィー (<span class="quote">「<span class="quote"><code class="literal">'</code></span>」</span>) も含めることはできますが、1 行に 1 つまでです。つまり、<code class="literal">aaa'bbb</code> は 1 語とみなされますが、<code class="literal">aaa''bbb</code> は 2 語とみなされます。単語の先頭または末尾のアポストロフィーは、<code class="literal">FULLTEXT</code> パーサーによって削除されます。<code class="literal">'aaa'bbb'</code> は、<code class="literal">aaa'bbb</code> として解析されます。
      </p><p>
        <code class="literal">FULLTEXT</code> パーサーは、特定の区切り文字 (<span class="quote">「<span class="quote"><code class="literal"> </code></span>」</span> (空白)、<span class="quote">「<span class="quote"><code class="literal">,</code></span>」</span> (カンマ)、<span class="quote">「<span class="quote"><code class="literal">.</code></span>」</span> (ピリオド) など) を検索することで、単語の先頭と末尾を特定します。単語が区切り文字で区切られていない場合 (たとえば中国語の場合)、<code class="literal">FULLTEXT</code> パーサーでは単語の先頭と末尾を特定できません。このような言語で単語やその他のインデックス付きの語句を <code class="literal">FULLTEXT</code> インデックスに追加するには、<span class="quote">「<span class="quote"><code class="literal">"</code></span>」</span> などの任意の区切り文字で区切られるように前処理を行う必要があります。
      </p><p>
        MySQL 5.6 では、組み込みの全文パーサーから置き換えられるプラグインを作成できます (<code class="literal">MyISAM</code> でのみサポートされています)。詳細は、<a class="xref" href="extending-mysql.html#plugin-api" title="24.2 MySQL プラグイン API">セクション24.2「MySQL プラグイン API」</a>を参照してください。パーサープラグインのサンプルソースコードについては、MySQL のソース配布の <code class="filename">plugin/fulltext</code> ディレクトリを参照してください。
      </p><p>
        全文検索では、一部の単語が無視されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            短すぎる単語は無視されます。全文検索で見つかった単語のデフォルトの最小長は、<code class="literal">InnoDB</code> 検索インデックスの場合は 3 文字、<code class="literal">MyISAM</code> の場合は 4 文字です。インデックスを作成する前に、構成オプション (<code class="literal">InnoDB</code> 検索インデックスの場合は <code class="literal">innodb_ft_min_token_size</code> 構成オプション、<code class="literal">MyISAM</code> の場合は <code class="literal">ft_min_word_len</code>) を設定すると、カットオフを制御できます。
          </p></li><li class="listitem"><p>
            ストップワードリスト内の単語は無視されます。ストップワードは、セマンティクス値がゼロであると考えられるほど一般的な単語 (<span class="quote">「<span class="quote">the</span>」</span> や <span class="quote">「<span class="quote">some</span>」</span> など) です。組み込みのストップワードリストもありますが、ユーザー定義のリストでオーバーライドできます。ストップワードリストおよび関連する構成オプションは、<code class="literal">InnoDB</code> 検索インデックスと <code class="literal">MyISAM</code> 検索インデックスとで異なります。ストップワードの処理は、<code class="literal">InnoDB</code> 検索インデックスの場合は構成オプション <code class="literal">innodb_ft_enable_stopword</code>、<code class="literal">innodb_ft_server_stopword_table</code>、および <code class="literal">innodb_ft_user_stopword_table</code>、<code class="literal">MyISAM</code> 検索インデックスの場合は <code class="literal">ft_stopword_file</code> によって制御されます。
          </p></li></ul></div><p>
        デフォルトのストップワードリストおよびそれを変更する方法を表示する方法については、<a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4 全文ストップワード">セクション12.9.4「全文ストップワード」</a>を参照してください。単語のデフォルト最小長は、<a class="xref" href="functions.html#fulltext-fine-tuning" title="12.9.6 MySQL の全文検索の微調整">セクション12.9.6「MySQL の全文検索の微調整」</a>で説明したように変更できます。
      </p><p>
        コレクションおよびクエリー内のすべての正確な単語は、コレクションまたはクエリーでの重要性に従って重み付けられます。したがって、多くのドキュメント内に存在する単語では、この特定のコレクション内のセマンティクス値が低くなるため、重みも低くなります。反対に、まれな単語には、高い重みが付けられます。単語の重みを組み合わせることで、行の関連性が計算されます。この技術は、大きなコレクションで最適に機能します。
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">MyISAM の制限</div><p>
          非常に小さなテーブルでは、単語の配布が適切にセマンティクス値に反映されないため、このモデルでは、<code class="literal">MyISAM</code> テーブル上の検索インデックスに対して異常な結果が生成される可能性があります。たとえば、以前に示した <code class="literal">articles</code> テーブルのすべての行には、<span class="quote">「<span class="quote">MySQL</span>」</span> という単語が存在しますが、<code class="literal">MyISAM</code> 検索インデックス内の単語を検索しても結果が生成されません。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('MySQL' IN NATURAL LANGUAGE MODE);</code></strong>
Empty set (0.00 sec)
</pre><p>
          <span class="quote">「<span class="quote">MySQL</span>」</span> という単語は 50% 以上の行に存在するため、検索の結果が空になります。そのため、事実上ストップワードとして処理されます。このフィルタ処理技術は、よくある語句に対して不適切な結果が生成される可能性のある小さなデータセットよりも、1G バイトのテーブルから 1 行おきに結果セットが返される可能性のない大きなデータセットに適しています。
        </p><p>
          全文検索がどのように動作するかを確認するために最初に試すと、しきい値が 50% であることに驚くかもしれませんが、これによって <code class="literal">InnoDB</code> テーブルが全文検索での実験によりふさわしいことがわかります。<code class="literal">MyISAM</code> テーブルを作成し、それに 1、2 行のテキストのみを挿入する場合は、テキスト内のすべての単語が 50% 以上の行に出現します。その結果、テーブルにより多くの行が含まれるまで、検索の結果が返されません。50% の制限を回避する必要のあるユーザーは、<code class="literal">InnoDB</code> テーブル上に検索インデックスを構築したり、<a class="xref" href="functions.html#fulltext-boolean" title="12.9.2 ブール全文検索">セクション12.9.2「ブール全文検索」</a>で説明したブール検索モードを使用したりできます。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-boolean"></a>12.9.2 ブール全文検索</h3></div></div></div><a class="indexterm" name="idm139979095321952"></a><a class="indexterm" name="idm139979095320496"></a><p>
        MySQL では、<code class="literal">IN BOOLEAN MODE</code> 修飾子を使用することでブール全文検索を実行できます。この修飾子を使用すると、検索文字列の先頭または末尾にある特定の文字が特別な意味を持ちます。次のクエリーでは、<code class="literal">+</code> および <code class="literal">-</code> 演算子は、一致が発生するために単語が存在しなければならないことと、単語が存在してはならないことをそれぞれ示します。したがって、このクエリーでは、<span class="quote">「<span class="quote">MySQL</span>」</span> という単語は含まれるが、<span class="quote">「<span class="quote">YourSQL</span>」</span> という単語は<span class="emphasis"><em>含まれない</em></span>すべての行が取得されます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM articles WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('+MySQL -YourSQL' IN BOOLEAN MODE);</code></strong>
+----+-----------------------+-------------------------------------+
| id | title                 | body                                |
+----+-----------------------+-------------------------------------+
|  1 | MySQL Tutorial        | DBMS stands for DataBase ...        |
|  2 | How To Use MySQL Well | After you went through a ...        |
|  3 | Optimizing MySQL      | In this tutorial we will show ...   |
|  4 | 1001 MySQL Tricks     | 1. Never run mysqld as root. 2. ... |
|  6 | MySQL Security        | When configured properly, MySQL ... |
+----+-----------------------+-------------------------------------+
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          この機能を実装すると、MySQL では<em class="firstterm">暗黙的ブール論理</em>とも呼ばれる次のようなものが使用されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">+</code> は <code class="literal">AND</code> を表します
            </p></li><li class="listitem"><p>
              <code class="literal">-</code> は <code class="literal">NOT</code> を表します
            </p></li><li class="listitem"><p>
              [<span class="emphasis"><em>演算子なし</em></span>] は暗黙的に <code class="literal">OR</code> を表します
            </p></li></ul></div></div><p>
        ブール全文検索には、次のような特徴があります。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            行は自動的に関連性の降順にソートされません。
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> テーブルでブールクエリーを実行するには、<code class="literal">MATCH()</code> 式のすべてのカラム上に <code class="literal">FULLTEXT</code> インデックスが必要です。<code class="literal">MyISAM</code> 検索インデックスに対するブールクエリーは、<code class="literal">FULLTEXT</code> インデックスなしでも機能します。ただし、この方法で実行される検索の速度は、非常に遅くなります。
          </p></li><li class="listitem"><p>
            単語の最小長および最大長の全文パラメータは、<code class="literal">InnoDB</code> 検索インデックスの場合は <code class="literal">innodb_ft_min_token_size</code> および <code class="literal">innodb_ft_max_token_size</code>、<code class="literal">MyISAM</code> 検索インデックスの場合は <code class="literal">ft_min_word_len</code> および <code class="literal">ft_max_word_len</code> に適用されます。
          </p></li><li class="listitem"><p>
            ストップワードリストが適用されます。これらは、<code class="literal">InnoDB</code> 検索インデックスの場合は <code class="literal">innodb_ft_enable_stopword</code>、<code class="literal">innodb_ft_server_stopword_table</code>、および <code class="literal">innodb_ft_user_stopword_table</code>、<code class="literal">MyISAM</code> 検索インデックスの場合は <code class="literal">ft_stopword_file</code> によって制御されます。
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> の全文検索では、<code class="literal">'++apple'</code> の例と同様に、単一の検索単語で複数の演算子を使用するようサポートされていません。MyISAM の全文検索では、同じ検索が正常に処理され、検索単語に隣接する演算子を除くすべての演算子が無視されます。
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> の全文検索では、先頭のプラス記号またはマイナス記号のみがサポートされています。たとえば、<code class="literal">InnoDB</code> では <code class="literal">'+apple'</code> がサポートされますが、<code class="literal">'apple+'</code> はサポートされていません。末尾にプラス記号またはマイナス記号を指定すると、<code class="literal">InnoDB</code> で構文エラーがレポートされます。
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> の全文検索では、ワイルドカード (<code class="literal">'+*'</code>) を使用した先頭のプラス記号、プラス記号とマイナス記号の組み合わせ (<code class="literal">'+-'</code>)、または先頭のプラス記号とマイナス記号の組み合わせ (<code class="literal">'+-apple'</code>) はサポートされていません。このような無効なクエリーでは、構文エラーが返されます。
          </p></li><li class="listitem"><p>
            <code class="literal">MyISAM</code> 検索インデックスに適用される 50% のしきい値は使用されません。
          </p></li></ul></div><p>
        ブール全文検索機能では、次の演算子がサポートされています。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">+</code>
          </p><p>
            先頭または末尾のプラス記号は、この単語が返される各行に存在<span class="emphasis"><em>しなければならない</em></span>ことを示します。<code class="literal">InnoDB</code> では、先頭のプラス記号のみがサポートされています。
          </p></li><li class="listitem"><p>
            <code class="literal">-</code>
          </p><p>
            先頭または末尾のマイナス記号は、この単語が返される行のいずれにも存在<span class="emphasis"><em>してはならない</em></span>ことを示します。<code class="literal">InnoDB</code> では、先頭のマイナス記号のみがサポートされています。
          </p><p>
            注: <code class="literal">-</code> 演算子は、本来ならほかの検索語句で一致が行われる行を除外することのみに使用します。したがって、<code class="literal">-</code> の前にある検索語句のみを含むブールモードの検索では、空の結果が返されます。<span class="quote">「<span class="quote">除外された検索語句のいずれかを含む行を除いたすべての行</span>」</span>が返されるわけではありません。
          </p></li><li class="listitem"><p>
            (演算子なし)
          </p><p>
            デフォルトでは (<code class="literal">+</code> と <code class="literal">-</code> のどちらも指定されてない場合)、この単語はオプションですが、それを含む行の評価は高くなります。これは、<code class="literal">IN BOOLEAN MODE</code> 修飾子なしの <code class="literal">MATCH() ... AGAINST()</code> の動作と似ています。
          </p></li><li class="listitem"><p>
            <code class="literal">@<em class="replaceable"><code>distance</code></em></code>
          </p><p>
            この演算子は、<code class="literal">InnoDB</code> テーブルでのみ機能します。2 つ以上の単語がすべて、相互に指定された距離内で始まっているかどうかが単語単位でテストされます。<code class="literal">@<em class="replaceable"><code>distance</code></em></code> 演算子の直前に、二重引用符で囲まれた文字列内の検索単語を指定します (たとえば、<code class="literal">MATCH(col1) AGAINST('"word1 word2 word3" @8' IN BOOLEAN MODE)</code>)。
          </p></li><li class="listitem"><p>
            <code class="literal">&gt; &lt;</code>
          </p><p>
            これらの 2 つの演算子は、行に割り当てられた関連性の値への単語の貢献度を変更する際に使用されます。<code class="literal">&gt;</code> 演算子は貢献度を上げ、<code class="literal">&lt;</code> 演算子は貢献度を下げます。次のリストのあとに示す例を参照してください。
          </p></li><li class="listitem"><p>
            <code class="literal">( )</code>
          </p><p>
            丸括弧は、単語を部分式にグループ化します。丸括弧で囲まれたグループはネストできます。
          </p></li><li class="listitem"><p>
            <code class="literal">~</code>
          </p><p>
            先頭のチルダは否定演算子として機能するため、行の関連性への単語の貢献度がマイナスになります。これは、<span class="quote">「<span class="quote">ノイズ</span>」</span>単語にマークを付ける際に便利です。このような単語を含む行は、その他よりも低く評価されますが、<code class="literal">-</code> 演算子を使用した場合のように、完全に除外されることはありません。
          </p></li><li class="listitem"><p>
            <code class="literal">*</code>
          </p><p>
            アスタリスクは、切り捨て (またはワイルドカード) 演算子として機能します。その他の演算子とは異なり、影響を受ける単語に<span class="emphasis"><em>追加</em></span>されます。<code class="literal">*</code> 演算子の前の単語で始まれば、単語が一致します。
          </p><p>
            切り捨て演算子を付けて単語が指定されている場合は、その単語が短すぎたり、ストップワードであったりしても、ブールクエリーから削除されません。単語が短すぎるかどうかは、<code class="literal">InnoDB</code> テーブルの場合は <code class="literal">innodb_ft_min_token_size</code> 設定、<code class="literal">MyISAM</code> テーブルの場合は <code class="literal">ft_min_word_len</code> によって判断されます。ワイルドカード単語は、1 つ以上の単語の先頭に存在しなければならないプリフィクスとみなされます。単語の最小長が 4 である場合は、<code class="literal">'+<em class="replaceable"><code>word</code></em> +the*'</code> の検索では、2 番目のクエリーで短すぎる検索語句 <code class="literal">the</code> が無視されるため、<code class="literal">'+<em class="replaceable"><code>word</code></em> +the'</code> の検索よりも少ない行が返される可能性があります。
          </p></li><li class="listitem"><p>
            <code class="literal">"</code>
          </p><p>
            二重引用符 (<span class="quote">「<span class="quote"><code class="literal">"</code></span>」</span>) 文字内で囲まれたフレーズは、<span class="emphasis"><em>入力されたそのままの</em></span>フレーズを含む行にのみ一致します。全文エンジンでは、フレーズが複数の単語に分割され、それらの単語の <code class="literal">FULLTEXT</code> インデックス内で検索が実行されます。単語以外の文字は、正確に一致する必要がありません。フレーズ検索では、そのフレーズとまったく同じ単語が同じ順序で一致に含まれることのみが必要です。たとえば、<code class="literal">"test phrase"</code> は <code class="literal">"test, phrase"</code> と一致します。
          </p><p>
            フレーズにインデックス内にある単語が含まれない場合は、結果が空になります。単語がテキスト内に存在しない場合、ストップワードである場合、またはインデックス付きの単語の最小長よりも短い場合の組み合わせが原因で、単語がインデックス内に存在しない可能性があります。
          </p></li></ul></div><p>
        次の例では、ブール全文演算子を使用する一部の検索文字列を実演します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">'apple banana'</code>
          </p><p>
            2 つの単語の 1 つ以上を含む行を検索します。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple +juice'</code>
          </p><p>
            両方の単語を含む行を検索します。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple macintosh'</code>
          </p><p>
            単語 <span class="quote">「<span class="quote">apple</span>」</span> を含む行を検索しますが、行に <span class="quote">「<span class="quote">macintosh</span>」</span> も含まれる場合は行を高く評価されます。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple -macintosh'</code>
          </p><p>
            単語 <span class="quote">「<span class="quote">apple</span>」</span> を含むが、<span class="quote">「<span class="quote">macintosh</span>」</span> は含まない行を検索します。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple ~macintosh'</code>
          </p><p>
            単語 <span class="quote">「<span class="quote">apple</span>」</span> を含む行を検索しますが、行に単語 <span class="quote">「<span class="quote">macintosh</span>」</span> も含まれる場合は、行に含まれない場合よりも低く評価されます。これは、<span class="quote">「<span class="quote">macintosh</span>」</span> が存在すると、行がまったく返されない <code class="literal">'+apple -macintosh'</code> の検索よりも<span class="quote">「<span class="quote">ソフト</span>」</span>です。
          </p></li><li class="listitem"><p>
            <code class="literal">'+apple +(&gt;turnover &lt;strudel)'</code>
          </p><p>
            単語 <span class="quote">「<span class="quote">apple</span>」</span> と <span class="quote">「<span class="quote">turnover</span>」</span>、または <span class="quote">「<span class="quote">apple</span>」</span> と <span class="quote">「<span class="quote">strudel</span>」</span> (順序は不問) を含む行を検索しますが、<span class="quote">「<span class="quote">apple turnover</span>」</span> を <span class="quote">「<span class="quote">apple strudel</span>」</span> よりも高く評価します。
          </p></li><li class="listitem"><p>
            <code class="literal">'apple*'</code>
          </p><p>
            <span class="quote">「<span class="quote">apple</span>」</span>、<span class="quote">「<span class="quote">apples</span>」</span>、<span class="quote">「<span class="quote">applesauce</span>」</span>、<span class="quote">「<span class="quote">applet</span>」</span> などの単語を含む行を検索します。
          </p></li><li class="listitem"><p>
            <code class="literal">'"some words"'</code>
          </p><p>
            <span class="quote">「<span class="quote">some words</span>」</span> とまったく同じフレーズを含む行を検索します (たとえば、<span class="quote">「<span class="quote">some words of wisdom</span>」</span> を含む行は検索しますが、<span class="quote">「<span class="quote">some noise words</span>」</span> は検索しません)。
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              フレーズを囲む <span class="quote">「<span class="quote"><code class="literal">"</code></span>」</span> 文字は、フレーズを区切る演算子文字です。検索文字列自体を囲む引用符ではありません。
            </p></div></li></ul></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-boolean-innodb-relevancy-ranking"></a>InnoDB ブールモード検索の関連性ランキング</h4></div></div></div><p>
          <code class="literal">InnoDB</code> の全文検索は、<a class="ulink" href="http://sphinxsearch.com/" target="_top">Sphinx</a> の全文検索エンジンをモデルにし、使用されるアルゴリズムは、<a class="ulink" href="http://en.wikipedia.org/wiki/Okapi_BM25" target="_top">BM25</a> および <a class="ulink" href="http://en.wikipedia.org/wiki/TF-IDF" target="_top">TF-IDF</a> のランキングアルゴリズムに基づいています。このような理由のため、<code class="literal">InnoDB</code> のブール全文検索の関連性ランキングは、<code class="literal">MyISAM</code> の関連性ランキングと異なる場合があります。
        </p><p>
          <code class="literal">InnoDB</code> では、<span class="quote">「<span class="quote">term frequency-inverse document frequency</span>」</span> (<code class="literal">TF-IDF</code>) 重み付けシステムの偏差を使用して、指定された全文検索クエリーのドキュメントの関連性にランクが付けられます。<code class="literal">TF-IDF</code> の重み付けは、ドキュメントで単語が出現する頻度に基づき、コレクション内のすべてのドキュメントで単語が出現する頻度によってオフセットされます。言い換えると、ある単語がドキュメントで出現する頻度が高くなるほど、その単語がドキュメントコレクションで出現する頻度が低くなり、ドキュメントのランクが高くなります。
        </p><h5><a name="idm139979095176352"></a>関連性ランキングの計算方法</h5><p>
          単語の出現頻度 (<code class="literal">TF</code>) 値は、単語がドキュメントで出現する回数です。単語の逆文書頻度 (<code class="literal">IDF</code>) 値は、次の公式を使用して計算されます。ここで、<code class="literal">total_records</code> はコレクション内のレコード数、<code class="literal">matching_records</code> は検索語句が表示されるレコード数です。
        </p><pre class="programlisting">${IDF} = log10( ${total_records} / ${matching_records} )  </pre><p>
          ドキュメントに単語が複数回含まれる場合は、IDF 値が TF 値で乗算されます。
        </p><pre class="programlisting">${TF} * ${IDF}</pre><p>
          <code class="literal">TF</code> および <code class="literal">IDF</code> 値を使用する場合は、ドキュメントの関連性ランキングが次の公式を使用して計算されます。
        </p><pre class="programlisting">${rank} = ${TF} * ${IDF} * ${IDF}</pre><p>
          公式については、次の例で実演されています。
        </p><h5><a name="idm139979095166448"></a>単一単語検索の関連性ランキング</h5><p>
          この例では、単一単語検索の関連性ランキングの計算を実演します。
        </p><pre class="programlisting">mysql&gt; CREATE TABLE articles (
id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
title VARCHAR(200),
body TEXT,
FULLTEXT (title,body)
) ENGINE=InnoDB;
Query OK, 0 rows affected (1.04 sec)
 
mysql&gt; INSERT INTO articles (title,body) VALUES 
('MySQL Tutorial','This database tutorial ...'),
("How To Use MySQL",'After you went through a ...'),
('Optimizing Your Database','In this database tutorial ...'),
('MySQL vs. YourSQL','When comparing databases ...'),
('MySQL Security','When configured properly, MySQL ...'),
('Database, Database, Database','database database database'),
('1001 MySQL Tricks','1. Never run mysqld as root. 2. ...'),
('MySQL Full-Text Indexes', 'MySQL fulltext indexes use a ..');                    
Query OK, 8 rows affected (0.06 sec)
Records: 8  Duplicates: 0  Warnings: 0

mysql&gt; SELECT id, title, body, MATCH (title,body)  AGAINST ('database' IN BOOLEAN MODE) 
AS score FROM articles ORDER BY score DESC;
+----+------------------------------+-------------------------------------+---------------------+
| id | title                        | body                                | score               |
+----+------------------------------+-------------------------------------+---------------------+
|  6 | Database, Database, Database | database database database          |  1.0886961221694946 |
|  3 | Optimizing Your Database     | In this database tutorial ...       | 0.36289870738983154 |
|  1 | MySQL Tutorial               | This database tutorial ...          | 0.18144935369491577 |
|  2 | How To Use MySQL             | After you went through a ...        |                   0 |
|  4 | MySQL vs. YourSQL            | When comparing databases ...        |                   0 |
|  5 | MySQL Security               | When configured properly, MySQL ... |                   0 |
|  7 | 1001 MySQL Tricks            | 1. Never run mysqld as root. 2. ... |                   0 |
|  8 | MySQL Full-Text Indexes      | MySQL fulltext indexes use a ..     |                   0 |
+----+------------------------------+-------------------------------------+---------------------+
8 rows in set (0.00 sec)</pre><p>
          合計で 8 つのレコードがあり、そのうち 3 つが <span class="quote">「<span class="quote">database</span>」</span> という検索語句に一致します。1 つ目のレコード (<code class="literal">id 6</code>) には、検索語句が 6 回含まれ、関連性ランキングは <code class="literal">1.0886961221694946</code> です。このランキング値は、6 の <code class="literal">TF</code> 値 (レコード <code class="literal">id 6</code> には <span class="quote">「<span class="quote">database</span>」</span> という検索語句が 6 回出現します)、および次のように計算される 0.42596873216370745 の <code class="literal">IDF</code> 値 (ここで、8 はレコードの合計数、3 は検索語句が出現するレコードの数) を使用して計算されます。
        </p><pre class="programlisting">${IDF} = log10( 8 / 3 ) = 0.42596873216370745</pre><p>
          その後、<code class="literal">TF</code> および <code class="literal">IDF</code> 値はランキング公式に入力されます。
        </p><pre class="programlisting">${rank} = ${TF} * ${IDF} * ${IDF}</pre><p>
          MySQL コマンド行クライアントで計算を実行すると、1.088696164686938 のランキング値が返されます。
        </p><pre class="programlisting">mysql&gt; SELECT 6*log10(8/3)*log10(8/3);
+-------------------------+
| 6*log10(8/3)*log10(8/3) |
+-------------------------+
|       1.088696164686938 |
+-------------------------+
1 row in set (0.00 sec)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">SELECT ... MATCH ... AGAINST</code> ステートメントと MySQL コマンド行クライアントで返されるランキング値 (<code class="literal">1.0886961221694946</code> と <code class="literal">1.088696164686938</code>) に、わずかな相違がある場合があります。この相違は、整数と浮動小数点/倍精度間のキャストが (関連する精度および丸めの決定とともに) <code class="literal">InnoDB</code> によって内部で実行される方法、およびその他の場所 (MySQL コマンド行クライアントやその他のタイプの計算機など) で実行される方法が原因で発生します。
          </p></div><h5><a name="idm139979095142048"></a>複数単語検索の関連性ランキング</h5><p>
          この例では、以前の例で使用された <code class="literal">articles</code> テーブルおよびデータに基づいて、複数単語の全文検索の関連性ランキングの計算を実演します。
        </p><p>
          複数の単語で検索する場合は、次の公式に示すように、関連性ランキングの値が各単語の関連性ランキングの合計になります。
        </p><pre class="programlisting">${rank} = ${TF} * ${IDF} * ${IDF} + ${TF} * ${IDF} * ${IDF}</pre><p>
          2 つの語句 ('mysql tutorial') で検索を実行すると、次の結果が返されます。
        </p><pre class="programlisting">mysql&gt; SELECT id, title, body, MATCH (title,body)  AGAINST ('mysql tutorial' IN BOOLEAN MODE) 
    AS score FROM articles ORDER BY score DESC;
+----+------------------------------+-------------------------------------+----------------------+
| id | title                        | body                                | score                |
+----+------------------------------+-------------------------------------+----------------------+
|  1 | MySQL Tutorial               | This database tutorial ...          |   0.7405621409416199 |
|  3 | Optimizing Your Database     | In this database tutorial ...       |   0.3624762296676636 |
|  5 | MySQL Security               | When configured properly, MySQL ... | 0.031219376251101494 |
|  8 | MySQL Full-Text Indexes      | MySQL fulltext indexes use a ..     | 0.031219376251101494 |
|  2 | How To Use MySQL             | After you went through a ...        | 0.015609688125550747 |
|  4 | MySQL vs. YourSQL            | When comparing databases ...        | 0.015609688125550747 |
|  7 | 1001 MySQL Tricks            | 1. Never run mysqld as root. 2. ... | 0.015609688125550747 |
|  6 | Database, Database, Database | database database database          |                    0 |
+----+------------------------------+-------------------------------------+----------------------+
8 rows in set (0.00 sec)</pre><p>
          1 つ目のレコード (<code class="literal">id 8</code>) では、'mysql' が 1 回出現し、'tutorial' が 2 回出現します。'mysql' に一致するレコードは 6 つ、'tutorial' に一致するレコードは 2 つあります。MySQL コマンド行クライアントでは、これらの値を複数単語検索のランキング公式に挿入するときに、予期されるランキング値が返されます。
        </p><pre class="programlisting">mysql&gt; SELECT (1*log10(8/6)*log10(8/6)) + (2*log10(8/2)*log10(8/2));
+-------------------------------------------------------+
| (1*log10(8/6)*log10(8/6)) + (2*log10(8/2)*log10(8/2)) |
+-------------------------------------------------------+
|                                    0.7405621541938003 |
+-------------------------------------------------------+
1 row in set (0.00 sec)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            上記の例では、<code class="literal">SELECT ... MATCH ... AGAINST</code> ステートメントと MySQL コマンド行クライアントで返されるランキング値に、わずかな相違があることについて説明しました。
          </p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-query-expansion"></a>12.9.3 クエリー拡張を使用した全文検索</h3></div></div></div><a class="indexterm" name="idm139979095127680"></a><a class="indexterm" name="idm139979095126256"></a><p>
        全文検索では、クエリー拡張 (特に、そのバリアントの <span class="quote">「<span class="quote">ブラインドクエリー拡張</span>」</span>) がサポートされています。一般に、これは検索フレーズが短すぎるときに役立ちます。つまり、ユーザーは多くの場合暗黙的な知識に依存しますが、全文検索エンジンにはこれが不足していることを意味します。たとえば、ユーザーが <span class="quote">「<span class="quote">database</span>」</span> を検索することは、実際は <span class="quote">「<span class="quote">MySQL</span>」</span>、<span class="quote">「<span class="quote">Oracle</span>」</span>、<span class="quote">「<span class="quote">DB2</span>」</span>、および <span class="quote">「<span class="quote">RDBMS</span>」</span> がすべて、<span class="quote">「<span class="quote">databases</span>」</span> に一致して返されるはずのフレーズであることを意味する場合があります。これが暗黙的な知識です。
      </p><p>
        ブラインドクエリー拡張 (自動関連性フィードバックとも呼ばれる) は、検索フレーズのあとに <code class="literal">WITH QUERY EXPANSION</code> または <code class="literal">IN NATURAL LANGUAGE MODE WITH QUERY EXPANSION</code> を追加することで有効になります。これは、検索を 2 回実行することで機能します。2 回目の検索での検索フレーズは、1 回目の検索でのもっとも関連性の高い数個のドキュメントと連結されたオリジナルの検索フレーズです。したがって、これらのドキュメントのいずれかに単語 <span class="quote">「<span class="quote">databases</span>」</span> および単語 <span class="quote">「<span class="quote">MySQL</span>」</span> が含まれている場合は、単語 <span class="quote">「<span class="quote">database</span>」</span> が含まれていなくても、2 回目の検索で単語 <span class="quote">「<span class="quote">MySQL</span>」</span> を含むドキュメントが検索されます。次の例では、この相違点を示します。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong>
+----+-------------------+------------------------------------------+
| id | title             | body                                     |
+----+-------------------+------------------------------------------+
|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |
|  5 | MySQL vs. YourSQL | In the following database comparison ... |
+----+-------------------+------------------------------------------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' WITH QUERY EXPANSION);</code></strong>
+----+-----------------------+------------------------------------------+
| id | title                 | body                                     |
+----+-----------------------+------------------------------------------+
|  5 | MySQL vs. YourSQL     | In the following database comparison ... |
|  1 | MySQL Tutorial        | DBMS stands for DataBase ...             |
|  3 | Optimizing MySQL      | In this tutorial we will show ...        |
|  6 | MySQL Security        | When configured properly, MySQL ...      |
|  2 | How To Use MySQL Well | After you went through a ...             |
|  4 | 1001 MySQL Tricks     | 1. Never run mysqld as root. 2. ...      |
+----+-----------------------+------------------------------------------+
6 rows in set (0.00 sec)
</pre><p>
        もう 1 つの例では、ユーザーが <span class="quote">「<span class="quote">Maigret</span>」</span> のスペルに自信がないときに、Georges Simenon 著の Maigret に関する書籍を検索しています。クエリー拡張を使用しなければ、<span class="quote">「<span class="quote">Megre and the reluctant witnesses</span>」</span> を検索しても <span class="quote">「<span class="quote">Maigret and the Reluctant Witnesses</span>」</span> のみが検索されます。クエリー拡張を使用すれば、2 回目の検索で単語 <span class="quote">「<span class="quote">Maigret</span>」</span> を含むすべての書籍が検索されます。
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          ブラインドクエリー拡張には、関連性のないドキュメントが返されるとノイズが大幅に増加する傾向があるため、検索フレーズが短すぎる場合にのみ使用してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-stopwords"></a>12.9.4 全文ストップワード</h3></div></div></div><a class="indexterm" name="idm139979095102560"></a><p>
        サーバー文字セットおよび照合順序 (<code class="literal">character_set_server</code> および <code class="literal">collation_server</code> システム変数の値) を使用すると、全文クエリー用のストップワードリストがロードおよび検索されます。全文インデックス作成または検索で使用されるストップワードファイルまたはカラムに、<code class="literal">character_set_server</code> または <code class="literal">collation_server</code> とは異なる文字セットまたは照合順序が含まれている場合は、ストップワード検索で誤ったヒットまたはミスが発生する可能性があります。
      </p><p>
        ストップワード検索で大文字と小文字が区別されるかどうかは、サーバー照合順序によって異なります。たとえば、照合順序が <code class="literal">latin1_swedish_ci</code> の場合は検索で大文字と小文字が区別されませんが、照合順序が <code class="literal">latin1_general_cs</code> または <code class="literal">latin1_bin</code> の場合は検索で大文字と小文字が区別されます。
      </p><h4><a name="idm139979095092544"></a>InnoDB 検索インデックスのストップワード</h4><p>
        技術的、文学的、およびその他のソースからのドキュメントでは、キーワードとしてまたは重要なフレーズで短い単語が使用されることが多いため、<code class="literal">InnoDB</code> ではデフォルトのストップワードリストが比較的短くなります。たとえば、<span class="quote">「<span class="quote">to be or not to be</span>」</span> を検索し、これらの単語がすべて無視されるのではなく、適切な結果が取得されることを期待するとします。
      </p><p>
        

        デフォルトの <code class="literal">InnoDB</code> ストップワードリストを確認するには、<code class="literal">INFORMATION_SCHEMA.INNODB_FT_DEFAULT_STOPWORD</code> テーブルを問い合わせます。
      </p><pre class="programlisting">mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INNODB_FT_DEFAULT_STOPWORD;
+-------+
| value |
+-------+
| a     |
| about |
| an    |
| are   |
| as    |
| at    |
| be    |
| by    |
| com   |
| de    |
| en    |
| for   |
| from  |
| how   |
| i     |
| in    |
| is    |
| it    |
| la    |
| of    |
| on    |
| or    |
| that  |
| the   |
| this  |
| to    |
| was   |
| what  |
| when  |
| where |
| who   |
| will  |
| with  |
| und   |
| the   |
| www   |
+-------+
36 rows in set (0.00 sec)</pre><p>
        すべての <code class="literal">InnoDB</code> テーブルで独自のストップワードリストを定義するには、<code class="literal">INNODB_FT_DEFAULT_STOPWORD</code> テーブルと同じ構造を持つテーブルを定義し、それにストップワードを移入し、<code class="literal">innodb_ft_server_stopword_table</code> オプションの値を <code class="literal"><em class="replaceable"><code>db_name</code></em>/<em class="replaceable"><code>table_name</code></em></code> 形式の値に設定してから、全文インデックスを作成します。ストップワードテーブルには、<code class="literal">value</code> という名前の単一の <code class="literal">VARCHAR</code> カラムが含まれている必要があります。次の例では、<code class="literal">InnoDB</code> 用に新しいグローバルストップワードテーブルを作成および構成するよう実演します。
      </p><pre class="programlisting">-- Create a new stopword table

mysql&gt; CREATE TABLE my_stopwords(value VARCHAR(30)) ENGINE = INNODB;
Query OK, 0 rows affected (0.01 sec)

-- Insert stopwords (for simplicity, a single stopword is used in this example)  

mysql&gt; INSERT INTO my_stopwords(value) VALUES ('Ishmael');
Query OK, 1 row affected (0.00 sec)

-- Create the table

mysql&gt; CREATE TABLE opening_lines (
id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
opening_line TEXT(500),
author VARCHAR(200),
title VARCHAR(200)
) ENGINE=InnoDB;
Query OK, 0 rows affected (0.01 sec)

-- Insert data into the table

mysql&gt; INSERT INTO opening_lines(opening_line,author,title) VALUES
('Call me Ishmael.','Herman Melville','Moby-Dick'),
('A screaming comes across the sky.','Thomas Pynchon','Gravity\'s Rainbow'),
('I am an invisible man.','Ralph Ellison','Invisible Man'),
('Where now? Who now? When now?','Samuel Beckett','The Unnamable'),
('It was love at first sight.','Joseph Heller','Catch-22'),
('All this happened, more or less.','Kurt Vonnegut','Slaughterhouse-Five'),
('Mrs. Dalloway said she would buy the flowers herself.','Virginia Woolf','Mrs. Dalloway'),
('It was a pleasure to burn.','Ray Bradbury','Fahrenheit 451');
Query OK, 8 rows affected (0.00 sec)
Records: 8  Duplicates: 0  Warnings: 0

-- Set the innodb_ft_server_stopword_table option to the new stopword table

mysql&gt; SET GLOBAL innodb_ft_server_stopword_table = 'test/my_stopwords';
Query OK, 0 rows affected (0.00 sec)

-- Create the full-text index (which rebuilds the table if no FTS_DOC_ID column is defined)

mysql&gt; CREATE FULLTEXT INDEX idx ON opening_lines(opening_line);
Query OK, 0 rows affected, 1 warning (1.17 sec)
Records: 0  Duplicates: 0  Warnings: 1</pre><p>
        <code class="literal">INFORMATION_SCHEMA.INNODB_FT_INDEX_TABLE</code> で単語を問い合わせて、指定したストップワード ('Ishmael') が表示されないことを確認します。
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          デフォルトでは、長さが 3 文字よりも少ない単語または 84 文字よりも多い単語は、<code class="literal">InnoDB</code> の全文検索インデックスに表示されません。単語の最大長および最小長の値は、<code class="literal">innodb_ft_max_token_size</code> および <code class="literal">innodb_ft_min_token_size</code> 変数を使用して構成できます。
        </p></div><pre class="programlisting">mysql&gt; SET GLOBAL innodb_ft_aux_table='test/opening_lines';
Query OK, 0 rows affected (0.00 sec)
  
mysql&gt; SELECT word FROM INFORMATION_SCHEMA.INNODB_FT_INDEX_TABLE LIMIT 15;
+-----------+
| word      |
+-----------+
| across    |
| all       |
| burn      |
| buy       |
| call      |
| comes     |
| dalloway  |
| first     |
| flowers   |
| happened  |
| herself   |
| invisible |
| less      |
| love      |
| man       |
+-----------+
15 rows in set (0.00 sec)</pre><p>
        ストップワードリストをテーブルごとに作成するには、その他のストップワードテーブルを作成し、<code class="literal">innodb_ft_user_stopword_table</code> オプションを使用して使用されるストップワードテーブルを指定してから、全文インデックスを作成します。
      </p><h4><a name="idm139979095063216"></a>MyISAM 検索インデックスのストップワード</h4><p>
        MySQL 5.6 では、<code class="literal">character_set_server</code> が <code class="literal">ucs2</code>、<code class="literal">utf16</code>、<code class="literal">utf16le</code>、または <code class="literal">utf32</code> の場合、ストップワードファイルが <code class="literal">latin1</code> を使用してロードおよび検索されます。
      </p><p>
        <a class="indexterm" name="idm139979095057280"></a> <a class="indexterm" name="idm139979095055088"></a>MyISAM テーブル用のデフォルトのストップワードリストをオーバーライドするには、<code class="literal">ft_stopword_file</code> システム変数を設定します。(<a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 サーバーシステム変数">セクション5.1.4「サーバーシステム変数」</a>を参照してください。)変数の値は、ストップワードリストを含むファイルのパス名、またはストップワードのフィルタ処理が無効になる空の文字列になるようにしてください。サーバーは、別のディレクトリを指定する絶対パス名が指定されないかぎり、データディレクトリ内のファイルを検索します。この変数の値またはストップワードファイルの内容を変更したら、サーバーを再起動し、<code class="literal">FULLTEXT</code> インデックスを再構築してください。
      </p><p>
        ストップワードリストは自由形式で、改行、空白、カンマなどの英数字以外の文字でストップワードが区切られます。例外として、下線文字 (<span class="quote">「<span class="quote"><code class="literal">_</code></span>」</span>) と単一アポストロフィー (<span class="quote">「<span class="quote"><code class="literal">'</code></span>」</span>) は単語の一部として処理されます。ストップワードリストの文字セットは、サーバーのデフォルト文字セットです。<a class="xref" href="globalization.html#charset-server" title="10.1.3.1 サーバー文字セットおよび照合順序">セクション10.1.3.1「サーバー文字セットおよび照合順序」</a>を参照してください。
      </p><p>
        次の表には、<code class="literal">MyISAM</code> 検索インデックスのデフォルトのストップワードリストを示します。このリストは、MySQL ソース配布の <code class="filename">storage/myisam/ft_static.c</code> ファイルで検索できます。
      </p><div class="informaltable"><table summary="この表には、全文ストップワードのデフォルトリストを示します。このリストは、MySQL ソース配布の myisam/ft_static.c ファイルで検索できます。このテーブルには、1 行ごとに左から右へと読んだときにアルファベット順になるように、ストップワードが一覧表示されています。" border="1"><colgroup><col><col><col><col><col></colgroup><tbody><tr><td scope="row">a's</td><td>able</td><td>about</td><td>above</td><td>according</td></tr><tr><td scope="row">accordingly</td><td>across</td><td>actually</td><td>after</td><td>afterwards</td></tr><tr><td scope="row">again</td><td>against</td><td>ain't</td><td>all</td><td>allow</td></tr><tr><td scope="row">allows</td><td>almost</td><td>alone</td><td>along</td><td>already</td></tr><tr><td scope="row">also</td><td>although</td><td>always</td><td>am</td><td>among</td></tr><tr><td scope="row">amongst</td><td>an</td><td>and</td><td>another</td><td>any</td></tr><tr><td scope="row">anybody</td><td>anyhow</td><td>anyone</td><td>anything</td><td>anyway</td></tr><tr><td scope="row">anyways</td><td>anywhere</td><td>apart</td><td>appear</td><td>appreciate</td></tr><tr><td scope="row">appropriate</td><td>are</td><td>aren't</td><td>around</td><td>as</td></tr><tr><td scope="row">aside</td><td>ask</td><td>asking</td><td>associated</td><td>at</td></tr><tr><td scope="row">available</td><td>away</td><td>awfully</td><td>be</td><td>became</td></tr><tr><td scope="row">because</td><td>become</td><td>becomes</td><td>becoming</td><td>been</td></tr><tr><td scope="row">before</td><td>beforehand</td><td>behind</td><td>being</td><td>believe</td></tr><tr><td scope="row">below</td><td>beside</td><td>besides</td><td>best</td><td>better</td></tr><tr><td scope="row">between</td><td>beyond</td><td>both</td><td>brief</td><td>but</td></tr><tr><td scope="row">by</td><td>c'mon</td><td>c's</td><td>came</td><td>can</td></tr><tr><td scope="row">can't</td><td>cannot</td><td>cant</td><td>cause</td><td>causes</td></tr><tr><td scope="row">certain</td><td>certainly</td><td>changes</td><td>clearly</td><td>co</td></tr><tr><td scope="row">com</td><td>come</td><td>comes</td><td>concerning</td><td>consequently</td></tr><tr><td scope="row">consider</td><td>considering</td><td>contain</td><td>containing</td><td>contains</td></tr><tr><td scope="row">corresponding</td><td>could</td><td>couldn't</td><td>course</td><td>currently</td></tr><tr><td scope="row">definitely</td><td>described</td><td>despite</td><td>did</td><td>didn't</td></tr><tr><td scope="row">different</td><td>do</td><td>does</td><td>doesn't</td><td>doing</td></tr><tr><td scope="row">don't</td><td>done</td><td>down</td><td>downwards</td><td>during</td></tr><tr><td scope="row">each</td><td>edu</td><td>eg</td><td>eight</td><td>either</td></tr><tr><td scope="row">else</td><td>elsewhere</td><td>enough</td><td>entirely</td><td>especially</td></tr><tr><td scope="row">et</td><td>etc</td><td>even</td><td>ever</td><td>every</td></tr><tr><td scope="row">everybody</td><td>everyone</td><td>everything</td><td>everywhere</td><td>ex</td></tr><tr><td scope="row">exactly</td><td>example</td><td>except</td><td>far</td><td>few</td></tr><tr><td scope="row">fifth</td><td>first</td><td>five</td><td>followed</td><td>following</td></tr><tr><td scope="row">follows</td><td>for</td><td>former</td><td>formerly</td><td>forth</td></tr><tr><td scope="row">four</td><td>from</td><td>further</td><td>furthermore</td><td>get</td></tr><tr><td scope="row">gets</td><td>getting</td><td>given</td><td>gives</td><td>go</td></tr><tr><td scope="row">goes</td><td>going</td><td>gone</td><td>got</td><td>gotten</td></tr><tr><td scope="row">greetings</td><td>had</td><td>hadn't</td><td>happens</td><td>hardly</td></tr><tr><td scope="row">has</td><td>hasn't</td><td>have</td><td>haven't</td><td>having</td></tr><tr><td scope="row">he</td><td>he's</td><td>hello</td><td>help</td><td>hence</td></tr><tr><td scope="row">her</td><td>here</td><td>here's</td><td>hereafter</td><td>hereby</td></tr><tr><td scope="row">herein</td><td>hereupon</td><td>hers</td><td>herself</td><td>hi</td></tr><tr><td scope="row">him</td><td>himself</td><td>his</td><td>hither</td><td>hopefully</td></tr><tr><td scope="row">how</td><td>howbeit</td><td>however</td><td>i'd</td><td>i'll</td></tr><tr><td scope="row">i'm</td><td>i've</td><td>ie</td><td>if</td><td>ignored</td></tr><tr><td scope="row">immediate</td><td>in</td><td>inasmuch</td><td>inc</td><td>indeed</td></tr><tr><td scope="row">indicate</td><td>indicated</td><td>indicates</td><td>inner</td><td>insofar</td></tr><tr><td scope="row">instead</td><td>into</td><td>inward</td><td>is</td><td>isn't</td></tr><tr><td scope="row">it</td><td>it'd</td><td>it'll</td><td>it's</td><td>its</td></tr><tr><td scope="row">itself</td><td>just</td><td>keep</td><td>keeps</td><td>kept</td></tr><tr><td scope="row">know</td><td>known</td><td>knows</td><td>last</td><td>lately</td></tr><tr><td scope="row">later</td><td>latter</td><td>latterly</td><td>least</td><td>less</td></tr><tr><td scope="row">lest</td><td>let</td><td>let's</td><td>like</td><td>liked</td></tr><tr><td scope="row">likely</td><td>little</td><td>look</td><td>looking</td><td>looks</td></tr><tr><td scope="row">ltd</td><td>mainly</td><td>many</td><td>may</td><td>maybe</td></tr><tr><td scope="row">me</td><td>mean</td><td>meanwhile</td><td>merely</td><td>might</td></tr><tr><td scope="row">more</td><td>moreover</td><td>most</td><td>mostly</td><td>much</td></tr><tr><td scope="row">must</td><td>my</td><td>myself</td><td>name</td><td>namely</td></tr><tr><td scope="row">nd</td><td>near</td><td>nearly</td><td>necessary</td><td>need</td></tr><tr><td scope="row">needs</td><td>neither</td><td>never</td><td>nevertheless</td><td>new</td></tr><tr><td scope="row">next</td><td>nine</td><td>no</td><td>nobody</td><td>non</td></tr><tr><td scope="row">none</td><td>noone</td><td>nor</td><td>normally</td><td>not</td></tr><tr><td scope="row">nothing</td><td>novel</td><td>now</td><td>nowhere</td><td>obviously</td></tr><tr><td scope="row">of</td><td>off</td><td>often</td><td>oh</td><td>ok</td></tr><tr><td scope="row">okay</td><td>old</td><td>on</td><td>once</td><td>one</td></tr><tr><td scope="row">ones</td><td>only</td><td>onto</td><td>or</td><td>other</td></tr><tr><td scope="row">others</td><td>otherwise</td><td>ought</td><td>our</td><td>ours</td></tr><tr><td scope="row">ourselves</td><td>out</td><td>outside</td><td>over</td><td>overall</td></tr><tr><td scope="row">own</td><td>particular</td><td>particularly</td><td>per</td><td>perhaps</td></tr><tr><td scope="row">placed</td><td>please</td><td>plus</td><td>possible</td><td>presumably</td></tr><tr><td scope="row">probably</td><td>provides</td><td>que</td><td>quite</td><td>qv</td></tr><tr><td scope="row">rather</td><td>rd</td><td>re</td><td>really</td><td>reasonably</td></tr><tr><td scope="row">regarding</td><td>regardless</td><td>regards</td><td>relatively</td><td>respectively</td></tr><tr><td scope="row">right</td><td>said</td><td>same</td><td>saw</td><td>say</td></tr><tr><td scope="row">saying</td><td>says</td><td>second</td><td>secondly</td><td>see</td></tr><tr><td scope="row">seeing</td><td>seem</td><td>seemed</td><td>seeming</td><td>seems</td></tr><tr><td scope="row">seen</td><td>self</td><td>selves</td><td>sensible</td><td>sent</td></tr><tr><td scope="row">serious</td><td>seriously</td><td>seven</td><td>several</td><td>shall</td></tr><tr><td scope="row">she</td><td>should</td><td>shouldn't</td><td>since</td><td>six</td></tr><tr><td scope="row">so</td><td>some</td><td>somebody</td><td>somehow</td><td>someone</td></tr><tr><td scope="row">something</td><td>sometime</td><td>sometimes</td><td>somewhat</td><td>somewhere</td></tr><tr><td scope="row">soon</td><td>sorry</td><td>specified</td><td>specify</td><td>specifying</td></tr><tr><td scope="row">still</td><td>sub</td><td>such</td><td>sup</td><td>sure</td></tr><tr><td scope="row">t's</td><td>take</td><td>taken</td><td>tell</td><td>tends</td></tr><tr><td scope="row">th</td><td>than</td><td>thank</td><td>thanks</td><td>thanx</td></tr><tr><td scope="row">that</td><td>that's</td><td>thats</td><td>the</td><td>their</td></tr><tr><td scope="row">theirs</td><td>them</td><td>themselves</td><td>then</td><td>thence</td></tr><tr><td scope="row">there</td><td>there's</td><td>thereafter</td><td>thereby</td><td>therefore</td></tr><tr><td scope="row">therein</td><td>theres</td><td>thereupon</td><td>these</td><td>they</td></tr><tr><td scope="row">they'd</td><td>they'll</td><td>they're</td><td>they've</td><td>think</td></tr><tr><td scope="row">third</td><td>this</td><td>thorough</td><td>thoroughly</td><td>those</td></tr><tr><td scope="row">though</td><td>three</td><td>through</td><td>throughout</td><td>thru</td></tr><tr><td scope="row">thus</td><td>to</td><td>together</td><td>too</td><td>took</td></tr><tr><td scope="row">toward</td><td>towards</td><td>tried</td><td>tries</td><td>truly</td></tr><tr><td scope="row">try</td><td>trying</td><td>twice</td><td>two</td><td>un</td></tr><tr><td scope="row">under</td><td>unfortunately</td><td>unless</td><td>unlikely</td><td>until</td></tr><tr><td scope="row">unto</td><td>up</td><td>upon</td><td>us</td><td>use</td></tr><tr><td scope="row">used</td><td>useful</td><td>uses</td><td>using</td><td>usually</td></tr><tr><td scope="row">value</td><td>various</td><td>very</td><td>via</td><td>viz</td></tr><tr><td scope="row">vs</td><td>want</td><td>wants</td><td>was</td><td>wasn't</td></tr><tr><td scope="row">way</td><td>we</td><td>we'd</td><td>we'll</td><td>we're</td></tr><tr><td scope="row">we've</td><td>welcome</td><td>well</td><td>went</td><td>were</td></tr><tr><td scope="row">weren't</td><td>what</td><td>what's</td><td>whatever</td><td>when</td></tr><tr><td scope="row">whence</td><td>whenever</td><td>where</td><td>where's</td><td>whereafter</td></tr><tr><td scope="row">whereas</td><td>whereby</td><td>wherein</td><td>whereupon</td><td>wherever</td></tr><tr><td scope="row">whether</td><td>which</td><td>while</td><td>whither</td><td>who</td></tr><tr><td scope="row">who's</td><td>whoever</td><td>whole</td><td>whom</td><td>whose</td></tr><tr><td scope="row">why</td><td>will</td><td>willing</td><td>wish</td><td>with</td></tr><tr><td scope="row">within</td><td>without</td><td>won't</td><td>wonder</td><td>would</td></tr><tr><td scope="row">wouldn't</td><td>yes</td><td>yet</td><td>you</td><td>you'd</td></tr><tr><td scope="row">you'll</td><td>you're</td><td>you've</td><td>your</td><td>yours</td></tr><tr><td scope="row">yourself</td><td>yourselves</td><td>zero</td><td> </td><td> </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-restrictions"></a>12.9.5 全文制限</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            全文検索は、<code class="literal">InnoDB</code> および <code class="literal">MyISAM</code> テーブルでのみサポートされています。<code class="literal">InnoDB</code> テーブルで <code class="literal">FULLTEXT</code> インデックスがサポートされるようにするには、MySQL 5.6.4 以上が必要です。
          </p></li><li class="listitem"><p>
            パーティション化されたテーブルでは、全文検索がサポートされていません。<a class="xref" href="partitioning.html#partitioning-limitations" title="19.6 パーティショニングの制約と制限">セクション19.6「パーティショニングの制約と制限」</a>を参照してください。
          </p></li><li class="listitem"><p>
            全文検索は、ほとんどのマルチバイト文字セットで使用できます。例外として、Unicode では、<code class="literal">utf8</code> 文字セットは使用できますが、<code class="literal">ucs2</code> 文字セットは使用できません。<code class="literal">ucs2</code> カラム上では <code class="literal">FULLTEXT</code> インデックスを使用できませんが、このようなインデックスが含まれない <code class="literal">ucs2</code> 上で <code class="literal">IN BOOLEAN MODE</code> 検索を実行することはできます。
          </p><p>
            <code class="literal">utf8</code> に関する備考は <code class="literal">utf8mb4</code> にも適用され、<code class="literal">ucs2</code> に関する備考は <code class="literal">utf16</code>、<code class="literal">utf16le</code>、および <code class="literal">utf32</code> にも適用されます。
          </p></li><li class="listitem"><p>
            中国語や日本語のような表意文字を使用する言語には、単語の区切り文字がありません。したがって、<code class="literal">FULLTEXT</code> パーサーでは、<span class="emphasis"><em>このような言語で単語の初めと終わりを特定できません</em></span>。この意味および問題の一部の回避策については、<a class="xref" href="functions.html#fulltext-search" title="12.9 全文検索関数">セクション12.9「全文検索関数」</a>で説明されています。
          </p></li><li class="listitem"><p>
            単一テーブル内で複数の文字セットを使用することはサポートされていますが、<code class="literal">FULLTEXT</code> インデックス内のすべてのカラムで同じ文字セットおよび照合順序が使用される必要があります。
          </p></li><li class="listitem"><p>
            <code class="literal">MATCH()</code> カラムリストは、この <code class="literal">MATCH()</code> が <code class="literal">MyISAM</code> テーブル上の <code class="literal">IN BOOLEAN MODE</code> である場合を除いて、テーブルの一部の <code class="literal">FULLTEXT</code> インデックス定義に含まれるカラムリストに完全に一致する必要があります。<code class="literal">MyISAM</code> テーブルでは、インデックスが付いていないカラムでもブールモード検索を実行できます。ただし、検索が遅くなる可能性があります。
          </p></li><li class="listitem"><p>
            <code class="literal">AGAINST()</code> への引数は、クエリー評価時に定数である文字列値にする必要があります。たとえば、テーブルカラムは、行ごとに異なる可能性があるため除外されます。
          </p></li><li class="listitem"><p>
            <code class="literal">FULLTEXT</code> 以外の検索の場合よりも <code class="literal">FULLTEXT</code> 検索の場合の方が、インデックスヒントに対する制限が多くなります。<a class="xref" href="sql-syntax.html#index-hints" title="13.2.9.3 インデックスヒントの構文">セクション13.2.9.3「インデックスヒントの構文」</a>を参照してください。
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> では、全文インデックスを含むカラムを必要とするすべての DML 演算子 (<code class="literal">INSERT</code>、<code class="literal">UPDATE</code>、<code class="literal">DELETE</code>) は、トランザクションのコミット時に処理されます。たとえば、<code class="literal">INSERT</code> 演算では、挿入された文字列がトークン化され、個々の単語に分解されます。その後、個々の単語は、トランザクションのコミット時に全文インデックステーブルに追加されます。その結果、全文検索ではコミットされたデータのみが返されます。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="fulltext-fine-tuning"></a>12.9.6 MySQL の全文検索の微調整</h3></div></div></div><p>
        MySQL の全文検索機能には、ユーザーが調整できるパラメータがほとんどありません。一部の変更でソースコードを変更する必要があるために、MySQL ソース配布を持っている場合は、全文検索の動作をさらに制御できます。<a class="xref" href="installing.html#source-installation" title="2.9 ソースから MySQL をインストールする">セクション2.9「ソースから MySQL をインストールする」</a>を参照してください。
      </p><p>
        全文検索の有効性は、慎重に調整されます。ほとんど場合、デフォルトの動作を変更すると、実際には有効性が低くなる可能性があります。<span class="emphasis"><em>使用方法を理解していない場合は、MySQL ソースは変更しないでください</em></span>。
      </p><p>
        このセクションで説明するほとんどの全文変数は、サーバーの起動時に設定する必要があります。変更するには、サーバーの再起動が必要です。サーバーが動作しているときは、変更できません。
      </p><p>
        一部の変数を変更するには、テーブル内の <code class="literal">FULLTEXT</code> インデックスを再構築する必要があります。これを行う手順については、このセクションの後半で説明します。
      </p><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-word-length"></a>単語の最小長と最大長の構成</h4></div></div></div><p>
          インデックスが付けられる単語の最小長および最大長は、<code class="literal">InnoDB</code> 検索インデックスの場合は <code class="literal">innodb_ft_min_token_size</code> および <code class="literal">innodb_ft_max_token_size</code>、<code class="literal">MyISAM</code> 検索インデックスの場合は <code class="literal">ft_min_word_len</code> および <code class="literal">ft_max_word_len</code> で定義されます。これらのオプションのいずれかを変更したら、変更を有効にするために <code class="literal">FULLTEXT</code> インデックスを再構築してください。たとえば、2 文字の単語を検索可能にするには、オプションファイルに次の行を配置します。
        </p><pre class="programlisting">[mysqld]
innodb_ft_min_token_size=2
ft_min_word_len=2</pre><p>
          次に、サーバーを再起動し、<code class="literal">FULLTEXT</code> インデックスを再構築します。<code class="literal">MyISAM</code> テーブルについては、<code class="literal">MyISAM</code> の全文インデックスを再構築する際に従う手順で、<span class="command"><strong>myisamchk</strong></span> に関する備考に注意してください。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-natural-language-threshold"></a>自然言語検索のしきい値の構成</h4></div></div></div><p>
          <code class="literal">MyISAM</code> 検索インデックスでは、選択された特定の重み付けスキームによって、自然言語検索で 50% のしきい値が決定されます。これを無効にするには、<code class="filename">storage/myisam/ftdefs.h</code> で次の行を検索してください。
        </p><pre class="programlisting">
#define GWS_IN_USE GWS_PROB
</pre><p>
          この行を次のように変更します。
        </p><pre class="programlisting">
#define GWS_IN_USE GWS_FREQ
</pre><p>
          次に、MySQL を再コンパイルします。この場合、インデックスを再構築する必要はありません。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            このように変更すると、<code class="literal">MATCH()</code> 関数に適切な関連性値を提供する MySQL の能力が<span class="emphasis"><em>大幅に</em></span>低下します。このような一般的な単語を検索する必要がある場合は、代わりに、50% のしきい値に従わない <code class="literal">IN BOOLEAN MODE</code> を使用して検索する方が適切です。
          </p></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-modify-boolean-operators"></a>ブール全文検索演算子の変更</h4></div></div></div><p>
          <code class="literal">MyISAM</code> テーブル上でブール全文検索に使用される演算子を変更するには、<code class="literal">ft_boolean_syntax</code> システム変数を設定します。(<code class="literal">InnoDB</code> には同等の設定がありません。)この変数はサーバーの実行中に変更できますが、そのためには <code class="literal">SUPER</code> 権限を持っている必要があります。この場合は、インデックスを再構築する必要はありません。この変数を設定する方法を制御するルールについては、<a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 サーバーシステム変数">セクション5.1.4「サーバーシステム変数」</a>を参照してください。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-modify-character-set"></a>文字セットの変更</h4></div></div></div><p>
          次のリストで説明するように、単語文字とみなされる文字セットは複数の方法で変更できます。変更が完了したら、任意の <code class="literal">FULLTEXT</code> インデックスを含むテーブルごとにインデックスを再構築します。ハイフン文字 (' - ') を単語文字として処理すると仮定します。次の方法のいずれかを使用します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              MySQL ソースを変更します。<code class="filename">storage/innobase/handler/ha_innodb.cc</code> (<code class="literal">InnoDB</code> の場合) または <code class="filename">storage/myisam/ftdefs.h</code> (<code class="literal">MyISAM</code> の場合) で、<code class="literal">true_word_char()</code> および <code class="literal">misc_word_char()</code> マクロを参照してください。それらのマクロのいずれかに <code class="literal">'-'</code> を追加し、MySQL を再コンパイルします。
            </p></li><li class="listitem"><p>
              文字セットファイルを変更します。再コンパイルする必要はありません。<code class="literal">true_word_char()</code> マクロでは、英数字とその他の文字を区別するために <span class="quote">「<span class="quote">character type</span>」</span> テーブルが使用されます。文字セット XML ファイルのいずれかで <code class="literal">&lt;ctype&gt;&lt;map&gt;</code> 配列の内容を編集すると、<code class="literal">'-'</code> が<span class="quote">「<span class="quote">英字</span>」</span>になるように指定できます。次に、<code class="literal">FULLTEXT</code> インデックスに指定された文字セットを使用します。<code class="literal">&lt;ctype&gt;&lt;map&gt;</code> 配列の書式については、<a class="xref" href="globalization.html#character-arrays" title="10.3.1 文字定義配列">セクション10.3.1「文字定義配列」</a>を参照してください。
            </p></li><li class="listitem"><p>
              インデックス付きのカラムで使用される文字セットに新しい照合順序を追加し、その照合順序が使用されるようにカラムを変更します。照合順序の追加に関する一般的な情報については、<a class="xref" href="globalization.html#adding-collation" title="10.4 文字セットへの照合順序の追加">セクション10.4「文字セットへの照合順序の追加」</a>を参照してください。全文インデックス作成に固有の例については、<a class="xref" href="functions.html#full-text-adding-collation" title="12.9.7 全文インデックス作成用の照合順序の追加">セクション12.9.7「全文インデックス作成用の照合順序の追加」</a>を参照してください。
            </p></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-rebuild-innodb-indexes"></a>InnoDB 全文インデックスの再構築</h4></div></div></div><p>
          インデックス作成に影響を与える全文変数 (<code class="literal">innodb_ft_min_token_size</code>、<code class="literal">innodb_ft_max_token_size</code>、<code class="literal">innodb_ft_server_stopword_table</code>、<code class="literal">innodb_ft_user_stopword_table</code>、<code class="literal">innodb_ft_enable_stopword</code>) を変更する場合は、変更したあとに <code class="literal">FULLTEXT</code> インデックスを再構築する必要があります。<code class="literal">innodb_ft_min_token_size</code> および <code class="literal">innodb_ft_max_token_size</code> 変数は動的に設定できないため、変更するにはサーバーを再起動し、インデックスを再構築する必要があります。
        </p><p>
          <code class="literal">InnoDB</code> テーブルの <code class="literal">FULLTEXT </code> インデックスを再構築するには、<code class="literal">DROP INDEX</code> および <code class="literal">ADD INDEX</code> オプションを付けて <code class="literal">ALTER TABLE</code> を使用して、各インデックスを削除してから再作成します。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-optimize"></a>InnoDB 全文インデックスの最適化</h4></div></div></div><p>
          全文インデックス付きのテーブル上で <code class="literal">OPTIMIZE TABLE</code> を実行すると、全文インデックスが再構築され、削除済みのドキュメント ID が削除され、同じ単語に対応する複数のエントリが連結されます (可能な場合)。
        </p><p>
          全文インデックスを最適化するには、<code class="literal">innodb_optimize_fulltext_only</code> を有効にして、<code class="literal">OPTIMIZE TABLE</code> を実行します。
        </p><pre class="programlisting">mysql&gt; set GLOBAL innodb_optimize_fulltext_only=ON;
Query OK, 0 rows affected (0.01 sec)

mysql&gt; OPTIMIZE TABLE opening_lines;
+--------------------+----------+----------+----------+
| Table              | Op       | Msg_type | Msg_text |
+--------------------+----------+----------+----------+
| test.opening_lines | optimize | status   | OK       |
+--------------------+----------+----------+----------+
1 row in set (0.01 sec)    </pre><p>
          大きなテーブルで全文インデックスの再構築時間が長くなることを回避するには、<code class="literal">innodb_ft_num_word_optimize</code> オプションを使用すれば、最適化を段階的に実行できます。<code class="literal">innodb_ft_num_word_optimize</code> オプションでは、<code class="literal">OPTIMIZE TABLE</code> が実行されるたびに最適化される単語の数が定義されます。デフォルト設定は 2000 です。これは、<code class="literal">OPTIMIZE TABLE</code> が実行されるたびに 2000 個の単語が最適化されることを表します。後続の <code class="literal">OPTIMIZE TABLE</code> 演算は、先行する <code class="literal">OPTIMIZE TABLE</code> 演算が終了した場所から続行されます。
        </p></div><div class="simplesect"><div class="titlepage"><div><div><h4 class="title"><a name="fulltext-rebuild-myisam-indexes"></a>MyISAM 全文インデックスの再構築</h4></div></div></div><p>
          インデックス作成に影響を与える全文変数 (<code class="literal">ft_min_word_len</code>、<code class="literal">ft_max_word_len</code>、または <code class="literal">ft_stopword_file</code>) を変更する場合や、ストップワードファイル自体を変更する場合は、変更して、サーバーを再起動したあとに、<code class="literal">FULLTEXT</code> インデックスを再構築する必要があります。
        </p><p>
          <code class="literal">MyISAM</code> テーブルの <code class="literal">FULLTEXT</code> インデックスを再構築するには、<code class="literal">QUICK</code> 修復演算を実行すれば十分です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>REPAIR TABLE <em class="replaceable"><code>tbl_name</code></em> QUICK;</code></strong>
</pre><p>
          または、先ほど説明した <code class="literal">ALTER TABLE</code> を使用します。これは、修復演算よりも高速になる可能性もあります。
        </p><p>
          任意の <code class="literal">FULLTEXT</code> インデックスを含む各テーブルは、上記のように修復する必要があります。それ以外の場合は、テーブルのクエリーで不正な結果が生成される可能性があり、テーブルを変更すると、サーバーでは、テーブルが破損していて修復が必要であるとみなされます。
        </p><p>
          <span class="command"><strong>myisamchk</strong></span> を使用して、<code class="literal">MyISAM</code> テーブルインデックスを変更する演算 (修復や分析など) を実行する場合は、ほかに指定がなければ、単語の最小長、単語の最大長、およびストップワードファイルの<span class="emphasis"><em>デフォルト</em></span>の全文パラメータ値を使用して、<code class="literal">FULLTEXT</code> インデックスが再構築されます。これにより、クエリーに失敗する可能性があります。
        </p><p>
          この問題は、これらのパラメータがサーバーでのみ認識されていることが原因で発生します。<code class="literal">MyISAM</code> インデックスファイルには格納されていません。サーバーで使用される単語の最小長や最大長、またはストップワードファイルの値を変更した場合の問題を回避するには、<span class="command"><strong>mysqld</strong></span> で使用される <span class="command"><strong>myisamchk</strong></span> と同じ <code class="literal">ft_min_word_len</code>、<code class="literal">ft_max_word_len</code>、および <code class="literal">ft_stopword_file</code> 値を指定します。たとえば、単語の最小長を 3 に設定した場合は、次のように <span class="command"><strong>myisamchk</strong></span> を使用してテーブルを修復できます。
        </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>myisamchk --recover --ft_min_word_len=3 <em class="replaceable"><code>tbl_name</code></em>.MYI</code></strong>
</pre><p>
          <span class="command"><strong>myisamchk</strong></span> およびサーバーで全文パラメータに必ず同じ値が使用されるようにするには、オプションファイルの <code class="literal">[mysqld]</code> と <code class="literal">[myisamchk]</code> の両方のセクションにそれぞれを配置してください。
        </p><pre class="programlisting">
[mysqld]
ft_min_word_len=3

[myisamchk]
ft_min_word_len=3
</pre><p>
          <code class="literal">MyISAM</code> テーブルインデックスの変更に <span class="command"><strong>myisamchk</strong></span> を使用する方法の代替として、<code class="literal">REPAIR TABLE</code>、<code class="literal">ANALYZE TABLE</code>、<code class="literal">OPTIMIZE TABLE</code>、または <code class="literal">ALTER TABLE</code> ステートメントを使用します。これらのステートメントは、適切に使用される全文パラメータ値が認識されているサーバーで実行されます。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="full-text-adding-collation"></a>12.9.7 全文インデックス作成用の照合順序の追加</h3></div></div></div><p>
        このセクションでは、全文検索用に新しい照合順序を追加する方法について説明します。サンプルの照合順序は <code class="literal">latin1_swedish_ci</code> と似ていますが、<code class="literal">'-'</code> 文字は、単語文字としてインデックスを付けることができるように、句読文字としてではなく英字として処理されます。照合順序の追加に関する一般的な情報については、<a class="xref" href="globalization.html#adding-collation" title="10.4 文字セットへの照合順序の追加">セクション10.4「文字セットへの照合順序の追加」</a>で説明されています。この情報を参照し、関与するファイルをよく理解することが前提となっています。
      </p><p>
        全文インデックス作成用に照合順序を追加するには、次の手順を使用します。
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            照合順序を <code class="filename">Index.xml</code> ファイルに追加します。照合順序 ID は未使用にする必要があるため、その ID がすでにシステムで取得されている場合は、1000 以外の値を選択してください。
          </p><pre class="programlisting">
&lt;charset name="latin1"&gt;
...
&lt;collation name="latin1_fulltext_ci" id="1000"/&gt;
&lt;/charset&gt;
</pre></li><li class="listitem"><p>
            <code class="filename">latin1.xml</code> ファイルで照合順序のソート順序を宣言します。この場合、<code class="literal">latin1_swedish_ci</code> から順序をコピーできます。
          </p><pre class="programlisting">
&lt;collation name="latin1_fulltext_ci"&gt;
&lt;map&gt;
00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F
30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F
40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F
60 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
50 51 52 53 54 55 56 57 58 59 5A 7B 7C 7D 7E 7F
80 81 82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F
90 91 92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F
A0 A1 A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF
B0 B1 B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF
41 41 41 41 5C 5B 5C 43 45 45 45 45 49 49 49 49
44 4E 4F 4F 4F 4F 5D D7 D8 55 55 55 59 59 DE DF
41 41 41 41 5C 5B 5C 43 45 45 45 45 49 49 49 49
44 4E 4F 4F 4F 4F 5D F7 D8 55 55 55 59 59 DE FF
&lt;/map&gt;
&lt;/collation&gt;
</pre></li><li class="listitem"><p>
            <code class="filename">latin1.xml</code> で <code class="literal">ctype</code> 配列を変更します。0x2D (<code class="literal">'-'</code> 文字のコード) に対応する値を 10 (句読点) から 01 (小文字) に変更します。次の配列では、これは 4 行目の要素で、最後から 3 番目の値です。
          </p><pre class="programlisting">
&lt;ctype&gt;
&lt;map&gt;
00
20 20 20 20 20 20 20 20 20 28 28 28 28 28 20 20
20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
48 10 10 10 10 10 10 10 10 10 10 10 10 <span class="bold"><strong>01</strong></span> 10 10
84 84 84 84 84 84 84 84 84 84 10 10 10 10 10 10
10 81 81 81 81 81 81 01 01 01 01 01 01 01 01 01
01 01 01 01 01 01 01 01 01 01 01 10 10 10 10 10
10 82 82 82 82 82 82 02 02 02 02 02 02 02 02 02
02 02 02 02 02 02 02 02 02 02 02 10 10 10 10 20
10 00 10 02 10 10 10 10 10 10 01 10 01 00 01 00
00 10 10 10 10 10 10 10 10 10 02 10 02 00 02 01
48 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01
01 01 01 01 01 01 01 10 01 01 01 01 01 01 01 02
02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02
02 02 02 02 02 02 02 10 02 02 02 02 02 02 02 02
&lt;/map&gt;
&lt;/ctype&gt;
</pre></li><li class="listitem"><p>
            サーバーを再起動します。
          </p></li><li class="listitem"><p>
            新しい照合順序を使用するには、使用されるカラムの定義に追加します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS t1;</code></strong>
Query OK, 0 rows affected (0.13 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
    <strong class="userinput"><code>a TEXT CHARACTER SET latin1 COLLATE latin1_fulltext_ci,</code></strong>
    <strong class="userinput"><code>FULLTEXT INDEX(a)</code></strong>
    <strong class="userinput"><code>) ENGINE=InnoDB;</code></strong>
Query OK, 0 rows affected (0.47 sec)
</pre></li><li class="listitem"><p>
            照合順序をテストして、ハイフンが単語文字としてみなされることを確認します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUEs ('----'),('....'),('abcd');</code></strong>
Query OK, 3 rows affected (0.22 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 WHERE MATCH a AGAINST ('----' IN BOOLEAN MODE);</code></strong>
+------+
| a    |
+------+
| ---- |
+------+
1 row in set (0.00 sec)
</pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cast-functions"></a>12.10 キャスト関数と演算子</h2></div></div></div><a class="indexterm" name="idm139979094574272"></a><a class="indexterm" name="idm139979094572848"></a><a class="indexterm" name="idm139979094571488"></a><a class="indexterm" name="idm139979094569456"></a><a class="indexterm" name="idm139979094568096"></a><div class="table"><a name="idm139979094566064"></a><p class="title"><b>表 12.14 キャスト関数</b></p><div class="table-contents"><table summary="キャスト関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></td><td>
      文字列をバイナリ文字列にキャストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a></td><td>
      値を特定の型としてキャストします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a></td><td>
      値を特定の型としてキャストします
    </td></tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_binary"></a><p>
          <a class="indexterm" name="idm139979094554208"></a> <code class="literal">BINARY</code>
        </p><p>
          <code class="literal">BINARY</code> 演算子は、それに続く文字列をバイナリ文字列にキャストします。これは、カラムの比較を文字ごとでなく、バイトごとに強制的に実行させる簡単な方法です。これにより、カラムが <code class="literal">BINARY</code> または <code class="literal">BLOB</code> として定義されていない場合でも、比較で大文字と小文字が区別されます。また、<code class="literal">BINARY</code> では末尾の空白文字が重要になります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 'a' = 'A';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT BINARY 'a' = 'A';</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 'a' = 'a ';</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT BINARY 'a' = 'a ';</code></strong>
        -&gt; 0
</pre><p>
          比較時に、<code class="literal">BINARY</code> によって演算全体が影響を受けます。これは、同じ結果を持ついずれかのオペランドの前に指定できます。
        </p><p>
          <code class="literal">BINARY <em class="replaceable"><code>str</code></em></code> は、<code class="literal">CAST(<em class="replaceable"><code>str</code></em> AS BINARY)</code> の略です。
        </p><p>
          一部のコンテキストでは、インデックス付きのカラムを <code class="literal">BINARY</code> にキャストすると、MySQL はインデックスを効率的に使用できなくなります。
        </p></li><li class="listitem"><a name="function_cast"></a><p>
          <a class="indexterm" name="idm139979094530752"></a> <code class="literal">CAST(<em class="replaceable"><code>expr</code></em> AS <em class="replaceable"><code>type</code></em>)</code>
        </p><p>
          <code class="literal">CONVERT()</code> と同様に、<code class="literal">CAST()</code> 関数には任意の型の式が指定され、指定された型の結果値が生成されます。詳細は、<code class="literal">CONVERT()</code> の説明を参照してください。
        </p></li><li class="listitem"><a name="function_convert"></a><p>
          <a class="indexterm" name="idm139979094519056"></a> <code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>type</code></em>)</code>, <code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em> USING <em class="replaceable"><code>transcoding_name</code></em>)</code>
        </p><p>
          <code class="literal">CONVERT()</code> および <code class="literal">CAST()</code> 関数には、任意の型の式が指定され、指定された型の結果値が生成されます。
        </p><p>
          結果の <em class="replaceable"><code>type</code></em> には、次の値のいずれかを指定できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">BINARY[(<em class="replaceable"><code>N</code></em>)]</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CHAR[(<em class="replaceable"><code>N</code></em>)]</code>
            </p></li><li class="listitem"><p>
              <code class="literal">DATE</code>
            </p></li><li class="listitem"><p>
              <code class="literal">DATETIME</code>
            </p></li><li class="listitem"><p>
              <code class="literal">DECIMAL[(<em class="replaceable"><code>M</code></em>[,<em class="replaceable"><code>D</code></em>])]</code>
            </p></li><li class="listitem"><p>
              <code class="literal">SIGNED [INTEGER]</code>
            </p></li><li class="listitem"><p>
              <code class="literal">TIME</code>
            </p></li><li class="listitem"><p>
              <code class="literal">UNSIGNED [INTEGER]</code>
            </p></li></ul></div><p>
          <code class="literal">BINARY</code> は、<code class="literal">BINARY</code> データ型の文字列を生成します。これによる比較への影響度については、<a class="xref" href="data-types.html#binary-varbinary" title="11.4.2 BINARY および VARBINARY 型">セクション11.4.2「BINARY および VARBINARY 型」</a>を参照してください。オプションの長さ <em class="replaceable"><code>N</code></em> が指定されている場合に、<code class="literal">BINARY(<em class="replaceable"><code>N</code></em>)</code> を使用すると、キャストで <em class="replaceable"><code>N</code></em> バイトの引数しか使用されなくなります。値が <em class="replaceable"><code>N</code></em> バイトよりも短い場合は、<em class="replaceable"><code>N</code></em> の長さになるまで <code class="literal">0x00</code> バイトでパディングされます。
        </p><p>
          <code class="literal">CHAR(<em class="replaceable"><code>N</code></em>)</code> 句を使用すると、キャストで <em class="replaceable"><code>N</code></em> 文字の引数しか使用されなくなります。
        </p><p>
          <code class="literal">CAST()</code> および <code class="literal">CONVERT(... USING ...)</code> は標準 SQL の構文です。<code class="literal">USING</code> 形式以外の <code class="literal">CONVERT()</code> は ODBC の構文です。
        </p><p>
          <code class="literal">USING</code> とともに <code class="literal">CONVERT()</code> を使用すると、さまざまな文字セット間でデータが変換されます。MySQL では、トランスコーディング名は対応する文字セット名と同じです。たとえば、このステートメントは、デフォルトの文字セットの文字列 <code class="literal">'abc'</code> を <code class="literal">utf8</code> 文字セットの対応する文字列に変換します。
        </p><pre class="programlisting">
SELECT CONVERT('abc' USING utf8);
</pre></li></ul></div><p>
      バイナリ文字列には文字セットがなく、大文字と小文字の区別の概念もないため、通常は、大文字と小文字が区別されない方法で、<code class="literal">BLOB</code> 値またはその他のバイナリ文字列を比較できません。大文字と小文字が区別されない比較を実行するには、<code class="literal">CONVERT()</code> 関数を使用して、値を非バイナリ文字列に変換します。結果の比較には、文字列照合順序が使用されます。たとえば、結果の文字セットに大文字と小文字が区別されない照合順序が含まれる場合は、<code class="literal">LIKE</code> 演算子でも大文字と小文字が区別されません。
    </p><pre class="programlisting">
SELECT 'A' LIKE CONVERT(<em class="replaceable"><code>blob_col</code></em> USING latin1) FROM <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
      別の文字セットを使用するには、上記のステートメントの <code class="literal">latin1</code> にその名前を代入します。変換された文字列用に特定の照合順序を指定するには、<a class="xref" href="globalization.html#charset-convert" title="10.1.9.2 CONVERT() と CAST()">セクション10.1.9.2「CONVERT() と CAST()」</a>で説明するように、<code class="literal">CONVERT()</code> の呼び出しのあとに <code class="literal">COLLATE</code> 句を使用します。たとえば、<code class="literal">latin1_german1_ci</code> を使用する場合は次のとおりです。
    </p><pre class="programlisting">
SELECT 'A' LIKE CONVERT(<em class="replaceable"><code>blob_col</code></em> USING latin1) COLLATE latin1_german1_ci
  FROM <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
      <code class="literal">CONVERT()</code> は、さまざま文字セットで表される文字列を比較する際に、より一般的に使用できます。
    </p><p>
      <code class="literal">LOWER()</code> (および <code class="literal">UPPER()</code>) をバイナリ文字列 (<code class="literal">BINARY</code>、<code class="literal">VARBINARY</code>、<code class="literal">BLOB</code>) に適用しても、何の効果もありません。大文字/小文字の変換を実行するには、バイナリ文字列を非バイナリ文字列に変換します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @str = BINARY 'New York';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT LOWER(@str), LOWER(CONVERT(@str USING latin1));</code></strong>
+-------------+-----------------------------------+
| LOWER(@str) | LOWER(CONVERT(@str USING latin1)) |
+-------------+-----------------------------------+
| New York    | new york                          |
+-------------+-----------------------------------+
</pre><p>
      キャスト関数は、<code class="literal">CREATE TABLE ... SELECT</code> ステートメントで特定の型を持つカラムを作成する際に役立ちます。
    </p><pre class="programlisting">
CREATE TABLE new_table SELECT CAST('2000-01-01' AS DATE);
</pre><p>
      この関数は、<code class="literal">ENUM</code> カラムを語彙順にソートする際に役立つこともあります。通常、<code class="literal">ENUM</code> カラムのソートは、内部数値を使用して実行されます。値を <code class="literal">CHAR</code> にキャストすると、語彙順にソートされます。
    </p><pre class="programlisting">
SELECT <em class="replaceable"><code>enum_col</code></em> FROM <em class="replaceable"><code>tbl_name</code></em> ORDER BY CAST(<em class="replaceable"><code>enum_col</code></em> AS CHAR);
</pre><p>
      <code class="literal">CAST(<em class="replaceable"><code>str</code></em> AS BINARY)</code> は <code class="literal">BINARY <em class="replaceable"><code>str</code></em></code> と同じです。<code class="literal">CAST(<em class="replaceable"><code>expr</code></em> AS CHAR)</code> では、式はデフォルトの文字セットを持つ文字列として処理されます。
    </p><p>
      <code class="literal">CONCAT('Date: ',CAST(NOW() AS DATE))</code> のように、より複雑な式の一部として使用する場合でも、<code class="literal">CAST()</code> の結果が変わります。
    </p><p>
      データを別の書式で抽出するには、<code class="literal">CAST()</code> ではなく、代わりに <code class="literal">LEFT()</code> または <code class="literal">EXTRACT()</code> のような文字列関数を使用してください。<a class="xref" href="functions.html#date-and-time-functions" title="12.7 日付および時間関数">セクション12.7「日付および時間関数」</a>を参照してください。
    </p><p>
      数値のコンテキストで文字列を数値にキャストするには、通常は、文字列値を数字と同様に使用する以外には何もする必要はありません。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1+'1';</code></strong>
       -&gt; 2
</pre><p>
      算術演算で文字列を使用する場合は、式の評価時に浮動小数点数に変換されます。
    </p><p>
      文字列のコンテキストで数字を使用する場合は、自動的に数字が文字列に変換されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CONCAT('hello you ',2);</code></strong>
        -&gt; 'hello you 2'
</pre><p>
      MySQL 5.6.4 よりも前では、どのテーブルからも選択されないステートメントの <code class="literal">TIMESTAMP</code> 値で明示的に <code class="literal">CAST()</code> を使用すると、変換が実行される前に、その値が MySQL 5.6 で文字列として処理されます。これにより、値を数値型にキャストすると、次に示すように値が切り捨てられます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CAST(TIMESTAMP '2014-09-08 18:07:54' AS SIGNED);</code></strong>
+-------------------------------------------------+
| CAST(TIMESTAMP '2014-09-08 18:07:54' AS SIGNED) |
+-------------------------------------------------+
|                                            2014 |
+-------------------------------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+----------------------------------------------------------+
| Level   | Code | Message                                                  |
+---------+------+----------------------------------------------------------+
| Warning | 1292 | Truncated incorrect INTEGER value: '2014-09-08 18:07:54' |
+---------+------+----------------------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
      次に示すように、これはテーブルから行を選択するときには適用されません。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>USE test;</code></strong>

Database changed
mysql&gt; <strong class="userinput"><code>CREATE TABLE c_test (col TIMESTAMP);</code></strong>
Query OK, 0 rows affected (0.07 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO c_test VALUES ('2014-09-08 18:07:54');</code></strong>
Query OK, 1 row affected (0.05 sec)

mysql&gt; <strong class="userinput"><code>SELECT col, CAST(col AS UNSIGNED) AS c_col FROM c_test;</code></strong>
+---------------------+----------------+
| col                 | c_col          |
+---------------------+----------------+
| 2014-09-08 18:07:54 | 20140908180754 |
+---------------------+----------------+
1 row in set (0.00 sec)
</pre><p>
      MySQL 5.6.4 以降では、次に示すように、どの行も選択されていないクエリーでも、選択されている場合と同様に CAST() で TIMESTAMP 値が処理されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CAST(TIMESTAMP '2014-09-08 18:07:54' AS SIGNED);</code></strong>
+-------------------------------------------------+
| CAST(TIMESTAMP '2014-09-08 18:05:07' AS SIGNED) |
+-------------------------------------------------+
|                                  20140908180754 |
+-------------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
      数字から文字列への暗黙的な変換については、<a class="xref" href="functions.html#type-conversion" title="12.2 式評価での型変換">セクション12.2「式評価での型変換」</a>を参照してください。
    </p><p>
      MySQL では、符号付きと符号なしの両方の 64 ビット値を使用した演算がサポートされています。数値演算子 (<code class="literal">+</code> や <code class="literal">-</code> など) を使用していて、オペランドのいずれかが符号なし整数である場合は、デフォルトの結果が符号なしになります (<a class="xref" href="functions.html#arithmetic-functions" title="12.6.1 算術演算子">セクション12.6.1「算術演算子」</a>を参照してください)。これは、<code class="literal">SIGNED</code> または <code class="literal">UNSIGNED</code> キャスト演算子を使用して、値をそれぞれ符号付きまたは符号なしの 64 ビット整数にキャストすることでオーバーライドできます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CAST(1-2 AS UNSIGNED)</code></strong>
        -&gt; 18446744073709551615
mysql&gt; <strong class="userinput"><code>SELECT CAST(CAST(1-2 AS UNSIGNED) AS SIGNED);</code></strong>
        -&gt; -1
</pre><p>
      オペランドのいずれかが浮動小数点値である場合は、結果が浮動小数点値になり、上記のルールによる影響を受けません。(このコンテキストでは、<code class="literal">DECIMAL</code> カラム値は浮動小数点値とみなされます。)
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CAST(1 AS UNSIGNED) - 2.0;</code></strong>
        -&gt; -1.0
</pre><p>
      SQL モードは、変換演算の結果に影響を与えます。例:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="quote">「<span class="quote">zero</span>」</span> 日付文字列を日付に変換する場合、<code class="literal">CONVERT()</code> と <code class="literal">CAST()</code> は <code class="literal">NULL</code> を返し、<code class="literal">NO_ZERO_DATE</code> SQL モードが有効になると警告を発行します。
        </p></li><li class="listitem"><p>
          整数の減算では、<code class="literal">NO_UNSIGNED_SUBTRACTION</code> SQL モードが有効になっている場合は、オペランドのいずれかが符号なしでも、結果が符号付きになります。
        </p></li></ul></div><p>
      詳細は、<a class="xref" href="server-administration.html#sql-mode" title="5.1.7 サーバー SQL モード">セクション5.1.7「サーバー SQL モード」</a>を参照してください。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="xml-functions"></a>12.11 XML 関数</h2></div></div></div><div class="table"><a name="idm139979094390464"></a><p class="title"><b>表 12.15 XML 関数</b></p><div class="table-contents"><table summary="XML 関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a></td><td>
      XPath 表記法を使用して、XML
      文字列から値を抽出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a></td><td>
      置換後 XML フラグメントを返します
    </td></tr></tbody></table></div></div><br class="table-break"><p>
      このセクションでは、MySQL での XML および関連する機能について説明します。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        <code class="option">--xml</code> オプションを付けて呼び出すと、<span class="command"><strong>mysql</strong></span> および <span class="command"><strong>mysqldump</strong></span> クライアントで XML 書式の出力を MySQL から取得できます。<a class="xref" href="programs.html#mysql" title="4.5.1 mysql — MySQL コマンド行ツール">セクション4.5.1「<span class="command"><strong>mysql</strong></span> — MySQL コマンド行ツール」</a>および<a class="xref" href="programs.html#mysqldump" title="4.5.4 mysqldump — データベースバックアッププログラム">セクション4.5.4「<span class="command"><strong>mysqldump</strong></span> — データベースバックアッププログラム」</a>を参照してください。
      </p></div><p>
      基本的な XPath 1.0 (XML Path Language、バージョン 1.0) の機能を提供する 2 つの関数が使用可能です。XPath の構文および使用法に関する一部の基本情報については、このセクションの後半で提供しますが、このようなトピックの詳しい説明は、このマニュアルのスコープ外です。最終的な情報については、<a class="ulink" href="http://www.w3.org/TR/xpath" target="_top">「XML Path Language (XPath) 1.0 標準」</a>を参照してください。XPath がはじめてのユーザーや基本の復習を希望するユーザーに役立つリソースは、複数の言語で入手できる<a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top">「Zvon.org XPath Tutorial」</a>です。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        これらの関数はまだ開発中です。XML および XPath 機能のこれらの側面やその他の側面については、MySQL 5.6 以降で引き続き改善します。これらについて議論したり、質問したり、<a class="ulink" href="http://forums.mysql.com/list.php?44" target="_top">MySQL XML ユーザーフォーラム</a>でほかのユーザーからの支援を得たりすることもできます。
      </p></div><p>
      これらの関数で使用される XPath の式では、ユーザー変数およびローカルストアドプログラム変数がサポートされています。ユーザー変数は簡単にチェックされます。ストアドプログラムへのローカル変数は厳密にチェックされます (Bug#26518 も参照してください)。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b>ユーザー変数 (簡単なチェック) </b>
            構文 <code class="literal">$@<em class="replaceable"><code>variable_name</code></em></code> を使用する変数 (つまり、ユーザー変数) はチェックされません。変数の型が間違っている場合や、変数に値が事前に割り当てられていない場合でも、サーバーから警告やエラーが発行されません。これは、(たとえば) <code class="literal">$@myvariable</code> が使用されても警告が発行されないため (<code class="literal">$@myvariable</code> は故意に間違えたものです)、入力ミスについてはユーザーが全責任を負うことも意味します。
          </p><p>
          例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @xml = '&lt;a&gt;&lt;b&gt;X&lt;/b&gt;&lt;b&gt;Y&lt;/b&gt;&lt;/a&gt;';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @i =1, @j = 2;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @i, ExtractValue(@xml, '//b[$@i]');</code></strong>
+------+--------------------------------+
| @i   | ExtractValue(@xml, '//b[$@i]') |
+------+--------------------------------+
|    1 | X                              |
+------+--------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @j, ExtractValue(@xml, '//b[$@j]');</code></strong>
+------+--------------------------------+
| @j   | ExtractValue(@xml, '//b[$@j]') |
+------+--------------------------------+
|    2 | Y                              |
+------+--------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @k, ExtractValue(@xml, '//b[$@k]');</code></strong>
+------+--------------------------------+
| @k   | ExtractValue(@xml, '//b[$@k]') |
+------+--------------------------------+
| NULL |                                |
+------+--------------------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><p><b>ストアドプログラム内の変数 (厳密なチェック) </b>
            これらの関数をストアドプログラム内部で呼び出すときに、構文 <code class="literal">$<em class="replaceable"><code>variable_name</code></em></code> を使用する変数を宣言し、これらの関数で使用できます。このような変数は、定義されているストアドプログラムへのローカル変数であり、型および値について厳密にチェックされます。
          </p><p>
          例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DELIMITER |</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE myproc ()</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>DECLARE i INT DEFAULT 1;</code></strong>
    -&gt;   <strong class="userinput"><code>DECLARE xml VARCHAR(25) DEFAULT '&lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt;';</code></strong>
    -&gt;
    -&gt;   <strong class="userinput"><code>WHILE i &lt; 4 DO</code></strong>
    -&gt;     <strong class="userinput"><code>SELECT xml, i, ExtractValue(xml, '//a[$i]');</code></strong>
    -&gt;     <strong class="userinput"><code>SET i = i+1;</code></strong>
    -&gt;   <strong class="userinput"><code>END WHILE;</code></strong>
    -&gt; <strong class="userinput"><code>END |</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>DELIMITER ;</code></strong>

mysql&gt; <strong class="userinput"><code>CALL myproc();</code></strong>
+--------------------------+---+------------------------------+
| xml                      | i | ExtractValue(xml, '//a[$i]') |
+--------------------------+---+------------------------------+
| &lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt; | 1 | X                            |
+--------------------------+---+------------------------------+
1 row in set (0.00 sec)

+--------------------------+---+------------------------------+
| xml                      | i | ExtractValue(xml, '//a[$i]') |
+--------------------------+---+------------------------------+
| &lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt; | 2 | Y                            |
+--------------------------+---+------------------------------+
1 row in set (0.01 sec)

+--------------------------+---+------------------------------+
| xml                      | i | ExtractValue(xml, '//a[$i]') |
+--------------------------+---+------------------------------+
| &lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt; | 3 | Z                            |
+--------------------------+---+------------------------------+
1 row in set (0.01 sec)
</pre><p><b>パラメータ </b>
            ストアドルーチン内部の XPath 式で使用され、パラメータとして渡される変数も、厳密なチェックの対象です。
          </p></li></ul></div><p>
      ユーザー変数やストアドプログラムへのローカル変数を含む式は、その他の点 (表記法は除く) では、XPath 1.0 仕様で規定されている変数を含む XPath 式のルールに準拠する必要があります。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        現時点では、XPath 式の格納に使用されたユーザー変数は、空の文字列として処理されます。このため、ユーザー変数として XPath 式を格納することはできません。(Bug #32911)
      </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_extractvalue"></a><p>
          <a class="indexterm" name="idm139979094339248"></a> <code class="literal">ExtractValue(<em class="replaceable"><code>xml_frag</code></em>, <em class="replaceable"><code>xpath_expr</code></em>)</code>
        </p><p>
          <code class="literal">ExtractValue()</code> には、XML マークアップ <em class="replaceable"><code>xml_frag</code></em> のフラグメントと XPath 式 <em class="replaceable"><code>xpath_expr</code></em> (<em class="firstterm">locator</em> とも呼ばれます) の 2 つの文字列引数が指定され、要素の子または XPath 式で一致された要素である 1 番目のテキストノードのテキスト (<code class="literal">CDATA</code>) が返されます。MySQL 5.6.6 以前では、XPath 式に最大でも 127 文字しか含めることができませんでした。この制限は、MySQL 5.6.7 で解除されました。(Bug #13007062、Bug #62429)
        </p><p>
          この関数を使用することは、<code class="literal">/text()</code> を追加したあとに <em class="replaceable"><code>xpath_expr</code></em> を使用して一致を実行することと同等です。言い換えると、<code class="literal">ExtractValue('&lt;a&gt;&lt;b&gt;Sakila&lt;/b&gt;&lt;/a&gt;', '/a/b')</code> と <code class="literal">ExtractValue('&lt;a&gt;&lt;b&gt;Sakila&lt;/b&gt;&lt;/a&gt;', '/a/b/text()')</code> では同じ結果が生成されます。
        </p><p>
          複数の一致が見つかった場合は、一致する各要素の 1 番目の子テキストノードの内容が空白文字で区切られた単一文字列として (一致した順序で) 返されます。
        </p><p>
          式に一致するテキストノード (暗黙的な <code class="literal">/text()</code> を含む) が見つからない場合は、どのような理由でも、<em class="replaceable"><code>xpath_expr</code></em> が有効で、<em class="replaceable"><code>xml_frag</code></em> が適切にネストされ、閉じられた要素で構成されていれば、空の文字列が返されます。空の要素で一致することと、まったく一致しないこととは区別されません。これは意図的なものです。
        </p><p>
          <em class="replaceable"><code>xml_frag</code></em> で一致する要素が見つからなかったのか、またはこのような要素は見つかったが、子テキストノードが含まれていなかったのかを判断する必要がある場合は、XPath <code class="literal">count()</code> 関数を使用する式の結果をテストしてください。たとえば、次に示すように、これらのステートメントの両方で空の文字列が返されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', '/a/b');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', '/a/b') |
+-------------------------------------+
|                                     |
+-------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', '/a/b');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', '/a/b') |
+-------------------------------------+
|                                     |
+-------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          ただし、次のコマンドを使用すれば、実際に一致する要素があったかどうかを判断できます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', 'count(/a/b)');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', 'count(/a/b)') |
+-------------------------------------+
| 1                                   |
+-------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', 'count(/a/b)');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', 'count(/a/b)') |
+-------------------------------------+
| 0                                   |
+-------------------------------------+
1 row in set (0.01 sec)
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            <code class="literal">ExtractValue()</code> では <code class="literal">CDATA</code> のみが返され、一致するタグ内に含まれるタグや、それらの内容は返されません (次の例で、<code class="literal">val1</code> として返された結果を参照してください)。
          </p></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/a') AS val1,</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/a/b') AS val2,</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '//b') AS val3,</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/b') AS val4,</code></strong>
    -&gt; <strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;b&gt;eee&lt;/b&gt;&lt;/a&gt;', '//b') AS val5;</code></strong>

+------+------+------+------+---------+
| val1 | val2 | val3 | val4 | val5    |
+------+------+------+------+---------+
| ccc  | ddd  | ddd  |      | ddd eee |
+------+------+------+------+---------+
</pre><p>
          この関数では、<code class="literal">contains()</code> との比較を実行し、その他の文字列関数 (<code class="literal">CONCAT()</code> など) と同じ照合順序アグリゲーションを実行し、それらの引数の照合順序強制性を考慮に入れる際に、現在の SQL 照合順序が使用されます。この動作を制御するルールの説明については、<a class="xref" href="globalization.html#charset-collation-expressions" title="10.1.7.5 式の照合順序">セクション10.1.7.5「式の照合順序」</a>を参照してください。
        </p><p>
          (以前は、大文字と小文字が区別されるバイナリが常に使用されていました。)
        </p><p>
          次の例に示すように、<em class="replaceable"><code>xml_frag</code></em> に、適切にネストされていない要素や閉じられていない要素が含まれ、警告が生成された場合は、<code class="literal">NULL</code> が返されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a');</code></strong>
+-----------------------------------+
| ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a') |
+-----------------------------------+
| NULL                              |
+-----------------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Warning
   Code: 1525
Message: Incorrect XML value: 'parse error at line 1 pos 11:
         END-OF-INPUT unexpected ('&gt;' wanted)'
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a') |
+-------------------------------------+
| c                                   |
+-------------------------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><a name="function_updatexml"></a><p>
          <a class="indexterm" name="idm139979094290160"></a> <code class="literal">UpdateXML(<em class="replaceable"><code>xml_target</code></em>, <em class="replaceable"><code>xpath_expr</code></em>, <em class="replaceable"><code>new_xml</code></em>)</code>
        </p><p>
          この関数は、XML マークアップ <em class="replaceable"><code>xml_target</code></em> の特定のフラグメントの一部を新しい XML フラグメント <em class="replaceable"><code>new_xml</code></em> に置き換えてから、変更された XML を返します。置換された <em class="replaceable"><code>xml_target</code></em> の一部は、ユーザーが指定した XPath 式 <em class="replaceable"><code>xpath_expr</code></em> に一致します。MySQL 5.6.6 以前では、XPath 式に最大でも 127 文字しか含めることができませんでした。この制限は、MySQL 5.6.7 で解除されました。(Bug #13007062、Bug #62429)
        </p><p>
          <em class="replaceable"><code>xpath_expr</code></em> に一致する式が見つからない場合、または複数の一致が見つかった場合、この関数は元の <em class="replaceable"><code>xml_target</code></em> XML フラグメントを返します。3 つの引数はすべて文字列にする必要があります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a', '&lt;e&gt;fff&lt;/e&gt;') AS val1,</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/b', '&lt;e&gt;fff&lt;/e&gt;') AS val2,</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '//b', '&lt;e&gt;fff&lt;/e&gt;') AS val3,</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a/d', '&lt;e&gt;fff&lt;/e&gt;') AS val4,</code></strong>
    -&gt; <strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a/d', '&lt;e&gt;fff&lt;/e&gt;') AS val5</code></strong>
    -&gt; <strong class="userinput"><code>\G</code></strong>

*************************** 1. row ***************************
val1: &lt;e&gt;fff&lt;/e&gt;
val2: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;
val3: &lt;a&gt;&lt;e&gt;fff&lt;/e&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;
val4: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;e&gt;fff&lt;/e&gt;&lt;/a&gt;
val5: &lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;
</pre></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        XPath 構文のさらに詳しい説明や使用法については、このマニュアルのスコープ外です。最終的な情報については、<a class="ulink" href="http://www.w3.org/TR/xpath" target="_top">「XML Path Language (XPath) 1.0 仕様」</a>を参照してください。XPath がはじめてのユーザーや基本の復習を希望するユーザーに役立つリソースは、複数の言語で入手できる<a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top">「Zvon.org XPath Tutorial」</a>です。
      </p></div><p>
      一部の基本的な XPath 式の説明および例は、次のとおりです。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">/<em class="replaceable"><code>tag</code></em></code>
        </p><p>
          <code class="literal">&lt;<em class="replaceable"><code>tag</code></em>/&gt;</code> がルート要素の場合にかぎり、<code class="literal">&lt;<em class="replaceable"><code>tag</code></em>/&gt;</code> に一致します。
        </p><p>
          例: <code class="literal">/a</code> はいちばん外側の (ルート) タグに一致するため、<code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code> には一致があります。この例では、別の要素の子であるため、<code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code> の内側の <em class="replaceable"><code>a</code></em> 要素には一致しません。
        </p></li><li class="listitem"><p>
          <code class="literal">/<em class="replaceable"><code>tag1</code></em>/<em class="replaceable"><code>tag2</code></em></code>
        </p><p>
          <code class="literal">&lt;<em class="replaceable"><code>tag1</code></em>/&gt;</code> の子であり、<code class="literal">&lt;<em class="replaceable"><code>tag1</code></em>/&gt;</code> がルート要素である場合にかぎり、<code class="literal">&lt;<em class="replaceable"><code>tag2</code></em>/&gt;</code> に一致します。
        </p><p>
          例: <code class="literal">/a/b</code> はルート要素 <em class="replaceable"><code>a</code></em> の子であるため、XML フラグメント <code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code> の <em class="replaceable"><code>b</code></em> 要素に一致します。この場合、<em class="replaceable"><code>b</code></em> はルート要素 (その他の要素の子) であるため、<code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code> には一致がありません。XPath 式でも <code class="literal">&lt;a&gt;&lt;c&gt;&lt;b/&gt;&lt;/c&gt;&lt;/a&gt;</code> に一致がありません。ここで、<em class="replaceable"><code>b</code></em> は <em class="replaceable"><code>a</code></em> の子孫ですが、実際には <em class="replaceable"><code>a</code></em> の子ではありません。
        </p><p>
          この構成は、3 つ以上の要素に拡張できます。たとえば、XPath 式 <code class="literal">/a/b/c</code> は、フラグメント <code class="literal">&lt;a&gt;&lt;b&gt;&lt;c/&gt;&lt;/b&gt;&lt;/a&gt;</code> 内の <em class="replaceable"><code>c</code></em> 要素に一致します。
        </p></li><li class="listitem"><p>
          <code class="literal">//<em class="replaceable"><code>tag</code></em></code>
        </p><p>
          <code class="literal">&lt;<em class="replaceable"><code>tag</code></em>&gt;</code> の任意のインスタンスに一致します。
        </p><p>
          例: <code class="literal">//a</code> は、<code class="literal">&lt;a&gt;&lt;b&gt;&lt;c/&gt;&lt;/b&gt;&lt;/a&gt;</code>、<code class="literal">&lt;c&gt;&lt;a&gt;&lt;b/&gt;&lt;/a&gt;&lt;/b&gt;</code>、<code class="literal">&lt;c&gt;&lt;b&gt;&lt;a/&gt;&lt;/b&gt;&lt;/c&gt;</code> のいずれかの <em class="replaceable"><code>a</code></em> 要素に一致します。
        </p><p>
          <code class="literal">//</code> は <code class="literal">/</code> と組み合わせることができます。たとえば、<code class="literal">//a/b</code> は、フラグメント <code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code> または <code class="literal">&lt;a&gt;&lt;b&gt;&lt;c/&gt;&lt;/b&gt;&lt;/a&gt;</code> 内の <em class="replaceable"><code>b</code></em> 要素に一致します。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">//<em class="replaceable"><code>tag</code></em></code> は <code class="literal">/descendant-or-self::*/<em class="replaceable"><code>tag</code></em></code> と同等です。よく見られる誤りは、これと <code class="literal">/descendant-or-self::<em class="replaceable"><code>tag</code></em></code> とを混同することです。次に示すように、実際には後者の式ではまったく異なる結果が生成される可能性があります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @xml = '&lt;a&gt;&lt;b&gt;&lt;c&gt;w&lt;/c&gt;&lt;b&gt;x&lt;/b&gt;&lt;d&gt;y&lt;/d&gt;z&lt;/b&gt;&lt;/a&gt;';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @xml;</code></strong>
+-----------------------------------------+
| @xml                                    |
+-----------------------------------------+
| &lt;a&gt;&lt;b&gt;&lt;c&gt;w&lt;/c&gt;&lt;b&gt;x&lt;/b&gt;&lt;d&gt;y&lt;/d&gt;z&lt;/b&gt;&lt;/a&gt; |
+-----------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '//b[1]');</code></strong>
+------------------------------+
| ExtractValue(@xml, '//b[1]') |
+------------------------------+
| x z                          |
+------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '//b[2]');</code></strong>
+------------------------------+
| ExtractValue(@xml, '//b[2]') |
+------------------------------+
|                              |
+------------------------------+
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::*/b[1]');</code></strong>
+---------------------------------------------------+
| ExtractValue(@xml, '/descendant-or-self::*/b[1]') |
+---------------------------------------------------+
| x z                                               |
+---------------------------------------------------+
1 row in set (0.06 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::*/b[2]');</code></strong>
+---------------------------------------------------+
| ExtractValue(@xml, '/descendant-or-self::*/b[2]') |
+---------------------------------------------------+
|                                                   |
+---------------------------------------------------+
1 row in set (0.00 sec)


mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::b[1]');</code></strong>
+-------------------------------------------------+
| ExtractValue(@xml, '/descendant-or-self::b[1]') |
+-------------------------------------------------+
| z                                               |
+-------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::b[2]');</code></strong>
+-------------------------------------------------+
| ExtractValue(@xml, '/descendant-or-self::b[2]') |
+-------------------------------------------------+
| x                                               |
+-------------------------------------------------+
1 row in set (0.00 sec)
</pre></div></li><li class="listitem"><p>
          <code class="literal">*</code> 演算子は、任意の要素に一致する<span class="quote">「<span class="quote">ワイルドカード</span>」</span>として機能します。たとえば、式 <code class="literal">/*/b</code> は、XML フラグメント <code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code> または <code class="literal">&lt;c&gt;&lt;b/&gt;&lt;/c&gt;</code> 内の <em class="replaceable"><code>b</code></em> 要素に一致します。ただし、<em class="replaceable"><code>b</code></em> はその他の要素の子である必要があるため、この式ではフラグメント <code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code> 内の一致は生成されません。ワイルドカードは、任意の位置で使用できます。式 <code class="literal">/*/b/*</code> は、それ自体がルート要素でない <em class="replaceable"><code>b</code></em> 要素の任意の子に一致します。
        </p></li><li class="listitem"><p>
          <code class="literal">|</code> (<code class="literal">UNION</code>) 演算子を使用すれば、複数のロケータのいずれかに一致できます。たとえば、式 <code class="literal">//b|//c</code> は、XML ターゲット内のすべての <em class="replaceable"><code>b</code></em> および <em class="replaceable"><code>c</code></em> 要素に一致します。
        </p></li><li class="listitem"><p>
          その属性の 1 つ以上の値に基づいて、要素に一致することもできます。これは、構文 <code class="literal"><em class="replaceable"><code>tag</code></em>[@<em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"]</code> を使用して実行されます。たとえば、式 <code class="literal">//b[@id="idB"]</code> は、フラグメント <code class="literal">&lt;a&gt;&lt;b id="idA"/&gt;&lt;c/&gt;&lt;b id="idB"/&gt;&lt;/a&gt;</code> 内の 2 番目の <em class="replaceable"><code>b</code></em> 要素に一致します。<code class="literal"><em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"</code> を含む<span class="emphasis"><em>任意の</em></span>要素に対して一致を行うには、XPath 式 <code class="literal">//*[<em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"]</code> を使用します。
        </p><p>
          複数の属性値をフィルタ処理するには、単に複数の属性比較句を連続して使用するだけです。たとえば、式 <code class="literal">//b[@c="x"][@d="y"]</code> は、指定した XML フラグメントの任意の場所で発生した要素 <code class="literal">&lt;b c="x" d="y"/&gt;</code> に一致します。
        </p><p>
          同じ属性が複数の値のいずれかに一致する要素を見つけるには、<code class="literal">|</code> 演算子で結合された複数のロケータを使用します。たとえば、<em class="replaceable"><code>c</code></em> 属性の値が 23 または 17 であるすべての <em class="replaceable"><code>b</code></em> 要素に一致するには、式 <code class="literal">//b[@c="23"]|//b[@c="17"]</code> を使用します。この目的のために、<code class="literal">//b[@c="23" or @c="17"]</code> のように論理 <code class="literal">or</code> 演算子を使用することもできます。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">or</code> と <code class="literal">|</code> の相違点として、<code class="literal">or</code> は条件を結合するのに対し、<code class="literal">|</code> は結果セットを結合します。
          </p></div></li></ul></div><p><b>XPath の制限 </b>
        現在、これらの関数でサポートされている XPath 構文は、次の制限の対象となっています。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          ノードセット間の比較 (<code class="literal">'/a/b[@c=@d]'</code> など) はサポートされていません。
        </p></li><li class="listitem"><p>
          標準の XPath 比較演算子はすべてサポートされています。(Bug #22823)
        </p></li><li class="listitem"><p>
          相対ロケータ式は、ルートノードのコンテキストで解決されます。たとえば、次のようなクエリーと結果を考えてみます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(</code></strong>
    -&gt;   <strong class="userinput"><code>'&lt;a&gt;&lt;b c="1"&gt;X&lt;/b&gt;&lt;b c="2"&gt;Y&lt;/b&gt;&lt;/a&gt;',</code></strong>
    -&gt;    <strong class="userinput"><code>'a/b'</code></strong>
    -&gt; <strong class="userinput"><code>) AS result;</code></strong>
+--------+
| result |
+--------+
| X Y    |
+--------+
1 row in set (0.03 sec)
</pre><p>
          この場合は、ロケータ <code class="literal">a/b</code> が <code class="literal">/a/b</code> に解決されています。
        </p><p>
          相対ロケータは、述語内でもサポートされています。次の例では、<code class="literal">d[../@c="1"]</code> が <code class="literal">/a/b[@c="1"]/d</code> として解決されています。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(</code></strong>
    -&gt;      <strong class="userinput"><code>'&lt;a&gt;</code></strong>
    -&gt;        <strong class="userinput"><code>&lt;b c="1"&gt;&lt;d&gt;X&lt;/d&gt;&lt;/b&gt;</code></strong>
    -&gt;        <strong class="userinput"><code>&lt;b c="2"&gt;&lt;d&gt;X&lt;/d&gt;&lt;/b&gt;</code></strong>
    -&gt;      <strong class="userinput"><code>&lt;/a&gt;',</code></strong>
    -&gt;      <strong class="userinput"><code>'a/b/d[../@c="1"]')</code></strong>
    -&gt; <strong class="userinput"><code>AS result;</code></strong>
+--------+
| result |
+--------+
| X      |
+--------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><p>
          スカラー値 (変数参照、リテラル、数字、およびスカラー関数の呼び出しを含む) として評価する式が前に付けられたロケータは許可されず、使用するとエラーが発生します。
        </p></li><li class="listitem"><p>
          <code class="literal">::</code> 演算子を次のようなノード型と組み合わせることは、サポートされていません。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::comment()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::text()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::processing-instructions()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::node()</code>
            </p></li></ul></div><p>
          ただし、次の例に示すように、名前のテスト (<code class="literal"><em class="replaceable"><code>axis</code></em>::<em class="replaceable"><code>name</code></em></code> や <code class="literal"><em class="replaceable"><code>axis</code></em>::*</code> など) はサポートされています。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::b');</code></strong>
+-------------------------------------------------------+
| ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::b') |
+-------------------------------------------------------+
| x                                                     |
+-------------------------------------------------------+
1 row in set (0.02 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::*');</code></strong>
+-------------------------------------------------------+
| ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::*') |
+-------------------------------------------------------+
| x y                                                   |
+-------------------------------------------------------+
1 row in set (0.01 sec)
</pre></li><li class="listitem"><p>
          パスがルート要素を<span class="quote">「<span class="quote">上方向</span>」</span>に導いている場合は、<span class="quote">「<span class="quote">上下</span>」</span>の移動がサポートされていません。つまり、現在の要素の 1 つ以上の祖先がルート要素の祖先でもある場合は、指定された要素の祖先の子孫で一致する式を使用できません (Bug #16321 を参照してください)。
        </p></li><li class="listitem"><p>
          次の XPath 関数はサポートされていないか、または説明したような既知の問題があります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">id()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">lang()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">local-name()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">name()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">namespace-uri()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">normalize-space()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">starts-with()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">string()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">substring-after()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">substring-before()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">translate()</code>
            </p></li></ul></div></li><li class="listitem"><p>
          次の軸はサポートされていません。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">following-sibling</code>
            </p></li><li class="listitem"><p>
              <code class="literal">following</code>
            </p></li><li class="listitem"><p>
              <code class="literal">preceding-sibling</code>
            </p></li><li class="listitem"><p>
              <code class="literal">preceding</code>
            </p></li></ul></div></li></ul></div><p>
      <code class="literal">ExtractValue()</code> および <code class="literal">UpdateXML()</code> への引数として渡される XPath 式の要素セレクタ内には、コロン文字 (<span class="quote">「<span class="quote"><code class="literal">:</code></span>」</span>) が含まれている可能性があります。これにより、XML 名前空間の表記法を使用しているマークアップとの使用が有効になります。例:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @xml = '&lt;a&gt;111&lt;b:c&gt;222&lt;d&gt;333&lt;/d&gt;&lt;e:f&gt;444&lt;/e:f&gt;&lt;/b:c&gt;&lt;/a&gt;';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(@xml, '//e:f');</code></strong>
+-----------------------------+
| ExtractValue(@xml, '//e:f') |
+-----------------------------+
| 444                         |
+-----------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT UpdateXML(@xml, '//b:c', '&lt;g:h&gt;555&lt;/g:h&gt;');</code></strong>
+--------------------------------------------+
| UpdateXML(@xml, '//b:c', '&lt;g:h&gt;555&lt;/g:h&gt;') |
+--------------------------------------------+
| &lt;a&gt;111&lt;g:h&gt;555&lt;/g:h&gt;&lt;/a&gt;                   |
+--------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
      これは、いくつかの点で <a class="ulink" href="http://xalan.apache.org/" target="_top">Apache Xalan</a> およびその他の一部のパーサーで許可されているものと似ていますが、名前空間の制限や <code class="literal">namespace-uri()</code> および <code class="literal">local-name()</code> 関数の使用を必要とするよりも大幅に単純です。
    </p><p><b>エラー処理 </b>
        <code class="literal">ExtractValue()</code> と <code class="literal">UpdateXML()</code> のどちらの場合でも、使用される XPath ロケータが有効であり、検索対象の XML が適切にネストされ、閉じられた要素で構成されている必要があります。ロケータが無効な場合は、次のようなエラーが生成されます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '/&amp;a');</code></strong>
<span class="errortext">ERROR 1105 (HY000): XPATH syntax error: '&amp;a'</span>
</pre><p>
      <em class="replaceable"><code>xml_frag</code></em> が適切にネストされ、閉じられている要素で構成されていない場合は、次の例に示すように、<code class="literal">NULL</code> が返され、警告が生成されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a');</code></strong>
+-----------------------------------+
| ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a') |
+-----------------------------------+
| NULL                              |
+-----------------------------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Warning
   Code: 1525
Message: Incorrect XML value: 'parse error at line 1 pos 11:
         END-OF-INPUT unexpected ('&gt;' wanted)'
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a');</code></strong>
+-------------------------------------+
| ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a') |
+-------------------------------------+
| c                                   |
+-------------------------------------+
1 row in set (0.00 sec)
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
        <code class="literal">UpdateXML()</code> への第 3 引数として使用される置換用の XML は、適切にネストされ、閉じられている要素のみで構成されているかどうかを判断するためにチェック<span class="emphasis"><em>されません</em></span>。
      </p></div><p><b>XPath インジェクション </b>
        <em class="firstterm">コードインジェクション</em>は、権限やデータへの不正アクセス権を取得するために、悪意のあるコードがシステムに導入された場合に発生します。これは、ユーザーが入力したデータの型や内容について開発者が行なった想定の悪用に基づいています。これに関しては、XPath も例外ではありません。
      </p><p>
      この問題が発生する可能性のある一般的なシナリオは、次のような XPath 式を使用して、ログイン名とパスワードの組み合わせを XML ファイル内で見つかったものと一致させることで承認を処理するアプリケーションのケースです。
    </p><pre class="programlisting">
//user[login/text()='neapolitan' and password/text()='1c3cr34m']/attribute::id
</pre><p>
      この XPath 式は、次のような SQL ステートメントと同等です。
    </p><pre class="programlisting">
SELECT id FROM users WHERE login='neapolitan' AND password='1c3cr34m';
</pre><p>
      XPath を使用している PHP アプリケーションでは、次のようにログインプロセスが処理される可能性があります。
    </p><pre class="programlisting">
&lt;?php

  $file     =   "users.xml";

  $login    =   $POST["login"];
  $password =   $POST["password"];

  $xpath = "//user[login/text()=$login and password/text()=$password]/attribute::id";

  if( file_exists($file) )
  {
    $xml = simplexml_load_file($file);

    if($result = $xml-&gt;xpath($xpath))
      echo "You are now logged in as user $result[0].";
    else
      echo "Invalid login name or password.";
  }
  else
    exit("Failed to open $file.");

?&gt;
</pre><p>
      入力時にはチェックが実行されません。これは、悪意のあるユーザーがログイン名とパスワードの両方に <code class="literal">' or 1=1</code> と入力することで、テストを<span class="quote">「<span class="quote">回避</span>」</span>できることを意味します。その結果、<code class="varname">$xpath</code> が次のように評価されます。
    </p><pre class="programlisting">
//user[login/text()='' or 1=1 and password/text()='' or 1=1]/attribute::id
</pre><p>
      角括弧内の式は常に <code class="literal">true</code> と評価されるため、事実上、XML ドキュメント内のすべての <code class="literal">user</code> 要素の <code class="literal">id</code> 属性に一致する次の式と同じです。
    </p><pre class="programlisting">
//user/attribute::id
</pre><p>
      この攻撃を回避する方法の 1 つは、<code class="literal">$xpath</code> の定義内に挿入される変数名を単に引用符で囲むだけです。これにより、Web フォームから渡された値が強制的に文字列に変換されます。
    </p><pre class="programlisting">
$xpath = "//user[login/text()='$login' and password/text()='$password']/attribute::id";
</pre><p>
      これは、SQL インジェクション攻撃を回避する際に推奨されることの多い方法と同じです。一般に、XPath インジェクション攻撃を回避するために従うべき方法は、SQL インジェクションを回避するための方法と同じです。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          アプリケーションでは、テストされていないユーザーデータは許可されません。
        </p></li><li class="listitem"><p>
          ユーザーが送信したすべてのデータの型をチェックします。不正な型のデータは拒否または変換します。
        </p></li><li class="listitem"><p>
          数値データに範囲外の値が含まれていないかをテストします。範囲外の値は切り捨てるか、丸めるか、拒否します。文字列に不正な文字が含まれていないかをテストし、不正な文字が含まれる入力は削除するか拒否します。
        </p></li><li class="listitem"><p>
          明示的なエラーメッセージは、システムを危険にさらすために使用できる手がかりを未承認ユーザーに与える可能性があるため、出力しないでください。その代わりに、ファイルやデータベーステーブルにログを記録してください。
        </p></li></ul></div><p>
      SQL インジェクション攻撃を使用すればデータベーススキーマに関する情報を取得できるように、XPath インジェクションを使用すれば、Amit Klein 氏の論文<a class="ulink" href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf" target="_top">『Blind XPath Injection』</a>(PDF ファイル、46K バイト) で説明されているように、XML ファイルをスキャンして構造を明らかにできます。
    </p><p>
      クライアントに返送される出力をチェックすることも重要です。MySQL の <code class="literal">ExtractValue()</code> 関数を使用すると何が発生する可能性があるのかを検討します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ExtractValue(</code></strong>
    -&gt;     <strong class="userinput"><code>LOAD_FILE('users.xml'),</code></strong>
    -&gt;     <strong class="userinput"><code>'//user[login/text()="" or 1=1 and password/text()="" or 1=1]/attribute::id'</code></strong>
    -&gt; <strong class="userinput"><code>) AS id;</code></strong>
+-------------------------------+
| id                            |
+-------------------------------+
| 00327 13579 02403 42354 28570 |
+-------------------------------+
1 row in set (0.01 sec)
</pre><p>
      <code class="literal">ExtractValue()</code> は複数の一致を空白で区切られた単一の文字列として返すため、このインジェクション攻撃によって、<code class="filename">users.xml</code> 内に含まれるすべての有効な ID が単一の出力行としてユーザーに提供されます。追加の保護手段として、ユーザーに返される前に出力のテストも行うべきです。次に、単純な例を示します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT @id = ExtractValue(</code></strong>
    -&gt;     <strong class="userinput"><code>LOAD_FILE('users.xml'),</code></strong>
    -&gt;     <strong class="userinput"><code>'//user[login/text()="" or 1=1 and password/text()="" or 1=1]/attribute::id'</code></strong>
    -&gt; <strong class="userinput"><code>);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT IF(</code></strong>
    -&gt;     <strong class="userinput"><code>INSTR(@id, ' ') = 0,</code></strong>
    -&gt;     <strong class="userinput"><code>@id,</code></strong>
    -&gt;     <strong class="userinput"><code>'Unable to retrieve user ID')</code></strong>
    -&gt; <strong class="userinput"><code>AS singleID;</code></strong>
+----------------------------+
| singleID                   |
+----------------------------+
| Unable to retrieve user ID |
+----------------------------+
1 row in set (0.00 sec)
</pre><p>
      一般に、ユーザーにデータをセキュアに返すためのガイドラインは、ユーザー入力を受け入れるためのガイドラインと同じです。それらは、次のように要約できます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          常に、出力データの型および許可される値をテストします。
        </p></li><li class="listitem"><p>
          未承認ユーザーがエラーメッセージを表示することを許可しないでください。アプリケーションに関する情報が提供される可能性があり、それを悪用されるおそれがあります。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="bit-functions"></a>12.12 ビット関数</h2></div></div></div><a class="indexterm" name="idm139979094055392"></a><a class="indexterm" name="idm139979094053920"></a><a class="indexterm" name="idm139979094051888"></a><a class="indexterm" name="idm139979094049856"></a><div class="table"><a name="idm139979094048512"></a><p class="title"><b>表 12.16 ビット単位の関数</b></p><div class="table-contents"><table summary="ビット単位の関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT()</code></a></td><td>
      設定されているビット数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></td><td>
      ビット単位の AND
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></td><td>
      ビットを反転します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></td><td>
      ビット単位の OR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></td><td>
      ビット単位の XOR
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></td><td>
      左シフト
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></td><td>
      右シフト
    </td></tr></tbody></table></div></div><br class="table-break"><p>
      MySQL では、演算子の最大範囲が 64 ビットになるように、ビット演算に <code class="literal">BIGINT</code> (64 ビット) 算術が使用されます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_bitwise-or"></a><p>
          <a class="indexterm" name="idm139979094026704"></a> <a class="indexterm" name="idm139979094025200"></a> <code class="literal">|</code>
        </p><p>
          ビット単位の OR:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 29 | 15;</code></strong>
        -&gt; 31
</pre><p>
          結果は符合なしの 64 ビット整数です。
        </p></li><li class="listitem"><a name="operator_bitwise-and"></a><p>
          <a class="indexterm" name="idm139979094015104"></a> <a class="indexterm" name="idm139979094013584"></a> <code class="literal">&amp;</code>
        </p><p>
          ビット単位の AND:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 29 &amp; 15;</code></strong>
        -&gt; 13
</pre><p>
          結果は符合なしの 64 ビット整数です。
        </p></li><li class="listitem"><a name="operator_bitwise-xor"></a><p>
          <a class="indexterm" name="idm139979094003488"></a> <a class="indexterm" name="idm139979094001984"></a> <code class="literal">^</code>
        </p><p>
          ビット単位の XOR:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 ^ 1;</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT 1 ^ 0;</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT 11 ^ 3;</code></strong>
        -&gt; 8
</pre><p>
          結果は符合なしの 64 ビット整数です。
        </p></li><li class="listitem"><a name="operator_left-shift"></a><p>
          <a class="indexterm" name="idm139979093990448"></a> <code class="literal">&lt;&lt;</code>
        </p><p>
          longlong (<code class="literal">BIGINT</code>) 数値を左にシフトします。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 &lt;&lt; 2;</code></strong>
        -&gt; 4
</pre><p>
          結果は符合なしの 64 ビット整数です。値は 64 ビットに切り捨てられます。特に、シフト数が符号なし 64 ビット数値の幅以上の大きさの場合は、結果がゼロになります。
        </p></li><li class="listitem"><a name="operator_right-shift"></a><p>
          <a class="indexterm" name="idm139979093979456"></a> <code class="literal">&gt;&gt;</code>
        </p><p>
          longlong (<code class="literal">BIGINT</code>) 数値を右にシフトします。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 4 &gt;&gt; 2;</code></strong>
        -&gt; 1
</pre><p>
          結果は符合なしの 64 ビット整数です。値は 64 ビットに切り捨てられます。特に、シフト数が符号なし 64 ビット数値の幅以上の大きさの場合は、結果がゼロになります。
        </p></li><li class="listitem"><a name="operator_bitwise-invert"></a><p>
          <a class="indexterm" name="idm139979093968496"></a> <code class="literal">~</code>
        </p><p>
          すべてのビットを反転します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 5 &amp; ~1;</code></strong>
        -&gt; 4
</pre><p>
          結果は符合なしの 64 ビット整数です。
        </p></li><li class="listitem"><a name="function_bit-count"></a><p>
          <a class="indexterm" name="idm139979093958848"></a> <code class="literal">BIT_COUNT(<em class="replaceable"><code>N</code></em>)</code>
        </p><p>
          引数 <em class="replaceable"><code>N</code></em> で設定されているビットの数を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT BIT_COUNT(29), BIT_COUNT(b'101010');</code></strong>
        -&gt; 4, 3
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="encryption-functions"></a>12.13 暗号化関数と圧縮関数</h2></div></div></div><a class="indexterm" name="idm139979093949984"></a><a class="indexterm" name="idm139979093948544"></a><div class="table"><a name="idm139979093946512"></a><p class="title"><b>表 12.17 暗号化関数</b></p><div class="table-contents"><table summary="暗号化関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a></td><td>
      AES を使用して復号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a></td><td>
      AES を使用して暗号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_compress"><code class="literal">COMPRESS()</code></a></td><td>
      バイナリ文字列として結果を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_decode"><code class="literal">DECODE()</code></a></td><td>
      ENCODE()
      を使用して暗号化された文字列をデコードします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_des-decrypt"><code class="literal">DES_DECRYPT()</code></a></td><td>
      文字列を復号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_des-encrypt"><code class="literal">DES_ENCRYPT()</code></a></td><td>
      文字列を暗号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_encode"><code class="literal">ENCODE()</code></a></td><td>
      文字列をエンコードします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_encrypt"><code class="literal">ENCRYPT()</code></a></td><td>
      文字列を暗号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a></td><td>
      MD5 チェックサムを計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_old-password"><code class="literal">OLD_PASSWORD()</code></a> (deprecated 5.6.5)</td><td>
      4.1 より前の PASSWORD 実装の値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a></td><td>
      パスワード文字列を計算して返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a></td><td>
      ランダムなバイトベクトルを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code>, <code class="literal">SHA()</code></a></td><td>
      SHA-1 160 ビットチェックサムを計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a></td><td>
      SHA-2 チェックサムを計算します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_uncompress"><code class="literal">UNCOMPRESS()</code></a></td><td>
      圧縮された文字列を圧縮解除します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_uncompressed-length"><code class="literal">UNCOMPRESSED_LENGTH()</code></a></td><td>
      圧縮前の文字列長を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH()</code></a></td><td>
      パスワードの強度を判断します
    </td></tr></tbody></table></div></div><br class="table-break"><p>
      多くの暗号化関数および圧縮関数では、結果に任意のバイト値が含まれている可能性のある文字列が返されます。これらの結果を格納する場合は、<code class="literal">VARBINARY</code> または <code class="literal">BLOB</code> バイナリ文字列データ型のカラムを使用します。これにより、末尾の空白を削除したり、文字セットを変換したりするとデータ値が変更される可能性があるという問題を回避できます。たとえば、非バイナリ文字列のデータ型 (<code class="literal">CHAR</code>、<code class="literal">VARCHAR</code>、<code class="literal">TEXT</code>) を使用した場合に、これが発生する可能性があります。
    </p><p>
      一部の暗号化関数では、ASCII 文字 (<code class="literal">MD5()</code>、<code class="literal">OLD_PASSWORD()</code>、<code class="literal">PASSWORD()</code>、<code class="literal">SHA()</code>、<code class="literal">SHA1()</code>、<code class="literal">SHA2()</code>) の文字列が返されます。MySQL 5.6 では、戻り値は、<code class="literal">character_set_connection</code> および <code class="literal">collation_connection</code> システム変数で決定された文字セットおよび照合順序を含む非バイナリ文字列です。
    </p><p>
      <code class="literal">MD5()</code> や <code class="literal">SHA1()</code> などの関数がバイナリ文字列として 16 進数の文字列を返すバージョンでは、戻り値を大文字に変換したり、大文字と小文字が区別されない方法でそのまま比較したりできません。値を非バイナリ文字列に変換する必要があります。<a class="xref" href="functions.html#cast-functions" title="12.10 キャスト関数と演算子">セクション12.10「キャスト関数と演算子」</a>で、バイナリ文字列の変換の説明を参照してください。
    </p><p>
      アプリケーションで 16 進数の文字列を返す関数 (<code class="literal">MD5()</code> や <code class="literal">SHA1()</code> など) からの値を格納する場合は、<code class="literal">UNHEX()</code> を使用して 16 進表現をバイナリに変換し、その結果を <code class="literal">BINARY(<em class="replaceable"><code>N</code></em>)</code> カラムに格納すれば、より効率的な格納および比較を実現できます。16 進数の各ペアには、バイナリ形式での 1 バイトが必要であるため、<em class="replaceable"><code>N</code></em> の値は、16 進文字列の長さによって異なります。<em class="replaceable"><code>N</code></em> は、<code class="literal">MD5()</code> 値の場合は 16、<code class="literal">SHA1()</code> の場合は 20 です。<code class="literal">SHA2()</code> の場合、<em class="replaceable"><code>N</code></em> の範囲は、結果の目的のビット長を指定する引数に応じて 28 から 32 までです。
    </p><p>
      <code class="literal">utf8</code> 文字セット (文字ごとに 4 バイト使用されます) が使用されるカラムに値が格納される場合に、16 進文字列を <code class="literal">CHAR</code> カラムに格納する際のサイズのペナルティーは最小で 2 回、最大で 8 回です。また、文字列を格納すると、値が大きくなり、文字セットの照合順序ルールを考慮に入れる必要があるため、比較が遅くなります。
    </p><p>
      アプリケーションで <code class="literal">MD5()</code> 文字列値が <code class="literal">CHAR(32)</code> カラムに格納されると仮定します。
    </p><pre class="programlisting">
CREATE TABLE md5_tbl (md5_val CHAR(32), ...);
INSERT INTO md5_tbl (md5_val, ...) VALUES(MD5('abcdef'), ...);
</pre><p>
      16 進文字列をよりコンパクトな形式に変換するには、次のように、代わりに <code class="literal">UNHEX()</code> および <code class="literal">BINARY(16)</code> が使用されるようにアプリケーションを変更します。
    </p><pre class="programlisting">
CREATE TABLE md5_tbl (md5_val BINARY(16), ...);
INSERT INTO md5_tbl (md5_val, ...) VALUES(UNHEX(MD5('abcdef')), ...);
</pre><p>
      ハッシュ関数が 2 つの異なる入力値に同じ値を生成するという非常にまれなケースに対応できるように、アプリケーションが準備されるはずです。競合を検出可能にする方法の 1 つは、ハッシュカラムを主キーにすることです。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        MD5 および SHA-1 アルゴリズムの悪用が知られています。代わりに、このセクションで説明するその他の暗号化関数 (<code class="literal">SHA2()</code> など) のいずれか使用することを検討してください。
      </p></div><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
        SSL 接続が使用されていなければ、暗号化関数への引数として指定されたパスワードやその他の機密の値は、プレーンテキストで MySQL サーバーに送信されます。また、このような値は、書き込み先の MySQL ログにも表示されます。このようなタイプの露出を回避するために、アプリケーションはクライアント側で機密の値を暗号化してから、サーバーに送信できます。同じ考慮事項が暗号化鍵にも適用されます。これらの露出を回避するために、アプリケーションはストアドプロシージャーを使用して、サーバー側で値を暗号化および復号化できます。
      </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_aes-decrypt"></a><p>
          <a class="indexterm" name="idm139979093860416"></a> <code class="literal">AES_DECRYPT(<em class="replaceable"><code>crypt_str</code></em>,<em class="replaceable"><code>key_str</code></em>[,<em class="replaceable"><code>init_vector</code></em>])</code>
        </p><p>
          この関数は、公式の AES (Advanced Encryption Standard) アルゴリズムを使用してデータを復号化します。詳細は、<code class="literal">AES_ENCRYPT()</code> の説明を参照してください。
        </p><p>
          MySQL 5.6.17 の時点では、オプションの初期化ベクトル引数 <em class="replaceable"><code>init_vector</code></em> を使用できます。そのバージョンでは、<code class="literal">AES_DECRYPT()</code> が使用されるステートメントはステートメントベースのレプリケーションに対して安全ではなく、クエリーキャッシュ内に格納できません。
        </p></li><li class="listitem"><a name="function_aes-encrypt"></a><p>
          <a class="indexterm" name="idm139979093847776"></a> <code class="literal">AES_ENCRYPT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>key_str</code></em>[,<em class="replaceable"><code>init_vector</code></em>])</code>
        </p><p>
          <code class="literal">AES_ENCRYPT()</code> および <code class="literal">AES_DECRYPT()</code> では、AES (Advanced Encryption Standard) アルゴリズム (以前は <span class="quote">「<span class="quote">Rijndael</span>」</span> と呼ばれていました) を使用したデータの暗号化および復号化が実装されます。AES の標準では、さまざまな鍵の長さが許可されます。デフォルトでは、これらの関数で鍵の長さが 128 ビットの AES が実装されます。MySQL 5.6.17 の時点では、あとで説明するように、使用できる鍵の長さは 196 または 256 ビットです。鍵の長さは、パフォーマンスとセキュリティーの間でのトレードオフです。
        </p><p>
          <code class="literal">AES_ENCRYPT()</code> は、鍵文字列 <em class="replaceable"><code>key_str</code></em> を使用して文字列 <em class="replaceable"><code>str</code></em> を暗号化し、暗号化された出力を含むバイナリ文字列を返します。<code class="literal">AES_DECRYPT()</code> は、鍵文字列 <em class="replaceable"><code>key_str</code></em> を使用して暗号化された文字列 <em class="replaceable"><code>crypt_str</code></em> を復号化し、元のプレーンテキスト文字列を返します。関数引数のいずれかが <code class="literal">NULL</code> の場合は、関数で <code class="literal">NULL</code> が返されます。
        </p><p>
          <em class="replaceable"><code>str</code></em> および <em class="replaceable"><code>crypt_str</code></em> 引数は任意の長さにすることができ、AES などのブロックベースのアルゴリズムによって、必要に応じてブロックの倍数になるように、自動的にパディングが <em class="replaceable"><code>str</code></em> に追加されます。このパディングは、<code class="literal">AES_DECRYPT()</code> 関数によって自動的に削除されます。<em class="replaceable"><code>crypt_str</code></em> の長さは、次の公式を使用して計算できます。
        </p><pre class="programlisting">
16 * (trunc(<em class="replaceable"><code>string_length</code></em> / 16) + 1)
</pre><p>
          鍵の長さが 128 ビットの場合、<em class="replaceable"><code>key_str</code></em> 引数に鍵を渡すもっともセキュアな方法は、完全にランダムな 128 ビット値を作成し、それをバイナリ値として渡すことです。例:
        </p><pre class="programlisting">
INSERT INTO t
VALUES (1,AES_ENCRYPT('text',UNHEX('F3229A0B371ED2D9441B830D21A390C3')));
</pre><p>
          パスフレーズを使用すると、パスフレーズをハッシュ化することで AES 鍵を生成できます。例:
        </p><pre class="programlisting">
INSERT INTO t VALUES (1,AES_ENCRYPT('text', SHA2('My secret passphrase',512)));
</pre><p>
          パスワードまたはパスフレーズは直接 <em class="replaceable"><code>crypt_str</code></em> に渡さず、最初にハッシュ化してください。このドキュメントの以前のバージョンでは、従来のアプローチが提案されていましたが、ここで示す例の方がセキュアであるため、推奨されなくなりました。
        </p><p>
          <code class="literal">AES_DECRYPT()</code> で無効な日付または不正なパディングが検出された場合は、<code class="literal">NULL</code> が返されます。ただし、入力データまたは鍵が無効になっている場合は、<code class="literal">AES_DECRYPT()</code> で <code class="literal">NULL</code> 以外の値 (ごみの可能性もあります) が返される可能性があります。
        </p><p>
          MySQL 5.6.17 の時点では、<code class="literal">AES_ENCRYPT()</code> および <code class="literal">AES_DECRYPT()</code> でブロック暗号化モードの制御が許可され、オプションの <em class="replaceable"><code>init_vector</code></em> 初期化ベクトル引数が指定されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">block_encryption_mode</code> システム変数は、ブロックベースの暗号化アルゴリズムのモードを制御します。そのデフォルト値は、128 ビットの鍵の長さと ECB モードを使用した暗号化を表す <code class="literal">aes-128-ecb</code> です。この変数で許可されている値については、<a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 サーバーシステム変数">セクション5.1.4「サーバーシステム変数」</a>を参照してください。
            </p></li><li class="listitem"><p>
              オプションの <em class="replaceable"><code>init_vector</code></em> 引数では、必要とするブロック暗号化モードに対応する初期化ベクトルが提供されます。
            </p></li></ul></div><p>
          オプションの <em class="replaceable"><code>init_vector</code></em> 引数が必要なモードでは、16 バイト以上の長さにする必要があります (16 を超えるバイトは無視されます)。<em class="replaceable"><code>init_vector</code></em> が欠落している場合は、エラーが発生します。
        </p><p>
          <em class="replaceable"><code>init_vector</code></em> が必要ないモードでは、これが無視され、指定されている場合は警告が生成されます。
        </p><p>
          <code class="literal">RANDOM_BYTES(16)</code> を呼び出すと、初期化ベクトルに使用されるバイトのランダム文字列を生成できます。初期化ベクトルが必要な暗号化モードでは、暗号化および復号化でも同じベクトルを使用する必要があります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET block_encryption_mode = 'aes-256-cbc';</code></strong>
mysql&gt; <strong class="userinput"><code>SET @key_str = SHA2('My secret passphrase',512);</code></strong>
mysql&gt; <strong class="userinput"><code>SET @init_vector = RANDOM_BYTES(16);</code></strong>
mysql&gt; <strong class="userinput"><code>SET @crypt_str = AES_ENCRYPT('text',@key_str,@init_vector);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AES_DECRYPT(@crypt_str,@key_str,@init_vector);</code></strong>
+-----------------------------------------------+
| AES_DECRYPT(@crypt_str,@key_str,@init_vector) |
+-----------------------------------------------+
| text                                          |
+-----------------------------------------------+
</pre><p>
          次の表には、許可されている各ブロック暗号化モード、サポートされている SSL ライブラリ、および初期化ベクトル引数が必須であるかどうかを一覧表示します。
        </p><div class="informaltable"><table summary="次の表には、許可されている各ブロック暗号化モード、サポートされている SSL ライブラリ、およびそのモードで初期化ベクトル引数が必須であるかどうかを一覧表示します。" border="1"><colgroup><col><col><col></colgroup><thead><tr><th scope="col">ブロック暗号化モード</th><th scope="col">モードがサポートされている SSL ライブラリ</th><th scope="col">初期化ベクトルが必要</th></tr></thead><tbody><tr><td scope="row">ECB</td><td>OpenSSL、yaSSL</td><td>いいえ</td></tr><tr><td scope="row">CBC</td><td>OpenSSL、yaSSL</td><td>はい</td></tr><tr><td scope="row">CFB1</td><td>OpenSSL</td><td>はい</td></tr><tr><td scope="row">CFB8</td><td>OpenSSL</td><td>はい</td></tr><tr><td scope="row">CFB128</td><td>OpenSSL</td><td>はい</td></tr><tr><td scope="row">OFB</td><td>OpenSSL</td><td>はい</td></tr></tbody></table></div><p>
          MySQL 5.6.17 では、<code class="literal">AES_ENCRYPT()</code> または <code class="literal">AES_DECRYPT()</code> が使用されるステートメントはステートメントベースのレプリケーションに対して安全ではなく、クエリーキャッシュ内に格納できません。
        </p></li><li class="listitem"><a name="function_compress"></a><p>
          <a class="indexterm" name="idm139979093777920"></a> <code class="literal">COMPRESS(<em class="replaceable"><code>string_to_compress</code></em>)</code>
        </p><p>
          文字列を圧縮し、その結果をバイナリ文字列として返します。この関数を使用するには、MySQL が <code class="literal">zlib</code> などの圧縮ライブラリを使用してコンパイルされている必要があります。そうでない場合、戻り値は常に <code class="literal">NULL</code> になります。圧縮された文字列は、<code class="literal">UNCOMPRESS()</code> を使用して圧縮解除できます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LENGTH(COMPRESS(REPEAT('a',1000)));</code></strong>
        -&gt; 21
mysql&gt; <strong class="userinput"><code>SELECT LENGTH(COMPRESS(''));</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT LENGTH(COMPRESS('a'));</code></strong>
        -&gt; 13
mysql&gt; <strong class="userinput"><code>SELECT LENGTH(COMPRESS(REPEAT('a',16)));</code></strong>
        -&gt; 15
</pre><p>
          圧縮された文字列の内容は、次の方法で格納されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              空の文字列は、空の文字列として格納されます。
            </p></li><li class="listitem"><p>
              空以外の文字列は、4 バイトの長さの圧縮されていない文字列として格納され (低いバイトが 1 番目)、そのあとに圧縮された文字列が続きます。文字列が空白文字で終わる場合は、結果が <code class="literal">CHAR</code> または <code class="literal">VARCHAR</code> カラムに格納されていても、末尾の空白文字が削除されるという問題が回避されるように、<span class="quote">「<span class="quote"><code class="literal">.</code></span>」</span> 文字が追加されます。(ただし、<code class="literal">CHAR</code> や <code class="literal">VARCHAR</code> などの非バイナリ文字列のデータ型を使用して圧縮された文字列を格納すると、文字セットの変換が発生する可能性があるため、いずれにしても推奨されません。代わりに、<code class="literal">VARBINARY</code> または <code class="literal">BLOB</code> バイナリ文字列のカラムを使用してください。)
            </p></li></ul></div></li><li class="listitem"><a name="function_decode"></a><p>
          <a class="indexterm" name="idm139979093752384"></a> <code class="literal">DECODE(<em class="replaceable"><code>crypt_str</code></em>,<em class="replaceable"><code>pass_str</code></em>)</code>
        </p><p>
          暗号化された文字列 <em class="replaceable"><code>crypt_str</code></em> は、パスワードとして <em class="replaceable"><code>pass_str</code></em> を使用して復号化します。<em class="replaceable"><code>crypt_str</code></em> は、<code class="literal">ENCODE()</code> から返された文字列にするようにしてください。
        </p></li><li class="listitem"><a name="function_des-decrypt"></a><p>
          <a class="indexterm" name="idm139979093742064"></a> <code class="literal">DES_DECRYPT(<em class="replaceable"><code>crypt_str</code></em>[,<em class="replaceable"><code>key_str</code></em>])</code>
        </p><p>
          <code class="literal">DES_ENCRYPT()</code> を使用して暗号化された文字列を復号化します。エラーが発生した場合、この関数は <code class="literal">NULL</code> を返します。
        </p><p>
          この関数は、MySQL が SSL サポートで構成されている場合のみ機能します。<a class="xref" href="security.html#ssl-connections" title="6.3.10 セキュアな接続のための SSL の使用">セクション6.3.10「セキュアな接続のための SSL の使用」</a>を参照してください。
        </p><p>
          <em class="replaceable"><code>key_str</code></em> 引数が指定されていない場合、<code class="literal">DES_DECRYPT()</code> は暗号化された文字列の最初のバイトを調査して、元の文字列を暗号化したときに使用した DES 鍵番号を特定してから、DES 鍵ファイルからメッセージを復号化するための鍵を読み取ります。これが機能するには、ユーザーが <code class="literal">SUPER</code> 権限を持っている必要があります。鍵ファイルは、<code class="option">--des-key-file</code> サーバーオプションを使用して指定できます。
        </p><p>
          この関数を <em class="replaceable"><code>key_str</code></em> 引数に渡すと、その文字列がメッセージを復号化するための鍵として使用されます。
        </p><p>
          <em class="replaceable"><code>crypt_str</code></em> 引数が暗号化された文字列として表示されない場合は、MySQL では指定された <em class="replaceable"><code>crypt_str</code></em> が返されます。
        </p></li><li class="listitem"><a name="function_des-encrypt"></a><p>
          <a class="indexterm" name="idm139979093724096"></a> <code class="literal">DES_ENCRYPT(<em class="replaceable"><code>str</code></em>[,{<em class="replaceable"><code>key_num</code></em>|<em class="replaceable"><code>key_str</code></em>}])</code>
        </p><p>
          Triple-DES アルゴリズムを使用して、指定された鍵で文字列を暗号化します。
        </p><p>
          この関数は、MySQL が SSL サポートで構成されている場合のみ機能します。<a class="xref" href="security.html#ssl-connections" title="6.3.10 セキュアな接続のための SSL の使用">セクション6.3.10「セキュアな接続のための SSL の使用」</a>を参照してください。
        </p><p>
          使用する暗号化鍵は、指定されていれば、<code class="literal">DES_ENCRYPT()</code> への 2 番目の引数に基づいて選択されます。引数を付けない場合は、DES 鍵ファイルの最初の鍵が使用されます。<em class="replaceable"><code>key_num</code></em> 引数を付けると、DES 鍵ファイルの指定された鍵番号 (0 - 9) が使用されます。<em class="replaceable"><code>key_str</code></em> 引数を付けた場合は、指定された鍵文字列を使用して <em class="replaceable"><code>str</code></em> が暗号化されます。
        </p><p>
          鍵ファイルは、<code class="option">--des-key-file</code> サーバーオプションを使用して指定できます。
        </p><p>
          返される文字列は、最初の文字が <code class="literal">CHAR(128 | <em class="replaceable"><code>key_num</code></em>)</code> であるバイナリ文字列です。エラーが発生した場合、<code class="literal">DES_ENCRYPT()</code> は <code class="literal">NULL</code> を返します。
        </p><p>
          暗号化された鍵を認識しやすくするために、128 が追加されます。文字列鍵を使用する場合、<em class="replaceable"><code>key_num</code></em> は 127 です。
        </p><p>
          結果の文字列の長さは、次の公式で指定されます。
        </p><pre class="programlisting">
<em class="replaceable"><code>new_len</code></em> = <em class="replaceable"><code>orig_len</code></em> + (8 - (<em class="replaceable"><code>orig_len</code></em> % 8)) + 1
</pre><p>
          DES 鍵ファイルの各行の書式は、次のとおりです。
        </p><pre class="programlisting">
<em class="replaceable"><code>key_num</code></em> <em class="replaceable"><code>des_key_str</code></em>
</pre><p>
          各 <em class="replaceable"><code>key_num</code></em> 値は、<code class="literal">0</code> から <code class="literal">9</code> までの範囲内の数字にする必要があります。ファイル内の行は、任意の順序で指定できます。<em class="replaceable"><code>des_key_str</code></em> は、メッセージを暗号化する際に使用される文字列です。数字と鍵の間には、少なくとも 1 つの空白文字を入れるようにしてください。最初の鍵は、<code class="literal">DES_ENCRYPT()</code> への鍵引数を指定しなかった場合に使用されるデフォルトのキーです。
        </p><p>
          <code class="literal">FLUSH DES_KEY_FILE</code> ステートメントで鍵ファイルから新しいキー値を読み取るように、MySQL に指示できます。これには、<code class="literal">RELOAD</code> 権限が必須です。
        </p><p>
          デフォルト鍵のセットを持つ利点は、これらの値を復号化する権利をエンドユーザーに付与せずに、暗号化されたカラム値の有無をチェックする方法がアプリケーションに提供されることです。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT customer_address FROM customer_table </code></strong>
     &gt; <strong class="userinput"><code>WHERE crypted_credit_card = DES_ENCRYPT('credit_card_number');</code></strong>
</pre></li><li class="listitem"><a name="function_encode"></a><p>
          <a class="indexterm" name="idm139979093688944"></a> <code class="literal">ENCODE(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pass_str</code></em>)</code>
        </p><p>
          パスワードとして <em class="replaceable"><code>pass_str</code></em> を使用して、<em class="replaceable"><code>str</code></em> を暗号化します。結果は、<em class="replaceable"><code>str</code></em> と同じ長さのバイナリ文字列です。結果を復号化するには、<code class="literal">DECODE()</code> を使用します。
        </p><p>
          <code class="literal">ENCODE()</code> 関数は使用されるべきではなくなっています。まだ <code class="literal">ENCODE()</code> を使用する必要がある場合は、リスクを軽減するために、一緒に salt 値を使用する必要があります。例:
        </p><pre class="programlisting">
ENCODE('plaintext', CONCAT('my_random_salt','my_secret_password'))
</pre><p>
          パスワードを更新するたびに、新しいランダムな salt 値を使用する必要があります。
        </p></li><li class="listitem"><a name="function_encrypt"></a><p>
          <a class="indexterm" name="idm139979093674512"></a> <code class="literal">ENCRYPT(<em class="replaceable"><code>str</code></em>[,<em class="replaceable"><code>salt</code></em>])</code>
        </p><p>
          Unix <code class="function">crypt()</code> システム呼び出しを使用して <em class="replaceable"><code>str</code></em> を暗号化し、バイナリ文字列を返します。<em class="replaceable"><code>salt</code></em> 引数は、2 つ以上の文字を含む文字列にする必要があります。それ以外の場合は、結果が <code class="literal">NULL</code> になります。<em class="replaceable"><code>salt</code></em> 引数が指定されていない場合は、ランダムな値が使用されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ENCRYPT('hello');</code></strong>
        -&gt; 'VxuFAJXVARROc'
</pre><p>
          少なくとも一部のシステムでは、<code class="literal">ENCRYPT()</code> は <em class="replaceable"><code>str</code></em> の最初の 8 文字以外のすべてを無視します。この動作は、ベースとなる <code class="function">crypt()</code> システム呼び出しの実装によって決まります。
        </p><p>
          システム呼び出しではゼロバイトで終了する文字列が要求されるため、<code class="literal">ucs2</code>、<code class="literal">utf16</code>、<code class="literal">utf16le</code>、または <code class="literal">utf32</code> マルチバイト文字セットを含む <code class="literal">ENCRYPT()</code> の使用は推奨されません。
        </p><p>
          システムで <code class="function">crypt()</code> を使用できない場合 (Windows の場合など)、<code class="literal">ENCRYPT()</code> は常に <code class="literal">NULL</code> を返します。
        </p></li><li class="listitem"><a name="function_md5"></a><p>
          <a class="indexterm" name="idm139979093650912"></a> <code class="literal">MD5(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列の MD5 128 ビットチェックサムを計算します。この値は、32 桁の 16 進数の文字列として返されます。引数が <code class="literal">NULL</code> だった場合は、<code class="literal">NULL</code> になります。たとえば、戻り値をハッシュ鍵として使用できます。効率的なハッシュ値の格納については、このセクションの冒頭で示した注記を参照してください。
        </p><p>
          戻り値は、接続文字セット内の非バイナリ文字列です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT MD5('testing');</code></strong>
        -&gt; 'ae2b1fca515949e5d54fb22b8ed95575'
</pre><p>
          これは、<span class="quote">「<span class="quote">RSA Data Security, Inc. MD5 Message-Digest Algorithm</span>」</span> です。
        </p><p>
          このセクションの冒頭で示した MD5 アルゴリズムに関する注記を参照してください。
        </p></li><li class="listitem"><a name="function_old-password"></a><p>
          <a class="indexterm" name="idm139979093637232"></a> <code class="literal">OLD_PASSWORD(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <code class="literal">OLD_PASSWORD()</code> は、セキュリティーを改善するために、MySQL 4.1 で <code class="literal">PASSWORD()</code> の実装が変更されたときに追加されました。<code class="literal">OLD_PASSWORD()</code> は、<code class="literal">PASSWORD()</code> の 4.1 よりも前の実装の値を文字列として返します。これは、バージョン 5.6 の MySQL サーバーに接続する必要のある 4.1 よりも前のクライアントをロックアウトせずに、それらのクライアントのパスワードをリセットするよう許可するためです。<a class="xref" href="security.html#password-hashing" title="6.1.2.4 MySQL でのパスワードハッシュ">セクション6.1.2.4「MySQL でのパスワードハッシュ」</a>を参照してください。
        </p><p>
          戻り値は、接続文字セット内の非バイナリ文字列です。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            4.1 より前のハッシュ方式を使用するパスワードはネイティブのパスワードハッシュ方式を使用するパスワードよりもセキュアでないため、使用しないようにしてください。4.1 よりも前のパスワードは非推奨であり、これらのサポートは今後の MySQL リリースで削除される予定です。最終的に、<code class="literal">OLD_PASSWORD()</code> も非推奨になりました。
          </p></div></li><li class="listitem"><a name="function_password"></a><p>
          <a class="indexterm" name="idm139979093621536"></a> <code class="literal">PASSWORD(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          平文のパスワード <em class="replaceable"><code>str</code></em> から計算してハッシュ化されたパスワード文字列を返します。戻り値は、接続文字セット内の非バイナリ文字列です。引数が <code class="literal">NULL</code> の場合は、<code class="literal">NULL</code> になります。この関数は、<code class="literal">mysql.user</code> 付与テーブルに格納する MySQL パスワードを暗号化する際に、サーバーで使用されるアルゴリズムへの SQL インタフェースです。
        </p><p>
          <code class="literal">old_passwords</code> システム変数は、<code class="literal">PASSWORD()</code> 関数で使用されるパスワードのハッシュ化方法を制御します。これは、<code class="literal">IDENTIFIED BY</code> 句を使用してパスワードを指定する <code class="literal">CREATE USER</code> および <code class="literal">GRANT</code> ステートメントによって実行されるパスワードハッシュにも影響します。
        </p><p>
          次の表は、<code class="literal">old_passwords</code> の許可される値、それぞれの値に対するパスワードハッシュ方式、およびそれぞれの方式でハッシュされたパスワードを使用する認証プラグインを示します。これらの値は MySQL 5.6.6 以降で許可されます。5.6.6 より前では、許可される値は 0 (または <code class="literal">OFF</code>) および 1 (または <code class="literal">ON</code>) です。
        </p><div class="informaltable"><table summary="次の表は、old_passwords の許可される値、それぞれの値に対するパスワードハッシュ方式、およびそれぞれの方式でハッシュされたパスワードを使用する認証プラグインを示します。" border="1"><colgroup><col><col><col></colgroup><thead><tr><th scope="col">値</th><th scope="col">パスワードハッシュ方式</th><th scope="col">関連付けられた認証プラグイン</th></tr></thead><tbody><tr><td scope="row">0</td><td>MySQL 4.1 ネイティブハッシュ</td><td><code class="literal">mysql_native_password</code></td></tr><tr><td scope="row">1</td><td>4.1 以前の (<span class="quote">「<span class="quote">古い</span>」</span>) ハッシュ</td><td><code class="literal">mysql_old_password</code></td></tr><tr><td scope="row">2</td><td>SHA-256 ハッシュ</td><td><code class="literal">sha256_password</code></td></tr></tbody></table></div><p>
          <code class="literal">old_passwords=1</code> の場合、<code class="literal">PASSWORD(<em class="replaceable"><code>str</code></em>)</code> は <code class="literal">OLD_PASSWORD(<em class="replaceable"><code>str</code></em>)</code> と同じ値を返します。後者の関数は <code class="literal">old_passwords</code> の値によって影響を受けません。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET old_passwords = 0;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT PASSWORD('mypass'), OLD_PASSWORD('mypass');</code></strong>
+-------------------------------------------+------------------------+
| PASSWORD('mypass')                        | OLD_PASSWORD('mypass') |
+-------------------------------------------+------------------------+
| *6C8989366EAF75BB670AD8EA7A7FC1176A95CEF4 | 6f8c114b58f2ce9e       |
+-------------------------------------------+------------------------+

mysql&gt; <strong class="userinput"><code>SET old_passwords = 1;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT PASSWORD('mypass'), OLD_PASSWORD('mypass');</code></strong>
+--------------------+------------------------+
| PASSWORD('mypass') | OLD_PASSWORD('mypass') |
+--------------------+------------------------+
| 6f8c114b58f2ce9e   | 6f8c114b58f2ce9e       |
+--------------------+------------------------+
</pre><p>
          SHA-256 パスワードのハッシュ化 (<code class="literal">old_passwords=2</code>) では、<code class="literal">PASSWORD()</code> からの結果を非決定的にするランダムな salt 値が使用されます。その結果、この関数が使用されるステートメントはステートメントベースのレプリケーションで安全ではなく、クエリーキャッシュ内に格納できません。
        </p><p>
          <a class="indexterm" name="idm139979093575968"></a><code class="literal">PASSWORD()</code> で実行される暗号化は一方向です (可逆ではありません)。暗号化のタイプは、Unix パスワードに使用されるものと同じではありません。そのタイプを使用するには、<code class="literal">ENCRYPT()</code> を使用します。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">PASSWORD()</code> 関数は、MySQL サーバーの認証システムで使用されます。独自のアプリケーションでは、<span class="emphasis"><em>使用しない</em></span>ようにしてください。そのためには、代わりに <code class="literal">MD5()</code> または <code class="literal">SHA2()</code> を使用してください。アプリケーションでのセキュアなパスワードの処理および認証セキュリティーについての詳細は、<a class="ulink" href="http://www.faqs.org/rfcs/rfc2195.html" target="_top">RFC 2195 のセクション 2 (「Challenge-Response Authentication Mechanism (CRAM)」)</a>も参照してください。
          </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            4.1 より前のハッシュ方式を使用するパスワードはネイティブのパスワードハッシュ方式を使用するパスワードよりもセキュアでないため、使用しないようにしてください。4.1 よりも前のパスワードは非推奨であり、これらのサポートは今後の MySQL リリースで削除される予定です。その結果、<code class="literal">PASSWORD()</code> で 4.1 以前のパスワードハッシュを生成する <code class="literal">old_passwords=1</code> も非推奨となります。アカウントのアップグレード手順については、<a class="xref" href="security.html#account-upgrades" title="6.3.8.3 4.1 よりも前のパスワードハッシュ方式と mysql_old_password プラグインからの移行">セクション6.3.8.3「4.1 よりも前のパスワードハッシュ方式と mysql_old_password プラグインからの移行」</a>を参照してください。
          </p></div><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注意</div><p>
            状況によっては、サーバーログまたはクライアント側の <code class="filename">~/.mysql_history</code> などの履歴ファイルに、<code class="literal">PASSWORD()</code> を呼び出すステートメントが記録される可能性があります。これは、その情報への読み取りアクセス権を持っているユーザーならだれでも、平文のパスワードを読み取る可能性があることを意味します。これがサーバーログで発生する条件およびこれを制御する方法については、<a class="xref" href="security.html#password-logging" title="6.1.2.3 パスワードおよびロギング">セクション6.1.2.3「パスワードおよびロギング」</a>を参照してください。クライアント側のロギングに関する同様の情報については、<a class="xref" href="programs.html#mysql-logging" title="4.5.1.3 mysql のロギング">セクション4.5.1.3「mysql のロギング」</a>を参照してください。
          </p></div></li><li class="listitem"><a name="function_random-bytes"></a><p>
          <a class="indexterm" name="idm139979093553456"></a> <code class="literal">RANDOM_BYTES(<em class="replaceable"><code>len</code></em>)</code>
        </p><p>
          この関数は、SSL ライブラリ (OpenSSL または yaSSL) の乱数ジェネレータを使用して生成されたランダムな <em class="replaceable"><code>len</code></em> バイトのバイナリ文字列を返します。<em class="replaceable"><code>len</code></em> で許可されている値は、1 から 1024 までの範囲内です。値がこの範囲外の場合、<code class="literal">RANDOM_BYTES()</code> は警告を生成し、<code class="literal">NULL</code> を返します。
        </p><p>
          <code class="literal">RANDOM_BYTES()</code> を使用すると、<code class="literal">AES_DECRYPT()</code> および <code class="literal">AES_ENCRYPT()</code> 関数に初期化ベクトルを提供できます。このコンテキストで使用するには、<em class="replaceable"><code>len</code></em> を 16 以上にする必要があります。さらに大きい値も許可されますが、16 を超えるバイトは無視されます。
        </p><p>
          <code class="literal">RANDOM_BYTES()</code> は、その結果を非決定的にするランダムな値を生成します。その結果、この関数が使用されるステートメントはステートメントベースのレプリケーションに対して安全ではなく、クエリーキャッシュ内に格納できません。
        </p><p>
          この関数は、MySQL 5.6.17 の時点で使用可能です。
        </p></li><li class="listitem"><a name="function_sha1"></a><p>
          <a class="indexterm" name="idm139979093535488"></a> <a class="indexterm" name="idm139979093534144"></a> <code class="literal">SHA1(<em class="replaceable"><code>str</code></em>)</code>、<code class="literal">SHA(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          RFC 3174 (Secure Hash Algorithm) で説明されているように、文字列の SHA-1 160 ビットチェックサムを計算します。この値は、40 桁の 16 進数の文字列として返されます。引数が <code class="literal">NULL</code> だった場合は、<code class="literal">NULL</code> になります。この関数を使用する一例として、ハッシュ鍵が考えられます。効率的なハッシュ値の格納については、このセクションの冒頭で示した注記を参照してください。<code class="literal">SHA1()</code> は、パスワードを格納する暗号化関数としても使用できます。<code class="literal">SHA()</code> は <code class="literal">SHA1()</code> のシノニムです。
        </p><p>
          戻り値は、接続文字セット内の非バイナリ文字列です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SHA1('abc');</code></strong>
        -&gt; 'a9993e364706816aba3e25717850c26c9cd0d89d'
</pre><p>
          <code class="literal">SHA1()</code> は <code class="literal">MD5()</code> と同等ですが、暗号化に関してはよりセキュアであると考えられます。ただし、このセクションの冒頭で示した MD5 と SHA-1 アルゴリズムに関する注記を参照してください。
        </p></li><li class="listitem"><a name="function_sha2"></a><p>
          <a class="indexterm" name="idm139979093513264"></a> <code class="literal">SHA2(<em class="replaceable"><code>str</code></em>, <em class="replaceable"><code>hash_length</code></em>)</code>
        </p><p>
          SHA-2 ファミリのハッシュ関数 (SHA-224、SHA-256、SHA-384、および SHA-512) を計算します。1 番目の引数は、ハッシュ化される平文の文字列です。2 番目の引数には、結果の目的のビット長が指定されます。値は、224、256、384、512、または 0 (256 と同等です) にする必要があります。引数のいずれかが <code class="literal">NULL</code> の場合や、ハッシュの長さが許可される値のいずれでもない場合は、戻り値が <code class="literal">NULL</code> になります。それ以外の場合は、関数の結果が目的のビット数が含まれるハッシュ値になります。効率的なハッシュ値の格納については、このセクションの冒頭で示した注記を参照してください。
        </p><p>
          戻り値は、接続文字セット内の非バイナリ文字列です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SHA2('abc', 224);</code></strong>
        -&gt; '23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7'
</pre><p>
          この関数は、MySQL が SSL サポートで構成されている場合のみ機能します。<a class="xref" href="security.html#ssl-connections" title="6.3.10 セキュアな接続のための SSL の使用">セクション6.3.10「セキュアな接続のための SSL の使用」</a>を参照してください。
        </p><p>
          <code class="literal">SHA2()</code> は <code class="literal">MD5()</code> や <code class="literal">SHA1()</code> よりも、暗号化に関してはよりセキュアであると考えられます。
        </p></li><li class="listitem"><a name="function_uncompress"></a><p>
          <a class="indexterm" name="idm139979093495312"></a> <code class="literal">UNCOMPRESS(<em class="replaceable"><code>string_to_uncompress</code></em>)</code>
        </p><p>
          <code class="literal">COMPRESS()</code> 関数で圧縮された文字列を圧縮解除します。引数が圧縮された値でない場合は、結果が <code class="literal">NULL</code> になります。この関数を使用するには、MySQL が <code class="literal">zlib</code> などの圧縮ライブラリを使用してコンパイルされている必要があります。そうでない場合、戻り値は常に <code class="literal">NULL</code> になります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UNCOMPRESS(COMPRESS('any string'));</code></strong>
        -&gt; 'any string'
mysql&gt; <strong class="userinput"><code>SELECT UNCOMPRESS('any string');</code></strong>
        -&gt; NULL
</pre></li><li class="listitem"><a name="function_uncompressed-length"></a><p>
          <a class="indexterm" name="idm139979093481440"></a> <code class="literal">UNCOMPRESSED_LENGTH(<em class="replaceable"><code>compressed_string</code></em>)</code>
        </p><p>
          圧縮された文字列が圧縮される前の長さを返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UNCOMPRESSED_LENGTH(COMPRESS(REPEAT('a',30)));</code></strong>
        -&gt; 30
</pre></li><li class="listitem"><a name="function_validate-password-strength"></a><p>
          <a class="indexterm" name="idm139979093472048"></a> <code class="literal">VALIDATE_PASSWORD_STRENGTH(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          平文のパスワードを表す引数が指定された場合、この関数はパスワードの強度を示す整数を返します。戻り値は、0 (弱) から 100 (強) までの範囲内です。
        </p><p>
          パスワードは、一段と厳密になったテストの対象であり、戻り値は、次の表に示すように、どのテストに合格したのかを示します。
        </p><div class="informaltable"><table summary="次の表には、VALIDATE_PASSWORD_STRENGTH() 関数のパスワードテストを一覧表示し、各パスワードテストで返される値を示します。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">パスワードテスト</th><th scope="col">戻り値</th></tr></thead><tbody><tr><td scope="row">長さ &lt; 4</td><td>0</td></tr><tr><td scope="row">長さ ≥ 4 および &lt; <code class="literal">validate_password_length</code></td><td>25</td></tr><tr><td scope="row">ポリシー 1 を満たす (<code class="literal">LOW</code>)</td><td>50</td></tr><tr><td scope="row">ポリシー 2 を満たす (<code class="literal">MEDIUM</code>)</td><td>75</td></tr><tr><td scope="row">ポリシー 3 を満たす (<code class="literal">STRONG</code>)</td><td>100</td></tr></tbody></table></div><p>
          <code class="literal">VALIDATE_PASSWORD_STRENGTH()</code> によるパスワードの評価は、<code class="literal">validate_password</code> プラグインで実行されます。このプラグインがインストールされていない場合、関数は常に 0 を返します。<code class="literal">validate_password</code> プラグインのインストールについては、<a class="xref" href="security.html#validate-password-plugin" title="6.1.2.6 パスワード検証プラグイン">セクション6.1.2.6「パスワード検証プラグイン」</a>を参照してください。パスワードのテストに影響を与えるパラメータを確認または構成するには、<code class="literal">validate_password</code> プラグインで実装されているシステム変数をチェックまたは設定します。<a class="xref" href="security.html#validate-password-options-variables" title="6.1.2.6.2 パスワード検証プラグインのオプションおよび変数">セクション6.1.2.6.2「パスワード検証プラグインのオプションおよび変数」</a>を参照してください。
        </p><p>
          この関数は、MySQL 5.6.6 で追加されました。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="information-functions"></a>12.14 情報関数</h2></div></div></div><a class="indexterm" name="idm139979093443296"></a><a class="indexterm" name="idm139979093441824"></a><div class="table"><a name="idm139979093439792"></a><p class="title"><b>表 12.18 情報関数</b></p><div class="table-contents"><table summary="情報関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a></td><td>
      式を繰り返し実行します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_charset"><code class="literal">CHARSET()</code></a></td><td>
      引数の文字セットを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_coercibility"><code class="literal">COERCIBILITY()</code></a></td><td>
      文字列引数の照合順序強制性値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_collation"><code class="literal">COLLATION()</code></a></td><td>
      文字列引数の照合順序を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a></td><td>
      接続のための接続 ID (スレッド ID) を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code>, <code class="literal">CURRENT_USER</code></a></td><td>
      認証済みユーザー名とホスト名
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a></td><td>
      デフォルト (現在) のデータベース名を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a></td><td>
      LIMIT 句付き SELECT で、LIMIT
      句がない場合に戻される可能性がある行の数です
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a></td><td>
      前回の INSERT での AUTOINCREMENT カラムの値です
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a></td><td>
      更新された行数
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_schema"><code class="literal">SCHEMA()</code></a></td><td>
      DATABASE() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a></td><td>
      USER() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a></td><td>
      USER() のシノニムです
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a></td><td>
      ユーザー名と、クライアントによって提供されるホスト名です
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_version"><code class="literal">VERSION()</code></a></td><td>
      MySQL
      サーバーのバージョンを示す文字列を返します
    </td></tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_benchmark"></a><p>
          <a class="indexterm" name="idm139979093402624"></a> <code class="literal">BENCHMARK(<em class="replaceable"><code>count</code></em>,<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          <code class="literal">BENCHMARK()</code> 関数は、式 <em class="replaceable"><code>expr</code></em> を <em class="replaceable"><code>count</code></em> の回数だけ繰り返し実行します。MySQL による式の処理速度を計測する際に使用される場合もあります。結果の値は常に <code class="literal">0</code> になります。この使用目的は、<span class="command"><strong>mysql</strong></span> クライアント内から、クエリーの実行時間をレポートすることです。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT BENCHMARK(1000000,ENCODE('hello','goodbye'));</code></strong>
+----------------------------------------------+
| BENCHMARK(1000000,ENCODE('hello','goodbye')) |
+----------------------------------------------+
|                                            0 |
+----------------------------------------------+
1 row in set (4.74 sec)
</pre><p>
          レポートされる時間は、クライアント側での経過時間であり、サーバー側での CPU 時間ではありません。<code class="literal">BENCHMARK()</code> を複数回実行し、サーバーマシン上の負荷量について結果を解釈することをお勧めします。
        </p><p>
          <code class="literal">BENCHMARK()</code> の目的は、スカラー式の実行時パフォーマンスを測定することです。これにより、その使用方法や結果の解釈方法について、重要ないくつかの推測が提供されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              スカラー式しか使用できません。式をサブクエリーにすることはできますが、単一のカラムおよび最大でも単一の行が返される必要があります。たとえば、テーブル <code class="literal">t</code> に複数のカラムや複数の行が含まれていると、<code class="literal">BENCHMARK(10, (SELECT * FROM t))</code> は失敗します。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT <em class="replaceable"><code>expr</code></em></code> ステートメントを <em class="replaceable"><code>N</code></em> 回実行する場合と、<code class="literal">SELECT BENCHMARK(<em class="replaceable"><code>N</code></em>, <em class="replaceable"><code>expr</code></em>)</code> を実行する場合とでは、発生するオーバーヘッドの量が異なります。この 2 つは非常に異なる実行プロファイルを持つため、両者の所要時間は同一になりません。前者では、パーサー、オプティマイザ、テーブルロック、および実行時評価がそれぞれ <em class="replaceable"><code>N</code></em> 回ずつ発生します。後者では、実行時評価のみが <em class="replaceable"><code>N</code></em> 回発生し、その他のすべてのコンポーネントは 1 回だけ発生します。割り当て済みのメモリー構造体は再使用され、集約関数で評価済みの結果をローカルキャッシュに入れるなどの実行時最適化によって、結果が変わる可能性もあります。したがって、<code class="literal">BENCHMARK()</code> を使用して、実行時コンポーネントに高い重みを付加し、ネットワーク、パーサー、オプティマイザなどで導入された<span class="quote">「<span class="quote">ノイズ</span>」</span>を削除することで、そのコンポーネントのパフォーマンスが測定されます。
            </p></li></ul></div></li><li class="listitem"><a name="function_charset"></a><p>
          <a class="indexterm" name="idm139979093373840"></a> <code class="literal">CHARSET(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列引数の文字セットを返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CHARSET('abc');</code></strong>
        -&gt; 'latin1'
mysql&gt; <strong class="userinput"><code>SELECT CHARSET(CONVERT('abc' USING utf8));</code></strong>
        -&gt; 'utf8'
mysql&gt; <strong class="userinput"><code>SELECT CHARSET(USER());</code></strong>
        -&gt; 'utf8'
</pre></li><li class="listitem"><a name="function_coercibility"></a><p>
          <a class="indexterm" name="idm139979093362960"></a> <code class="literal">COERCIBILITY(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列引数の照合順序強制性値を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT COERCIBILITY('abc' COLLATE latin1_swedish_ci);</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT COERCIBILITY(USER());</code></strong>
        -&gt; 3
mysql&gt; <strong class="userinput"><code>SELECT COERCIBILITY('abc');</code></strong>
        -&gt; 4
</pre><p>
          戻り値の意味は、次の表に示すとおりです。値が低いほど、優先順位は高くなります。
        </p><div class="informaltable"><table summary="この表には、照合順序強制性の戻り値と各値の意味を一覧表示し、それぞれの例を示します。" border="1"><colgroup><col><col><col></colgroup><thead><tr><th scope="col">型変換属性</th><th scope="col">意味</th><th scope="col">例</th></tr></thead><tbody><tr><td scope="row"><code class="literal">0</code></td><td>明示的な照合順序</td><td><code class="literal">COLLATE</code> 句の値</td></tr><tr><td scope="row"><code class="literal">1</code></td><td>照合順序なし</td><td>さまざまな照合順序との文字列の連結</td></tr><tr><td scope="row"><code class="literal">2</code></td><td>暗黙的な照合順序</td><td>カラム値、ストアドルーチンパラメータ、またはローカル変数</td></tr><tr><td scope="row"><code class="literal">3</code></td><td>系統定数</td><td><code class="literal">USER()</code> の戻り値</td></tr><tr><td scope="row"><code class="literal">4</code></td><td>型変換可能</td><td>リテラル文字列</td></tr><tr><td scope="row"><code class="literal">5</code></td><td>無視可能</td><td><code class="literal">NULL</code> または <code class="literal">NULL</code> から派生した式</td></tr></tbody></table></div></li><li class="listitem"><a name="function_collation"></a><p>
          <a class="indexterm" name="idm139979093330896"></a> <code class="literal">COLLATION(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          文字列引数の照合順序を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT COLLATION('abc');</code></strong>
        -&gt; 'latin1_swedish_ci'
mysql&gt; <strong class="userinput"><code>SELECT COLLATION(_utf8'abc');</code></strong>
        -&gt; 'utf8_general_ci'
</pre></li><li class="listitem"><a name="function_connection-id"></a><p>
          <a class="indexterm" name="idm139979093320720"></a> <code class="literal">CONNECTION_ID()</code>
        </p><p>
          接続用の接続 ID (スレッド ID) を返します。すべての接続は、現在接続されているクライアントのセット間で一意の ID を持っています。
        </p><p>
          <code class="literal">CONNECTION_ID()</code> で返される値の型は、<code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> テーブルの <code class="literal">ID</code> カラム、<code class="literal">SHOW PROCESSLIST</code> 出力の <code class="literal">Id</code> カラム、およびパフォーマンススキーマ <code class="literal">threads</code> テーブルの <code class="literal">PROCESSLIST_ID</code> カラムに表示される値と同じです。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CONNECTION_ID();</code></strong>
        -&gt; 23786
</pre></li><li class="listitem"><a name="function_current-user"></a><p>
          <a class="indexterm" name="idm139979093304880"></a> <code class="literal">CURRENT_USER</code>, <code class="literal">CURRENT_USER()</code>
        </p><p>
          現在のクライアントを認証する際にサーバーで使用された MySQL アカウントを表すユーザー名とホスト名の組み合わせを返します。このアカウントで、アクセス権限が決まります。戻り値は、<code class="literal">utf8</code> 文字セット内の文字列です。
        </p><p>
          <code class="literal">CURRENT_USER()</code> の値は、<code class="literal">USER()</code> の値とは異なる可能性があります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT USER();</code></strong>
        -&gt; 'davida@localhost'
mysql&gt; <strong class="userinput"><code>SELECT * FROM mysql.user;</code></strong>
ERROR 1044: Access denied for user ''@'localhost' to
database 'mysql'
mysql&gt; <strong class="userinput"><code>SELECT CURRENT_USER();</code></strong>
        -&gt; '@localhost'
</pre><p>
          この例は、クライアントが <code class="literal">davida</code> のユーザー名を指定 (<code class="literal">USER()</code> 関数の値で指定されます) したが、サーバーは匿名のユーザーアカウント (<code class="literal">CURRENT_USER()</code> 値の空のユーザー名部分に表示されます) を使用してクライアントを認証したことを示しています。これが発生する原因として、<code class="literal">davida</code> の付与テーブルにアカウントが一覧表示されていないことが考えられます。
        </p><p>
          ストアドプログラムまたはビューでは、<code class="literal">SQL SECURITY INVOKER</code> 特性で定義されていなければ、<code class="literal">CURRENT_USER()</code> はオブジェクトを定義したユーザー (その <code class="literal">DEFINER</code> 値で指定されます) のアカウントを返します。後者の場合、<code class="literal">CURRENT_USER()</code> はオブジェクトを呼び出したユーザーを返します。
        </p><p>
          トリガーおよびイベントには、<code class="literal">SQL SECURITY</code> 特性を定義するためのオプションがありません。したがって、このようなオブジェクトの場合、<code class="literal">CURRENT_USER()</code> はオブジェクトを定義したユーザーのアカウントを返します。呼び出したユーザーを返すには、<code class="literal">USER()</code> または <code class="literal">SESSION_USER()</code> を使用します。
        </p><p>
          次のステートメントでは、影響を受けるユーザーや定義したユーザーの名前 (ホストの可能性もあります) の代わりに、<code class="literal">CURRENT_USER()</code> 関数を使用することがサポートされています。このような場合、必要に応じて <code class="literal">CURRENT_USER()</code> が拡張されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">DROP USER</code>
            </p></li><li class="listitem"><p>
              <code class="literal">RENAME USER</code>
            </p></li><li class="listitem"><p>
              <code class="literal">GRANT</code>
            </p></li><li class="listitem"><p>
              <code class="literal">REVOKE</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE FUNCTION</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE PROCEDURE</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE TRIGGER</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE EVENT</code>
            </p></li><li class="listitem"><p>
              <code class="literal">CREATE VIEW</code>
            </p></li><li class="listitem"><p>
              <code class="literal">ALTER EVENT</code>
            </p></li><li class="listitem"><p>
              <code class="literal">ALTER VIEW</code>
            </p></li><li class="listitem"><p>
              <code class="literal">SET PASSWORD</code>
            </p></li></ul></div><p>
          このような <code class="literal">CURRENT_USER()</code> の拡張がさまざまな MySQL 5.6 リリースのレプリケーションで持つ意味については、<a class="xref" href="replication.html#replication-features-current-user" title="17.4.1.7 CURRENT_USER() のレプリケーション">セクション17.4.1.7「CURRENT_USER() のレプリケーション」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_database"></a><p>
          <a class="indexterm" name="idm139979093249152"></a> <code class="literal">DATABASE()</code>
        </p><p>
          デフォルト (現在) のデータベース名を <code class="literal">utf8</code> 文字セット内の文字列として返します。デフォルトのデータベースがない場合は、<code class="literal">DATABASE()</code> は <code class="literal">NULL</code> を返します。ストアドルーチン内では、デフォルトのデータベースはルーチンが関連付けられたデータベースですが、これは呼び出し元のコンテキストでのデフォルトのデータベースと同じであるとはかぎりません。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT DATABASE();</code></strong>
        -&gt; 'test'
</pre><p>
          デフォルトのデータベースがない場合は、<code class="literal">DATABASE()</code> は <code class="literal">NULL</code> を返します。
        </p></li><li class="listitem"><a name="function_found-rows"></a><p>
          <a class="indexterm" name="idm139979093234736"></a> <a class="indexterm" name="idm139979093233392"></a> <code class="literal">FOUND_ROWS()</code>
        </p><p>
          サーバーからクライアントに返される行の数を制限するために、<code class="literal">SELECT</code> ステートメントに <code class="literal">LIMIT</code> 句が含まれている場合があります。場合によっては、ステートメントを再度実行せずに、<code class="literal">LIMIT</code> を付けなかった場合にステートメントで返されるはずの行数を知っておくことが望ましいことがあります。この行数を取得するには、<code class="literal">SELECT</code> ステートメントに <code class="literal">SQL_CALC_FOUND_ROWS</code> オプションを付けてから、<code class="literal">FOUND_ROWS()</code> を呼び出します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SQL_CALC_FOUND_ROWS * FROM <em class="replaceable"><code>tbl_name</code></em></code></strong>
    -&gt; <strong class="userinput"><code>WHERE id &gt; 100 LIMIT 10;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT FOUND_ROWS();</code></strong>
</pre><p>
          2 番目の <code class="literal">SELECT</code> は、1 番目の <code class="literal">SELECT</code> を <code class="literal">LIMIT</code> 句なしで記述した場合に返される行数を示す数字を返します。
        </p><p>
          最近成功した <code class="literal">SELECT</code> ステートメントに <code class="literal">SQL_CALC_FOUND_ROWS</code> オプションを付けなければ、<code class="literal">FOUND_ROWS()</code> は、そのステートメントで返された結果セットの行数を返します。ステートメントに <code class="literal">LIMIT</code> 句が含まれている場合、<code class="literal">FOUND_ROWS()</code> はその制限値以下の行数を返します。たとえば、ステートメントに <code class="literal">LIMIT 10</code> または <code class="literal">LIMIT 50, 10</code> が含まれている場合、<code class="literal">FOUND_ROWS()</code> はそれぞれ 10 と 60 を返します。
        </p><p>
          <code class="literal">FOUND_ROWS()</code> から取得できる行数は一時的なもので、<code class="literal">SELECT SQL_CALC_FOUND_ROWS</code> ステートメントのあとに、このステートメントを発行しても取得できるようには設計されていません。あとで値を参照する必要がある場合は、保存してください。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SQL_CALC_FOUND_ROWS * FROM ... ;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @rows = FOUND_ROWS();</code></strong>
</pre><p>
          <code class="literal">SELECT SQL_CALC_FOUND_ROWS</code> を使用している場合は、MySQL では完全な結果セット内の行数を計算する必要があります。ただし、結果セットはクライアントに送信される必要がないため、<code class="literal">LIMIT</code> なしでクエリーを再度実行するよりも速くなります。
        </p><p>
          <code class="literal">SQL_CALC_FOUND_ROWS</code> および <code class="literal">FOUND_ROWS()</code> は、クエリーで返される行数を制限するが、クエリーを再度実行しないで完全な結果セット内の行数を確認する必要がある状況でも役立ちます。例として、検索結果のほかのセクションを表示するページへのリンクを含むページが表示される Web スクリプトがあります。<code class="literal">FOUND_ROWS()</code> を使用すると、残りの結果を表示するために必要なその他のページ数を確認できます。
        </p><p>
          <code class="literal">SQL_CALC_FOUND_ROWS</code> および <code class="literal">FOUND_ROWS()</code> を使用すると、<code class="literal">UNION</code> の複数箇所で <code class="literal">LIMIT</code> が発生する可能性があるため、単純な <code class="literal">SELECT</code> ステートメントよりも、<code class="literal">UNION</code> ステートメントで使用した方が複雑になります。これは、<code class="literal">UNION</code> 内の個々の <code class="literal">SELECT</code> ステートメントに適用される場合と、<code class="literal">UNION</code> の結果全体にグローバルに適用される場合があります。
        </p><p>
          <code class="literal">UNION</code> で <code class="literal">SQL_CALC_FOUND_ROWS</code> を使用する目的は、グローバルな <code class="literal">LIMIT</code> なしで返される行数を返すことです。<code class="literal">UNION</code> で <code class="literal">SQL_CALC_FOUND_ROWS</code> を使用する条件は、次のとおりです。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">UNION</code> の 1 番目の <code class="literal">SELECT</code> に、<code class="literal">SQL_CALC_FOUND_ROWS</code> キーワードが表示される必要があります。
            </p></li><li class="listitem"><p>
              <code class="literal">FOUND_ROWS()</code> の値は、<code class="literal">UNION ALL</code> が使用されている場合にのみ正確です。<code class="literal">ALL</code> なしで <code class="literal">UNION</code> が使用される場合は、重複の削除が発生し、<code class="literal">FOUND_ROWS()</code> の値が単なる近似値になります。
            </p></li><li class="listitem"><p>
              <code class="literal">UNION</code> で <code class="literal">LIMIT</code> が表示されない場合は、<code class="literal">SQL_CALC_FOUND_ROWS</code> が無視され、<code class="literal">UNION</code> を処理するために作成された一時テーブル内の行数が返されます。
            </p></li></ul></div><p>
          ここで説明した以外のケースでは、<code class="literal">FOUND_ROWS()</code> の動作 (エラーが発生して <code class="literal">SELECT</code> ステートメントに失敗したあとの値など) が定義されません。
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            ステートメントベースのレプリケーションでは、確実に <code class="literal">FOUND_ROWS()</code> をレプリケートすることはできません。行ベースのレプリケーションを使用すると、この関数は自動的にレプリケートされます。
          </p></div></li><li class="listitem"><a name="function_last-insert-id"></a><p>
          <a class="indexterm" name="idm139979093160656"></a> <code class="literal">LAST_INSERT_ID()</code>、<code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          <code class="literal">LAST_INSERT_ID()</code> に引数を付けない場合は、最近実行された <code class="literal">INSERT</code> ステートメントの結果として、最初に自動的に生成され、正常に <code class="literal">AUTO_INCREMENT</code> カラムに挿入された値を表す 64 ビット値が返されます。この値の型は、MySQL 5.6.9 の時点では <code class="literal">BIGINT UNSIGNED</code>、それよりも前では <code class="literal">BIGINT</code> (符号付き) です。正常に挿入された行がない場合は、<code class="literal">LAST_INSERT_ID()</code> の値は未変更のままです。
        </p><p>
          <code class="literal">LAST_INSERT_ID()</code> に引数を付けない場合は、MySQL 5.6.9 の時点では符号なし整数、それよりも前では符号付き整数が返されます。
        </p><p>
          たとえば、<code class="literal">AUTO_INCREMENT</code> 値を生成する行を挿入したあとは、次のようにして値を取得できます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
        -&gt; 195
</pre><p>
          現在実行中のステートメントによって、<code class="literal">LAST_INSERT_ID()</code> の値は影響を受けません。1 つのステートメントで <code class="literal">AUTO_INCREMENT</code> 値を生成してから、独自の <code class="literal">AUTO_INCREMENT</code> カラムを含むテーブルに行を挿入する複数行の <code class="literal">INSERT</code> ステートメントで <code class="literal">LAST_INSERT_ID()</code> を参照すると仮定します。<code class="literal">LAST_INSERT_ID()</code> の値は、2 番目のステートメントでも未変更のままです。2 番目以降の行でも、その値は以前に行われた行の挿入による影響を受けません。(ただし、<code class="literal">LAST_INSERT_ID()</code> と <code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code> への参照を混在させると、効果は定義されません。)
        </p><p>
          以前のステートメントでエラーが返された場合は、<code class="literal">LAST_INSERT_ID()</code> の値が定義されません。トランザクションテーブルでは、エラーによってステートメントがロールバックされる場合、<code class="literal">LAST_INSERT_ID()</code> の値は未定義のままです。手動の <code class="literal">ROLLBACK</code> では、<code class="literal">LAST_INSERT_ID()</code> の値はトランザクション前の値にリストアされず、<code class="literal">ROLLBACK</code> 時点と同じままです。
        </p><p>
          MySQL 5.6.15 よりも前では、レプリケーションのフィルタ処理ルールが使用されている場合に、この関数が正常にレプリケートされませんでした。(Bug #17234370、Bug #69861)
        </p><p>
          ストアドルーチン (プロシージャーや関数) またはトリガーの本文内では、<code class="literal">LAST_INSERT_ID()</code> の値は、このような種類のオブジェクトの本文外で実行されたステートメントと同様に変更されます。あとに続くステートメントで参照される <code class="literal">LAST_INSERT_ID()</code> の値でのストアドルーチンまたはトリガーの効果は、ルーチンの種類によって異なります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              ストアドプロシージャーで <code class="literal">LAST_INSERT_ID()</code> の値を変更するステートメントが実行される場合は、プロシージャー呼び出しが続くステートメントで変更された値が参照されます。
            </p></li><li class="listitem"><p>
              値を変更するストアドファンクションおよびトリガーでは、値は関数やトリガーが終了したときにリストアされ、あとに続くステートメントでは変更された値が参照されません。
            </p></li></ul></div><p>
          生成された ID は、<span class="emphasis"><em>接続ごとに</em></span>サーバー内に保持されます。つまり、関数によって指定されたクライアントに返された値は、<span class="emphasis"><em>そのクライアントによって</em></span> <code class="literal">AUTO_INCREMENT</code> カラムに影響を与える最近のステートメント用に最初に生成された <code class="literal">AUTO_INCREMENT</code> 値です。この値は、ほかのクライアントが独自の <code class="literal">AUTO_INCREMENT</code> 値を生成した場合でも影響を受ける可能性はありません。この動作によって、各クライアントはほかのクライアントのアクティビティーを気にすることなく、ロックやトランザクションを実行しないで独自の ID を取得できます。
        </p><p>
          行の <code class="literal">AUTO_INCREMENT</code> カラムを非<span class="quote">「<span class="quote">マジック</span>」</span>値 (つまり、<code class="literal">NULL</code> でも <code class="literal">0</code> でもない値) に設定する場合は、<code class="literal">LAST_INSERT_ID()</code> の値が変更されません。
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            単一の <code class="literal">INSERT</code> ステートメントを使用して複数の行を挿入する場合、<code class="literal">LAST_INSERT_ID()</code> は、<span class="emphasis"><em>最初に</em></span>挿入された行<span class="emphasis"><em>のみ</em></span>に対して生成された値を返します。この理由は、ほかの一部のサーバーに対して同じ <code class="literal">INSERT</code> ステートメントを簡単に再現できるようにするためです。
          </p></div><p>
          例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>USE test;</code></strong>
Database changed
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (</code></strong>
    -&gt;   <strong class="userinput"><code>id INT AUTO_INCREMENT NOT NULL PRIMARY KEY,</code></strong>
    -&gt;   <strong class="userinput"><code>name VARCHAR(10) NOT NULL</code></strong>
    -&gt; <strong class="userinput"><code>);</code></strong>
Query OK, 0 rows affected (0.09 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES (NULL, 'Bob');</code></strong>
Query OK, 1 row affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM t;</code></strong>
+----+------+
| id | name |
+----+------+
|  1 | Bob  |
+----+------+
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
+------------------+
| LAST_INSERT_ID() |
+------------------+
|                1 |
+------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES</code></strong>
    -&gt; <strong class="userinput"><code>(NULL, 'Mary'), (NULL, 'Jane'), (NULL, 'Lisa');</code></strong>
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; SELECT * FROM t;
+----+------+
| id | name |
+----+------+
|  1 | Bob  |
|  2 | Mary |
|  3 | Jane |
|  4 | Lisa |
+----+------+
4 rows in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
+------------------+
| LAST_INSERT_ID() |
+------------------+
|                2 |
+------------------+
1 row in set (0.00 sec)
</pre><p>
          2 番目の <code class="literal">INSERT</code> ステートメントで 3 つの新しい行が <code class="literal">t</code> に挿入されましたが、これらの行の 1 番目に生成された ID は <code class="literal">2</code> であり、あとに続く <code class="literal">SELECT</code> ステートメントでも、この値が <code class="literal">LAST_INSERT_ID()</code> によって返されます。
        </p><p>
          <code class="literal">INSERT IGNORE</code> を使用し、その行が無視された場合、<code class="literal">LAST_INSERT_ID()</code> は現在の値から未変更のままです (接続で正常な <code class="literal">INSERT</code> が実行されていない場合は、0 が返されます)。トランザクショナル以外のテーブルでは、<code class="literal">AUTO_INCREMENT</code> カウンタが増分されません。<code class="literal">InnoDB</code> テーブルでは、<code class="literal">innodb_autoinc_lock_mode</code> が <code class="literal">1</code> または <code class="literal">2</code> に設定されている場合は、次の例で示すように <code class="literal">AUTO_INCREMENT</code> が増分されます。
        </p><pre class="programlisting">mysql&gt; USE test;
Database changed

mysql&gt; SELECT @@innodb_autoinc_lock_mode;
+----------------------------+
| @@innodb_autoinc_lock_mode |
+----------------------------+
|                          1 |
+----------------------------+
1 row in set (0.00 sec)

mysql&gt; CREATE TABLE `t` (
`id` INT(11) NOT NULL AUTO_INCREMENT,
`val` INT(11) DEFAULT NULL,
PRIMARY KEY (`id`),
UNIQUE KEY `i1` (`val`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
Query OK, 0 rows affected (0.02 sec)

-- Insert two rows

mysql&gt; INSERT INTO t (val) VALUES (1),(2);
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

-- With auto_increment_offset=1, the inserted rows
-- result in an AUTO_INCREMENT value of 3

mysql&gt; SHOW CREATE TABLE t\G
*************************** 1. row ***************************
       Table: t
Create Table: CREATE TABLE `t` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `val` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `i1` (`val`)
) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1
1 row in set (0.00 sec)

-- LAST_INSERT_ID() returns the first automatically generated 
-- value that is successfully inserted for the AUTO_INCREMENT column

mysql&gt; SELECT LAST_INSERT_ID();
+------------------+
| LAST_INSERT_ID() |
+------------------+
|                1 |
+------------------+
1 row in set (0.00 sec)

-- The attempted insertion of duplicate rows fail but errors are ignored     

mysql&gt; INSERT IGNORE INTO t (val) VALUES (1),(2);
Query OK, 0 rows affected (0.00 sec)
Records: 2  Duplicates: 2  Warnings: 0

-- With innodb_autoinc_lock_mode=1, the AUTO_INCREMENT counter 
-- is incremented for the ignored rows

mysql&gt; SHOW CREATE TABLE t\G
*************************** 1. row ***************************
       Table: t
Create Table: CREATE TABLE `t` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `val` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `i1` (`val`)
) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1
1 row in set (0.00 sec)

-- The LAST_INSERT_ID is unchanged becuase the previous insert was unsuccessful

mysql&gt; SELECT LAST_INSERT_ID();
+------------------+
| LAST_INSERT_ID() |
+------------------+
|                1 |
+------------------+
1 row in set (0.00 sec)        </pre><p>
          詳細は、<a class="xref" href="innodb-storage-engine.html#innodb-auto-increment-handling" title="14.6.5 InnoDB での AUTO_INCREMENT 処理">セクション14.6.5「InnoDB での AUTO_INCREMENT 処理」</a>を参照してください。
        </p><p>
          <a class="indexterm" name="idm139979093075968"></a><em class="replaceable"><code>expr</code></em> が <code class="literal">LAST_INSERT_ID()</code> への引数として指定されている場合は、その引数の値が関数によって返され、<code class="literal">LAST_INSERT_ID()</code> によって次に返される値として記憶されます。これを使用すると、シーケンスのシミュレーションを行うことができます。
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
              シーケンスカウンタを保持するテーブルを作成し、それを初期化します。
            </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE sequence (id INT NOT NULL);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO sequence VALUES (0);</code></strong>
</pre></li><li class="listitem"><p>
              そのテーブルを使用して、次のようにシーケンス番号を生成します。
            </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE sequence SET id=LAST_INSERT_ID(id+1);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
</pre><p>
              <code class="literal">UPDATE</code> ステートメントは、シーケンスカウンタを増分し、<code class="literal">LAST_INSERT_ID()</code> への次の呼び出しで更新された値が返されるようにします。<code class="literal">SELECT</code> ステートメントは、その値を取得します。<code class="literal">mysql_insert_id()</code> C API 関数を使用して、値を取得することもできます。<a class="xref" href="connectors-apis.html#mysql-insert-id" title="23.8.7.37 mysql_insert_id()">セクション23.8.7.37「mysql_insert_id()」</a>を参照してください。
            </p></li></ol></div><p>
          <code class="literal">LAST_INSERT_ID()</code> を呼び出さずに、シーケンスを生成できます。このように関数を使用する有用性は、ID 値が最後に自動的に生成された値として保持されることです。独自のシーケンス値を生成するほかのクライアントと互いに影響しあうことなく、複数のクライアントが <code class="literal">UPDATE</code> ステートメントを発行し、<code class="literal">SELECT</code> ステートメント (または <code class="literal">mysql_insert_id()</code>) で独自のシーケンス値を取得できるため、マルチユーザーでも安全です。
        </p><p>
          <code class="literal">mysql_insert_id()</code> 関数は、<code class="literal">INSERT</code> および <code class="literal">UPDATE</code> ステートメントのあとにしか更新されないため、<code class="literal">SELECT</code> や <code class="literal">SET</code> などのその他の SQL ステートメントを実行したあとに、この C API 関数を使用しても、<code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code> の値を取得できません。
        </p></li><li class="listitem"><a name="function_row-count"></a><p>
          <a class="indexterm" name="idm139979093043872"></a> <code class="literal">ROW_COUNT()</code>
        </p><p>
          MySQL 5.6 では、<code class="literal">ROW_COUNT()</code> は次のように値を返します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              DDL ステートメント: 0。これは、<code class="literal">CREATE TABLE</code> や <code class="literal">DROP TABLE</code> などのステートメントに適用されます。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT</code> 以外の DML ステートメント: 影響を受ける行数です。これは、(以前と同様に) <code class="literal">UPDATE</code>、<code class="literal">INSERT</code>、<code class="literal">DELETE</code> などのステートメントに適用されますが、<code class="literal">ALTER TABLE</code> や <code class="literal">LOAD DATA INFILE</code> などのステートメントにも適用されるようになりました。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT</code>: ステートメントで結果セットが返される場合は -1、そうでない場合は<span class="quote">「<span class="quote">影響を受ける</span>」</span>行数。たとえば、<code class="literal">SELECT * FROM t1</code> の場合、<code class="literal">ROW_COUNT()</code> は -1 を返します。<code class="literal">SELECT * FROM t1 INTO OUTFILE '<em class="replaceable"><code>file_name</code></em>'</code> の場合、<code class="literal">ROW_COUNT()</code> はファイルに書き込まれた行の数を返します。
            </p></li><li class="listitem"><p>
              <code class="literal">SIGNAL</code> ステートメント: 0。
            </p></li></ul></div><p>
          <code class="literal">UPDATE</code> ステートメントの場合、デフォルトで影響を受けた行の値は実際に変更された行の数です。<span class="command"><strong>mysqld</strong></span> への接続時に <code class="literal">CLIENT_FOUND_ROWS</code> フラグを <code class="literal">mysql_real_connect()</code> に指定した場合、影響を受けた行の値は<span class="quote">「<span class="quote">見つかった</span>」</span>、つまり <code class="literal">WHERE</code> 句に一致した行数です。
        </p><p>
          <code class="literal">REPLACE</code> ステートメントの場合、影響を受けた行の値は、新しい行が古い行に置き換わった場合 2 です。この場合、重複が削除されたあとに行が挿入されたためです。
        </p><p>
          <code class="literal">INSERT ... ON DUPLICATE KEY UPDATE</code> ステートメントの場合、行ごとの影響を受けた行の値は、その行が新しい行として挿入された場合は 1、既存の行が更新された場合は 2、既存の行がその現在の値に設定された場合は 0 です。<code class="literal">CLIENT_FOUND_ROWS</code> フラグを指定した場合、影響を受けた行の値は、既存の行がその現在の値に設定された場合は (0 ではなく) 1 になります。
        </p><p>
          <code class="literal">ROW_COUNT()</code> は、<code class="literal">mysql_affected_rows()</code> C API 関数から取得される値と同様で、ステートメントの実行後に <span class="command"><strong>mysql</strong></span> クライアントに表示される行数です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(1),(2),(3);</code></strong>
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT ROW_COUNT();</code></strong>
+-------------+
| ROW_COUNT() |
+-------------+
|           3 |
+-------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>DELETE FROM t WHERE i IN(1,2);</code></strong>
Query OK, 2 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT ROW_COUNT();</code></strong>
+-------------+
| ROW_COUNT() |
+-------------+
|           2 |
+-------------+
1 row in set (0.00 sec)
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">重要</div><p>
            ステートメントベースのレプリケーションでは、確実に <code class="literal">ROW_COUNT()</code> をレプリケートすることはできません。行ベースのレプリケーションを使用すると、この関数は自動的にレプリケートされます。
          </p></div></li><li class="listitem"><a name="function_schema"></a><p>
          <a class="indexterm" name="idm139979092995488"></a> <code class="literal">SCHEMA()</code>
        </p><p>
          この関数は <code class="literal">DATABASE()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_session-user"></a><p>
          <a class="indexterm" name="idm139979092987584"></a> <code class="literal">SESSION_USER()</code>
        </p><p>
          <code class="literal">SESSION_USER()</code> は <code class="literal">USER()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_system-user"></a><p>
          <a class="indexterm" name="idm139979092978752"></a> <code class="literal">SYSTEM_USER()</code>
        </p><p>
          <code class="literal">SYSTEM_USER()</code> は <code class="literal">USER()</code> のシノニムです。
        </p></li><li class="listitem"><a name="function_user"></a><p>
          <a class="indexterm" name="idm139979092969984"></a> <code class="literal">USER()</code>
        </p><p>
          現在の MySQL ユーザー名とホスト名を <code class="literal">utf8</code> 文字セット内の文字列として返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT USER();</code></strong>
        -&gt; 'davida@localhost'
</pre><p>
          この値は、サーバーへの接続時に指定したユーザー名および接続元のクライアントホストを示します。<code class="literal">CURRENT_USER()</code> の値とは異なる可能性があります。
        </p><p>
          次のように、ユーザー名の部分のみを抽出できます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING_INDEX(USER(),'@',1);</code></strong>
        -&gt; 'davida'
</pre></li><li class="listitem"><a name="function_version"></a><p>
          <a class="indexterm" name="idm139979092956400"></a> <code class="literal">VERSION()</code>
        </p><p>
          MySQL サーバーのバージョンを示す文字列を返します。この文字列では、<code class="literal">utf8</code> 文字セットが使用されます。値にはバージョン番号に加えて、サフィクスが付いている場合もあります。<a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 サーバーシステム変数">セクション5.1.4「サーバーシステム変数」</a>内の <code class="literal">version</code> システム変数の説明を参照してください。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT VERSION();</code></strong>
        -&gt; '5.6.23-standard'
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spatial-analysis-functions"></a>12.15 空間分析関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#spatial-function-reference">12.15.1 空間関数のリファレンス</a></span></dt><dt><span class="section"><a href="functions.html#spatial-function-argument-handling">12.15.2 空間関数による引数処理</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkt-functions">12.15.3 WKT 値から幾何値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkb-functions">12.15.4 WKB 値から幾何値を作成する関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-mysql-specific-functions">12.15.5 幾何値を作成する MySQL 固有の関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-format-conversion-functions">12.15.6 幾何形式変換関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-property-functions">12.15.7 幾何プロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-operator-functions">12.15.8 空間演算子関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions">12.15.9 幾何オブジェクト間の空間関係をテストする関数</a></span></dt></dl></div><p>
    MySQL には、空間データに対してさまざまな操作を実行する関数が用意されています。これらの関数は、実行する操作の種類に従って、次のいくつかの主なカテゴリにグループ化できます。
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        さまざまな形式 (WKT、WKB、内部) の幾何図形を作成する関数
      </p></li><li class="listitem"><p>
        幾何図形の形式を変換する関数
      </p></li><li class="listitem"><p>
        幾何図形の定性的または定量的なプロパティーにアクセスする関数
      </p></li><li class="listitem"><p>
        2 つの幾何図形間の関係を記述する関数
      </p></li><li class="listitem"><p>
        既存の幾何図形から新しい幾何図形を作成する関数
      </p></li></ul></div><p>
    空間データを使用するための MySQL のサポートに関する一般的なバックグラウンドについては、<a class="xref" href="data-types.html#spatial-extensions" title="11.5 空間データの拡張">セクション11.5「空間データの拡張」</a>を参照してください。
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-function-reference"></a>12.15.1 空間関数のリファレンス</h3></div></div></div><a class="indexterm" name="idm139979092934368"></a><div class="table"><a name="idm139979092932928"></a><p class="title"><b>表 12.19 空間関数</b></p><div class="table-contents"><table summary="空間関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_area"><code class="literal">Area()</code></a></td><td>
      Polygon または MultiPolygon 領域を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asbinary"><code class="literal">AsBinary()</code>, <code class="literal">AsWKB()</code></a></td><td>
      内部幾何形式から WKB に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_astext"><code class="literal">AsText()</code>, <code class="literal">AsWKT()</code></a></td><td>
      内部幾何形式から WKT に変換します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_buffer"><code class="literal">Buffer()</code></a></td><td>
      幾何図形から指定された距離内にある点の幾何図形を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_centroid"><code class="literal">Centroid()</code></a></td><td>
      重心を Point として返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_contains"><code class="literal">Contains()</code></a></td><td>
      ある幾何図形に別の幾何図形が含まれているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_crosses"><code class="literal">Crosses()</code></a></td><td>
      ある幾何図形が別の幾何図形と交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_dimension"><code class="literal">Dimension()</code></a></td><td>
      幾何図形の次元
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_disjoint"><code class="literal">Disjoint()</code></a></td><td>
      ある幾何図形が別の幾何図形から切り離されているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_endpoint"><code class="literal">EndPoint()</code></a></td><td>
      LineString の終点
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_envelope"><code class="literal">Envelope()</code></a></td><td>
      幾何図形の MBR を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_equals"><code class="literal">Equals()</code></a></td><td>
      ある幾何図形が別の幾何図形に等しいかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_exteriorring"><code class="literal">ExteriorRing()</code></a></td><td>
      Polygon の外側のリングを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geomcollfromtext"><code class="literal">GeomCollFromText()</code>, <code class="literal">GeometryCollectionFromText()</code></a></td><td>
      WKT からジオメトリコレクションを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geomcollfromwkb"><code class="literal">GeomCollFromWKB()</code>, <code class="literal">GeometryCollectionFromWKB()</code></a></td><td>
      WKB からジオメトリコレクションを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a></td><td>
      幾何図形からジオメトリコレクションを構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geometryn"><code class="literal">GeometryN()</code></a></td><td>
      ジオメトリコレクションから N
      番目の幾何図形を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geometrytype"><code class="literal">GeometryType()</code></a></td><td>
      幾何型の名前を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geomfromtext"><code class="literal">GeomFromText()</code>, <code class="literal">GeometryFromText()</code></a></td><td>
      WKT から幾何図形を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_geomfromwkb"><code class="literal">GeomFromWKB()</code></a></td><td>
      WKB から幾何図形を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_glength"><code class="literal">GLength()</code></a></td><td>
      LineString の長さを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_interiorringn"><code class="literal">InteriorRingN()</code></a></td><td>
      Polygon の N 番目の内側のリングを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_intersects"><code class="literal">Intersects()</code></a></td><td>
      ある幾何図形が別の幾何図形と交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_isclosed"><code class="literal">IsClosed()</code></a></td><td>
      幾何図形が閉じていて単純かどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_isempty"><code class="literal">IsEmpty()</code></a></td><td>
      プレースホルダ関数
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_issimple"><code class="literal">IsSimple()</code></a></td><td>
      幾何図形が単純かどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_linefromtext"><code class="literal">LineFromText()</code></a></td><td>
      WKT から LineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_linefromwkb"><code class="literal">LineFromWKB()</code>, <code class="literal">LineStringFromWKB()</code></a></td><td>
      WKB から LineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_linestring"><code class="literal">LineString()</code></a></td><td>
      Point 値から LineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains()</code></a></td><td>
      ある幾何図形の MBR に、別の幾何図形の MBR
      が含まれているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrdisjoint"><code class="literal">MBRDisjoint()</code></a></td><td>
      2 つの幾何図形の MBR
      が切り離されているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrequal"><code class="literal">MBREqual()</code></a></td><td>
      2 つの幾何図形の MBR が等しいかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrintersects"><code class="literal">MBRIntersects()</code></a></td><td>
      2 つの幾何図形の MBR が交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbroverlaps"><code class="literal">MBROverlaps()</code></a></td><td>
      2 つの幾何図形の MBR
      がオーバーラップしているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrtouches"><code class="literal">MBRTouches()</code></a></td><td>
      2 つの幾何図形の MBR が接しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin()</code></a></td><td>
      ある幾何図形の MBR が、別の幾何図形の MBR
      の内部にあるかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mlinefromtext"><code class="literal">MLineFromText()</code>, <code class="literal">MultiLineStringFromText()</code></a></td><td>
      WKT から MultiLineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mlinefromwkb"><code class="literal">MLineFromWKB()</code>, <code class="literal">MultiLineStringFromWKB()</code></a></td><td>
      WKB から MultiLineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mpointfromtext"><code class="literal">MPointFromText()</code>, <code class="literal">MultiPointFromText()</code></a></td><td>
      WKT から MultiPoint を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mpointfromwkb"><code class="literal">MPointFromWKB()</code>, <code class="literal">MultiPointFromWKB()</code></a></td><td>
      WKB から MultiPoint を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mpolyfromtext"><code class="literal">MPolyFromText()</code>, <code class="literal">MultiPolygonFromText()</code></a></td><td>
      WKT から MultiPolygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_mpolyfromwkb"><code class="literal">MPolyFromWKB()</code>, <code class="literal">MultiPolygonFromWKB()</code></a></td><td>
      WKB から MultiPolygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_multilinestring"><code class="literal">MultiLineString()</code></a></td><td>
      LineString 値から MultiLineString を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_multipoint"><code class="literal">MultiPoint()</code></a></td><td>
      Point 値から MultiPoint を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_multipolygon"><code class="literal">MultiPolygon()</code></a></td><td>
      Polygon 値から MultiPolygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_numgeometries"><code class="literal">NumGeometries()</code></a></td><td>
      ジオメトリコレクション内の幾何図形数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_numinteriorrings"><code class="literal">NumInteriorRings()</code></a></td><td>
      Polygon 内の内側のリング数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_numpoints"><code class="literal">NumPoints()</code></a></td><td>
      LineString 内の Point の数を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_overlaps"><code class="literal">Overlaps()</code></a></td><td>
      ある幾何図形が別の幾何図形とオーバーラップしているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_point"><code class="literal">Point()</code></a></td><td>
      座標から Point を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pointfromtext"><code class="literal">PointFromText()</code></a></td><td>
      WKT から Point を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pointfromwkb"><code class="literal">PointFromWKB()</code></a></td><td>
      WKB から Point を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_pointn"><code class="literal">PointN()</code></a></td><td>
      LineString から N 番目の Point を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_polyfromtext"><code class="literal">PolyFromText()</code>, <code class="literal">PolygonFromText()</code></a></td><td>
      WKT から Polygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_polyfromwkb"><code class="literal">PolyFromWKB()</code>, <code class="literal">PolygonFromWKB()</code></a></td><td>
      WKB から Polygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_polygon"><code class="literal">Polygon()</code></a></td><td>
      LineString 引数から Polygon を構築します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_srid"><code class="literal">SRID()</code></a></td><td>
      幾何図形の空間参照システム ID を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a></td><td>
      Polygon または MultiPolygon 領域を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-centroid"><code class="literal">ST_Centroid()</code></a></td><td>
      重心を Point として返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains()</code></a></td><td>
      ある幾何図形に別の幾何図形が含まれているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-crosses"><code class="literal">ST_Crosses()</code></a></td><td>
      ある幾何図形が別の幾何図形と交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-difference"><code class="literal">ST_Difference()</code></a></td><td>
      2 つの幾何図形の点集合の差集合を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-disjoint"><code class="literal">ST_Disjoint()</code></a></td><td>
      ある幾何図形が別の幾何図形から切り離されているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a></td><td>
      ある幾何図形の別の幾何図形からの距離
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope()</code></a></td><td>
      幾何図形の MBR を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-equals"><code class="literal">ST_Equals()</code></a></td><td>
      ある幾何図形が別の幾何図形に等しいかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-intersection"><code class="literal">ST_Intersection()</code></a></td><td>
      2 つの幾何図形の点集合の積集合を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-intersects"><code class="literal">ST_Intersects()</code></a></td><td>
      ある幾何図形が別の幾何図形と交差しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-overlaps"><code class="literal">ST_Overlaps()</code></a></td><td>
      ある幾何図形が別の幾何図形とオーバーラップしているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-symdifference"><code class="literal">ST_SymDifference()</code></a></td><td>
      2 つの幾何図形の点集合の対称差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-touches"><code class="literal">ST_Touches()</code></a></td><td>
      ある幾何図形が別の幾何図形に接しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-union"><code class="literal">ST_Union()</code></a></td><td>
      2 つの幾何図形の点集合の和集合を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within()</code></a></td><td>
      ある幾何図形が別の幾何図形の内部にあるかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_startpoint"><code class="literal">StartPoint()</code></a></td><td>
      LineString の始点
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_touches"><code class="literal">Touches()</code></a></td><td>
      ある幾何図形が別の幾何図形に接しているかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_within"><code class="literal">Within()</code></a></td><td>
      ある幾何図形が別の幾何図形の内部にあるかどうか
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_x"><code class="literal">X()</code></a></td><td>
      Point の X 座標を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_y"><code class="literal">Y()</code></a></td><td>
      Point の Y 座標を返します
    </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-function-argument-handling"></a>12.15.2 空間関数による引数処理</h3></div></div></div><p>
      空間値 (または幾何図形) は、<a class="xref" href="data-types.html#gis-class-geometry" title="11.5.2.2 Geometry クラス">セクション11.5.2.2「Geometry クラス」</a>で説明されているプロパティーを持っています。次の説明では、空間関数の一般的な引数処理特性を一覧表示します。特定の関数または関数のグループには、追加の引数処理特性がある場合があります。これらについては、これらの関数の説明が行われるセクションで説明されています。
    </p><p>
      空間関数は、有効な幾何値に対してのみ定義されています。無効な幾何図形が空間関数に渡された場合の結果は定義されていません。
    </p><p>
      幾何図形の空間参照識別子 (SRID) は、その幾何図形が定義されている座標空間を識別します。MySQL の SRID 値は、幾何値に関連付けられた整数です。ただし、すべての計算が実際の SRID 値には関係なく、デカルト (平面) 座標を表す SRID 0 を想定して実行されます。将来は、指定された SRID 値が計算で使用される可能性があります。SRID 0 の動作を保証するには、SRID 0 を使用して幾何図形を作成します。SRID 0 は、SRID が指定されていない場合の新しい幾何図形のためのデフォルトです。
    </p><p>
      使用可能な SRID の最大値は 2<sup>32</sup>−1 です。より大きな値が指定されると、低位の 32 ビットだけが使用されます。
    </p><p>
      どの空間関数によって生成された幾何値も、その幾何図形の引数の SRID を継承します。
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-wkt-functions"></a>12.15.3 WKT 値から幾何値を作成する関数</h3></div></div></div><p>
      これらの関数は、引数として Well-Known Text (WKT) 表現と、オプションで空間参照システム識別子 (SRID) を受け取ります。これらは、対応する幾何図形を返します。
    </p><p>
      <code class="literal">GeomFromText()</code> は、その最初の引数として任意の幾何型の WKT 値を受け入れます。その他の関数は、各幾何型の幾何値の構築のための型固有の構築関数を提供します。
    </p><p>
      WKT 形式については、<a class="xref" href="data-types.html#gis-wkt-format" title="11.5.3.1.1 WKT (Well-Known Text) 形式">セクション11.5.3.1.1「WKT (Well-Known Text) 形式」</a>を参照してください。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_geomcollfromtext"></a><p>
          <a class="indexterm" name="idm139979092747584"></a> <a class="indexterm" name="idm139979092746240"></a> <code class="literal">GeomCollFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">GeometryCollectionFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKT 表現と SRID を使用して <code class="literal">GeometryCollection</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_geomfromtext"></a><p>
          <a class="indexterm" name="idm139979092736000"></a> <a class="indexterm" name="idm139979092734656"></a> <code class="literal">GeomFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">GeometryFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKT 表現と SRID を使用して任意の型の幾何値を構築します。
        </p></li><li class="listitem"><a name="function_linefromtext"></a><p>
          <a class="indexterm" name="idm139979092725136"></a> <a class="indexterm" name="idm139979092723792"></a> <code class="literal">LineFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">LineStringFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKT 表現と SRID を使用して <code class="literal">LineString</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_mlinefromtext"></a><p>
          <a class="indexterm" name="idm139979092713584"></a> <a class="indexterm" name="idm139979092712240"></a> <code class="literal">MLineFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">MultiLineStringFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKT 表現と SRID を使用して <code class="literal">MultiLineString</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_mpointfromtext"></a><p>
          <a class="indexterm" name="idm139979092702016"></a> <a class="indexterm" name="idm139979092700672"></a> <code class="literal">MPointFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">MultiPointFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKT 表現と SRID を使用して <code class="literal">MultiPoint</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_mpolyfromtext"></a><p>
          <a class="indexterm" name="idm139979092690528"></a> <a class="indexterm" name="idm139979092689184"></a> <code class="literal">MPolyFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">MultiPolygonFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKT 表現と SRID を使用して <code class="literal">MultiPolygon</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_pointfromtext"></a><p>
          <a class="indexterm" name="idm139979092679696"></a> <code class="literal">PointFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKT 表現と SRID を使用して <code class="literal">Point</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_polyfromtext"></a><p>
          <a class="indexterm" name="idm139979092671632"></a> <a class="indexterm" name="idm139979092670288"></a> <code class="literal">PolyFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">PolygonFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKT 表現と SRID を使用して <code class="literal">Polygon</code> 値を構築します。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-wkb-functions"></a>12.15.4 WKB 値から幾何値を作成する関数</h3></div></div></div><p>
      これらの関数は、引数として Well-Known Binary (WKB) 表現を含む <code class="literal">BLOB</code> と、オプションで空間参照システム識別子 (SRID) を受け取ります。これらは、対応する幾何図形を返します。
    </p><p>
      これらの関数はまた、<a class="xref" href="functions.html#gis-mysql-specific-functions" title="12.15.5 幾何値を作成する MySQL 固有の関数">セクション12.15.5「幾何値を作成する MySQL 固有の関数」</a>にある関数の戻り値との互換性のために幾何オブジェクトも受け入れます。そのため、これらの関数を使用すると、このセクションにある関数への最初の引数を提供できます。
    </p><p>
      <code class="literal">GeomFromWKB()</code> は、その最初の引数として任意の幾何型の WKB 値を受け入れます。その他の関数は、各幾何型の幾何値の構築のための型固有の構築関数を提供します。
    </p><p>
      WKB 形式については、<a class="xref" href="data-types.html#gis-wkb-format" title="11.5.3.1.2 WKB (Well-Known Binary) 形式">セクション11.5.3.1.2「WKB (Well-Known Binary) 形式」</a>を参照してください。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_geomcollfromwkb"></a><p>
          <a class="indexterm" name="idm139979092650976"></a> <a class="indexterm" name="idm139979092649632"></a> <code class="literal">GeomCollFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">GeometryCollectionFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKB 表現と SRID を使用して <code class="literal">GeometryCollection</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_geomfromwkb"></a><p>
          <a class="indexterm" name="idm139979092639392"></a> <a class="indexterm" name="idm139979092638048"></a> <code class="literal">GeomFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">GeometryFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKB 表現と SRID を使用して任意の型の幾何値を構築します。
        </p></li><li class="listitem"><a name="function_linefromwkb"></a><p>
          <a class="indexterm" name="idm139979092628528"></a> <a class="indexterm" name="idm139979092627184"></a> <code class="literal">LineFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">LineStringFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKB 表現と SRID を使用して <code class="literal">LineString</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_mlinefromwkb"></a><p>
          <a class="indexterm" name="idm139979092617040"></a> <a class="indexterm" name="idm139979092615696"></a> <code class="literal">MLineFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">MultiLineStringFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKB 表現と SRID を使用して <code class="literal">MultiLineString</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_mpointfromwkb"></a><p>
          <a class="indexterm" name="idm139979092605488"></a> <a class="indexterm" name="idm139979092604144"></a> <code class="literal">MPointFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">MultiPointFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKB 表現と SRID を使用して <code class="literal">MultiPoint</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_mpolyfromwkb"></a><p>
          <a class="indexterm" name="idm139979092593952"></a> <a class="indexterm" name="idm139979092592608"></a> <code class="literal">MPolyFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">MultiPolygonFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKB 表現と SRID を使用して <code class="literal">MultiPolygon</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_pointfromwkb"></a><p>
          <a class="indexterm" name="idm139979092582480"></a> <code class="literal">PointFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKB 表現と SRID を使用して <code class="literal">Point</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_polyfromwkb"></a><p>
          <a class="indexterm" name="idm139979092574416"></a> <a class="indexterm" name="idm139979092573072"></a> <code class="literal">PolyFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>、<code class="literal">PolygonFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          WKB 表現と SRID を使用して <code class="literal">Polygon</code> 値を構築します。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-mysql-specific-functions"></a>12.15.5 幾何値を作成する MySQL 固有の関数</h3></div></div></div><p>
      MySQL には、幾何値を作成するために役立つ一連の非標準関数が用意されています。このセクションで説明されている関数は、OpenGIS 仕様への MySQL 拡張です。
    </p><p>
      これらの関数は、引数としての WKB 値または幾何オブジェクトから幾何オブジェクトを生成します。いずれかの引数が適切な WKB でも、適切なオブジェクト型の幾何表現でもない場合、戻り値は <code class="literal">NULL</code> になります。
    </p><p>
      たとえば、<code class="literal">Point()</code> からの幾何図形の戻り値を <code class="literal">POINT</code> カラムに直接挿入できます。
    </p><pre class="programlisting">
INSERT INTO t1 (pt_col) VALUES(Point(1,2));
</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_geometrycollection"></a><p>
          <a class="indexterm" name="idm139979092555440"></a> <code class="literal">GeometryCollection(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>,...)</code>
        </p><p>
          <code class="literal">GeometryCollection</code> を構築します。
        </p><p>
          引数にサポートされていない幾何図形が含まれている場合、戻り値は <code class="literal">NULL</code> になります。
        </p></li><li class="listitem"><a name="function_linestring"></a><p>
          <a class="indexterm" name="idm139979092546704"></a> <code class="literal">LineString(<em class="replaceable"><code>pt1</code></em>,<em class="replaceable"><code>pt2</code></em>,...)</code>
        </p><p>
          複数の <code class="literal">Point</code> または WKB <code class="literal">Point</code> 引数から <code class="literal">LineString</code> 値を構築します。引数の数が 2 未満の場合、戻り値は <code class="literal">NULL</code> になります。
        </p></li><li class="listitem"><a name="function_multilinestring"></a><p>
          <a class="indexterm" name="idm139979092536944"></a> <code class="literal">MultiLineString(<em class="replaceable"><code>ls1</code></em>,<em class="replaceable"><code>ls2</code></em>,...)</code>
        </p><p>
          <code class="literal">LineString</code> または WKB <code class="literal">LineString</code> 引数を使用して <code class="literal">MultiLineString</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_multipoint"></a><p>
          <a class="indexterm" name="idm139979092528096"></a> <code class="literal">MultiPoint(<em class="replaceable"><code>pt1</code></em>,<em class="replaceable"><code>pt2</code></em>,...)</code>
        </p><p>
          <code class="literal">Point</code> または WKB <code class="literal">Point</code> 引数を使用して <code class="literal">MultiPoint</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_multipolygon"></a><p>
          <a class="indexterm" name="idm139979092519296"></a> <code class="literal">MultiPolygon(<em class="replaceable"><code>poly1</code></em>,<em class="replaceable"><code>poly2</code></em>,...)</code>
        </p><p>
          一連の <code class="literal">Polygon</code> または WKB <code class="literal">Polygon</code> 引数から <code class="literal">MultiPolygon</code> 値を構築します。
        </p></li><li class="listitem"><a name="function_point"></a><p>
          <a class="indexterm" name="idm139979092510448"></a> <code class="literal">Point(<em class="replaceable"><code>x</code></em>,<em class="replaceable"><code>y</code></em>)</code>
        </p><p>
          座標を使用して <code class="literal">Point</code> を構築します。
        </p></li><li class="listitem"><a name="function_polygon"></a><p>
          <a class="indexterm" name="idm139979092503152"></a> <code class="literal">Polygon(<em class="replaceable"><code>ls1</code></em>,<em class="replaceable"><code>ls2</code></em>,...)</code>
        </p><p>
          複数の <code class="literal">LineString</code> または WKB <code class="literal">LineString</code> 引数から <code class="literal">Polygon</code> 値を構築します。いずれかの引数が <code class="literal">LinearRing</code> を表していない (つまり、閉じた単純な <code class="literal">LineString</code> でない) 場合、戻り値は <code class="literal">NULL</code> になります。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-format-conversion-functions"></a>12.15.6 幾何形式変換関数</h3></div></div></div><p>
      MySQL は、内部形式と WKT または WKB 形式の間で幾何値を変換するための次の関数をサポートします。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_asbinary"></a><p>
          <a class="indexterm" name="idm139979092488896"></a> <code class="literal">AsBinary(<em class="replaceable"><code>g</code></em>)</code>、<code class="literal">AsWKB(<em class="replaceable"><code>g</code></em>)</code>
        </p><p>
          内部幾何形式の値を WKB 表現に変換し、そのバイナリの結果を返します。
        </p><pre class="programlisting">
SELECT AsBinary(g) FROM geom;
</pre></li><li class="listitem"><a name="function_astext"></a><p>
          <a class="indexterm" name="idm139979092478832"></a> <code class="literal">AsText(<em class="replaceable"><code>g</code></em>)</code>、<code class="literal">AsWKT(<em class="replaceable"><code>g</code></em>)</code>
        </p><p>
          内部幾何形式の値を WKT 表現に変換し、その文字列の結果を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @g = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(GeomFromText(@g));</code></strong>
+--------------------------+
| AsText(GeomFromText(@g)) |
+--------------------------+
| LINESTRING(1 1,2 2,3 3)  |
+--------------------------+
</pre></li><li class="listitem"><p>
          <a class="indexterm" name="idm139979092469760"></a> <code class="literal">GeomFromText(<em class="replaceable"><code>wkt</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          文字列値を WKT 表現から内部幾何形式に変換し、その結果を返します。また、<code class="literal">PointFromText()</code> や <code class="literal">LineFromText()</code> などの型固有の関数もいくつかサポートされます。<a class="xref" href="functions.html#gis-wkt-functions" title="12.15.3 WKT 値から幾何値を作成する関数">セクション12.15.3「WKT 値から幾何値を作成する関数」</a>を参照してください。
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139979092462304"></a> <code class="literal">GeomFromWKB(<em class="replaceable"><code>wkb</code></em>[,<em class="replaceable"><code>srid</code></em>])</code>
        </p><p>
          バイナリ値を WKB 表現から内部幾何形式に変換し、その結果を返します。また、<code class="literal">PointFromWKB()</code> や <code class="literal">LineFromWKB()</code> などの型固有の関数もいくつかサポートされます。<a class="xref" href="functions.html#gis-wkb-functions" title="12.15.4 WKB 値から幾何値を作成する関数">セクション12.15.4「WKB 値から幾何値を作成する関数」</a>を参照してください。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="gis-property-functions"></a>12.15.7 幾何プロパティー関数</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#gis-general-property-functions">12.15.7.1 一般的な幾何プロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-point-property-functions">12.15.7.2 点プロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-linestring-property-functions">12.15.7.3 LineString プロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-multilinestring-property-functions">12.15.7.4 MultiLineString プロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-polygon-property-functions">12.15.7.5 Polygon プロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-multipolygon-property-functions">12.15.7.6 MultiPolygon プロパティー関数</a></span></dt><dt><span class="section"><a href="functions.html#gis-geometrycollection-property-functions">12.15.7.7 GeometryCollection プロパティー関数</a></span></dt></dl></div><p>
      このグループに属する各関数は、引数として幾何値を受け取り、その幾何図形の何らかの定量的または定性的なプロパティーを返します。一部の関数では、その引数の型が制限されます。このような関数は、その引数の幾何型が正しくない場合は <code class="literal">NULL</code> を返します。たとえば、<code class="literal">Area()</code> 多角形関数は、オブジェクト型が <code class="literal">Polygon</code> でも <code class="literal">MultiPolygon</code> でもない場合は <code class="literal">NULL</code> を返します。
    </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-general-property-functions"></a>12.15.7.1 一般的な幾何プロパティー関数</h4></div></div></div><p>
        このセクションに示されている関数では引数が制限されず、任意の型の幾何値が受け入れられます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_dimension"></a><p>
            <a class="indexterm" name="idm139979092443648"></a> <code class="literal">Dimension(<em class="replaceable"><code>g</code></em>)</code>
          </p><p>
            幾何値 <em class="replaceable"><code>g</code></em> の固有の次元を返します。結果は、-1、0、1、2 のいずれかです。これらの値の意味は、<a class="xref" href="data-types.html#gis-class-geometry" title="11.5.2.2 Geometry クラス">セクション11.5.2.2「Geometry クラス」</a>で指定されています。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT Dimension(GeomFromText('LineString(1 1,2 2)'));</code></strong>
+------------------------------------------------+
| Dimension(GeomFromText('LineString(1 1,2 2)')) |
+------------------------------------------------+
|                                              1 |
+------------------------------------------------+
</pre></li><li class="listitem"><a name="function_envelope"></a><p>
            <a class="indexterm" name="idm139979092433200"></a> <code class="literal">Envelope(<em class="replaceable"><code>g</code></em>)</code>
          </p><p>
            <code class="literal">ST_Envelope()</code> と <code class="literal">Envelope()</code> はシノニムです。詳細は、<code class="literal">ST_Envelope()</code> の説明を参照してください。
          </p></li><li class="listitem"><a name="function_geometrytype"></a><p>
            <a class="indexterm" name="idm139979092423952"></a> <code class="literal">GeometryType(<em class="replaceable"><code>g</code></em>)</code>
          </p><p>
            幾何インスタンス <em class="replaceable"><code>g</code></em> がメンバーになっている幾何型の名前を示すバイナリ文字列を返します。この名前は、インスタンス化可能な <code class="literal">Geometry</code> サブクラスのいずれかに対応します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT GeometryType(GeomFromText('POINT(1 1)'));</code></strong>
+------------------------------------------+
| GeometryType(GeomFromText('POINT(1 1)')) |
+------------------------------------------+
| POINT                                    |
+------------------------------------------+
</pre></li><li class="listitem"><a name="function_isempty"></a><p>
            <a class="indexterm" name="idm139979092414016"></a> <code class="literal">IsEmpty(<em class="replaceable"><code>g</code></em>)</code>
          </p><p>
            この関数は、すべての有効な幾何値に対しては 0、すべての無効な幾何値または <code class="literal">NULL</code> に対しては 1 を返すプレースホルダです。
          </p><p>
            MySQL は、<code class="literal">POINT EMPTY</code> などの GIS の <code class="literal">EMPTY</code> 値をサポートしていません。
          </p></li><li class="listitem"><a name="function_issimple"></a><p>
            <a class="indexterm" name="idm139979092404800"></a> <code class="literal">IsSimple(<em class="replaceable"><code>g</code></em>)</code>
          </p><p>
            幾何値 <em class="replaceable"><code>g</code></em> に自己交差や自己接触などの異常な幾何点が含まれていない場合は 1 を返します。<code class="literal">IsSimple()</code> は、その引数が単純でない場合は 0 を、<code class="literal">NULL</code> である場合は <code class="literal">NULL</code> を返します。
          </p><p>
            この章の最初の方で指定されているインスタンス化可能な各幾何クラスの説明には、そのクラスのインスタンスが単純でないとして分類される具体的な条件が含まれています。(<a class="xref" href="data-types.html#gis-geometry-class-hierarchy" title="11.5.2.1 幾何クラスの階層">セクション11.5.2.1「幾何クラスの階層」</a>を参照してください。)
          </p><p>
            MySQL 5.6.1 より前は、この関数は常に 0 を返します。
          </p></li><li class="listitem"><a name="function_srid"></a><p>
            <a class="indexterm" name="idm139979092393040"></a> <code class="literal">SRID(<em class="replaceable"><code>g</code></em>)</code>
          </p><p>
            幾何値 <em class="replaceable"><code>g</code></em> の空間参照システム ID を示す整数を返します。
          </p><p>
            MySQL では、SRID 値は幾何値に関連付けられた整数にすぎません。すべての計算はユークリッド (平面) 幾何学を前提にして実行されます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SRID(GeomFromText('LineString(1 1,2 2)',101));</code></strong>
+-----------------------------------------------+
| SRID(GeomFromText('LineString(1 1,2 2)',101)) |
+-----------------------------------------------+
|                                           101 |
+-----------------------------------------------+
</pre></li><li class="listitem"><a name="function_st-envelope"></a><p>
            <a class="indexterm" name="idm139979092382608"></a> <code class="literal">ST_Envelope(<em class="replaceable"><code>g</code></em>)</code>
          </p><p>
            幾何値 <em class="replaceable"><code>g</code></em> の最小外接矩形 (MBR) を返します。結果は、その外接矩形の角の点によって定義された <code class="literal">Polygon</code> 値として返されます。
          </p><pre class="programlisting">
POLYGON((MINX MINY, MAXX MINY, MAXX MAXY, MINX MAXY, MINX MINY))
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT AsText(ST_Envelope(GeomFromText('LineString(1 1,2 2)')));</code></strong>
+----------------------------------------------------------+
| AsText(ST_Envelope(GeomFromText('LineString(1 1,2 2)'))) |
+----------------------------------------------------------+
| POLYGON((1 1,2 1,2 2,1 2,1 1))                           |
+----------------------------------------------------------+
</pre><p>
            <code class="literal">ST_Envelope()</code> と <code class="literal">Envelope()</code> はシノニムです。
          </p><p>
            <code class="literal">ST_Envelope()</code> は、MySQL 5.6.1 で追加されました。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-point-property-functions"></a>12.15.7.2 点プロパティー関数</h4></div></div></div><p>
        <code class="literal">Point</code> は、次の関数を使用して取得できる X 座標と Y 座標で構成されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_x"></a><p>
            <a class="indexterm" name="idm139979092363888"></a> <code class="literal">X(<em class="replaceable"><code>p</code></em>)</code>
          </p><p>
            <code class="literal">Point</code> オブジェクト <em class="replaceable"><code>p</code></em> の X 座標値を倍精度数値として返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT X(POINT(56.7, 53.34));</code></strong>
+-----------------------+
| X(POINT(56.7, 53.34)) |
+-----------------------+
|                  56.7 |
+-----------------------+
</pre></li><li class="listitem"><a name="function_y"></a><p>
            <a class="indexterm" name="idm139979092354480"></a> <code class="literal">Y(<em class="replaceable"><code>p</code></em>)</code>
          </p><p>
            <code class="literal">Point</code> オブジェクト <em class="replaceable"><code>p</code></em> の Y 座標値を倍精度数値として返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT Y(POINT(56.7, 53.34));</code></strong>
+-----------------------+
| Y(POINT(56.7, 53.34)) |
+-----------------------+
|                 53.34 |
+-----------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-linestring-property-functions"></a>12.15.7.3 LineString プロパティー関数</h4></div></div></div><p>
        <code class="literal">LineString</code> は、<code class="literal">Point</code> 値で構成されます。<code class="literal">LineString</code> の特定の点を抽出したり、そこに含まれている点の数をカウントしたり、その長さを取得したりできます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_endpoint"></a><p>
            <a class="indexterm" name="idm139979092339600"></a> <code class="literal">EndPoint(<em class="replaceable"><code>ls</code></em>)</code>
          </p><p>
            <code class="literal">LineString</code> 値 <em class="replaceable"><code>ls</code></em> の終点である <code class="literal">Point</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(EndPoint(GeomFromText(@ls)));</code></strong>
+-------------------------------------+
| AsText(EndPoint(GeomFromText(@ls))) |
+-------------------------------------+
| POINT(3 3)                          |
+-------------------------------------+
</pre></li><li class="listitem"><a name="function_glength"></a><p>
            <a class="indexterm" name="idm139979092328640"></a> <code class="literal">GLength(<em class="replaceable"><code>ls</code></em>)</code>
          </p><p>
            <code class="literal">LineString</code> 値 <em class="replaceable"><code>ls</code></em> の関連付けられた空間参照内の長さを示す倍精度数値を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT GLength(GeomFromText(@ls));</code></strong>
+----------------------------+
| GLength(GeomFromText(@ls)) |
+----------------------------+
|            2.8284271247462 |
+----------------------------+
</pre><p>
            <code class="literal">GLength()</code> は非標準名です。これは、OpenGIS の <code class="literal">Length()</code> 関数に対応します。(文字列値の長さを計算する既存の SQL 関数 <code class="literal">Length()</code> が存在します。)
          </p></li><li class="listitem"><a name="function_isclosed"></a><p>
            <a class="indexterm" name="idm139979092314704"></a> <code class="literal">IsClosed(<em class="replaceable"><code>ls</code></em>)</code>
          </p><p>
            <code class="literal">LineString</code> 値 <em class="replaceable"><code>ls</code></em> が閉じており (つまり、その <code class="literal">StartPoint()</code> 値と <code class="literal">EndPoint()</code> 値が同じであり)、かつ単純である (同じ点を複数回通っていない) 場合は 1 を返します。<em class="replaceable"><code>ls</code></em> が閉じていない場合は 0 を、<code class="literal">NULL</code> である場合は -1 を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @ls1 = '<code class="literal">LineString</code>(1 1,2 2,3 3,2 2)';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET @ls2 = 'LineString(1 1,2 2,3 3,1 1)';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT IsClosed(<code class="literal">GeomFromText</code>(@ls1));</code></strong>
+------------------------------+
| IsClosed(GeomFromText(@ls1)) |
+------------------------------+
|                            0 |
+------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT IsClosed(GeomFromText(@ls2));</code></strong>
+------------------------------+
| IsClosed(GeomFromText(@ls2)) |
+------------------------------+
|                            1 |
+------------------------------+
1 row in set (0.00 sec)
</pre></li><li class="listitem"><a name="function_numpoints"></a><p>
            <a class="indexterm" name="idm139979092297024"></a> <code class="literal">NumPoints(<em class="replaceable"><code>ls</code></em>)</code>
          </p><p>
            <code class="literal">LineString</code> 値 <em class="replaceable"><code>ls</code></em> 内の <code class="literal">Point</code> オブジェクトの数を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT NumPoints(GeomFromText(@ls));</code></strong>
+------------------------------+
| NumPoints(GeomFromText(@ls)) |
+------------------------------+
|                            3 |
+------------------------------+
</pre></li><li class="listitem"><a name="function_pointn"></a><p>
            <a class="indexterm" name="idm139979092286176"></a> <code class="literal">PointN(<em class="replaceable"><code>ls</code></em>,<em class="replaceable"><code>N</code></em>)</code>
          </p><p>
            <code class="literal">Linestring</code> 値 <em class="replaceable"><code>ls</code></em> 内の <em class="replaceable"><code>N</code></em> 番目の <code class="literal">Point</code> を返します。点の番号は 1 から始まります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(PointN(GeomFromText(@ls),2));</code></strong>
+-------------------------------------+
| AsText(PointN(GeomFromText(@ls),2)) |
+-------------------------------------+
| POINT(2 2)                          |
+-------------------------------------+
</pre></li><li class="listitem"><a name="function_startpoint"></a><p>
            <a class="indexterm" name="idm139979092274368"></a> <code class="literal">StartPoint(<em class="replaceable"><code>ls</code></em>)</code>
          </p><p>
            <code class="literal">LineString</code> 値 <em class="replaceable"><code>ls</code></em> の始点である <code class="literal">Point</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(StartPoint(GeomFromText(@ls)));</code></strong>
+---------------------------------------+
| AsText(StartPoint(GeomFromText(@ls))) |
+---------------------------------------+
| POINT(1 1)                            |
+---------------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-multilinestring-property-functions"></a>12.15.7.4 MultiLineString プロパティー関数</h4></div></div></div><p>
        これらの関数は、<code class="literal">MultiLineString</code> 値のプロパティーを返します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="indexterm" name="idm139979092260256"></a> <code class="literal">GLength(<em class="replaceable"><code>mls</code></em>)</code>
          </p><p>
            <code class="literal">MultiLineString</code> 値 <em class="replaceable"><code>mls</code></em> の長さを示す倍精度数値を返します。<em class="replaceable"><code>mls</code></em> の長さは、その要素の長さの合計に等しくなります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @mls = 'MultiLineString((1 1,2 2,3 3),(4 4,5 5))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT GLength(GeomFromText(@mls));</code></strong>
+-----------------------------+
| GLength(GeomFromText(@mls)) |
+-----------------------------+
|             4.2426406871193 |
+-----------------------------+
</pre><p>
            <code class="literal">GLength()</code> は非標準名です。これは、OpenGIS の <code class="literal">Length()</code> 関数に対応します。
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139979092248928"></a> <code class="literal">IsClosed(<em class="replaceable"><code>mls</code></em>)</code>
          </p><p>
            <code class="literal">MultiLineString</code> 値 <em class="replaceable"><code>mls</code></em> が閉じている (つまり、<em class="replaceable"><code>mls</code></em> 内の各 <code class="literal">LineString</code> で <code class="literal">StartPoint()</code> 値と <code class="literal">EndPoint()</code> 値が同じである) 場合は 1 を返します。<em class="replaceable"><code>mls</code></em> が閉じていない場合は 0 を、<code class="literal">NULL</code> である場合は -1 を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @mls = 'MultiLineString((1 1,2 2,3 3),(4 4,5 5))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT IsClosed(GeomFromText(@mls));</code></strong>
+------------------------------+
| IsClosed(GeomFromText(@mls)) |
+------------------------------+
|                            0 |
+------------------------------+
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-polygon-property-functions"></a>12.15.7.5 Polygon プロパティー関数</h4></div></div></div><p>
        これらの関数は、<code class="literal">Polygon</code> 値のプロパティーを返します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_area"></a><p>
            <a class="indexterm" name="idm139979092230784"></a> <code class="literal">Area(<em class="replaceable"><code>poly</code></em>)</code>
          </p><p>
            <code class="literal">ST_Area()</code> と <code class="literal">Area()</code> はシノニムです。詳細は、<code class="literal">ST_Area()</code> の説明を参照してください。
          </p></li><li class="listitem"><a name="function_exteriorring"></a><p>
            <a class="indexterm" name="idm139979092221504"></a> <code class="literal">ExteriorRing(<em class="replaceable"><code>poly</code></em>)</code>
          </p><p>
            <code class="literal">Polygon</code> 値 <em class="replaceable"><code>poly</code></em> の外側のリングを <code class="literal">LineString</code> として返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
    -&gt; <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(ExteriorRing(GeomFromText(@poly)));</code></strong>
+-------------------------------------------+
| AsText(ExteriorRing(GeomFromText(@poly))) |
+-------------------------------------------+
| LINESTRING(0 0,0 3,3 3,3 0,0 0)           |
+-------------------------------------------+
</pre></li><li class="listitem"><a name="function_interiorringn"></a><p>
            <a class="indexterm" name="idm139979092209712"></a> <code class="literal">InteriorRingN(<em class="replaceable"><code>poly</code></em>,<em class="replaceable"><code>N</code></em>)</code>
          </p><p>
            <code class="literal">Polygon</code> 値 <em class="replaceable"><code>poly</code></em> の <em class="replaceable"><code>N</code></em> 番目の内側のリングを <code class="literal">LineString</code> として返します。リングの番号は 1 から始まります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
    -&gt; <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(InteriorRingN(GeomFromText(@poly),1));</code></strong>
+----------------------------------------------+
| AsText(InteriorRingN(GeomFromText(@poly),1)) |
+----------------------------------------------+
| LINESTRING(1 1,1 2,2 2,2 1,1 1)              |
+----------------------------------------------+
</pre></li><li class="listitem"><a name="function_numinteriorrings"></a><p>
            <a class="indexterm" name="idm139979092196912"></a> <code class="literal">NumInteriorRings(<em class="replaceable"><code>poly</code></em>)</code>
          </p><p>
            <code class="literal">Polygon</code> 値 <em class="replaceable"><code>poly</code></em> 内の内側のリングの数を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
    -&gt; <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT NumInteriorRings(GeomFromText(@poly));</code></strong>
+---------------------------------------+
| NumInteriorRings(GeomFromText(@poly)) |
+---------------------------------------+
|                                     1 |
+---------------------------------------+
</pre></li><li class="listitem"><a name="function_st-area"></a><p>
            <a class="indexterm" name="idm139979092185184"></a> <code class="literal">ST_Area(<em class="replaceable"><code>poly</code></em>)</code>
          </p><p>
            空間参照システムで測定された引数の面積を示す倍精度数値を返します。次元 0 または 1 の引数の場合、結果は 0 です。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @poly = 'Polygon((0 0,0 3,3 0,0 0),(1 1,1 2,2 1,1 1))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Area(GeomFromText(@poly));</code></strong>
+------------------------------+
| ST_Area(GeomFromText(@poly)) |
+------------------------------+
|                            4 |
+------------------------------+

mysql&gt; <strong class="userinput"><code>SET @mpoly =</code></strong>
    -&gt; <strong class="userinput"><code>'MultiPolygon(((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1)))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Area(GeomFromText(@mpoly));</code></strong>
+-------------------------------+
| ST_Area(GeomFromText(@mpoly)) |
+-------------------------------+
|                             8 |
+-------------------------------+
</pre><p>
            <code class="literal">ST_Area()</code> と <code class="literal">Area()</code> はシノニムです。
          </p><p>
            <code class="literal">ST_Area()</code> は、MySQL 5.6.1 で追加されました。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-multipolygon-property-functions"></a>12.15.7.6 MultiPolygon プロパティー関数</h4></div></div></div><p>
        これらの関数は、<code class="literal">MultiPolygon</code> 値のプロパティーを返します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="indexterm" name="idm139979092167456"></a> <code class="literal">Area(<em class="replaceable"><code>mpoly</code></em>)</code>
          </p><p>
            <a class="xref" href="functions.html#gis-polygon-property-functions" title="12.15.7.5 Polygon プロパティー関数">セクション12.15.7.5「Polygon プロパティー関数」</a>にある <code class="literal">Area()</code> の説明を参照してください。
          </p></li><li class="listitem"><a name="function_centroid"></a><p>
            <a class="indexterm" name="idm139979092159264"></a> <code class="literal">Centroid(<em class="replaceable"><code>mpoly</code></em>)</code>
          </p><p>
            <code class="literal">ST_Centroid()</code> と <code class="literal">Centroid()</code> はシノニムです。詳細は、<code class="literal">ST_Centroid()</code> の説明を参照してください。
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139979092151744"></a> <code class="literal">ST_Area(<em class="replaceable"><code>mpoly</code></em>)</code>
          </p><p>
            <a class="xref" href="functions.html#gis-polygon-property-functions" title="12.15.7.5 Polygon プロパティー関数">セクション12.15.7.5「Polygon プロパティー関数」</a>にある <code class="literal">Area()</code> の説明を参照してください。
          </p></li><li class="listitem"><a name="function_st-centroid"></a><p>
            <a class="indexterm" name="idm139979092143696"></a> <code class="literal">ST_Centroid(<em class="replaceable"><code>mpoly</code></em>)</code>
          </p><p>
            <code class="literal">MultiPolygon</code> 値 <em class="replaceable"><code>mpoly</code></em> の数学的な重心を <code class="literal">Point</code> として返します。結果が <code class="literal">MultiPolygon</code> 上にある保証はありません。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @poly =</code></strong>
    -&gt; <strong class="userinput"><code>GeomFromText('POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7,5 5))');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT GeometryType(@poly),AsText(ST_Centroid(@poly));</code></strong>
+---------------------+--------------------------------------------+
| GeometryType(@poly) | AsText(ST_Centroid(@poly))                 |
+---------------------+--------------------------------------------+
| POLYGON             | POINT(4.958333333333333 4.958333333333333) |
+---------------------+--------------------------------------------+
</pre><p>
            <code class="literal">ST_Centroid()</code> と <code class="literal">Centroid()</code> はシノニムです。
          </p><p>
            <code class="literal">ST_Centroid()</code> は、MySQL 5.6.1 で追加されました。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="gis-geometrycollection-property-functions"></a>12.15.7.7 GeometryCollection プロパティー関数</h4></div></div></div><p>
        これらの関数は、<code class="literal">GeometryCollection</code> 値のプロパティーを返します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_geometryn"></a><p>
            <a class="indexterm" name="idm139979092122704"></a> <code class="literal">GeometryN(<em class="replaceable"><code>gc</code></em>,<em class="replaceable"><code>N</code></em>)</code>
          </p><p>
            <code class="literal">GeometryCollection</code> 値 <em class="replaceable"><code>gc</code></em> 内の <em class="replaceable"><code>N</code></em> 番目の幾何図形を返します。幾何図形の番号は 1 から始まります。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2, 3 3))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(GeometryN(GeomFromText(@gc),1));</code></strong>
+----------------------------------------+
| AsText(GeometryN(GeomFromText(@gc),1)) |
+----------------------------------------+
| POINT(1 1)                             |
+----------------------------------------+
</pre></li><li class="listitem"><a name="function_numgeometries"></a><p>
            <a class="indexterm" name="idm139979092111504"></a> <code class="literal">NumGeometries(<em class="replaceable"><code>gc</code></em>)</code>
          </p><p>
            <code class="literal">GeometryCollection</code> 値 <em class="replaceable"><code>gc</code></em> 内の幾何図形の数を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2, 3 3))';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT NumGeometries(GeomFromText(@gc));</code></strong>
+----------------------------------+
| NumGeometries(GeomFromText(@gc)) |
+----------------------------------+
|                                2 |
+----------------------------------+
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-operator-functions"></a>12.15.8 空間演算子関数</h3></div></div></div><p>
      OpenGIS では、幾何図形を生成できる関数がいくつか提案されています。これらは、空間演算子を実装するように設計されています。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_buffer"></a><p>
          <a class="indexterm" name="idm139979092098576"></a> <code class="literal">Buffer(<em class="replaceable"><code>g</code></em>,<em class="replaceable"><code>d</code></em>)</code>
        </p><p>
          幾何値 <em class="replaceable"><code>g</code></em> からの距離が <em class="replaceable"><code>d</code></em> の距離以下であるすべての点を表す幾何図形を返します。
        </p><p>
          <code class="literal">Buffer()</code> は、多角形、複数多角形、および多角形または複数多角形を含む幾何図形コレクションに対して負の距離をサポートしています。点、複数点、ライン文字列、複数ライン文字列、および多角形または複数多角形を含まない幾何図形コレクションに対して、負の距離を含む <code class="literal">Buffer()</code> は <code class="literal">NULL</code> を返します。
        </p><p>
          <code class="literal">Buffer()</code> は、MySQL 5.6.1 で追加されました。
        </p></li><li class="listitem"><a name="function_st-difference"></a><p>
          <a class="indexterm" name="idm139979092085120"></a> <code class="literal">ST_Difference(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
        </p><p>
          幾何値 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の点集合の差集合を表す幾何図形を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @g1 = POINT(1,1), @g2 = POINT(2,2);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(ST_Difference(@g1, @g2));</code></strong>
+---------------------------------+
| AsText(ST_Difference(@g1, @g2)) |
+---------------------------------+
| POINT(1 1)                      |
+---------------------------------+
</pre><p>
          <code class="literal">ST_Difference()</code> は、MySQL 5.6.1 で追加されました。
        </p></li><li class="listitem"><a name="function_st-intersection"></a><p>
          <a class="indexterm" name="idm139979092072000"></a> <code class="literal">ST_Intersection(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
        </p><p>
          幾何値 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の点集合の共通集合を表す幾何図形を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @g1 = GeomFromText('LineString(1 1, 3 3)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = GeomFromText('LineString(1 3, 3 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(ST_Intersection(@g1, @g2));</code></strong>
+-----------------------------------+
| AsText(ST_Intersection(@g1, @g2)) |
+-----------------------------------+
| POINT(2 2)                        |
+-----------------------------------+
</pre><p>
          <code class="literal">ST_Intersection()</code> は、MySQL 5.6.1 で追加されました。
        </p></li><li class="listitem"><a name="function_st-symdifference"></a><p>
          <a class="indexterm" name="idm139979092058064"></a> <code class="literal">ST_SymDifference(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
        </p><p>
          幾何値 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の点集合の対称差を表す幾何図形を返します。これは、次のように定義されます。
        </p><pre class="programlisting">
<em class="replaceable"><code>g1</code></em> symdifference <em class="replaceable"><code>g2</code></em> := (<em class="replaceable"><code>g1</code></em> union <em class="replaceable"><code>g2</code></em>) difference (<em class="replaceable"><code>g1</code></em> intersection <em class="replaceable"><code>g2</code></em>)
</pre><p>
          または、関数呼び出しの表記では次のようになります。
        </p><pre class="programlisting">
ST_SymDifference(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>) = ST_Difference(ST_Union(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>), ST_Intersection(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>))
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @g1 = POINT(1,1), @g2 = POINT(2,2);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(ST_SymDifference(@g1, @g2));</code></strong>
+-------------------------------------------+
| AsText(ST_SymDifference(@g1, @g2))        |
+-------------------------------------------+
| GEOMETRYCOLLECTION(POINT(1 1),POINT(2 2)) |
+-------------------------------------------+
</pre><p>
          <code class="literal">ST_SymDifference()</code> は、MySQL 5.6.1 で追加されました。
        </p></li><li class="listitem"><a name="function_st-union"></a><p>
          <a class="indexterm" name="idm139979092038032"></a> <code class="literal">ST_Union(<em class="replaceable"><code>g1</code></em>, <em class="replaceable"><code>g2</code></em>)</code>
        </p><p>
          幾何値 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の点集合の和集合を表す幾何図形を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @g1 = GeomFromText('LineString(1 1, 3 3)');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = GeomFromText('LineString(1 3, 3 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT AsText(ST_Union(@g1, @g2));</code></strong>
+--------------------------------------+
| AsText(ST_Union(@g1, @g2))           |
+--------------------------------------+
| MULTILINESTRING((1 1,3 3),(3 1,1 3)) |
+--------------------------------------+
</pre><p>
          <code class="literal">ST_Union()</code> は、MySQL 5.6.1 で追加されました。
        </p></li></ul></div><p>
      さらに、<a class="xref" href="functions.html#gis-property-functions" title="12.15.7 幾何プロパティー関数">セクション12.15.7「幾何プロパティー関数」</a>では、既存の幾何図形から新しい幾何図形を構築するいくつかの関数について説明しています。これらの関数の説明については、そのセクションを参照してください。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">Envelope(<em class="replaceable"><code>g</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">StartPoint(<em class="replaceable"><code>ls</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">EndPoint(<em class="replaceable"><code>ls</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">PointN(<em class="replaceable"><code>ls</code></em>,<em class="replaceable"><code>N</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">ExteriorRing(<em class="replaceable"><code>poly</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">InteriorRingN(<em class="replaceable"><code>poly</code></em>,<em class="replaceable"><code>N</code></em>)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">GeometryN(<em class="replaceable"><code>gc</code></em>,<em class="replaceable"><code>N</code></em>)</code>
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spatial-relation-functions"></a>12.15.9 幾何オブジェクト間の空間関係をテストする関数</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#spatial-relation-functions-object-shapes">12.15.9.1 オブジェクト形状を使用する空間関係関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions-mbr">12.15.9.2 最小外接矩形 (MBR) を使用する空間関係関数</a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions-mysql-specific">12.15.9.3 最小外接矩形 (MBR) を使用する MySQL 固有の空間関係関数</a></span></dt></dl></div><p>
      このセクションで説明されている関数は、引数として 2 つの幾何図形を受け取り、それらの間の定性的または定量的な関係を返します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          OpenGIS 仕様では、2 つの幾何値間の関係をテストする一連の関数が定義されています。MySQL は最初、これらの関数を実装することにより、オブジェクトの最小外接矩形 (MBR) を使用し、対応する MBR ベースの関数と同じ結果を返していました。たとえば、<code class="literal">Contains()</code> と <code class="literal">MBRContains()</code> は同じ結果を返します。(例外: <code class="literal">Crosses()</code> は存在しますが、<code class="literal">MBRCrosses()</code> は存在しません。)
        </p><p>
          MySQL 5.6.1 の時点では、正確なオブジェクト形状を使用する対応するバージョンを使用できます。これらのバージョンの名前には <code class="literal">ST_</code> プリフィクスが付けられています。たとえば、<code class="literal">Contains()</code> が最小外接矩形を使用するのに対して、<code class="literal">ST_Contains()</code> はオブジェクト形状を使用します。
        </p><p>
          MySQL 5.6.1 の時点では、すでに正確であった既存の空間関数のための <code class="literal">ST_</code> エイリアスも存在します。たとえば、<code class="literal">ST_IsEmpty()</code> は <code class="literal">IsEmpty()</code> のエイリアスです。さらに、<code class="literal">ST_Distance()</code> も使用できます。
        </p></li><li class="listitem"><p>
          2 つの幾何値間の関係をテストするには、MySQL 固有の一連の MBR ベースの関数を使用できます。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="spatial-relation-functions-object-shapes"></a>12.15.9.1 オブジェクト形状を使用する空間関係関数</h4></div></div></div><p>
        OpenGIS 仕様では、次の関数が定義されています。これらは、正確なオブジェクト形状を使用して、2 つの幾何値 <code class="literal">g1</code> と <code class="literal">g2</code> の間の関係をテストします。戻り値 1 と 0 は、それぞれ true と false を示します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-contains"></a><p>
            <a class="indexterm" name="idm139979091985808"></a> <code class="literal">ST_Contains(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> を完全に含んでいるかどうかを示す 1 または 0 を返します。これは、<code class="literal">ST_Within()</code> とは逆の関係をテストします。
          </p></li><li class="listitem"><a name="function_st-crosses"></a><p>
            <a class="indexterm" name="idm139979091977200"></a> <code class="literal">ST_Crosses(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に交差している場合は 1 を返します。<code class="literal">g1</code> が <code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code> である場合、あるいは <em class="replaceable"><code>g2</code></em> が <code class="literal">Point</code> または <code class="literal">MultiPoint</code> である場合は <code class="literal">NULL</code> を返します。それ以外の場合は、0 を返します。
          </p><p>
            <span class="emphasis"><em>空間的に交差している</em></span>という用語は、2 つの指定された幾何図形間の空間関係が次の性質を持っていることを示します。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                2 つの幾何図形が交差している
              </p></li><li class="listitem"><p>
                それらの交差によって、2 つの指定された幾何図形の最大の次元より 1 つ小さい次元を持つ幾何図形が生成される
              </p></li><li class="listitem"><p>
                それらの交差が 2 つの指定された幾何図形のどちらとも等しくない
              </p></li></ul></div></li><li class="listitem"><a name="function_st-disjoint"></a><p>
            <a class="indexterm" name="idm139979091960352"></a> <code class="literal">ST_Disjoint(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に切り離されている (交差していない) かどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_st-distance"></a><p>
            <a class="indexterm" name="idm139979091952128"></a> <code class="literal">ST_Distance(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の間の距離を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @g1 = POINT(1,1), @g2 = POINT(2,2);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT ST_Distance(@g1, @g2);</code></strong>
+-----------------------+
| ST_Distance(@g1, @g2) |
+-----------------------+
|    1.4142135623730951 |
+-----------------------+
</pre><p>
            <code class="literal">ST_Distance()</code> は、MySQL 5.6.1 で追加されました。
          </p></li><li class="listitem"><a name="function_st-equals"></a><p>
            <a class="indexterm" name="idm139979091939968"></a> <code class="literal">ST_Equals(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に等しいかどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_st-intersects"></a><p>
            <a class="indexterm" name="idm139979091932464"></a> <code class="literal">ST_Intersects(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に交差しているかどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_st-overlaps"></a><p>
            <a class="indexterm" name="idm139979091925008"></a> <code class="literal">ST_Overlaps(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的にオーバーラップしているかどうかを示す 1 または 0 を返します。<span class="emphasis"><em>空間的にオーバーラップしている</em></span>という用語が使用されるのは、2 つの幾何図形が交差しており、かつそれらの交差によって同じ次元の幾何図形が生成されるが、指定された幾何図形のどちらとも等しくない場合です。
          </p></li><li class="listitem"><a name="function_st-touches"></a><p>
            <a class="indexterm" name="idm139979091916752"></a> <code class="literal">ST_Touches(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> に空間的に接しているかどうかを示す 1 または 0 を返します。2 つの幾何図形が<span class="emphasis"><em>空間的に接している</em></span>のは、これらの幾何図形の内部は交差していないが、一方の幾何図形の境界が他方の幾何図形の境界または内部と交差している場合です。
          </p></li><li class="listitem"><a name="function_st-within"></a><p>
            <a class="indexterm" name="idm139979091908560"></a> <code class="literal">ST_Within(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が空間的に <em class="replaceable"><code>g2</code></em> の内部にあるかどうかを示す 1 または 0 を返します。これは、<code class="literal">ST_Contains()</code> とは逆の関係をテストします。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="spatial-relation-functions-mbr"></a>12.15.9.2 最小外接矩形 (MBR) を使用する空間関係関数</h4></div></div></div><a class="indexterm" name="idm139979091900736"></a><a class="indexterm" name="idm139979091899456"></a><p>
        OpenGIS 仕様では、次の関数が定義されています。これらは、2 つの幾何値 <code class="literal">g1</code> と <code class="literal">g2</code> の間の関係をテストします。MySQL 実装では最小外接矩形を使用するため、これらの関数は、対応する MBR ベースの関数と同じ結果を返します。戻り値 1 と 0 は、それぞれ true と false を示します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_contains"></a><p>
            <a class="indexterm" name="idm139979091893104"></a> <code class="literal">Contains(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> を完全に含んでいるかどうかを示す 1 または 0 を返します。これは、<code class="literal">Within()</code> とは逆の関係をテストします。
          </p></li><li class="listitem"><a name="function_crosses"></a><p>
            <a class="indexterm" name="idm139979091884560"></a> <code class="literal">Crosses(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に交差している場合は 1 を返します。<code class="literal">g1</code> が <code class="literal">Polygon</code> または <code class="literal">MultiPolygon</code> である場合、あるいは <em class="replaceable"><code>g2</code></em> が <code class="literal">Point</code> または <code class="literal">MultiPoint</code> である場合は <code class="literal">NULL</code> を返します。それ以外の場合は、0 を返します。
          </p><p>
            <span class="emphasis"><em>空間的に交差している</em></span>という用語は、2 つの指定された幾何図形間の空間関係が次の性質を持っていることを示します。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                2 つの幾何図形が交差している
              </p></li><li class="listitem"><p>
                それらの交差によって、2 つの指定された幾何図形の最大の次元より 1 つ小さい次元を持つ幾何図形が生成される
              </p></li><li class="listitem"><p>
                それらの交差が 2 つの指定された幾何図形のどちらとも等しくない
              </p></li></ul></div></li><li class="listitem"><a name="function_disjoint"></a><p>
            <a class="indexterm" name="idm139979091867712"></a> <code class="literal">Disjoint(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に切り離されている (交差していない) かどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_equals"></a><p>
            <a class="indexterm" name="idm139979091860128"></a> <code class="literal">Equals(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に等しいかどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_intersects"></a><p>
            <a class="indexterm" name="idm139979091852624"></a> <code class="literal">Intersects(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的に交差しているかどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_overlaps"></a><p>
            <a class="indexterm" name="idm139979091845104"></a> <code class="literal">Overlaps(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> と空間的にオーバーラップしているかどうかを示す 1 または 0 を返します。<span class="emphasis"><em>空間的にオーバーラップしている</em></span>という用語が使用されるのは、2 つの幾何図形が交差しており、かつそれらの交差によって同じ次元の幾何図形が生成されるが、指定された幾何図形のどちらとも等しくない場合です。
          </p></li><li class="listitem"><a name="function_touches"></a><p>
            <a class="indexterm" name="idm139979091836848"></a> <code class="literal">Touches(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が <em class="replaceable"><code>g2</code></em> に空間的に接しているかどうかを示す 1 または 0 を返します。2 つの幾何図形が<span class="emphasis"><em>空間的に接している</em></span>のは、これらの幾何図形の内部は交差していないが、一方の幾何図形の境界が他方の幾何図形の境界または内部と交差している場合です。
          </p></li><li class="listitem"><a name="function_within"></a><p>
            <a class="indexterm" name="idm139979091828656"></a> <code class="literal">Within(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> が空間的に <em class="replaceable"><code>g2</code></em> の内部にあるかどうかを示す 1 または 0 を返します。これは、<code class="literal">Contains()</code> とは逆の関係をテストします。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="spatial-relation-functions-mysql-specific"></a>12.15.9.3 最小外接矩形 (MBR) を使用する MySQL 固有の空間関係関数</h4></div></div></div><a class="indexterm" name="idm139979091820784"></a><a class="indexterm" name="idm139979091819504"></a><p>
        MySQL には、2 つの幾何図形 <code class="literal">g1</code> と <code class="literal">g2</code> の最小外接矩形間の関係をテストする関数がいくつか用意されています。戻り値 1 と 0 は、それぞれ true と false を示します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_mbrcontains"></a><p>
            <a class="indexterm" name="idm139979091812672"></a> <code class="literal">MBRContains(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> の最小外接矩形が <em class="replaceable"><code>g2</code></em> の最小外接矩形を含んでいるかどうかを示す 1 または 0 を返します。これは、<code class="literal">MBRWithin()</code> とは逆の関係をテストします。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @g1 = GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = GeomFromText('Point(1 1)');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT MBRContains(@g1,@g2), MBRWithin(@g2,@g1);</code></strong>
+----------------------+--------------------+
| MBRContains(@g1,@g2) | MBRWithin(@g2,@g1) |
+----------------------+--------------------+
|                    1 |                  1 |
+----------------------+--------------------+
</pre></li><li class="listitem"><a name="function_mbrdisjoint"></a><p>
            <a class="indexterm" name="idm139979091800336"></a> <code class="literal">MBRDisjoint(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            2 つの幾何図形 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小外接矩形が切り離されている (交差していない) かどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_mbrequal"></a><p>
            <a class="indexterm" name="idm139979091792656"></a> <code class="literal">MBREqual(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            2 つの幾何図形 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小外接矩形が同じであるかどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_mbrintersects"></a><p>
            <a class="indexterm" name="idm139979091785104"></a> <code class="literal">MBRIntersects(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            2 つの幾何図形 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小外接矩形が交差しているかどうかを示す 1 または 0 を返します。
          </p></li><li class="listitem"><a name="function_mbroverlaps"></a><p>
            <a class="indexterm" name="idm139979091777472"></a> <code class="literal">MBROverlaps(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            2 つの幾何図形 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小外接矩形がオーバーラップしているかどうかを示す 1 または 0 を返します。<span class="emphasis"><em>空間的にオーバーラップしている</em></span>という用語が使用されるのは、2 つの幾何図形が交差しており、かつそれらの交差によって同じ次元の幾何図形が生成されるが、指定された幾何図形のどちらとも等しくない場合です。
          </p></li><li class="listitem"><a name="function_mbrtouches"></a><p>
            <a class="indexterm" name="idm139979091769184"></a> <code class="literal">MBRTouches(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            2 つの幾何図形 <em class="replaceable"><code>g1</code></em> と <em class="replaceable"><code>g2</code></em> の最小外接矩形が接しているかどうかを示す 1 または 0 を返します。2 つの幾何図形が<span class="emphasis"><em>空間的に接している</em></span>のは、これらの幾何図形の内部は交差していないが、一方の幾何図形の境界が他方の幾何図形の境界または内部と交差している場合です。
          </p></li><li class="listitem"><a name="function_mbrwithin"></a><p>
            <a class="indexterm" name="idm139979091760960"></a> <code class="literal">MBRWithin(<em class="replaceable"><code>g1</code></em>,<em class="replaceable"><code>g2</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>g1</code></em> の最小外接矩形が <em class="replaceable"><code>g2</code></em> の最小外接矩形の内部にあるかどうかを示す 1 または 0 を返します。これは、<code class="literal">MBRContains()</code> とは逆の関係をテストします。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @g1 = GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');</code></strong>
mysql&gt; <strong class="userinput"><code>SET @g2 = GeomFromText('Polygon((0 0,0 5,5 5,5 0,0 0))');</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT MBRWithin(@g1,@g2), MBRWithin(@g2,@g1);</code></strong>
+--------------------+--------------------+
| MBRWithin(@g1,@g2) | MBRWithin(@g2,@g1) |
+--------------------+--------------------+
|                  1 |                  0 |
+--------------------+--------------------+
</pre></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gtid-functions"></a>12.16 グローバルトランザクション ID とともに使用される関数</h2></div></div></div><a class="indexterm" name="idm139979091749104"></a><a class="indexterm" name="idm139979091747680"></a><p>
      このセクションで説明する関数は、GTID ベースのレプリケーション (MySQL 5.6.5 以降で使用可能) で使用されます。これらのすべての関数には、引数として GTID セットの文字列表現が指定されるため、これらの関数とともに GTID セットを使用する際は、常に引用符で囲む必要があることを忘れないことが重要です。
    </p><p>
      2 つの GTID セットの結合は、単にカンマを挿入して結合された文字列として表現されたものです。言い換えると、ここで作成した関数と同様に、非常に単純な関数を定義すれば、GTID セットの結合を取得できます。
    </p><pre class="programlisting">
CREATE FUNCTION GTID_UNION(g1 TEXT, g2 TEXT) 
    RETURNS TEXT DETERMINISTIC
    RETURN CONCAT(g1,',',g2);  
</pre><p>
      GTID の詳細およびこれらの GTID 関数を実際に使用する方法については、<a class="xref" href="replication.html#replication-gtids" title="17.1.3 グローバルトランザクション識別子を使用したレプリケーション">セクション17.1.3「グローバルトランザクション識別子を使用したレプリケーション」</a>を参照してください。
    </p><div class="table"><a name="idm139979091741648"></a><p class="title"><b>表 12.20 GTID 関数</b></p><div class="table-contents"><table summary="GTID 関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_gtid-subset"><code class="literal">GTID_SUBSET()</code></a></td><td>
      サブセット内のすべての GTID
      がセット内にもある場合は、true
      を返します。そうでない場合は、false
      を返します。
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_gtid-subtract"><code class="literal">GTID_SUBTRACT()</code></a></td><td>
      セット内の GTID
      のうち、サブセット内にないものをすべてを返します。
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sql-thread-wait-after-gtids"><code class="literal">SQL_THREAD_WAIT_AFTER_GTIDS()</code></a> (deprecated 5.6.9)</td><td>
      廃止: WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()
      に置き換わりました
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_wait-until-sql-thread-after-gtids"><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code></a></td><td>
      指定された GTID
      がスレーブで実行されるまで待ちます。
    </td></tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_gtid-subset"></a><p>
          <a class="indexterm" name="idm139979091727008"></a> <code class="literal">GTID_SUBSET(<em class="replaceable"><code>subset</code></em>,<em class="replaceable"><code>set</code></em>)</code>
        </p><p>
          2 セットのグローバルトランザクション ID <em class="replaceable"><code>subset</code></em> と <em class="replaceable"><code>set</code></em> が指定された場合、<em class="replaceable"><code>subset</code></em> 内のすべての GTID が <em class="replaceable"><code>set</code></em> にも存在すれば true (1) を返します。それ以外の場合は、false (0) を返します。
        </p><p>
          この関数で使用される GTID セットは、次の例で示すように文字列で表現されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23',</code></strong> 
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23', 
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57'): 1
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23-25',</code></strong> 
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23-25', 
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57'): 1
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25',</code></strong> 
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25', 
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57'): 0
1 row in set (0.00 sec)
</pre><p>
          この関数は、MySQL 5.6.5 で追加されました。
        </p></li><li class="listitem"><a name="function_gtid-subtract"></a><p>
          <a class="indexterm" name="idm139979091709232"></a> <code class="literal">GTID_SUBTRACT(<em class="replaceable"><code>set</code></em>,<em class="replaceable"><code>subset</code></em>)</code>
        </p><p>
          2 セットのグローバルトランザクション ID <em class="replaceable"><code>subset</code></em> と <em class="replaceable"><code>set</code></em> が指定された場合、<em class="replaceable"><code>set</code></em> 内の GTID で、<em class="replaceable"><code>subset</code></em> に存在しないものだけを返します。
        </p><p>
          この関数で使用される GTID セットはすべて文字列で表現されるため、次の例で示すように引用符で囲む必要があります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong> 
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57', 
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:21'): 3e11fa47-71ca-11e1-9e33-c80aa9429562:22-57
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong> 
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57', 
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25'): 3e11fa47-71ca-11e1-9e33-c80aa9429562:26-57
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong> 
    -&gt;     <strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:23-24')\G</code></strong>
*************************** 1. row ***************************
GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57', 
    '3E11FA47-71CA-11E1-9E33-C80AA9429562:23-24'): 3e11fa47-71ca-11e1-9e33-c80aa9429562:21-22:25-57
1 row in set (0.01 sec)
</pre><p>
          この関数は、MySQL 5.6.5 で追加されました。
        </p></li><li class="listitem"><a name="function_sql-thread-wait-after-gtids"></a><p>
          <a class="indexterm" name="idm139979091691296"></a> <code class="literal">SQL_THREAD_WAIT_AFTER_GTIDS(<em class="replaceable"><code>gtid_set</code></em>[, <em class="replaceable"><code>timeout</code></em>])</code>
        </p><p>
          <code class="literal">SQL_THREAD_WAIT_AFTER_GTIDS()</code> は MySQL 5.6.5 で追加され、MySQL 5.6.9 で <code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code> に置き換えられました。(Bug #14775984)
        </p><p>
          詳細は、<a class="xref" href="replication.html#replication-gtids" title="17.1.3 グローバルトランザクション識別子を使用したレプリケーション">セクション17.1.3「グローバルトランザクション識別子を使用したレプリケーション」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_wait-until-sql-thread-after-gtids"></a><p>
          <a class="indexterm" name="idm139979091680368"></a> <code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS(<em class="replaceable"><code>gtid_set</code></em>[, <em class="replaceable"><code>timeout</code></em>])</code>
        </p><p>
          スレーブ SQL スレッドで <em class="replaceable"><code>gtid_set</code></em> 内にグローバルトランザクション ID が含まれるすべてのトランザクションが実行されるか (<span class="quote">「<span class="quote">GTID セット</span>」</span>の定義については、<a class="xref" href="replication.html#replication-gtids-concepts" title="17.1.3.1 GTID の概念">セクション17.1.3.1「GTID の概念」</a>を参照してください)、<em class="replaceable"><code>timeout</code></em> 秒が経過するかのどちらかが先に発生するまで待機します。<em class="replaceable"><code>timeout</code></em> はオプションで、デフォルトのタイムアウトは 0 です。この場合、マスターは単に、GTID セット内のすべてのトランザクションが実行されるまで待機するだけです。
        </p><p>
          MySQL 5.6.9 よりも前では、<code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code> は <code class="literal">SQL_THREAD_WAIT_AFTER_GTIDS()</code> という名前でした。(Bug #14775984)
        </p><p>
          詳細は、<a class="xref" href="replication.html#replication-gtids" title="17.1.3 グローバルトランザクション識別子を使用したレプリケーション">セクション17.1.3「グローバルトランザクション識別子を使用したレプリケーション」</a>を参照してください。
        </p><p>
          この関数で使用される GTID セットは、次の例で示すように文字列で表現されるため、引用符で囲む必要があります。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS('3E11FA47-71CA-11E1-9E33-C80AA9429562:1-5');</code></strong>
        -&gt; 5
</pre><p>
          戻り値は、実行されたトランザクションイベントの数です。MySQL 5.6.8 よりも前では、この関数は、タイムアウトが設定されていない場合は予想不可能な動作となり、GTID ベースのレプリケーションがアクティブでない場合でも呼び出されていました。MySQL 5.6.8 以降では、<code class="literal">gtid_mode</code> が <code class="literal">OFF</code> である場合は、常に <code class="literal">NULL</code> を返します。(Bug #14640065)
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="enterprise-encryption"></a>12.17 MySQL Enterprise Encryption の関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#enterprise-encryption-installation">12.17.1 Enterprise Encryption のインストール</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-usage">12.17.2 Enterprise Encryption の使用法と例</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-function-reference">12.17.3 Enterprise Encryption 関数のリファレンス</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-functions">12.17.4 Enterprise Encryption 関数の説明</a></span></dt></dl></div><p>
      MySQL 5.6.21 の時点で MySQL Enterprise Edition には、SQL レベルで OpenSSL 機能を表示する OpenSSL ライブラリに基づいた一連の暗号化機能が含まれています。これらの関数を使用することによって、エンタープライズアプリケーションが次の操作を実行できるようになります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          公開鍵非対称暗号方式を使用した、追加のデータ保護の実装
        </p></li><li class="listitem"><p>
          公開鍵、秘密鍵、およびデジタル署名の作成
        </p></li><li class="listitem"><p>
          非対称暗号化および非対称復号化の実行
        </p></li><li class="listitem"><p>
          デジタル署名およびデータの検証や妥当性検査に対する暗号化ハッシュの使用
        </p></li></ul></div><p>
      Enterprise Encryption では、RSA、DSA、および DH の暗号アルゴリズムがサポートされています。
    </p><p>
      Enterprise Encryption は、個々の関数を個別にインストールできるユーザー定義関数 (UDF) ライブラリとして提供されます。
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="enterprise-encryption-installation"></a>12.17.1 Enterprise Encryption のインストール</h3></div></div></div><p>
        Enterprise Encryption の関数は、プラグインディレクトリ (<code class="literal">plugin_dir</code> システム変数で名前が指定されたディレクトリ) にインストールされたユーザー定義関数 (UDF) ライブラリファイルに配置されています。UDF ライブラリのベース名は <code class="filename">openssl_udf</code> であり、サフィクスはプラットフォームに依存します。たとえば、ファイル名は Linux では <code class="filename">openssl_udf.so</code>、Windows では <code class="filename">openssl_udf.dll</code> です。
      </p><p>
        ライブラリファイルから関数をインストールするには、<code class="literal">CREATE FUNCTION</code> ステートメントを使用します。ライブラリからすべての関数をロードするには、次のステートメントセットを使用します (必要に応じて、ファイル名サフィクスを調整します)。
      </p><pre class="programlisting">
CREATE FUNCTION asymmetric_decrypt RETURNS STRING
  SONAME 'openssl_udf.so';
CREATE FUNCTION asymmetric_derive RETURNS STRING
  SONAME 'openssl_udf.so';
CREATE FUNCTION asymmetric_encrypt RETURNS STRING
  SONAME 'openssl_udf.so';
CREATE FUNCTION asymmetric_sign RETURNS STRING
  SONAME 'openssl_udf.so';
CREATE FUNCTION asymmetric_verify RETURNS INTEGER
  SONAME 'openssl_udf.so';
CREATE FUNCTION create_asymmetric_priv_key RETURNS STRING
  SONAME 'openssl_udf.so';
CREATE FUNCTION create_asymmetric_pub_key RETURNS STRING
  SONAME 'openssl_udf.so';
CREATE FUNCTION create_dh_parameters RETURNS STRING
  SONAME 'openssl_udf.so';
CREATE FUNCTION create_digest RETURNS STRING
  SONAME 'openssl_udf.so';
</pre><p>
        一度インストールすれば、何回サーバーを再起動しても UDF はインストールされたままです。UDF をアンロードするには、<code class="literal">DROP FUNCTION</code> ステートメントを使用します。たとえば、鍵生成の関数をアンロードするには、次のように実行します。
      </p><pre class="programlisting">
DROP FUNCTION create_asymmetric_priv_key;
DROP FUNCTION create_asymmetric_pub_key;
</pre><p>
        <code class="literal">CREATE FUNCTION</code> および <code class="literal">DROP FUNCTION</code> ステートメントでは、関数名を小文字で指定する必要があります。これは、大文字と小文字のどちらでも使用できる関数の呼び出し時での使用とは異なります。
      </p><p>
        <code class="literal">mysql</code> データベースの場合、<code class="literal">CREATE FUNCTION</code> および <code class="literal">DROP FUNCTION</code> ステートメントでは、それぞれ <code class="literal">INSERT</code> および <code class="literal">DROP</code> 権限が必要です。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="enterprise-encryption-usage"></a>12.17.2 Enterprise Encryption の使用法と例</h3></div></div></div><p>
        アプリケーションで Enterprise Encryption を使用するには、実行する演算に適した関数を呼び出します。このセクションでは、一部の典型的なタスクを実行する方法を示します。
      </p><p>
        タスク: RSA 暗号化を使用して秘密鍵と公開鍵のペアを作成します。
      </p><pre class="programlisting">
-- Encryption algorithm; can be 'DSA' or 'DH' instead
SET @algo = 'RSA';
-- Minimum key length in bits; make larger for stronger keys
SET @key_len = 1024;

-- Create private key
SET @priv = CREATE_ASYMMETRIC_PRIV_KEY(@algo, @key_len);
-- Derive corresponding public key from private key, using same algorithm
SET @pub = CREATE_ASYMMETRIC_PUB_KEY(@algo, @priv);
</pre><p>
        鍵のペアを使用すると、データを暗号化および復号化したり、データを署名および検証したり、対称鍵を生成したりできるようになりました。
      </p><p>
        タスク: 秘密鍵を使用してデータを暗号化し、公開鍵を使用して復号化します。これには、鍵ペアのメンバーが RSA 鍵である必要があります。
      </p><pre class="programlisting">
SET @ciphertext = ASYMMETRIC_ENCRYPT(@algo, 'My secret text', @priv);
SET @plaintext = ASYMMETRIC_DECRYPT(@algo, @ciphertext, @pub);
</pre><p>
        反対に、公開鍵を使用して暗号化し、秘密鍵を使用して復号化できます。
      </p><pre class="programlisting">
SET @ciphertext = ASYMMETRIC_ENCRYPT(@algo, 'My secret text', @pub);
SET @plaintext = ASYMMETRIC_DECRYPT(@algo, @ciphertext, @priv);
</pre><p>
        いずれの場合でも、暗号化関数および復号化関数用に指定されたアルゴリズムは、鍵を生成したときに使用されたアルゴリズムと一致する必要があります。
      </p><p>
        タスク: 文字列からダイジェストを生成します。
      </p><pre class="programlisting">
-- Digest type; can be 'SHA256', 'SHA384', or 'SHA512' instead
SET @dig_type = 'SHA224';

-- Generate digest string
SET @dig = CREATE_DIGEST(@dig_type, 'My text to digest');
</pre><p>
        タスク: 鍵ペアを含むダイジェストを使用してデータを署名してから、その署名がダイジェストと一致することを確認します。
      </p><pre class="programlisting">
-- Encryption algorithm; could be 'DSA' instead; keys must
-- have been created using same algorithm
SET @algo = 'RSA';

-- Generate signature for digest and verify signature against digest
SET @sig = ASYMMETRIC_SIGN(@algo, @dig, @priv, @dig_type);
-- Verify signature against digest
SET @verf = ASYMMETRIC_VERIFY(@algo, @dig, @sig, @pub, @dig_type);
</pre><p>
        タスク: 対称鍵を作成します。これには、共有対称シークレットを使用して作成される DH 秘密鍵/公開鍵が入力として必要です。鍵の長さを <code class="literal">CREATE_DH_PARAMETERS()</code> に渡してシークレットを作成してから、そのシークレットを<span class="quote">「<span class="quote">鍵の長さ</span>」</span>として <code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code> に渡します。
      </p><pre class="programlisting">
-- Generate DH shared symmetric secret
SET @dhp = CREATE_DH_PARAMETERS(1024);
-- Generate DH key pairs
SET @algo = 'DH';
SET @priv1 = CREATE_ASYMMETRIC_PRIV_KEY(@algo, @dhp);
SET @pub1 = CREATE_ASYMMETRIC_PUB_KEY(@algo, @priv1);
SET @priv2 = CREATE_ASYMMETRIC_PRIV_KEY(@algo, @dhp);
SET @pub2 = CREATE_ASYMMETRIC_PUB_KEY(@algo, @priv2);

-- Generate symmetric key using public key of first party,
-- private key of second party
SET @sym1 = ASYMMETRIC_DERIVE(@pub1, @priv2);

-- Or use public key of second party, private key of first party
SET @sym2 = ASYMMETRIC_DERIVE(@pub2, @priv1);
</pre><p>
        鍵文字列の値は、<code class="literal">SET</code>、<code class="literal">SELECT</code>、または <code class="literal">INSERT</code> を使用することで実行時に作成し、変数やテーブルに格納できます。
      </p><pre class="programlisting">
SET @priv1 = CREATE_ASYMMETRIC_PRIV_KEY('RSA', 1024);
SELECT CREATE_ASYMMETRIC_PRIV_KEY('RSA', 1024) INTO @priv2;
INSERT INTO t (key_col) VALUES(CREATE_ASYMMETRIC_PRIV_KEY('RSA', 1024));
</pre><p>
        ファイルに格納されている鍵文字列の値は、<code class="literal">FILE</code> 権限を持つユーザーが <code class="literal">LOAD_FILE()</code> 関数を使用することで読み取ることができます。
      </p><p>
        ダイジェストと署名の文字列は、同様に処理できます。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="enterprise-encryption-function-reference"></a>12.17.3 Enterprise Encryption 関数のリファレンス</h3></div></div></div><div class="table"><a name="idm139979091606048"></a><p class="title"><b>表 12.21 MySQL Enterprise Encryption の関数</b></p><div class="table-contents"><table summary="MySQL Enterprise Encryption の関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT()</code></a></td><td>
      秘密鍵または公開鍵を使用して暗号文を復号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE()</code></a></td><td>
      非対称鍵から対称鍵を導出します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a></td><td>
      秘密鍵または公開鍵を使用してプレーンテキストを暗号化します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN()</code></a></td><td>
      ダイジェストから署名を生成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-verify"><code class="literal">ASYMMETRIC_VERIFY()</code></a></td><td>
      署名がダイジェストと一致することを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a></td><td>
      秘密鍵を作成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-pub-key"><code class="literal">CREATE_ASYMMETRIC_PUB_KEY()</code></a></td><td>
      公開鍵を作成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a></td><td>
      共有 DH シークレットを生成します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_create-digest"><code class="literal">CREATE_DIGEST()</code></a></td><td>
      文字列からダイジェストを生成します
    </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="enterprise-encryption-functions"></a>12.17.4 Enterprise Encryption 関数の説明</h3></div></div></div><p>
        Enterprise Encryption の関数には、次のような一般的な特性があります。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            引数の型が不正な場合や引数の数が間違っている場合は、各関数でエラーが返されます。
          </p></li><li class="listitem"><p>
            要求された演算を実行することを関数に許可するのに引数が適していない場合は、必要に応じて <code class="literal">NULL</code> または 0 が返されます。これは、指定されたアルゴリズムが関数でサポートされていない場合、鍵の長さが短すぎたり長すぎたりする場合、PEM 書式の鍵文字列として要求される文字列が有効な鍵でない場合などに発生します。
          </p></li><li class="listitem"><p>
            ベースとなる SSL ライブラリでは、ランダム度の初期化が処理されます。
          </p></li></ul></div><p>
        関数の一部には、暗号化アルゴリズムの引数が指定されます。次の表には、サポートされているアルゴリズムのサマリーを関数別に示します。
      </p><div class="table"><a name="idm139979091576640"></a><p class="title"><b>表 12.22 関数でサポートされているアルゴリズム</b></p><div class="table-contents"><table summary="関数でサポートされているアルゴリズム" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">関数</th><th scope="col">サポートされているアルゴリズム</th></tr></thead><tbody><tr><td scope="row"><code class="literal">ASYMMETRIC_DECRYPT()</code></td><td>RSA</td></tr><tr><td scope="row"><code class="literal">ASYMMETRIC_DERIVE()</code></td><td>DH</td></tr><tr><td scope="row"><code class="literal">ASYMMETRIC_ENCRYPT()</code></td><td>RSA</td></tr><tr><td scope="row"><code class="literal">ASYMMETRIC_SIGN()</code></td><td>RSA、DSA</td></tr><tr><td scope="row"><code class="literal">ASYMMETRIC_VERIFY()</code></td><td>RSA、DSA</td></tr><tr><td scope="row"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></td><td>RSA、DSA、DH</td></tr><tr><td scope="row"><code class="literal">CREATE_ASYMMETRIC_PUB_KEY()</code></td><td>RSA、DSA、DH</td></tr></tbody></table></div></div><br class="table-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          RSA、DSA、または DH のいずれかの暗号化アルゴリズムを使用すれば鍵を作成できますが、鍵引数が指定されるその他の関数では、特定のタイプの鍵のみが許可される可能性があります。たとえば、<code class="literal">ASYMMETRIC_ENCRYPT()</code> および <code class="literal">ASYMMETRIC_DECRYPT()</code> では RSA 鍵のみが許可されます。
        </p></div><p>
        次の説明では、Enterprise Encryption 関数を呼び出す手順を示します。追加の例と説明については、<a class="xref" href="functions.html#enterprise-encryption-usage" title="12.17.2 Enterprise Encryption の使用法と例">セクション12.17.2「Enterprise Encryption の使用法と例」</a>を参照してください。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_asymmetric-decrypt"></a><p>
            <a class="indexterm" name="idm139979091551408"></a> <code class="literal">ASYMMETRIC_DECRYPT(<em class="replaceable"><code>algorithm</code></em>, <em class="replaceable"><code>crypt_str</code></em>, <em class="replaceable"><code>key_str</code></em>)</code>
          </p><p>
            指定されたアルゴリズムおよび鍵文字列を使用して、暗号化された文字列を復号化し、結果として生成されるプレーンテキストをバイナリ文字列として返します。復号化に失敗した場合は、結果が <code class="literal">NULL</code> になります。
          </p><p>
            <em class="replaceable"><code>key_str</code></em> は、PEM 書式の有効な鍵文字列である必要があります。復号化に成功した場合は、公開鍵または秘密鍵の文字列が、暗号化された文字列を生成する際に <code class="literal">ASYMMETRIC_ENCRYPT()</code> で使用された公開鍵または秘密鍵の文字列に対応している必要があります。<em class="replaceable"><code>algorithm</code></em> は、鍵を作成する際に使用された暗号化アルゴリズムを示します。
          </p><p>
            サポートされている <em class="replaceable"><code>algorithm</code></em> 値: <code class="literal">'RSA'</code>
          </p><p>
            使用例については、<code class="literal">ASYMMETRIC_ENCRYPT()</code> の説明を参照してください。
          </p></li><li class="listitem"><a name="function_asymmetric-derive"></a><p>
            <a class="indexterm" name="idm139979091535824"></a> <code class="literal">ASYMMETRIC_DERIVE(<em class="replaceable"><code>pub_key_str</code></em>, <em class="replaceable"><code>priv_key_str</code></em>)</code>
          </p><p>
            あるパーティーの秘密鍵と別のパーティーの公開鍵を使用して対称鍵を導出し、結果として生成される鍵をバイナリ文字列として返します。鍵の抽出に失敗した場合は、結果が <code class="literal">NULL</code> になります。
          </p><p>
            <em class="replaceable"><code>pub_key_str</code></em> および <em class="replaceable"><code>priv_key_str</code></em> は、PEM 書式の有効な鍵文字列である必要があります。これらは、DH アルゴリズムを使用して作成する必要があります。
          </p><p>
            公開鍵と秘密鍵の 2 つのペアを持っていると仮定します。
          </p><pre class="programlisting">
SET @dhp = CREATE_DH_PARAMETERS(1024);
SET @priv1 = CREATE_ASYMMETRIC_PRIV_KEY('DH', @dhp);
SET @pub1 = CREATE_ASYMMETRIC_PUB_KEY('DH', @priv1);
SET @priv2 = CREATE_ASYMMETRIC_PRIV_KEY('DH', @dhp);
SET @pub2 = CREATE_ASYMMETRIC_PUB_KEY('DH', @priv2);
</pre><p>
            さらに、1 つのペアから秘密鍵を使用し、もう 1 つのペアから公開鍵を使用して、対称鍵文字列を作成すると仮定します。その後、この対称鍵の ID 関係が次のように保持されます。
          </p><pre class="programlisting">
ASYMMETRIC_DERIVE(@pub1, @priv2) = ASYMMETRIC_DERIVE(@pub2, @priv1)
</pre></li><li class="listitem"><a name="function_asymmetric-encrypt"></a><p>
            <a class="indexterm" name="idm139979091522064"></a> <code class="literal">ASYMMETRIC_ENCRYPT(<em class="replaceable"><code>algorithm</code></em>, <em class="replaceable"><code>str</code></em>, <em class="replaceable"><code>key_str</code></em>)</code>
          </p><p>
            指定されたアルゴリズムおよび鍵文字列を使用して文字列を暗号化し、結果として生成される暗号化テキストをバイナリ文字列として返します。暗号化に失敗した場合は、結果が <code class="literal">NULL</code> になります。
          </p><p>
            <em class="replaceable"><code>str</code></em> の長さは、バイト単位で <em class="replaceable"><code>key_str</code></em> の長さ − 11 よりも大きくすることができません。
          </p><p>
            <em class="replaceable"><code>key_str</code></em> は、PEM 書式の有効な鍵文字列にする必要があります。<em class="replaceable"><code>algorithm</code></em> は、鍵を作成する際に使用された暗号化アルゴリズムを示します。
          </p><p>
            サポートされている <em class="replaceable"><code>algorithm</code></em> 値: <code class="literal">'RSA'</code>
          </p><p>
            文字列を暗号化するには、秘密鍵または公開鍵の文字列を <code class="literal">ASYMMETRIC_ENCRYPT()</code> に渡します。元の非暗号化文字列をリカバリするには、暗号化に使用された秘密鍵または公開鍵の文字列に対応する公開鍵または秘密鍵の文字列とともに、暗号化された文字列を <code class="literal">ASYMMETRIC_DECRYPT()</code> に渡します。
          </p><pre class="programlisting">
-- Generate private/public key pair
SET @priv = CREATE_ASYMMETRIC_PRIV_KEY('RSA', 1024);
SET @pub = CREATE_ASYMMETRIC_PUB_KEY('RSA', @priv);

-- Encrypt using private key, decrypt using public key
SET @ciphertext = ASYMMETRIC_ENCRYPT('RSA', 'The quick brown fox', @priv);
SET @plaintext = ASYMMETRIC_DECRYPT('RSA', @ciphertext, @pub);

-- Encrypt using public key, decrypt using private key
SET @ciphertext = ASYMMETRIC_ENCRYPT('RSA', 'The quick brown fox', @pub);
SET @plaintext = ASYMMETRIC_DECRYPT('RSA', @ciphertext, @priv);
</pre><p>
            次のように仮定します。
          </p><pre class="programlisting">
SET @s = a string to be encrypted
SET @priv = a valid private RSA key string in PEM format
SET @pub = the corresponding public RSA key string in PEM format
</pre><p>
            その後、これらの ID 関係が次のように保持されます。
          </p><pre class="programlisting">
ASYMMETRIC_DECRYPT('RSA', ASYMMETRIC_ENCRYPT('RSA', @s, @priv), @pub) = @s
ASYMMETRIC_DECRYPT('RSA', ASYMMETRIC_ENCRYPT('RSA', @s, @pub), @priv) = @s
</pre></li><li class="listitem"><a name="function_asymmetric-sign"></a><p>
            <a class="indexterm" name="idm139979091500496"></a> <code class="literal">ASYMMETRIC_SIGN(<em class="replaceable"><code>algorithm</code></em>, <em class="replaceable"><code>digest_str</code></em>, <em class="replaceable"><code>priv_key_str</code></em>, <em class="replaceable"><code>digest_type</code></em>)</code>
          </p><p>
            秘密鍵文字列を使用してダイジェスト文字列に署名し、その署名をバイナリ文字列として返します。署名に失敗した場合は、結果が <code class="literal">NULL</code> になります。
          </p><p>
            <em class="replaceable"><code>digest_str</code></em> はダイジェスト文字列です。これは、<code class="literal">CREATE_DIGEST()</code> を呼び出すことで生成できます。<em class="replaceable"><code>digest_type</code></em> は、ダイジェスト文字列を生成する際に使用されたダイジェストアルゴリズムを示します。
          </p><p>
            <em class="replaceable"><code>priv_key_str</code></em> は、ダイジェスト文字列に著名する際に使用される秘密鍵文字列です。これは、PEM 書式の有効な鍵文字列にする必要があります。<em class="replaceable"><code>algorithm</code></em> は、鍵を作成する際に使用された暗号化アルゴリズムを示します。
          </p><p>
            サポートされている <em class="replaceable"><code>algorithm</code></em> 値: <code class="literal">'RSA'</code>、<code class="literal">'DSA'</code>
          </p><p>
            サポートされている <em class="replaceable"><code>digest_type</code></em> 値: <code class="literal">'SHA224'</code>、<code class="literal">'SHA256'</code>、<code class="literal">'SHA384'</code>、<code class="literal">'SHA512'</code>
          </p><p>
            使用例については、<code class="literal">ASYMMETRIC_VERIFY()</code> の説明を参照してください。
          </p></li><li class="listitem"><a name="function_asymmetric-verify"></a><p>
            <a class="indexterm" name="idm139979091478656"></a> <code class="literal">ASYMMETRIC_VERIFY(<em class="replaceable"><code>algorithm</code></em>, <em class="replaceable"><code>digest_str</code></em>, <em class="replaceable"><code>sig_str</code></em>, <em class="replaceable"><code>pub_key_str</code></em>, <em class="replaceable"><code>digest_type</code></em>)</code>
          </p><p>
            署名文字列がダイジェスト文字列と一致するかどうかを確認し、確認に成功したのか失敗したのかを示す 1 または 0 を返します。
          </p><p>
            <em class="replaceable"><code>digest_str</code></em> はダイジェスト文字列です。これは、<code class="literal">CREATE_DIGEST()</code> を呼び出すことで生成できます。<em class="replaceable"><code>digest_type</code></em> は、ダイジェスト文字列を生成する際に使用されたダイジェストアルゴリズムを示します。
          </p><p>
            <em class="replaceable"><code>sig_str</code></em> は署名文字列です。これは、<code class="literal">ASYMMETRIC_SIGN()</code> を呼び出すことで生成できます。
          </p><p>
            <em class="replaceable"><code>pub_key_str</code></em> は、署名者の公開鍵文字列です。これは、署名文字列を生成する <code class="literal">ASYMMETRIC_SIGN()</code> に渡される秘密鍵に対応し、PEM 書式の有効な鍵文字列にする必要があります。<em class="replaceable"><code>algorithm</code></em> は、鍵を作成する際に使用された暗号化アルゴリズムを示します。
          </p><p>
            サポートされている <em class="replaceable"><code>algorithm</code></em> 値: <code class="literal">'RSA'</code>、<code class="literal">'DSA'</code>
          </p><p>
            サポートされている <em class="replaceable"><code>digest_type</code></em> 値: <code class="literal">'SHA224'</code>、<code class="literal">'SHA256'</code>、<code class="literal">'SHA384'</code>、<code class="literal">'SHA512'</code>
          </p><pre class="programlisting">
-- Set the encryption algorithm and digest type
SET @algo = 'RSA';
SET @dig_type = 'SHA224';

-- Create private/public key pair
SET @priv = CREATE_ASYMMETRIC_PRIV_KEY(@algo, 1024);
SET @pub = CREATE_ASYMMETRIC_PUB_KEY(@algo, @priv);

-- Generate digest from string
SET @dig = CREATE_DIGEST(@dig_type, 'The quick brown fox');

-- Generate signature for digest and verify signature against digest
SET @sig = ASYMMETRIC_SIGN(@algo, @dig, @priv, @dig_type);
SET @verf = ASYMMETRIC_VERIFY(@algo, @dig, @sig, @pub, @dig_type);
</pre></li><li class="listitem"><a name="function_create-asymmetric-priv-key"></a><p>
            <a class="indexterm" name="idm139979091454016"></a> <code class="literal">CREATE_ASYMMETRIC_PRIV_KEY(<em class="replaceable"><code>algorithm</code></em>, {<em class="replaceable"><code>key_len</code></em>|<em class="replaceable"><code>dh_secret</code></em>})</code>
          </p><p>
            指定されたアルゴリズムおよび鍵の長さまたは DH シークレットを使用して秘密鍵を作成し、その鍵を PEM 書式のバイナリ文字列として返します。鍵の生成に失敗した場合は、結果が <code class="literal">NULL</code> になります。
          </p><p>
            サポートされている <em class="replaceable"><code>algorithm</code></em> 値: <code class="literal">'RSA'</code>、<code class="literal">'DSA'</code>、<code class="literal">'DH'</code>
          </p><p>
            サポートされている <em class="replaceable"><code>key_len</code></em> 値: 最小の鍵の長さは 1024 ビットです。最大の鍵の長さはアルゴリズムによって異なり、RSA の場合は 16,384、DSA の場合は 10,000 です。これらの長さは、OpenSSL によって課された制約です。
          </p><p>
            DH 鍵の場合は、キーの長さの代わりに、共有 DH シークレットを渡します。シークレットを作成するには、鍵の長さを <code class="literal">CREATE_DH_PARAMETERS()</code> に渡します。
          </p><p>
            この例では、2,048 ビットの DSA 秘密鍵を作成してから、その秘密鍵から公開鍵を導出します。
          </p><pre class="programlisting">
SET @priv = CREATE_ASYMMETRIC_PRIV_KEY('DSA', 2048);
SET @pub = CREATE_ASYMMETRIC_PUB_KEY('DSA', @priv);
</pre><p>
            DH 鍵の生成を示す例については、<code class="literal">ASYMMETRIC_DERIVE()</code> の説明を参照してください。
          </p><p>
            鍵の長さと暗号化アルゴリズムを選択する際の一般的ないくつかの考慮事項は、次のとおりです。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                鍵のサイズとともに、公開鍵と秘密鍵の暗号化強度が増加しますが、鍵の生成時間も同様に増加します。
              </p></li><li class="listitem"><p>
                DH 鍵の生成時間は、RSA 鍵または RSA 鍵よりも大幅に長くなります。
              </p></li><li class="listitem"><p>
                非対称暗号化関数は、対称関数よりも遅くなります。パフォーマンスが重要な要素であり、その関数が非常に頻繁に使用される場合は、対称暗号化を使用した方が適切です。たとえば、<code class="literal">AES_ENCRYPT()</code> および <code class="literal">AES_DECRYPT()</code> を使用することを検討してください。
              </p></li></ul></div></li><li class="listitem"><a name="function_create-asymmetric-pub-key"></a><p>
            <a class="indexterm" name="idm139979091427472"></a> <code class="literal">CREATE_ASYMMETRIC_PUB_KEY(<em class="replaceable"><code>algorithm</code></em>, <em class="replaceable"><code>priv_key_str</code></em>)</code>
          </p><p>
            指定されたアルゴリズムを使用して、指定された秘密鍵から公開鍵を導出し、その鍵を PEM 書式のバイナリ文字列として返します。鍵の抽出に失敗した場合は、結果が <code class="literal">NULL</code> になります。
          </p><p>
            <em class="replaceable"><code>priv_key_str</code></em> は、PEM 書式の有効な鍵文字列にする必要があります。<em class="replaceable"><code>algorithm</code></em> は、鍵を作成する際に使用された暗号化アルゴリズムを示します。
          </p><p>
            サポートされている <em class="replaceable"><code>algorithm</code></em> 値: <code class="literal">'RSA'</code>、<code class="literal">'DSA'</code>、<code class="literal">'DH'</code>
          </p><p>
            使用例については、<code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code> の説明を参照してください。
          </p></li><li class="listitem"><a name="function_create-dh-parameters"></a><p>
            <a class="indexterm" name="idm139979091411568"></a> <code class="literal">CREATE_DH_PARAMETERS(<em class="replaceable"><code>key_len</code></em>)</code>
          </p><p>
            DH 秘密鍵と公開鍵のペアを生成するための共有シークレットを作成し、<code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code> に渡すことができるバイナリ文字列を返します。シークレットの生成に失敗した場合は、結果が NULL になります。
          </p><p>
            サポートされている <em class="replaceable"><code>key_len</code></em> 値: 最小および最大の鍵の長さは、1024 ビットおよび 10,000 ビットです。これらの長さは、OpenSSL によって課された制約です。
          </p><p>
            対称鍵を生成するための戻り値を使用する方法を示す例については、<code class="literal">ASYMMETRIC_DERIVE()</code> の説明を参照してください。
          </p><pre class="programlisting">
SET @dhp = CREATE_DH_PARAMETERS(1024);
</pre></li><li class="listitem"><a name="function_create-digest"></a><p>
            <a class="indexterm" name="idm139979091399152"></a> <code class="literal">CREATE_DIGEST(<em class="replaceable"><code>digest_type</code></em>, <em class="replaceable"><code>str</code></em>)</code>
          </p><p>
            指定されたダイジェストタイプを使用して、指定された文字列からダイジェストを作成し、そのダイジェストをバイナリ文字列として返します。ダイジェストの生成に失敗した場合は、結果が <code class="literal">NULL</code> になります。
          </p><p>
            サポートされている <em class="replaceable"><code>digest_type</code></em> 値: <code class="literal">'SHA224'</code>、<code class="literal">'SHA256'</code>、<code class="literal">'SHA384'</code>、<code class="literal">'SHA512'</code>
          </p><pre class="programlisting">
SET @dig = CREATE_DIGEST('SHA512', The quick brown fox');
</pre><p>
            結果として生成されるダイジェスト文字列は、<code class="literal">ASYMMETRIC_SIGN()</code> および <code class="literal">ASYMMETRIC_VERIFY()</code> との使用に適しています。
          </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="miscellaneous-functions"></a>12.18 その他の関数</h2></div></div></div><a class="indexterm" name="idm139979091383952"></a><a class="indexterm" name="idm139979091382480"></a><div class="table"><a name="idm139979091380448"></a><p class="title"><b>表 12.23 その他の関数</b></p><div class="table-contents"><table summary="その他の関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_default"><code class="literal">DEFAULT()</code></a></td><td>
      テーブルカラムのデフォルト値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a></td><td>
      名前付きロックを取得します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a></td><td>
      IP アドレスの数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_inet-ntoa"><code class="literal">INET_NTOA()</code></a></td><td>
      数値から IP アドレスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a></td><td>
      IPv6 アドレスの数値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA()</code></a></td><td>
      数値から IPv6 アドレスを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-free-lock"><code class="literal">IS_FREE_LOCK()</code></a></td><td>
      名前付きロックが解放されているかどうかを確認します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4-compat"><code class="literal">IS_IPV4_COMPAT()</code></a></td><td>
      引数が IPv4 互換アドレスの場合、true を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4-mapped"><code class="literal">IS_IPV4_MAPPED()</code></a></td><td>
      引数が IPv4 マップアドレスの場合、true
      を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a></td><td>
      引数が IPv4 アドレスの場合、true を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv6"><code class="literal">IS_IPV6()</code></a></td><td>
      引数が IPv6 アドレスの場合、true を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_is-used-lock"><code class="literal">IS_USED_LOCK()</code></a></td><td>
      名前付きロックが使用中かどうかを確認します。true
      の場合は接続識別子を返します。
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a></td><td>
      スレーブが指定された位置まですべての更新を読み取って適用するまで、ブロックします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_name-const"><code class="literal">NAME_CONST()</code></a></td><td>
      指定された名前がカラムに付けられます
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td><td>
      ランダムな浮動小数点値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a></td><td>
      名前付きロックを解放します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a></td><td>
      ある秒数間スリープ状態にします
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a></td><td>
      整数値のユニバーサル識別子を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a></td><td>
      ユニバーサル固有識別子 (UUID) を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a></td><td>
      INSERT で使用される値を定義します
    </td></tr></tbody></table></div></div><br class="table-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_default"></a><p>
          <a class="indexterm" name="idm139979091333728"></a> <code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code>
        </p><p>
          テーブルカラムのデフォルト値を返します。カラムにデフォルト値がない場合は、エラーが発生します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE t SET i = DEFAULT(i)+1 WHERE id &lt; 100;</code></strong>
</pre></li><li class="listitem"><p>
          <code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code>
        </p><p>
          数値 <em class="replaceable"><code>X</code></em> を <code class="literal">'#,###,###.##'</code> のような書式に変換し、小数点第 <em class="replaceable"><code>D</code></em> 位に丸めて、その結果を文字列として返します。詳細は、<a class="xref" href="functions.html#string-functions" title="12.5 文字列関数">セクション12.5「文字列関数」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_get-lock"></a><p>
          <a class="indexterm" name="idm139979091318000"></a> <a class="indexterm" name="idm139979091316544"></a> <code class="literal">GET_LOCK(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>timeout</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>timeout</code></em> 秒のタイムアウトを使用して、文字列 <em class="replaceable"><code>str</code></em> で指定された名前でロックの取得を試みます。負の <em class="replaceable"><code>timeout</code></em> 値は、無限のタイムアウトを表します。
        </p><p>
          ロックの取得に成功した場合は <code class="literal">1</code> を返し、試行がタイムアウトになった場合 (たとえば、ほかのクライアントがすでにその名前をロックしている場合) は <code class="literal">0</code> を返し、エラー (メモリー不足や <span class="command"><strong>mysqladmin kill</strong></span> によるスレッドの停止など) が発生した場合は <code class="literal">NULL</code> を返します。<code class="literal">GET_LOCK()</code> を使用してロックを取得した場合は、<code class="literal">RELEASE_LOCK()</code> を実行したとき、新しい <code class="literal">GET_LOCK()</code> を実行したとき、または接続が切断されたとき (正常または異常を問わず) に解除されます。<code class="literal">GET_LOCK()</code> を使用して取得されたロックは、トランザクションとやりとりを行いません。つまり、トランザクションをコミットしても、トランザクション中に取得されたロックは解除されません。
        </p><p>
          <code class="literal">GET_LOCK()</code> を使用すると、アプリケーションロックを実装したり、レコードロックのシミュレーションを行なったりできます。名前はサーバー全体にわたってロックされます。1 つのセッション内で名前がロックされた場合は、<code class="literal">GET_LOCK()</code> によって、別のセッションによる同じ名前を持つロックのリクエストがブロックされます。これにより、指定されたロック名について合意したクライアントは、その名前を使用すると共同のアドバイザリロックを実行できます。ただし、共同するクライアントのセットに属さないクライアントも、不注意と故意のどちらででも、名前をロックできることに注意してください。したがって、共同するクライアントがその名前をロックできないようにしてください。この可能性を減らす方法の 1 つは、データベース固有またはアプリケーション固有のロック名を使用することです。たとえば、<em class="replaceable"><code>db_name.str</code></em> または <em class="replaceable"><code>app_name.str</code></em> 形式のロック名を使用します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT GET_LOCK('lock1',10);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT IS_FREE_LOCK('lock2');</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT GET_LOCK('lock2',10);</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT RELEASE_LOCK('lock2');</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT RELEASE_LOCK('lock1');</code></strong>
        -&gt; NULL
</pre><p>
          ロック <code class="literal">'lock1'</code> は 2 番目の <code class="literal">GET_LOCK()</code> 呼び出しによって自動的に解除されるため、2 番目の <code class="literal">RELEASE_LOCK()</code> 呼び出しは <code class="literal">NULL</code> を返します。
        </p><p>
          複数のクライアントがロックを待機している場合は、ロックを取得する順序が定義されません。アプリケーションは、ロックリクエストを発行したときと同じ順序でクライアントがロックを取得すると仮定しません。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。
        </p></li><li class="listitem"><a name="function_inet-aton"></a><p>
          <a class="indexterm" name="idm139979091280640"></a> <code class="literal">INET_ATON(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          IPv4 ネットワークアドレスのドット区切り表現が文字列として指定された場合、アドレスの数値を表す整数をネットワークバイト順序 (ビッグエンディアン) で返します。引数が認識されない場合、<code class="literal">INET_ATON()</code> は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT INET_ATON('10.0.5.9');</code></strong>
        -&gt; 167773449
</pre><p>
          この例では、戻り値は 10×256<sup>3</sup> + 0×256<sup>2</sup> + 5×256 + 9 として計算されます。
        </p><p>
          <code class="literal">INET_ATON()</code> は、短い形式の IP アドレス (<code class="literal">'127.0.0.1'</code> の表現として <code class="literal">'127.1'</code> など) の場合に、非 <code class="literal">NULL</code> を返す場合と返さない場合があります。このため、このようなアドレスには <code class="literal">INET_ATON()</code> を使用しないでください。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">INET_ATON()</code> で生成された値を格納するには、署名される <code class="literal">INT</code> ではなく、<code class="literal">INT UNSIGNED</code> カラムを使用します。署名付きのカラムを使用する場合は、第 1 オクテットが 127 よりも大きい IP アドレスに対応する値を正常に格納できません。<a class="xref" href="data-types.html#out-of-range-and-overflow" title="11.2.6 範囲外およびオーバーフローの処理">セクション11.2.6「範囲外およびオーバーフローの処理」</a>を参照してください。
          </p></div></li><li class="listitem"><a name="function_inet-ntoa"></a><p>
          <a class="indexterm" name="idm139979091258048"></a> <code class="literal">INET_NTOA(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          数値の IPv4 ネットワークアドレスがネットワークバイト順序で指定された場合、アドレスのドット区切り文字列表現を接続文字セット内の非バイナリ文字列として返します。引数が認識されない場合、<code class="literal">INET_NTOA()</code> は <code class="literal">NULL</code> を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT INET_NTOA(167773449);</code></strong>
        -&gt; '10.0.5.9'
</pre></li><li class="listitem"><a name="function_inet6-aton"></a><p>
          <a class="indexterm" name="idm139979091246656"></a> <code class="literal">INET6_ATON(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          IPv6 または IPv4 ネットワークアドレスが文字列として指定された場合、アドレスの数値を表すバイナリ文字列をネットワークバイト順序 (ビッグエンディアン) で返します。数値書式の IPv6 アドレスでは最大の整数型よりも大きいバイトが必要であるため、この関数で返される表現のデータ型は、<code class="literal">VARBINARY</code> (IPv6 アドレスの場合は <code class="literal">VARBINARY(16)</code>、IPv4 アドレスの場合は <code class="literal">VARBINARY(4)</code>) です。引数が有効なアドレスでない場合、<code class="literal">INET6_ATON()</code> は <code class="literal">NULL</code> を返します。
        </p><p>
          次の例では、<code class="literal">HEX()</code> を使用して <code class="literal">INET6_ATON()</code> の結果を出力可能な形式で表示します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON('fdfe::5a55:caff:fefa:9089'));</code></strong>
        -&gt; 'FDFE0000000000005A55CAFFFEFA9089'
mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON('10.0.5.9'));</code></strong>
        -&gt; '0A000509'
</pre><p>
          <code class="literal">INET6_ATON()</code> は、有効な引数上の複数の制約を監視します。これらについては、次のリストに例とともに示します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">fe80::3%1</code> や <code class="literal">fe80::3%eth0</code> のような末尾のゾーン ID は許可されません。
            </p></li><li class="listitem"><p>
              <code class="literal">2001:45f:3:ba::/64</code> や <code class="literal">192.168.1.0/24</code> のような末尾のネットワークマスクは許可されません。
            </p></li><li class="listitem"><p>
              IPv4 アドレスを表す値では、クラスレスアドレスのみがサポートされます。<code class="literal">192.168.1</code> などのクラスフルアドレスは拒否されます。<code class="literal">192.168.1.2:8080</code> のような末尾のポート番号は許可されません。<code class="literal">192.0xa0.1.2</code> のようなアドレスコンポーネント内の 16 進数は許可されません。8 進数はサポートされていません。<code class="literal">192.168.010.1</code> は <code class="literal">192.168.8.1</code> ではなく、<code class="literal">192.168.10.1</code> として処理されます。このような IPv4 の制約は、IPv4 アドレス部分を持つ IPv6 アドレス (IPv4 互換アドレスや IPv4 マップアドレスなど) にも適用されます。
            </p></li></ul></div><p>
          <code class="literal">INT</code> 値として数値形式で表現された IPv4 アドレス <em class="replaceable"><code>expr</code></em> を、<code class="literal">VARBINARY</code> 値として数値形式で表現された IPv6 アドレスに変換するには、次の式を使用します。
        </p><pre class="programlisting">
INET6_ATON(INET_NTOA(<em class="replaceable"><code>expr</code></em>))
</pre><p>
          例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON(INET_NTOA(167773449)));</code></strong>
        -&gt; '0A000509'
</pre><p>
          この関数は、MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><a name="function_inet6-ntoa"></a><p>
          <a class="indexterm" name="idm139979091209056"></a> <code class="literal">INET6_NTOA(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          バイナリ文字列として数値形式で表現された IPv6 または IPv4 ネットワークアドレスが指定された場合、アドレスの文字列表現を接続文字セット内の非バイナリ文字列として返します。引数が有効なアドレスでない場合、<code class="literal">INET6_NTOA()</code> は <code class="literal">NULL</code> を返します。
        </p><p>
          <code class="literal">INET6_NTOA()</code> には、次のようなプロパティーがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              変換はオペレーティングシステムの機能を使用して実行されないため、出力文字列はプラットフォームに依存しません。
            </p></li><li class="listitem"><p>
              戻り文字列の最大長は 39 (4 x 8 + 7) です。次のステートメントが指定された場合、
            </p><pre class="programlisting">
CREATE TABLE t AS SELECT INET6_NTOA(<em class="replaceable"><code>expr</code></em>) AS c1;
</pre><p>
              結果として生成されるテーブルに次の定義が含まれます。
            </p><pre class="programlisting">
CREATE TABLE t (c1 VARCHAR(39) CHARACTER SET utf8 DEFAULT NULL);
</pre></li><li class="listitem"><p>
              戻り文字列では、IPv6 アドレスを表す小文字が使用されます。
            </p></li></ul></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(INET6_ATON('fdfe::5a55:caff:fefa:9089'));</code></strong>
        -&gt; 'fdfe::5a55:caff:fefa:9089'
mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(INET6_ATON('10.0.5.9'));</code></strong>
        -&gt; '10.0.5.9'

mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(UNHEX('FDFE0000000000005A55CAFFFEFA9089'));</code></strong>
        -&gt; 'fdfe::5a55:caff:fefa:9089'
mysql&gt; <strong class="userinput"><code>SELECT INET6_NTOA(UNHEX('0A000509'));</code></strong>
        -&gt; '10.0.5.9'
</pre><p>
          この関数は、MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><a name="function_is-free-lock"></a><p>
          <a class="indexterm" name="idm139979091186848"></a> <code class="literal">IS_FREE_LOCK(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>str</code></em> という名前が付けられたロックが使用可能であるか (つまり、ロックされていないか) どうかをチェックします。ロックが使用可能である (だれもロックを使用していない) 場合は <code class="literal">1</code> を返し、使用中である場合は <code class="literal">0</code> を返し、エラー (不正な引数など) が発生した場合は <code class="literal">NULL</code> を返します。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。
        </p></li><li class="listitem"><a name="function_is-ipv4"></a><p>
          <a class="indexterm" name="idm139979091173856"></a> <code class="literal">IS_IPV4(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          引数が文字列として指定された有効な IPv4 アドレスの場合は 1 を返し、それ以外の場合は 0 を返します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4('10.0.5.9'), IS_IPV4('10.0.5.256');</code></strong>
        -&gt; 1, 0
</pre><p>
          特定の引数では、<code class="literal">IS_IPV4()</code> が 1 を返すと、<code class="literal">INET_ATON()</code> (および <code class="literal">INET6_ATON()</code>) は <code class="literal">NULL</code> 以外を返します。逆のステートメントは該当しません。一部のケースでは、<code class="literal">IS_IPV4()</code> が 0 を返すと、<code class="literal">INET_ATON()</code> は <code class="literal">NULL</code> 以外を返します。
        </p><p>
          上記の備考で示したように、<code class="literal">IS_IPV4()</code> は、有効な IPv4 アドレスを構成するものに関して、<code class="literal">INET_ATON()</code> よりも厳密であるため、無効な値に対して強固なチェックを実行する必要のあるアプリケーションで役立つことがあります。または、<code class="literal">INET6_ATON()</code> を使用して、IPv4 アドレスを内部形式に変換し、(無効なアドレスを示す) <code class="literal">NULL</code> の結果をチェックします。<code class="literal">INET6_ATON()</code> は、IPv4 アドレスのチェックという点では、<code class="literal">IS_IPV4()</code> と同等の強固さです。
        </p><p>
          この関数は、MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><a name="function_is-ipv4-compat"></a><p>
          <a class="indexterm" name="idm139979091149520"></a> <code class="literal">IS_IPV4_COMPAT(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          この関数には、<code class="literal">INET6_ATON()</code> で返されるように、バイナリ文字列として数値形式で表現された IPv6 アドレスが指定されます。引数が有効な IPv4 互換 IPv6 アドレスの場合は 1 を返し、それ以外の場合は 0 を返します。IPv4 互換アドレスの形式は、<code class="literal">::<em class="replaceable"><code>ipv4_address</code></em></code> です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9'));</code></strong>
        -&gt; 1
mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4_COMPAT(INET6_ATON('::ffff:10.0.5.9'));</code></strong>
        -&gt; 0
</pre><p>
          IPv4 互換アドレスの IPv4 部分は、16 進表記法を使用して表現することもできます。たとえば、<code class="literal">192.168.0.1</code> には、次のような生の 16 進値が含まれます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT HEX(INET6_ATON('192.168.0.1'));</code></strong>
        -&gt; 'C0A80001'
</pre><p>
          IPv4 互換形式で表現された <code class="literal">::192.168.0.1</code> は、<code class="literal">::c0a8:0001</code> または (先頭のゼロなしの) <code class="literal">::c0a8:1</code> と同等です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::192.168.0.1')),</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::c0a8:0001')),</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::c0a8:1'));</code></strong>
        -&gt; 1, 1, 1
</pre><p>
          この関数は、MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><a name="function_is-ipv4-mapped"></a><p>
          <a class="indexterm" name="idm139979091127024"></a> <code class="literal">IS_IPV4_MAPPED(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          この関数には、<code class="literal">INET6_ATON()</code> で返されるように、バイナリ文字列として数値形式で表現された IPv6 アドレスが指定されます。引数が有効な IPv4 マップ IPv6 アドレスの場合は 1 を返し、それ以外の場合は 0 を返します。IPv4 マップアドレスの形式は、<code class="literal">::ffff:<em class="replaceable"><code>ipv4_address</code></em></code> です。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4_MAPPED(INET6_ATON('::10.0.5.9'));</code></strong>
        -&gt; 0
mysql&gt; <strong class="userinput"><code>SELECT IS_IPV4_MAPPED(INET6_ATON('::ffff:10.0.5.9'));</code></strong>
        -&gt; 1
</pre><p>
          <code class="literal">IS_IPV4_COMPAT()</code> と同様に、IPv4 マップアドレスの IPv4 部分は、16 進表記法を使用して表現することもできます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:192.168.0.1')),</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:c0a8:0001')),</code></strong>
    -&gt; <strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:c0a8:1'));</code></strong>
        -&gt; 1, 1, 1
</pre><p>
          この関数は、MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><a name="function_is-ipv6"></a><p>
          <a class="indexterm" name="idm139979091108896"></a> <code class="literal">IS_IPV6(<em class="replaceable"><code>expr</code></em>)</code>
        </p><p>
          引数が文字列として指定された有効な IPv6 アドレスの場合は 1 を返し、それ以外の場合は 0 を返します。この関数では、IPv4 アドレスが有効な IPv6 アドレスとみなされません。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT IS_IPV6('10.0.5.9'), IS_IPV6('::1');</code></strong>
        -&gt; 0, 1
</pre><p>
          特定の引数では、<code class="literal">IS_IPV6()</code> が 1 を返すと、<code class="literal">INET6_ATON()</code> は <code class="literal">NULL</code> 以外を返します。
        </p><p>
          この関数は、MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><a name="function_is-used-lock"></a><p>
          <a class="indexterm" name="idm139979091095440"></a> <code class="literal">IS_USED_LOCK(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>str</code></em> という名前が付けられたロックが使用中であるか (つまり、ロックされているか) どうかをチェックします。その場合は、ロックを保持しているクライアントの接続識別子を返します。そうでない場合は、<code class="literal">NULL</code> を返します。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。
        </p></li><li class="listitem"><a name="function_master-pos-wait"></a><p>
          <a class="indexterm" name="idm139979091083872"></a> <code class="literal">MASTER_POS_WAIT(<em class="replaceable"><code>log_name</code></em>,<em class="replaceable"><code>log_pos</code></em>[,<em class="replaceable"><code>timeout</code></em>])</code>
        </p><p>
          この関数は、マスター/スレーブの同期化を制御する際に役立ちます。スレーブがマスターログで指定された位置までのすべての更新を読み取り、適用するまでブロックします。戻り値は、指定された位置まで進むまでスレーブが待機する必要のあるログイベントの数です。この関数は、スレーブ SQL スレッドが開始されていない場合、スレーブのマスター情報が初期化されていない場合、引数が正しくない場合、またはエラーが発生した場合に <code class="literal">NULL</code> を返します。タイムアウトを超えた場合は、<code class="literal">-1</code> を返します。<code class="literal">MASTER_POS_WAIT()</code> の待機中にスレーブ SQL スレッドが停止すると、関数は <code class="literal">NULL</code> を返します。スレーブが指定された位置を過ぎると、関数は即座に返します。
        </p><p>
          <em class="replaceable"><code>timeout</code></em> 値が指定されている場合、<code class="literal">MASTER_POS_WAIT()</code> は、<em class="replaceable"><code>timeout</code></em> 秒が経過した時点で待機を停止します。<em class="replaceable"><code>timeout</code></em> は 0 よりも大きい値にする必要があります。<em class="replaceable"><code>timeout</code></em> がゼロまたは負の値である場合は、タイムアウトがないことを意味します。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。
        </p></li><li class="listitem"><a name="function_name-const"></a><p>
          <a class="indexterm" name="idm139979091065344"></a> <code class="literal">NAME_CONST(<em class="replaceable"><code>name</code></em>,<em class="replaceable"><code>value</code></em>)</code>
        </p><p>
          指定された値を返します。結果セットのカラムを生成する際に <code class="literal">NAME_CONST()</code> を使用すると、指定された名前がカラムに付けられます。引数には定数を指定してください。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NAME_CONST('myname', 14);</code></strong>
+--------+
| myname |
+--------+
|     14 |
+--------+
</pre><p>
          この関数は、内部でのみ使用されます。<a class="xref" href="stored-programs-views.html#stored-programs-logging" title="20.7 ストアドプログラムのバイナリロギング">セクション20.7「ストアドプログラムのバイナリロギング」</a>で説明したように、ローカルプログラム変数への参照を含むストアドプログラムからステートメントを記述する際に、サーバーで使用されます。この関数は、<span class="command"><strong>mysqlbinlog</strong></span> からの出力に表示されることがあります。
        </p><p>
          アプリケーションで次のような単純なエイリアスを使用しても、上記で示した例とまったく同じ結果を取得できます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 14 AS myname;</code></strong>
+--------+
| myname |
+--------+
|     14 |
+--------+
1 row in set (0.00 sec)
</pre><p>
          カラムのエイリアスについての詳細は、<a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT 構文">セクション13.2.9「SELECT 構文」</a>を参照してください。
        </p></li><li class="listitem"><a name="function_release-lock"></a><p>
          <a class="indexterm" name="idm139979091049168"></a> <code class="literal">RELEASE_LOCK(<em class="replaceable"><code>str</code></em>)</code>
        </p><p>
          <code class="literal">GET_LOCK()</code> を使用して取得された文字列 <em class="replaceable"><code>str</code></em> によって名前が付けられたロックを解除します。ロックが解除された場合は <code class="literal">1</code> を返し、このスレッドによってロックが確立されなかった場合 (その場合、ロックは解除されません) は <code class="literal">0</code> を返し、名前付きのロックが存在しない場合は <code class="literal">NULL</code> を返します。<code class="literal">GET_LOCK()</code> を呼び出しても取得されなかった場合や、事前に解除された場合は、ロックが存在しません。
        </p><p>
          <code class="literal">DO</code> ステートメントは、<code class="literal">RELEASE_LOCK()</code> とともに使用すると便利です。<a class="xref" href="sql-syntax.html#do" title="13.2.3 DO 構文">セクション13.2.3「DO 構文」</a>を参照してください。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。
        </p></li><li class="listitem"><a name="function_sleep"></a><p>
          <a class="indexterm" name="idm139979091030752"></a> <code class="literal">SLEEP(<em class="replaceable"><code>duration</code></em>)</code>
        </p><p>
          <em class="replaceable"><code>duration</code></em> 引数で指定された秒数間スリープ状態に (一時停止) してから、0 を返します。<code class="literal">SLEEP()</code> が中断された場合は、1 を返します。この期間には、小数部分が含まれている場合もあります。
        </p><p>
          この関数は、ステートメントベースのレプリケーションでは安全に使用できません。<code class="literal">binlog_format</code> が <code class="literal">STATEMENT</code> に設定されているときに、この関数を使用すると、警告のログが記録されます。
        </p></li><li class="listitem"><a name="function_uuid"></a><p>
          <a class="indexterm" name="idm139979091019056"></a> <code class="literal">UUID()</code>
        </p><p>
          1997 年 10 月に The Open Group によって公開された <span class="quote">「<span class="quote">DCE 1.1: Remote Procedure Call</span>」</span> (付録 A) 「CAE (Common Applications Environment) Specifications」(ドキュメント番号 C706、<a class="ulink" href="http://www.opengroup.org/public/pubs/catalog/c706.htm" target="_top">http://www.opengroup.org/public/pubs/catalog/c706.htm</a>)に従って生成されたユニバーサル固有識別子 (UUID) を返します。
        </p><p>
          UUID は、空間と時間においてグローバルに一意の数字として設計されています。<code class="literal">UUID()</code> の 2 回の呼び出しが、相互に接続されていない 2 台の異なるコンピュータ上で実行された場合でも、これらの呼び出しでは 2 つの異なる値が生成されると想定されます。
        </p><p>
          UUID は、<code class="literal">aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee</code> という書式で、5 つの 16 進数で構成される <code class="literal">utf8</code> 文字列で表現された 128 ビットの数値です。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              最初の 3 つの数字は、タイムスタンプから生成されます。
            </p></li><li class="listitem"><p>
              4 番目の数字には、(たとえば、サマータイムが原因で) タイムスタンプ値の単調性が失われる場合に備えて、時間の一意性が保持されます。
            </p></li><li class="listitem"><p>
              5 番目の数字は、空間の一意性を提供する IEEE 802 ノード番号です。(たとえば、ホストコンピュータに Ethernet カードが搭載されていないことや、オペレーティングシステム上のインタフェースのハードウェアアドレスを見つける方法がわからないことが原因で) 後者を使用できない場合は、ランダムな数字で置き換えられます。この場合、空間の一意性は保証できません。しかしそれでも、競合が発生する可能性は<span class="emphasis"><em>非常に</em></span>低くなります。
            </p><p>
              現在、インタフェースの MAC アドレスは、FreeBSD と Linux でのみ考慮されています。その他のオペレーティングシステムでは、ランダムに生成された 48 ビットの数字が MySQL で使用されます。
            </p></li></ul></div><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UUID();</code></strong>
        -&gt; '6ccd780c-baba-1026-9564-0040f4311e29'
</pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">警告</div><p>
            <code class="literal">UUID()</code> 値の目的は一意性を保つことですが、必ずしも推測不可能または予測不可能であるとはかぎりません。予測不可能性が必要である場合は、UUID 値を何か別の方法で生成してください。
          </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">UUID()</code> は、ステートメントベースのレプリケーションでは正しく動作しません。
          </p></div></li><li class="listitem"><a name="function_uuid-short"></a><p>
          <a class="indexterm" name="idm139979090994736"></a> <code class="literal">UUID_SHORT()</code>
        </p><p>
          (<code class="literal">UUID()</code> 関数で返されるような文字列形式の 128 ビット識別子ではなく)、<span class="quote">「<span class="quote">短い</span>」</span>ユニバーサル識別子を 64 ビットの符号なし整数として返します。
        </p><p>
          次の条件を満たす場合は、<code class="literal">UUID_SHORT()</code> の値が一意であることが保証されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              一連のマスター/スレーブサーバーの中で現在のホストの <code class="literal">server_id</code> が一意である
            </p></li><li class="listitem"><p>
              <code class="literal">server_id</code> の範囲が 0 から 255 である
            </p></li><li class="listitem"><p>
              <span class="command"><strong>mysqld</strong></span> の再起動間にサーバーのシステム時間を戻さない
            </p></li><li class="listitem"><p>
              <span class="command"><strong>mysqld</strong></span> の再起動間に、<code class="literal">UUID_SHORT()</code> を 1 秒あたり平均 1600 万を上回る回数で呼び出さない
            </p></li></ul></div><p>
          <code class="literal">UUID_SHORT()</code> の戻り値は、次のように構成されます。
        </p><pre class="programlisting">
  (server_id &amp; 255) &lt;&lt; 56
+ (server_startup_time_in_seconds &lt;&lt; 24)
+ incremented_variable++;
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT UUID_SHORT();</code></strong>
        -&gt; 92395783831158784
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">UUID_SHORT()</code> は、ステートメントベースのレプリケーションでは正しく動作しません。
          </p></div></li><li class="listitem"><a name="function_values"></a><p>
          <a class="indexterm" name="idm139979090969808"></a> <code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code>
        </p><p>
          <code class="literal">INSERT ... ON DUPLICATE KEY UPDATE</code> ステートメントでは、<code class="literal">UPDATE</code> 句の <code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code> 関数を使用すると、ステートメントの <code class="literal">INSERT</code> 部分からカラム値を参照できます。つまり、<code class="literal">UPDATE</code> 句の <code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code> は、挿入される <em class="replaceable"><code>col_name</code></em> 値を参照するため、重複キーの競合が発生しなくなります。この関数は、複数の行を挿入する際に特に役立ちます。<code class="literal">VALUES()</code> 関数は、<code class="literal">INSERT</code> ステートメントの <code class="literal">ON DUPLICATE KEY UPDATE</code> 句でのみ有効であり、それ以外の場合は <code class="literal">NULL</code> を返します。<a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE 構文">セクション13.2.5.3「INSERT ... ON DUPLICATE KEY UPDATE 構文」</a>を参照してください。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>INSERT INTO table (a,b,c) VALUES (1,2,3),(4,5,6)</code></strong>
    -&gt; <strong class="userinput"><code>ON DUPLICATE KEY UPDATE c=VALUES(a)+VALUES(b);</code></strong>
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="group-by-functions-and-modifiers"></a>12.19 GROUP BY 句で使用される関数と修飾子</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#group-by-functions">12.19.1 GROUP BY (集約) 関数</a></span></dt><dt><span class="section"><a href="functions.html#group-by-modifiers">12.19.2 GROUP BY 修飾子</a></span></dt><dt><span class="section"><a href="functions.html#group-by-handling">12.19.3 MySQL での GROUP BY の処理</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="group-by-functions"></a>12.19.1 GROUP BY (集約) 関数</h3></div></div></div><a class="indexterm" name="idm139979090947472"></a><a class="indexterm" name="idm139979090946032"></a><a class="indexterm" name="idm139979090944112"></a><div class="table"><a name="idm139979090941936"></a><p class="title"><b>表 12.24 集約 (<code class="literal">GROUP BY</code>) 関数</b></p><div class="table-contents"><table summary="集約 (GROUP BY) 関数" border="1"><colgroup><col class="name"><col class="description"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a></td><td>
      引数の平均値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a></td><td>
      ビット単位の And を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a></td><td>
      ビット単位の OR を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a></td><td>
      ビット単位の XOR を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_count-distinct"><code class="literal">COUNT(DISTINCT)</code></a></td><td>
      異なる値のカウントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a></td><td>
      返された行数のカウントを返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_group-concat"><code class="literal">GROUP_CONCAT()</code></a></td><td>
      連結された文字列を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a></td><td>
      最大値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a></td><td>
      最小値を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a></td><td>
      母標準偏差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a></td><td>
      母標準偏差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev-samp"><code class="literal">STDDEV_SAMP()</code></a></td><td>
      標本標準偏差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a></td><td>
      母標準偏差を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a></td><td>
      集計を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a></td><td>
      母標準分散を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP()</code></a></td><td>
      標本分散を返します
    </td></tr><tr><td scope="row"><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a></td><td>
      母標準分散を返します
    </td></tr></tbody></table></div></div><br class="table-break"><p>
        このセクションでは、値のセットを演算するグループ (集約) 関数について説明します。特に指定されていなければ、グループ関数では <code class="literal">NULL</code> 値が無視されます。
      </p><p>
        <code class="literal">GROUP BY</code> 句を含まないステートメントでグループ関数を使用する場合は、すべての行をグループ化することと同等になります。詳細は、<a class="xref" href="functions.html#group-by-handling" title="12.19.3 MySQL での GROUP BY の処理">セクション12.19.3「MySQL での GROUP BY の処理」</a>を参照してください。
      </p><p>
        数値の引数の場合、分散および標準偏差関数が <code class="literal">DOUBLE</code> 値を返します。<code class="literal">SUM()</code> および <code class="literal">AVG()</code> 関数は、正確な値の引数 (整数または <code class="literal">DECIMAL</code>) の場合は <code class="literal">DECIMAL</code> 値を返し、近似値の引数 (<code class="literal">FLOAT</code> または <code class="literal">DOUBLE</code>) の場合は <code class="literal">DOUBLE</code> 値を返します。
      </p><p>
        <code class="literal">SUM()</code> および <code class="literal">AVG()</code> 集計関数は時間値を扱いません。(これらは値を数字に変換するので、最初の数字以外の文字のあとのすべての情報が失われます。)この問題を回避するには、数値単位に変換し、集計操作を実行してから、時間値に戻します。例:
      </p><pre class="programlisting">
SELECT SEC_TO_TIME(SUM(TIME_TO_SEC(<em class="replaceable"><code>time_col</code></em>))) FROM <em class="replaceable"><code>tbl_name</code></em>;
SELECT FROM_DAYS(SUM(TO_DAYS(<em class="replaceable"><code>date_col</code></em>))) FROM <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
        数値引数を取る <code class="literal">SUM()</code> や <code class="literal">AVG()</code> などの関数は、必要に応じて引数を数値にキャストします。<code class="literal">SET</code> や <code class="literal">ENUM</code> 値の場合、キャスト演算でベースとなる数値が使用されます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_avg"></a><p>
            <a class="indexterm" name="idm139979090878048"></a> <a class="indexterm" name="idm139979090876736"></a> <a class="indexterm" name="idm139979090875392"></a> <code class="literal">AVG([DISTINCT] <em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em></code> の平均値を返します。<code class="literal">DISTINCT</code> オプションを使用すると、個別の <em class="replaceable"><code>expr</code></em> 値の平均を返すことができます。
          </p><p>
            一致する行がなかった場合、<code class="literal">AVG()</code> は <code class="literal">NULL</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT student_name, AVG(test_score)</code></strong>
    -&gt;        <strong class="userinput"><code>FROM student</code></strong>
    -&gt;        <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre></li><li class="listitem"><a name="function_bit-and"></a><p>
            <a class="indexterm" name="idm139979090859648"></a> <code class="literal">BIT_AND(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> 内のすべてのビットのビット単位の <code class="literal">AND</code> を返します。計算は 64 ビット (<code class="literal">BIGINT</code>) の精度で実行されます。
          </p><p>
            一致する行がなかった場合、この関数は <code class="literal">18446744073709551615</code> を返します。(これは、すべてのビットが 1 に設定された符号なし <code class="literal">BIGINT</code> 値の値です。)
          </p></li><li class="listitem"><a name="function_bit-or"></a><p>
            <a class="indexterm" name="idm139979090847616"></a> <code class="literal">BIT_OR(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> 内のすべてのビットのビット単位の <code class="literal">OR</code> を返します。計算は 64 ビット (<code class="literal">BIGINT</code>) の精度で実行されます。
          </p><p>
            一致する行がなかった場合、この関数は <code class="literal">0</code> を返します。
          </p></li><li class="listitem"><a name="function_bit-xor"></a><p>
            <a class="indexterm" name="idm139979090836832"></a> <code class="literal">BIT_XOR(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> 内のすべてのビットのビット単位の <code class="literal">XOR</code> を返します。計算は 64 ビット (<code class="literal">BIGINT</code>) の精度で実行されます。
          </p><p>
            一致する行がなかった場合、この関数は <code class="literal">0</code> を返します。
          </p></li><li class="listitem"><a name="function_count"></a><p>
            <a class="indexterm" name="idm139979090825744"></a> <code class="literal">COUNT(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <code class="literal">SELECT</code> ステートメントで取得された行に含まれる <em class="replaceable"><code>expr</code></em> の非 <code class="literal">NULL</code> 値の数を返します。結果は <code class="literal">BIGINT</code> 値になります。
          </p><p>
            一致する行がなかった場合、<code class="literal">COUNT()</code> は <code class="literal">0</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT student.student_name,COUNT(*)</code></strong>
    -&gt;        <strong class="userinput"><code>FROM student,course</code></strong>
    -&gt;        <strong class="userinput"><code>WHERE student.student_id=course.student_id</code></strong>
    -&gt;        <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            <code class="literal">COUNT(*)</code> は、<code class="literal">NULL</code> 値が含まれるかどうかに関係なく、取得された行の数を返すという点で少し異なります。
          </p><p>
            <code class="literal">COUNT(*)</code> は、<code class="literal">SELECT</code> が 1 つのテーブルから取得し、その他のカラムは取得されず、<code class="literal">WHERE</code> 句がない場合に、非常に迅速に返すように最適化されています。例:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT COUNT(*) FROM student;</code></strong>
</pre><p>
            この最適化は、<code class="literal">MyISAM</code> テーブルにのみ適用されます。その理由は、正確な行数は、このストレージエンジンで格納されることで、非常にすばやくアクセスできるためです。<code class="literal">InnoDB</code> などのトランザクショナルストレージエンジンで正確な行数を格納すると、複数のトランザクションが発生し、それぞれが数に影響を与える可能性があるため、問題が発生する可能性が高くなります。
          </p></li><li class="listitem"><a name="function_count-distinct"></a><p>
            <a class="indexterm" name="idm139979090798096"></a> <a class="indexterm" name="idm139979090796752"></a> <code class="literal">COUNT(DISTINCT <em class="replaceable"><code>expr</code></em>,[<em class="replaceable"><code>expr</code></em>...])</code>
          </p><p>
            さまざまな非 <code class="literal">NULL</code> <em class="replaceable"><code>expr</code></em> 値を含む行の数を返します。
          </p><p>
            一致する行がなかった場合、<code class="literal">COUNT(DISTINCT)</code> は <code class="literal">0</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT COUNT(DISTINCT results) FROM student;</code></strong>
</pre><p>
            MySQL では、式のリストを指定することで、<code class="literal">NULL</code> が含まれない個別の式の組み合わせ数を取得できます。標準 SQL では、<code class="literal">COUNT(DISTINCT ...)</code> 内部で、すべての式の連結を行う必要があります。
          </p></li><li class="listitem"><a name="function_group-concat"></a><p>
            <a class="indexterm" name="idm139979090779616"></a> <code class="literal">GROUP_CONCAT(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            この関数は、グループから連結された非 <code class="literal">NULL</code> 値を含む文字列の結果を返します。非 <code class="literal">NULL</code> 値がない場合は、<code class="literal">NULL</code> を返します。完全な構文は次のとおりです。
          </p><pre class="programlisting">
GROUP_CONCAT([DISTINCT] <em class="replaceable"><code>expr</code></em> [,<em class="replaceable"><code>expr</code></em> ...]
             [ORDER BY {<em class="replaceable"><code>unsigned_integer</code></em> | <em class="replaceable"><code>col_name</code></em> | <em class="replaceable"><code>expr</code></em>}
                 [ASC | DESC] [,<em class="replaceable"><code>col_name</code></em> ...]]
             [SEPARATOR <em class="replaceable"><code>str_val</code></em>])
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT student_name,</code></strong>
    -&gt;     <strong class="userinput"><code>GROUP_CONCAT(test_score)</code></strong>
    -&gt;     <strong class="userinput"><code>FROM student</code></strong>
    -&gt;     <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            または:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT student_name,</code></strong>
    -&gt;     <strong class="userinput"><code>GROUP_CONCAT(DISTINCT test_score</code></strong>
    -&gt;               <strong class="userinput"><code>ORDER BY test_score DESC SEPARATOR ' ')</code></strong>
    -&gt;     <strong class="userinput"><code>FROM student</code></strong>
    -&gt;     <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            MySQL では、式の組み合わせを連結した値を取得できます。重複する値を除去するには、<code class="literal">DISTINCT</code> 句を使用します。結果の値をソートするには、<code class="literal">ORDER BY</code> 句を使用します。逆順でソートするには、<code class="literal">ORDER BY</code> 句のソートするカラムの名前に <code class="literal">DESC</code> (降順) キーワードを追加します。デフォルトは昇順です。これは、<code class="literal">ASC</code> キーワードを使用することで明示的に指定できます。グループ内の値間のデフォルトの区切り文字は、カンマ (<span class="quote">「<span class="quote"><code class="literal">,</code></span>」</span>) です。区切り文字を明示的に指定するには、<code class="literal">SEPARATOR</code> に続けて、グループ値の間に挿入される文字列リテラル値を指定します。区切り文字を完全に除去するには、<code class="literal">SEPARATOR ''</code> を指定します。
          </p><p>
            結果は、<code class="literal">group_concat_max_len</code> システム変数で指定された最大長まで切り捨てられます。その変数のデフォルト値は 1024 です。さらに高い値にも設定できますが、戻り値の有効な最大長は、<code class="literal">max_allowed_packet</code> の値によって制約されます。実行時に <code class="literal">group_concat_max_len</code> の値を変更するための構文は、次のとおりです。ここで、<em class="replaceable"><code>val</code></em> は符号なし整数です。
          </p><pre class="programlisting">
SET [GLOBAL | SESSION] group_concat_max_len = <em class="replaceable"><code>val</code></em>;
</pre><p>
            戻り値は、引数が非バイナリとバイナリのどちらの文字列であるのかに応じて、非バイナリ文字列またはバイナリ文字列になります。結果の型は、<code class="literal">group_concat_max_len</code> が 512 以下の場合 (この場合、結果の型は <code class="literal">VARCHAR</code> または <code class="literal">VARBINARY</code> です) を除いて、<code class="literal">TEXT</code> または <code class="literal">BLOB</code> です。
          </p><p>
            <code class="literal">CONCAT()</code> および <code class="literal">CONCAT_WS()</code>: <a class="xref" href="functions.html#string-functions" title="12.5 文字列関数">セクション12.5「文字列関数」</a>も参照してください。
          </p></li><li class="listitem"><a name="function_max"></a><p>
            <a class="indexterm" name="idm139979090734208"></a> <a class="indexterm" name="idm139979090732896"></a> <a class="indexterm" name="idm139979090731552"></a> <code class="literal">MAX([DISTINCT] <em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の最大値を返します。<code class="literal">MAX()</code> には、文字列の引数を指定できます。このような場合は、最大の文字列値が返されます。<a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 MySQL のインデックスの使用の仕組み">セクション8.3.1「MySQL のインデックスの使用の仕組み」</a>を参照してください。<code class="literal">DISTINCT</code> キーワードを使用すると、個別の <em class="replaceable"><code>expr</code></em> 値の最大を検索できます。ただし、<code class="literal">DISTINCT</code> を省略した場合と同じ結果が生成されます。
          </p><p>
            一致する行がなかった場合、<code class="literal">MAX()</code> は <code class="literal">NULL</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT student_name, MIN(test_score), MAX(test_score)</code></strong>
    -&gt;        <strong class="userinput"><code>FROM student</code></strong>
    -&gt;        <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            現在、MySQL の <code class="literal">MAX()</code> では、<code class="literal">ENUM</code> と <code class="literal">SET</code> カラムが、セット内の文字列の相対位置ではなく、文字列値について比較されます。これは、<code class="literal">ORDER BY</code> による比較方法とは異なります。これは、今後の MySQL リリースで反映される予定です。
          </p></li><li class="listitem"><a name="function_min"></a><p>
            <a class="indexterm" name="idm139979090708176"></a> <a class="indexterm" name="idm139979090706864"></a> <a class="indexterm" name="idm139979090705520"></a> <code class="literal">MIN([DISTINCT] <em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の最小値を返します。<code class="literal">MIN()</code> には、文字列の引数を指定できます。このような場合は、最小の文字列値が返されます。<a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 MySQL のインデックスの使用の仕組み">セクション8.3.1「MySQL のインデックスの使用の仕組み」</a>を参照してください。<code class="literal">DISTINCT</code> キーワードを使用すると、個別の <em class="replaceable"><code>expr</code></em> 値の最小を検索できます。ただし、<code class="literal">DISTINCT</code> を省略した場合と同じ結果が生成されます。
          </p><p>
            一致する行がなかった場合、<code class="literal">MIN()</code> は <code class="literal">NULL</code> を返します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT student_name, MIN(test_score), MAX(test_score)</code></strong>
    -&gt;        <strong class="userinput"><code>FROM student</code></strong>
    -&gt;        <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            現在、MySQL の <code class="literal">MIN()</code> では、<code class="literal">ENUM</code> と <code class="literal">SET</code> カラムが、セット内の文字列の相対位置ではなく、文字列値について比較されます。これは、<code class="literal">ORDER BY</code> による比較方法とは異なります。これは、今後の MySQL リリースで反映される予定です。
          </p></li><li class="listitem"><a name="function_std"></a><p>
            <a class="indexterm" name="idm139979090682144"></a> <code class="literal">STD(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の母標準偏差を返します。これは、標準 SQL の拡張です。代わりに、標準 SQL 関数 <code class="literal">STDDEV_POP()</code> を使用できます。
          </p><p>
            一致する行がなかった場合、この関数は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_stddev"></a><p>
            <a class="indexterm" name="idm139979090671232"></a> <a class="indexterm" name="idm139979090669888"></a> <a class="indexterm" name="idm139979090668384"></a> <code class="literal">STDDEV(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の母標準偏差を返します。この関数は、Oracle との互換性を確保するために提供されています。代わりに、標準 SQL 関数 <code class="literal">STDDEV_POP()</code> を使用できます。
          </p><p>
            一致する行がなかった場合、この関数は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_stddev-pop"></a><p>
            <a class="indexterm" name="idm139979090657456"></a> <code class="literal">STDDEV_POP(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の母標準偏差 (<code class="literal">VAR_POP()</code> の平方根) を返します。<code class="literal">STD()</code> または <code class="literal">STDDEV()</code> を使用することもできます。これらは同等ですが、標準 SQL ではありません。
          </p><p>
            一致する行がなかった場合、<code class="literal">STDDEV_POP()</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_stddev-samp"></a><p>
            <a class="indexterm" name="idm139979090644304"></a> <code class="literal">STDDEV_SAMP(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の標本標準偏差 (<code class="literal">VAR_SAMP()</code> の平方根) を返します。
          </p><p>
            一致する行がなかった場合、<code class="literal">STDDEV_SAMP()</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_sum"></a><p>
            <a class="indexterm" name="idm139979090632592"></a> <a class="indexterm" name="idm139979090631280"></a> <a class="indexterm" name="idm139979090629936"></a> <code class="literal">SUM([DISTINCT] <em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の集計を返します。戻り値のセットに行が含まれていない場合、<code class="literal">SUM()</code> は <code class="literal">NULL</code> を返します。<code class="literal">DISTINCT</code> キーワードを使用すると、個別の <em class="replaceable"><code>expr</code></em> 値のみを集計できます。
          </p><p>
            一致する行がなかった場合、<code class="literal">SUM()</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_var-pop"></a><p>
            <a class="indexterm" name="idm139979090616192"></a> <code class="literal">VAR_POP(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の母標準分散を返します。行は標本ではなく、母集団全体とみなされるため、行の数が分母とみなされます。また、<code class="literal">VARIANCE()</code> を使用することもできます。これは同等ですが、標準 SQL ではありません。
          </p><p>
            一致する行がなかった場合、<code class="literal">VAR_POP()</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_var-samp"></a><p>
            <a class="indexterm" name="idm139979090604752"></a> <code class="literal">VAR_SAMP(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の標本分散を返します。つまり、分母は行の数から 1 を引いたものです。
          </p><p>
            一致する行がなかった場合、<code class="literal">VAR_SAMP()</code> は <code class="literal">NULL</code> を返します。
          </p></li><li class="listitem"><a name="function_variance"></a><p>
            <a class="indexterm" name="idm139979090594608"></a> <code class="literal">VARIANCE(<em class="replaceable"><code>expr</code></em>)</code>
          </p><p>
            <em class="replaceable"><code>expr</code></em> の母標準分散を返します。これは、標準 SQL の拡張です。代わりに、標準 SQL 関数 <code class="literal">VAR_POP()</code> を使用できます。
          </p><p>
            一致する行がなかった場合、<code class="literal">VARIANCE()</code> は <code class="literal">NULL</code> を返します。
          </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="group-by-modifiers"></a>12.19.2 GROUP BY 修飾子</h3></div></div></div><a class="indexterm" name="idm139979090584272"></a><a class="indexterm" name="idm139979090582960"></a><p>
        <code class="literal">GROUP BY</code> 句では、追加の行がサマリー出力に追加される <code class="literal">WITH ROLLUP</code> 修飾子が許可されます。これらの行は、高レベル (または超集約) のサマリー演算を表します。したがって、<code class="literal">ROLLUP</code> で単一のクエリーを使用すれば、複数レベルの分析で質問に回答できます。たとえば、これを使用すれば、OLAP (Online Analytical Processing) 演算をサポートできます。
      </p><p>
        <code class="literal">sales</code> という名前が付けられたテーブルに、売り上げの収益性を記録するための <code class="literal">year</code>、<code class="literal">country</code>、<code class="literal">product</code>、および <code class="literal">profit</code> カラムが含まれていると仮定します。
      </p><pre class="programlisting">
CREATE TABLE sales
(
    year    INT NOT NULL,
    country VARCHAR(20) NOT NULL,
    product VARCHAR(32) NOT NULL,
    profit  INT
);
</pre><p>
        次のような単純な <code class="literal">GROUP BY</code> を使用すれば、テーブルの内容を年ごとにまとめることができます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT year, SUM(profit) FROM sales GROUP BY year;</code></strong>
+------+-------------+
| year | SUM(profit) |
+------+-------------+
| 2000 |        4525 |
| 2001 |        3010 |
+------+-------------+
</pre><p>
        この出力には、年ごとの合計収益が表示されますが、すべての年にわたって集計された合計収益を確認する場合は、各値を自分で合計するか、追加のクエリーを実行する必要があります。
      </p><p>
        または、単一のクエリーで両方のレベルの分析を提供する <code class="literal">ROLLUP</code> も使用できます。<code class="literal">GROUP BY</code> 句に <code class="literal">WITH ROLLUP</code> 修飾子を追加すると、クエリーによってすべての年にわたる総合計を示す別の行が生成されます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT year, SUM(profit) FROM sales GROUP BY year WITH ROLLUP;</code></strong>
+------+-------------+
| year | SUM(profit) |
+------+-------------+
| 2000 |        4525 |
| 2001 |        3010 |
| NULL |        7535 |
+------+-------------+
</pre><p>
        総合計の超集約行は、<code class="literal">year</code> カラムの <code class="literal">NULL</code> 値で識別されます。
      </p><p>
        複数の <code class="literal">GROUP BY</code> カラムがある場合は、<code class="literal">ROLLUP</code> の効果がより複雑になります。この場合、最後のグループ化カラム以外で<span class="quote">「<span class="quote">ブレイク</span>」</span> (値の変更) が発生するたびに、クエリーによって追加の超集約サマリー行が生成されます。
      </p><p>
        たとえば、<code class="literal">ROLLUP</code> を使用しない場合は、<code class="literal">year</code>、<code class="literal">country</code>、および <code class="literal">product</code> に基づいた <code class="literal">sales</code> テーブルのサマリーが次のように表示されます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT year, country, product, SUM(profit)</code></strong>
    -&gt; <strong class="userinput"><code>FROM sales</code></strong>
    -&gt; <strong class="userinput"><code>GROUP BY year, country, product;</code></strong>
+------+---------+------------+-------------+
| year | country | product    | SUM(profit) |
+------+---------+------------+-------------+
| 2000 | Finland | Computer   |        1500 |
| 2000 | Finland | Phone      |         100 |
| 2000 | India   | Calculator |         150 |
| 2000 | India   | Computer   |        1200 |
| 2000 | USA     | Calculator |          75 |
| 2000 | USA     | Computer   |        1500 |
| 2001 | Finland | Phone      |          10 |
| 2001 | USA     | Calculator |          50 |
| 2001 | USA     | Computer   |        2700 |
| 2001 | USA     | TV         |         250 |
+------+---------+------------+-------------+
</pre><p>
        この出力には、year/country/product の分析レベルでのみサマリー値が示されます。<code class="literal">ROLLUP</code> が追加されると、クエリーによって複数の追加行が生成されます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT year, country, product, SUM(profit)</code></strong>
    -&gt; <strong class="userinput"><code>FROM sales</code></strong>
    -&gt; <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP;</code></strong>
+------+---------+------------+-------------+
| year | country | product    | SUM(profit) |
+------+---------+------------+-------------+
| 2000 | Finland | Computer   |        1500 |
| 2000 | Finland | Phone      |         100 |
| 2000 | Finland | NULL       |        1600 |
| 2000 | India   | Calculator |         150 |
| 2000 | India   | Computer   |        1200 |
| 2000 | India   | NULL       |        1350 |
| 2000 | USA     | Calculator |          75 |
| 2000 | USA     | Computer   |        1500 |
| 2000 | USA     | NULL       |        1575 |
| 2000 | NULL    | NULL       |        4525 |
| 2001 | Finland | Phone      |          10 |
| 2001 | Finland | NULL       |          10 |
| 2001 | USA     | Calculator |          50 |
| 2001 | USA     | Computer   |        2700 |
| 2001 | USA     | TV         |         250 |
| 2001 | USA     | NULL       |        3000 |
| 2001 | NULL    | NULL       |        3010 |
| NULL | NULL    | NULL       |        7535 |
+------+---------+------------+-------------+
</pre><p>
        このクエリーでは、<code class="literal">ROLLUP</code> 句を追加すると、出力に 1 つだけでなく、4 つの分析レベルでのサマリー情報が含まれます。次に、<code class="literal">ROLLUP</code> 出力の解釈方法を示します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            指定された year と country に対応する product 行の各セットに続いて、すべての product の合計を示す追加のサマリー行が生成されます。これらの行には、<code class="literal">NULL</code> に設定された <code class="literal">product</code> カラムが含まれています。
          </p></li><li class="listitem"><p>
            指定された year に対応する行の各セットに続いて、すべての country と product の合計を示す追加のサマリー行が生成されます。これらの行には、<code class="literal">NULL</code> に設定された <code class="literal">country</code> および <code class="literal">products</code> カラムが含まれています。
          </p></li><li class="listitem"><p>
            最後に、その他のすべての行に続いて、すべての year、country、および product の総合計を示す追加のサマリー行が生成されます。この行には、<code class="literal">NULL</code> に設定された <code class="literal">year</code>、<code class="literal">country</code>、および <code class="literal">products</code> カラムが含まれています。
          </p></li></ul></div><h4><a name="idm139979090531904"></a>ROLLUP 使用時のその他の考慮事項</h4><p>
        次の項目には、MySQL での <code class="literal">ROLLUP</code> の実装に固有の動作の一部を一覧表示します。
      </p><p>
        <code class="literal">ROLLUP</code> を使用する場合は、<code class="literal">ORDER BY</code> 句を同時に使用して結果をソートできません。つまり、<code class="literal">ROLLUP</code> と <code class="literal">ORDER BY</code> は相互に排他的です。ただし、ソート順序を一部制御することはできます。MySQL の <code class="literal">GROUP BY</code> によって結果がソートされます。<code class="literal">GROUP BY</code> で名前が指定されたカラムで明示的な <code class="literal">ASC</code> および <code class="literal">DESC</code> キーワードを使用すると、カラムごとにソート順序を指定できます。(<code class="literal">ROLLUP</code> で追加された高レベルのサマリー行は、ソート順序には関係なく、計算された行の後ろに表示されます。)
      </p><p>
        <code class="literal">LIMIT</code> を使用すると、クライアントに返される行の数を制限できます。<code class="literal">LIMIT</code> は <code class="literal">ROLLUP</code> のあとに適用されるため、<code class="literal">ROLLUP</code> で追加された追加の行に対して制限が適用されます。例:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT year, country, product, SUM(profit)</code></strong>
    -&gt; <strong class="userinput"><code>FROM sales</code></strong>
    -&gt; <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP</code></strong>
    -&gt; <strong class="userinput"><code>LIMIT 5;</code></strong>
+------+---------+------------+-------------+
| year | country | product    | SUM(profit) |
+------+---------+------------+-------------+
| 2000 | Finland | Computer   |        1500 |
| 2000 | Finland | Phone      |         100 |
| 2000 | Finland | NULL       |        1600 |
| 2000 | India   | Calculator |         150 |
| 2000 | India   | Computer   |        1200 |
+------+---------+------------+-------------+
</pre><p>
        <code class="literal">LIMIT</code> と <code class="literal">ROLLUP</code> を同時に使用すると、超集約行を理解するためのコンテキストが少ないため、解釈がより難しい結果が生成される可能性があります。
      </p><p>
        各超集約行の <code class="literal">NULL</code> 指示子は、行がクライアントに送信されるときに生成されます。サーバーでは、変更された値を持つ左端のカラムに続いて、<code class="literal">GROUP BY</code> 句で名前が指定されたカラムが調査されます。これらの名前のいずれかに語彙が一致する名前を持つ結果セット内のカラムでは、その値が <code class="literal">NULL</code> に設定されます。(カラム番号別にグループ化カラムを指定すると、サーバーでは <code class="literal">NULL</code> に設定するカラムが番号で識別されます。)
      </p><p>
        超集約行の <code class="literal">NULL</code> 値は、クエリー処理のかなり後半の段階で結果セットに配置されるため、クエリー自体で <code class="literal">NULL</code> 値としてテストすることはできません。たとえば、クエリーに <code class="literal">HAVING product IS NULL</code> を追加しても、超集約行以外のすべてを出力から除去できません。
      </p><p>
        一方で、<code class="literal">NULL</code> 値はクライアント側で <code class="literal">NULL</code> として表示され、MySQL クライアントプログラミングインタフェースのいずれかを使用してテストできます。
      </p><p>
        MySQL では、<code class="literal">GROUP BY</code> リストに表示されないカラムを、選択リストで名前を指定することが許可されます。この場合、サーバーはサマリー行内のこのような非集約カラムから任意の値を自由に選択できます。これには、<code class="literal">WITH ROLLUP</code> で追加された追加の行も含まれます。たとえば、次のクエリーでは、<code class="literal">country</code> は <code class="literal">GROUP BY</code> リストに表示されない非集約カラムであり、このカラムで選択された値は不確定です。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT year, country, SUM(profit)</code></strong>
    -&gt; <strong class="userinput"><code>FROM sales GROUP BY year WITH ROLLUP;</code></strong>
+------+---------+-------------+
| year | country | SUM(profit) |
+------+---------+-------------+
| 2000 | India   |        4525 |
| 2001 | USA     |        3010 |
| NULL | USA     |        7535 |
+------+---------+-------------+
</pre><p>
        この動作は、<code class="literal">ONLY_FULL_GROUP_BY</code> SQL モードが無効になっている場合に発生します。このモードが有効になっている場合は、<code class="literal">country</code> が <code class="literal">GROUP BY</code> 句に一覧表示されないため、サーバーはそのクエリーを不正として拒否します。非集約カラムおよび <code class="literal">GROUP BY</code> についての詳細は、<a class="xref" href="functions.html#group-by-handling" title="12.19.3 MySQL での GROUP BY の処理">セクション12.19.3「MySQL での GROUP BY の処理」</a>を参照してください。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="group-by-handling"></a>12.19.3 MySQL での GROUP BY の処理</h3></div></div></div><a class="indexterm" name="idm139979090489712"></a><a class="indexterm" name="idm139979090487584"></a><a class="indexterm" name="idm139979090485520"></a><p>
        標準 SQL では、<code class="literal">GROUP BY</code> 句を含むクエリーは、<code class="literal">GROUP BY</code> 句で名前が指定されていない選択リスト内の非集約カラムを参照できません。たとえば、このクエリーは、選択リスト内の <code class="literal">name</code> カラムが <code class="literal">GROUP BY</code> に表示されていないため、標準 SQL では不正です。
      </p><pre class="programlisting">
SELECT o.custid, c.name, MAX(o.payment)
  FROM orders AS o, customers AS c
  WHERE o.custid = c.custid
  GROUP BY o.custid;
</pre><p>
        このクエリーを正当にするには、<code class="literal">name</code> カラムを選択リストから削除するか、<code class="literal">GROUP BY</code> 句で名前を指定する必要があります。
      </p><p>
        MySQL では、選択リストが <code class="literal">GROUP BY</code> 句で名前が指定されていない非集約カラムを参照できないように、<code class="literal">GROUP BY</code> の使用が拡張されています。つまり、上記のクエリーは MySQL では正当です。この機能を使用すると、不要なカラムのソートおよびグループ化が回避されるため、パフォーマンスを改善できます。ただし、これは主に、<code class="literal">GROUP BY</code> で名前が指定されていない各非集約カラム内のすべての値がグループごとに同じである場合に役立ちます。サーバーは各グループから任意の値を自由に選択できるため、同じ値でなければ、選択した値は不確定です。さらに、<code class="literal">ORDER BY</code> 句を追加しても、各グループからの値の選択が影響を受ける可能性はありません。値が選択されたあとに結果セットのソートが発生しますが、<code class="literal">ORDER BY</code> によって、サーバーで選択された各グループ内の値は影響を受けません。
      </p><p>
        同様の MySQL 拡張が <code class="literal">HAVING</code> 句に適用されます。標準 SQL では、<code class="literal">GROUP BY</code> 句を含むクエリーは、<code class="literal">GROUP BY</code> 句で名前が指定されていない <code class="literal">HAVING</code> 句の非集約カラムを参照できません。MySQL 拡張では、計算を簡単にするために、このようなカラムへの参照が許可されます。この拡張では、グループ化されていないカラムに同じグループに関する値が含まれると仮定されます。それ以外の場合は、結果が不確定です。
      </p><p>
        MySQL <code class="literal">GROUP BY</code> の拡張を無効にするには、<code class="literal">ONLY_FULL_GROUP_BY</code> SQL モードを有効にします。これにより、標準 SQL の動作が有効になります。<code class="literal">GROUP BY</code> 句で名前が指定されていないカラムは、集約関数で囲まなければ、選択リストまたは <code class="literal">HAVING</code> 句で使用できません。
      </p><p>
        また、<code class="literal">ONLY_FULL_GROUP_BY</code> によって、<code class="literal">HAVING</code> 句のエイリアスの使用も影響を受けません。たとえば、次のクエリーは、<code class="literal">orders</code> テーブルで 1 回だけ発生する <code class="literal">name</code> 値を返します。
      </p><pre class="programlisting">
SELECT name, COUNT(name) FROM orders
  GROUP BY name
  HAVING COUNT(name) = 1;
</pre><p>
        MySQL では、集約カラム用に <code class="literal">HAVING</code> 句でエイリアスを使用することが許可されるように、この動作が拡張されています。
      </p><pre class="programlisting">
SELECT name, COUNT(name) AS c FROM orders
  GROUP BY name
  HAVING c = 1;
</pre><p>
        <code class="literal">ONLY_FULL_GROUP_BY</code> を有効にすると、この MySQL 拡張が無効になり、<code class="literal">HAVING</code> 句の <code class="literal">c</code> カラムが集約関数で囲まれていないため (これは、<span class="emphasis"><em>集約関数です</em></span>)、<code class="literal">「non-grouping field 'c' is used in HAVING clause」</code>というエラーが発生します。
      </p><p>
        選択リストの拡張は、<code class="literal">ORDER BY</code> にも適用されます。つまり、<code class="literal">GROUP BY</code> 句に表示されていない <code class="literal">ORDER BY</code> 句の非集約カラムは参照できません。(ただし、すでに説明したように、<code class="literal">ORDER BY</code> によって、非集約カラムからどの値が選択されるのかは影響を受けません。選択されたあとにはじめてソートされます。)<code class="literal">ONLY_FULL_GROUP_BY</code> SQL モードが有効になっている場合は、この拡張が適用されません。
      </p><p>
        一部のケースでは、<code class="literal">MIN()</code> および <code class="literal">MAX()</code> を使用すると、一意でない場合でも特定のカラム値を取得できます。<code class="literal">sort</code> カラムに 6 桁以内の整数が含まれている場合、次のクエリーは、最小の <code class="literal">sort</code> 値を含む行から <code class="literal">column</code> の値を取得します。
      </p><pre class="programlisting">
SUBSTR(MIN(CONCAT(LPAD(sort,6,'0'),column)),7)
</pre><p>
        <a class="xref" href="tutorial.html#example-maximum-column-group-row" title="3.6.4 特定のカラムのグループごとの最大値が格納されている行">セクション3.6.4「特定のカラムのグループごとの最大値が格納されている行」</a>を参照してください。
      </p><a class="indexterm" name="idm139979090439296"></a><a class="indexterm" name="idm139979090437152"></a><a class="indexterm" name="idm139979090435104"></a><a class="indexterm" name="idm139979090433744"></a><p>
        標準 SQL に従おうとすると、<code class="literal">GROUP BY</code> 句で式を使用できません。回避策として、式のエイリアスを使用します。
      </p><pre class="programlisting">
SELECT id, FLOOR(value/100) AS val
  FROM <em class="replaceable"><code>tbl_name</code></em>
  GROUP BY id, val;
</pre><p>
        MySQL では、<code class="literal">GROUP BY</code> 句で式を使用することが許可されているため、エイリアスは必要ありません。
      </p><pre class="programlisting">
SELECT id, FLOOR(value/100)
  FROM <em class="replaceable"><code>tbl_name</code></em>
  GROUP BY id, FLOOR(value/100);
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="precision-math"></a>12.20 高精度計算</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="functions.html#precision-math-numbers">12.20.1 数値の型</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-decimal-characteristics">12.20.2 DECIMAL データ型の特性</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-expressions">12.20.3 式の処理</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-rounding">12.20.4 丸め動作</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-examples">12.20.5 高精度計算の例</a></span></dt></dl></div><a class="indexterm" name="idm139979090425344"></a><a class="indexterm" name="idm139979090423872"></a><a class="indexterm" name="idm139979090422528"></a><a class="indexterm" name="idm139979090421184"></a><a class="indexterm" name="idm139979090419792"></a><a class="indexterm" name="idm139979090418432"></a><a class="indexterm" name="idm139979090417072"></a><a class="indexterm" name="idm139979090415040"></a><a class="indexterm" name="idm139979090413008"></a><a class="indexterm" name="idm139979090411648"></a><a class="indexterm" name="idm139979090410288"></a><a class="indexterm" name="idm139979090408912"></a><p>
    MySQL 5.6 は、高精度計算、つまり、きわめて正確な結果が得られ、さらに無効な値を高いレベルで制御できる数値処理をサポートしています。高精度計算は、次の 2 つの機能に基づいています。
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        サーバーが無効なデータの受け入れまたは拒否に関してどの程度厳密かを制御する SQL モード。
      </p></li><li class="listitem"><p>
        固定小数点数演算のための MySQL ライブラリ。
      </p></li></ul></div><p>
    これらの機能は数値操作にいくつかの影響を与えるとともに、標準 SQL への高度の準拠を実現します。
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <span class="bold"><strong>正確な計算</strong></span>: 厳密値数値の場合、計算に浮動小数点エラーは導入されません。代わりに、正確な精度が使用されます。たとえば、MySQL は <code class="literal">.0001</code> などの数値を近似値ではなく厳密値として処理し、それを 10,000 回合計すると 1 に<span class="quote">「<span class="quote">近い</span>」</span>だけの値ではなく、正確に <code class="literal">1</code> の結果が生成されます。
      </p></li><li class="listitem"><p>
        <span class="bold"><strong>適切に定義された丸め動作</strong></span>: 厳密値数値の場合、<code class="literal">ROUND()</code> の結果は、ベースとなる C ライブラリの動作方法などの環境要因ではなく、その引数に依存します。
      </p></li><li class="listitem"><p>
        <span class="bold"><strong>プラットフォームからの独立</strong></span>: 厳密値数値に対する操作は、Windows や Unix などの各プラットフォームにわたって同じです。
      </p></li><li class="listitem"><p>
        <span class="bold"><strong>無効な値の処理に対する制御</strong></span>: オーバーフローおよび 0 による除算が検出可能であり、これらはエラーとして処理できます。たとえば、あるカラムに対して大きすぎる値は、そのカラムのデータ型の範囲内に収まるように値が切り捨てられるようにするのではなく、エラーとして処理できます。同様に、0 による除算は、<code class="literal">NULL</code> の結果を生成する操作としてではなく、エラーとして処理できます。どちらのアプローチをとるかの選択は、サーバー SQL モードの設定によって決定されます。
      </p></li></ul></div><p>
    次の説明では、古いアプリケーションとの非互換性の可能性を含め、高精度計算の動作方法のいくつかの側面について触れています。最後に、MySQL 5.6 が数値操作をどのように処理するかを正確に示すいくつかの例を示します。SQL モードの制御については、<a class="xref" href="server-administration.html#sql-mode" title="5.1.7 サーバー SQL モード">セクション5.1.7「サーバー SQL モード」</a>を参照してください。
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-numbers"></a>12.20.1 数値の型</h3></div></div></div><p>
      厳密値の操作に関する高精度計算のスコープには、厳密値データ型 (整数および <code class="literal">DECIMAL</code> 型) と厳密値数値リテラルが含まれます。近似値データ型および数値リテラルは、浮動小数点数として処理されます。
    </p><p>
      正確値の数値リテラルには、整数部または小数部、あるいはその両方が含まれています。これらには符号を付けることができます。例: <code class="literal">1</code>、<code class="literal">.2</code>、<code class="literal">3.4</code>、<code class="literal">-5</code>、<code class="literal">-6.78</code>、<code class="literal">+9.10</code>。
    </p><p>
      近似値の数値リテラルは仮数と指数による指数表現で表されます。一方または両方の部分に符号を付けることができます。例: <code class="literal">1.2E3</code>、<code class="literal">1.2E-3</code>、<code class="literal">-1.2E3</code>、<code class="literal">-1.2E-3</code>。
    </p><p>
      2 つの数値が同じように見えても、別々に扱われることがあります。たとえば、<code class="literal">2.34</code> は (固定小数点の) 正確値ですが、<code class="literal">2.34E0</code> は (浮動小数点の) 近似値です。
    </p><p>
      <code class="literal">DECIMAL</code> データ型は固定小数点型で、計算は正確です。MySQL では、<code class="literal">DECIMAL</code> 型には、<code class="literal">NUMERIC</code>、<code class="literal">DEC</code>、<code class="literal">FIXED</code> という複数のシノニムがあります。整数型も正確値型です。
    </p><p>
      <code class="literal">FLOAT</code> データ型および <code class="literal">DOUBLE</code> データ型は浮動小数点型で、計算によって近似値が得られます。MySQL では、<code class="literal">FLOAT</code> または <code class="literal">DOUBLE</code> のシノニムである型は <code class="literal">DOUBLE PRECISION</code> および <code class="literal">REAL</code> です。
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-decimal-characteristics"></a>12.20.2 DECIMAL データ型の特性</h3></div></div></div><p>
      このセクションでは、MySQL 5.6 での <code class="literal">DECIMAL</code> データ型 (およびそのシノニム) の特性について、特に次のトピックに注意を払いながら説明します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          最大桁数
        </p></li><li class="listitem"><p>
          ストレージフォーマット
        </p></li><li class="listitem"><p>
          ストレージ要件
        </p></li><li class="listitem"><p>
          <code class="literal">DECIMAL</code> カラムの上限への非標準の MySQL 拡張。
        </p></li></ul></div><p>
      このセクション全体を通して、古いバージョン (5.0.3 より前) の MySQL のために記述されたアプリケーションとの非互換性の可能性が記載されています。
    </p><p>
      <code class="literal">DECIMAL</code> カラムの宣言構文は、<code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> です。MySQL 5.6 での引数の値の範囲は次のとおりです。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <em class="replaceable"><code>M</code></em> は、最大桁数 (精度) です。その範囲は 1 から 65 までです。(古いバージョンの MySQL では 1 から 254 までの範囲が許可されました。)
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>D</code></em> は、小数点の右側の桁数 (スケール) です。その範囲は 0 から 30 までであり、<em class="replaceable"><code>M</code></em> より大きくすることはできません。
        </p></li></ul></div><p>
      <em class="replaceable"><code>M</code></em> が 65 の最大値である場合は、<code class="literal">DECIMAL</code> 値に対する計算が 65 桁まで正確であることを示します。この 65 桁の精度の制限は厳密値数値リテラルにも適用されるため、このようなリテラルの最大範囲は以前とは異なります。(古いバージョンの MySQL では、10 進数値の最大桁数は 254 でした。ただし、計算は浮動小数点を使用して実行されたために厳密値ではなく、近似値でした。)
    </p><p>
      MySQL 5.6 での <code class="literal">DECIMAL</code> カラムの値は、9 桁の 10 進数が 4 バイトにパックされたバイナリ形式を使用して格納されます。各値の整数部と小数部に対するストレージ要件は個別に決定されます。9 桁の繰り返しごとに 4 バイトが必要であり、残りの桁がある場合は、4 バイトのうちの一部が必要になります。残りの桁に必要なストレージは、次の表で指定されます。
    </p><div class="informaltable"><table summary="この表は、残りの桁に必要なバイト数を示しています。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">余りの桁</th><th scope="col">バイト数</th></tr></thead><tbody><tr><td scope="row">0</td><td>0</td></tr><tr><td scope="row">1–2</td><td>1</td></tr><tr><td scope="row">3–4</td><td>2</td></tr><tr><td scope="row">5–6</td><td>3</td></tr><tr><td scope="row">7–9</td><td>4</td></tr></tbody></table></div><p>
      たとえば、<code class="literal">DECIMAL(18,9)</code> カラムは小数点の両側に 9 桁あるため、整数部と小数部のそれぞれに 4 バイトが必要です。<code class="literal">DECIMAL(20,6)</code> カラムは整数部に 14 桁、小数部に 6 桁あります。整数部の桁は、そのうちの 9 桁に 4 バイト、残りの 5 桁に 3 バイトが必要です。小数部の 6 桁には 3 バイトが必要です。
    </p><p>
      一部の古いバージョンの MySQL とは異なり、MySQL 5.6 での <code class="literal">DECIMAL</code> カラムには、先頭の <code class="literal">+</code> 文字や <code class="literal">-</code> 文字、または先頭の <code class="literal">0</code> の桁が格納されません。<code class="literal">DECIMAL(5,1)</code> カラムに <code class="literal">+0003.1</code> を挿入すると、それは <code class="literal">3.1</code> として格納されます。負の数の場合、リテラルの <code class="literal">-</code> 文字は格納されません。古い動作に依存するアプリケーションは、この変更が反映されるように変更する必要があります。
    </p><p>
      MySQL 5.6 での <code class="literal">DECIMAL</code> カラムでは、カラム定義によって暗黙的に指定された範囲を超える値が許可されません。たとえば、<code class="literal">DECIMAL(3,0)</code> カラムは <code class="literal">-999</code> から <code class="literal">999</code> までの範囲をサポートします。<code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> カラムでは、小数点の左側に許可されるのは多くても <em class="replaceable"><code>M</code></em> - <em class="replaceable"><code>D</code></em> 桁です。これは、<code class="literal">+</code> 記号の代わりに追加の桁の格納が許可されていた古いバージョンの MySQL に依存するアプリケーションとは互換性がありません。
    </p><p>
      SQL 標準では、<code class="literal">NUMERIC(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> の精度は<span class="emphasis"><em>正確に</em></span> <em class="replaceable"><code>M</code></em> 桁である必要があります。<code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> の場合、この標準では少なくとも <em class="replaceable"><code>M</code></em> 桁の精度が必要ですが、それを超える精度が許可されます。MySQL では、<code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> と <code class="literal">NUMERIC(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code> は同じであり、どちらも正確に <em class="replaceable"><code>M</code></em> 桁の精度を持っています。
    </p><p>
      <code class="literal">DECIMAL</code> 値の内部形式の完全な説明については、MySQL ソース配布内のファイル <code class="filename">strings/decimal.c</code> を参照してください。この形式は、<code class="literal">decimal2bin()</code> 関数で (例を使用して) 説明されています。
    </p><p>
      <code class="literal">DECIMAL</code> データ型の古い処理に依存するアプリケーションの移植の詳細は、『<em class="citetitle">MySQL 5.0 リファレンスマニュアル</em>』を参照してください。
    </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-expressions"></a>12.20.3 式の処理</h3></div></div></div><p>
      高精度計算では、可能な場合は常に、厳密値数値は与えられたとおりに使用されます。たとえば、比較での数値は、値を変更することなく正確に指定されたとおりに使用されます。厳密な SQL モードでは、厳密値データ型 (<code class="literal">DECIMAL</code> または整数) を持つカラムへの <code class="literal">INSERT</code> の場合、数値の厳密値がそのカラムの範囲内にあれば、その数値が厳密値で挿入されます。取得されると、その値は、挿入された値と同じになるはずです。(厳密な SQL モードが有効になっていない場合は、<code class="literal">INSERT</code> での切り捨てが許可されます。)
    </p><p>
      数値式の処理は、その式にどのような種類の値が含まれているかによって異なります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          近似値が存在する場合、その式は近似値であるため、浮動小数点演算を使用して評価されます。
        </p></li><li class="listitem"><p>
          近似値が存在しない場合、その式には厳密値のみが含まれています。いずれかの厳密値に小数部 (小数点に続く値) が含まれている場合、その式は <code class="literal">DECIMAL</code> の正確な演算を使用して評価され、精度は 65 桁になります。<span class="quote">「<span class="quote">正確な</span>」</span>という用語は、バイナリで表すことができる精度の制限に従います。たとえば、<code class="literal">1.0/3.0</code> は 10 進数表記で <code class="literal">.333...</code> と近似できますが、厳密値数値として記述されないため、<code class="literal">(1.0/3.0)*3.0</code> は正確には <code class="literal">1.0</code> に評価されません。
        </p></li><li class="listitem"><p>
          それ以外の場合、式には整数値のみが含まれています。その式は厳密値であり、整数演算を使用して評価され、精度は <code class="literal">BIGINT</code> (64 ビット) と同じになります。
        </p></li></ul></div><p>
      数値式に文字列が含まれている場合、その文字列は倍精度浮動小数点値に変換され、その式は近似値になります。
    </p><p>
      数値カラムへの挿入は、<code class="literal">sql_mode</code> システム変数によって制御される SQL モードによって影響を受けます。(<a class="xref" href="server-administration.html#sql-mode" title="5.1.7 サーバー SQL モード">セクション5.1.7「サーバー SQL モード」</a>を参照してください。)次の説明では、厳密モード (<code class="literal">STRICT_ALL_TABLES</code> または <code class="literal">STRICT_TRANS_TABLES</code> モード値によって選択されます) および <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> について触れています。すべての制限を有効にするには、単純に、厳密モード値と <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> の両方を含む <code class="literal">TRADITIONAL</code> モードを使用できます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_mode='TRADITIONAL';</code></strong>
</pre><p>
      数値が厳密値型のカラム (<code class="literal">DECIMAL</code> または整数) に挿入された場合は、数値の厳密値がそのカラムの範囲内にあれば、その数値が厳密値で挿入されます。
    </p><p>
      その値の小数部に含まれている桁が多すぎる場合は、丸めが発生し、警告が生成されます。丸めは、<a class="xref" href="functions.html#precision-math-rounding" title="12.20.4 丸め動作">セクション12.20.4「丸め動作」</a>で説明されているとおりに実行されます。
    </p><p>
      その値の整数部に含まれている桁が多すぎる場合は、その値が大きすぎるため、次のように処理されます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          厳密モードが有効になっていない場合は、その値がもっとも近い正当な値に切り捨てられ、警告が生成されます。
        </p></li><li class="listitem"><p>
          厳密モードが有効になっている場合は、オーバーフローエラーが発生します。
        </p></li></ul></div><p>
      アンダーフローは検出されないため、アンダーフローの処理は定義されていません。
    </p><p>
      数値カラムへの文字列の挿入では、その文字列に非数値の内容が含まれている場合、文字列から数値への変換は次のように処理されます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          数値で始まらない文字列を数値として使用することはできないため、この文字列により厳密モードではエラーが生成され、それ以外の場合は警告が生成されます。これには、空の文字列が含まれます。
        </p></li><li class="listitem"><p>
          数値で始まる文字列は変換できますが、後続の非数値の部分は切り捨てられます。その切り捨てられた部分にスペース以外の文字が含まれている場合、厳密モードではエラーが生成され、それ以外の場合は警告が生成されます。
        </p></li></ul></div><p>
      デフォルトでは、0 による除算によって <code class="literal">NULL</code> の結果が生成され、警告は生成されません。SQL モードを適切に設定することにより、0 による除算を制限できます。
    </p><p>
      <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> SQL モードが有効になっている場合、MySQL は、0 による除算を次の異なった方法で処理します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          厳密モードが有効になっていない場合は、警告が発生します。
        </p></li><li class="listitem"><p>
          厳密モードが有効になっている場合は、0 による除算を含む挿入と更新が禁止され、エラーが発生します。
        </p></li></ul></div><p>
      つまり、0 による除算を実行する式を含む挿入や更新をエラーとして処理できますが、それには、厳密モードに加えて <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> が必要です。
    </p><p>
      次のステートメントがあるとします。
    </p><pre class="programlisting">
INSERT INTO t SET i = 1/0;
</pre><p>
      次に、厳密モードと <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> モードの各組み合わせに対する動作を示します。
    </p><div class="informaltable"><table summary="この表は、厳密モードと ERROR_FOR_DIVISION_BY_ZERO モードの各組み合わせに対する動作を示しています。" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col"><code class="literal">sql_mode</code> 値</th><th scope="col">結果</th></tr></thead><tbody><tr><td scope="row"><code class="literal">''</code> (デフォルト)</td><td>警告なし、エラーなし。<code class="literal">i</code> は <code class="literal">NULL</code> に設定されます。</td></tr><tr><td scope="row">厳密</td><td>警告なし、エラーなし。<code class="literal">i</code> は <code class="literal">NULL</code> に設定されます。</td></tr><tr><td scope="row"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></td><td>警告あり、エラーなし。<code class="literal">i</code> は <code class="literal">NULL</code> に設定されます。</td></tr><tr><td scope="row">厳密、<code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></td><td>エラー状態。行は挿入されません。</td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-rounding"></a>12.20.4 丸め動作</h3></div></div></div><p>
      このセクションでは、<code class="literal">ROUND()</code> 関数、および厳密値型 (<code class="literal">DECIMAL</code> と整数) を持つカラムへの挿入での高精度計算の丸めについて説明します。
    </p><p>
      <code class="literal">ROUND()</code> 関数は、その引数が厳密値または近似値のどちらであるかに応じて、異なった方法で丸めます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          真値の数値の場合、<code class="literal">ROUND()</code> は<span class="quote">「<span class="quote">四捨五入</span>」</span>ルールを使用します。0.5 以上の小数部を持つ値は、正の場合は次の整数に切り上げられ、負の場合は次の整数に切り下げられます。(つまり、ゼロから遠い方に丸められます。)0.5 未満の小数部を持つ値は、正の場合は次の整数に切り下げられ、負の場合は次の整数に切り上げられます。
        </p></li><li class="listitem"><p>
          近似値の数字の場合、結果は C ライブラリによって異なります。つまり、多くのシステムでは、<code class="literal">ROUND()</code> は<span class="quote">「<span class="quote">偶数丸め</span>」</span>ルールを使用します。どのような小数部を持つ値も、もっとも近い偶数に丸められます。
        </p></li></ul></div><p>
      次の例では、正確な値の丸めと近似値の丸めの相違点を示します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5), ROUND(25E-1);</code></strong>
+------------+--------------+
| ROUND(2.5) | ROUND(25E-1) |
+------------+--------------+
| 3          |            2 |
+------------+--------------+
</pre><p>
      <code class="literal">DECIMAL</code> または整数カラムへの挿入では、ターゲットが厳密値データ型であるため、挿入される値が厳密値または近似値のどちらであるかには関係なく、丸めでは<span class="quote">「<span class="quote">四捨五入</span>」</span>が使用されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (d DECIMAL(10,0));</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(2.5),(2.5E0);</code></strong>
Query OK, 2 rows affected, 2 warnings (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 2

mysql&gt; <strong class="userinput"><code>SELECT d FROM t;</code></strong>
+------+
| d    |
+------+
| 3    |
| 3    |
+------+
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="precision-math-examples"></a>12.20.5 高精度計算の例</h3></div></div></div><p>
      このセクションでは、MySQL 5.6 での高精度計算のクエリー結果を示すいくつかの例について説明します。これらの例は、<a class="xref" href="functions.html#precision-math-expressions" title="12.20.3 式の処理">セクション12.20.3「式の処理」</a>および<a class="xref" href="functions.html#precision-math-rounding" title="12.20.4 丸め動作">セクション12.20.4「丸め動作」</a>で説明されている原則を示しています。
    </p><p>
      <span class="bold"><strong>例 1</strong></span>。数値は、可能であれば、指定されたとおりにその厳密値で使用されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT (.1 + .2) = .3;</code></strong>
+----------------+
| (.1 + .2) = .3 |
+----------------+
|              1 |
+----------------+
</pre><p>
      浮動小数点値の場合、結果は不正確です。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT (.1E0 + .2E0) = .3E0;</code></strong>
+----------------------+
| (.1E0 + .2E0) = .3E0 |
+----------------------+
|                    0 |
+----------------------+
</pre><p>
      厳密値と近似値の処理の違いを確認するための別の方法として、合計値に小さい数値を何回も加える方法があります。ある変数に <code class="literal">.0001</code> を 1,000 回加える次のストアドプロシージャーを考えてみます。
    </p><pre class="programlisting">
CREATE PROCEDURE p ()
BEGIN
  DECLARE i INT DEFAULT 0;
  DECLARE d DECIMAL(10,4) DEFAULT 0;
  DECLARE f FLOAT DEFAULT 0;
  WHILE i &lt; 10000 DO
    SET d = d + .0001;
    SET f = f + .0001E0;
    SET i = i + 1;
  END WHILE;
  SELECT d, f;
END;
</pre><p>
      論理的には、<code class="literal">d</code> と <code class="literal">f</code> の両方の合計値が 1 になるはずですが、それは 10 進数の計算にしか当てはまりません。浮動小数点の計算では、小さなエラーが発生します。
    </p><pre class="programlisting">
+--------+------------------+
| d      | f                |
+--------+------------------+
| 1.0000 | 0.99999999999991 |
+--------+------------------+
</pre><p>
      <span class="bold"><strong>例 2</strong></span>。乗算は、標準 SQL に必要なスケールで実行されます。つまり、スケール <em class="replaceable"><code>S1</code></em> と <em class="replaceable"><code>S2</code></em> を持つ 2 つの数値 <em class="replaceable"><code>X1</code></em> と <em class="replaceable"><code>X2</code></em> の場合、結果のスケールは <code class="literal"><em class="replaceable"><code>S1</code></em> + <em class="replaceable"><code>S2</code></em></code> になります。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT .01 * .01;</code></strong>
+-----------+
| .01 * .01 |
+-----------+
| 0.0001    |
+-----------+
</pre><p>
      <span class="bold"><strong>例 3</strong></span>。厳密値数値に対する丸め動作は、適切に定義されています。
    </p><p>
      丸め動作 (たとえば、<code class="literal">ROUND()</code> 関数を使用した動作) は、ベースとなる C ライブラリの実装には依存しません。つまり、その結果は各プラットフォームにわたって一貫性があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          厳密値カラム (<code class="literal">DECIMAL</code> と整数) および厳密値数値に対する丸めでは、<span class="quote">「<span class="quote">四捨五入</span>」</span>ルールが使用されます。0.5 以上の小数部を持つ値は、次に示すように、0 から遠いもっとも近い整数に丸められます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5), ROUND(-2.5);</code></strong>
+------------+-------------+
| ROUND(2.5) | ROUND(-2.5) |
+------------+-------------+
| 3          | -3          |
+------------+-------------+
</pre></li><li class="listitem"><p>
          浮動小数点値に対する丸めでは、C ライブラリが使用されます。これは、多くのシステムでは<span class="quote">「<span class="quote">偶数丸め</span>」</span>ルールを使用します。このようなシステムでは、どのような小数部を持つ値も、もっとも近い偶数に丸められます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5E0), ROUND(-2.5E0);</code></strong>
+--------------+---------------+
| ROUND(2.5E0) | ROUND(-2.5E0) |
+--------------+---------------+
|            2 |            -2 |
+--------------+---------------+
</pre></li></ul></div><p>
      <span class="bold"><strong>例 4</strong></span>。厳密モードでは、カラムの範囲を外れている値を挿入すると、正当な値への切り捨てではなく、エラーが発生します。
    </p><p>
      MySQL が厳密モードで実行されていない場合は、正当な値への切り捨てが発生します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_mode='';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t SET i = 128;</code></strong>
Query OK, 1 row affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i FROM t;</code></strong>
+------+
| i    |
+------+
|  127 |
+------+
1 row in set (0.00 sec)
</pre><p>
      ただし、厳密モードが有効になっている場合は、エラーが発生します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_mode='STRICT_ALL_TABLES';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t SET i = 128;</code></strong>
ERROR 1264 (22003): Out of range value adjusted for column 'i' at row 1

mysql&gt; <strong class="userinput"><code>SELECT i FROM t;</code></strong>
Empty set (0.00 sec)
</pre><p>
      <span class="bold"><strong>例 5</strong></span>: 厳密モードで <code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code> が設定されている場合は、0 による除算によって <code class="literal">NULL</code> の結果ではなく、エラーが発生します。
    </p><p>
      非厳密モードでは、0 による除算によって <code class="literal">NULL</code> の結果が生成されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_mode='';</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t SET i = 1 / 0;</code></strong>
Query OK, 1 row affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT i FROM t;</code></strong>
+------+
| i    |
+------+
| NULL |
+------+
1 row in set (0.03 sec)
</pre><p>
      ただし、適切な SQL モードが有効になっている場合、0 による除算はエラーになります。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_mode='STRICT_ALL_TABLES,ERROR_FOR_DIVISION_BY_ZERO';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t SET i = 1 / 0;</code></strong>
ERROR 1365 (22012): Division by 0

mysql&gt; <strong class="userinput"><code>SELECT i FROM t;</code></strong>
Empty set (0.01 sec)
</pre><p>
      <span class="bold"><strong>例 6</strong></span>。厳密値リテラルは、厳密値として評価されます。
    </p><p>
      MySQL 5.0.3 より前は、厳密値リテラルと近似値リテラルはどちらも、倍精度浮動小数点値として評価されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT VERSION();</code></strong>
+------------+
| VERSION()  |
+------------+
| 4.1.18-log |
+------------+
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t SELECT 2.5 AS a, 25E-1 AS b;</code></strong>
Query OK, 1 row affected (0.07 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>DESCRIBE t;</code></strong>
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| a     | double(3,1) |      |     | 0.0     |       |
| b     | double      |      |     | 0       |       |
+-------+-------------+------+-----+---------+-------+
2 rows in set (0.04 sec)
</pre><p>
      MySQL 5.0.3 の時点では、近似値リテラルは浮動小数点を使用して評価されますが、厳密値リテラルは <code class="literal">DECIMAL</code> として処理されます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT VERSION();</code></strong>
+-----------------+
| VERSION()       |
+-----------------+
| 5.1.6-alpha-log |
+-----------------+
1 row in set (0.11 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t SELECT 2.5 AS a, 25E-1 AS b;</code></strong>
Query OK, 1 row affected (0.01 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>DESCRIBE t;</code></strong>
+-------+-----------------------+------+-----+---------+-------+
| Field | Type                  | Null | Key | Default | Extra |
+-------+-----------------------+------+-----+---------+-------+
| a     | decimal(2,1) unsigned | NO   |     | 0.0     |       |
| b     | double                | NO   |     | 0       |       |
+-------+-----------------------+------+-----+---------+-------+
2 rows in set (0.01 sec)
</pre><p>
      <span class="bold"><strong>例 7</strong></span>。集約関数への引数が厳密値数値型である場合は、その結果も、少なくとも引数と同じスケールを持つ厳密値数値型になります。
    </p><p>
      これらのステートメントを考慮してください。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i INT, d DECIMAL, f FLOAT);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(1,1,1);</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE TABLE y SELECT AVG(i), AVG(d), AVG(f) FROM t;</code></strong>
</pre><p>
      MySQL 5.0.3 より前は、引数の型にかかわらず、結果が倍精度値になります。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DESCRIBE y;</code></strong>
+--------+--------------+------+-----+---------+-------+
| Field  | Type         | Null | Key | Default | Extra |
+--------+--------------+------+-----+---------+-------+
| AVG(i) | double(17,4) | YES  |     | NULL    |       |
| AVG(d) | double(17,4) | YES  |     | NULL    |       |
| AVG(f) | double       | YES  |     | NULL    |       |
+--------+--------------+------+-----+---------+-------+
</pre><p>
      MySQL 5.0.3 の時点では、結果が倍精度値になるのは浮動小数点引数の場合だけです。厳密値型引数の場合は、結果も厳密値型になります。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DESCRIBE y;</code></strong>
+--------+---------------+------+-----+---------+-------+
| Field  | Type          | Null | Key | Default | Extra |
+--------+---------------+------+-----+---------+-------+
| AVG(i) | decimal(14,4) | YES  |     | NULL    |       |
| AVG(d) | decimal(14,4) | YES  |     | NULL    |       |
| AVG(f) | double        | YES  |     | NULL    |       |
+--------+---------------+------+-----+---------+-------+
</pre><p>
      結果が倍精度値になるのは浮動小数点引数の場合だけです。厳密値型引数の場合は、結果も厳密値型になります。
    </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="data-types.html">前</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="sql-syntax.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第 11 章 データ型 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 第 13 章 SQL ステートメントの構文</td></tr></table></div><div class="copyright-footer"></div></body></html>
