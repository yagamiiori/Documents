<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第 22 章 MySQL パフォーマンススキーマ</title><link rel="stylesheet" type="text/css" href="mvl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="MySQL 5.6 リファレンスマニュアル"><link rel="up" href="index.html" title="MySQL 5.6 リファレンスマニュアル"><link rel="prev" href="information-schema.html" title="第 21 章 INFORMATION_SCHEMA テーブル"><link rel="next" href="connectors-apis.html" title="第 23 章 Connector および API">
<script language="javascript" type="text/javascript">
  function addOnload(theFunc)
  {
    var previous = window.onload;
    if (typeof window.onload != 'function')
    {
      window.onload = theFunc;
    }
    else
    {
      window.onload = function()
      {
        previous();
        theFunc();
      }
    }
  }

  addOnload(function()
  {
    var base = new Date(1442918127*1000);
    var now = new Date();
    var diff = ((now-base)/1000)/(24*3600);

    if (diff > 90) {
      var nodes = document.getElementsByClassName('titlepage');
      nodes[0].innerHTML = '<p style="border: 5px #ff0000 solid; padding: 5px; margin 5px">' +
        'This copy of the manual is more than 90 days old. We encourage you to download a ' +
        'new version from <a href="http://dev.mysql.com">dev.mysql.com/doc</a>.</p>' + nodes[0].innerHTML;
    }
  });
</script>
<noscript></noscript>
</head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 22 章 MySQL パフォーマンススキーマ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="information-schema.html">前</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="connectors-apis.html">次へ</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="performance-schema"></a>第 22 章 MySQL パフォーマンススキーマ</h1></div></div></div><div class="toc"><p><b>目次</b></p><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-quick-start">22.1 パフォーマンススキーマクイックスタート</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-configuration">22.2 パフォーマンススキーマ構成</a></span></dt><dd><dl><dt><span class="section"><a href="performance-schema.html#performance-schema-build-configuration">22.2.1 パフォーマンススキーマビルド構成</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-startup-configuration">22.2.2 パフォーマンススキーマ起動構成</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-runtime-configuration">22.2.3 パフォーマンススキーマ実行時構成</a></span></dt></dl></dd><dt><span class="section"><a href="performance-schema.html#performance-schema-queries">22.3 パフォーマンススキーマクエリー</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrument-naming">22.4 パフォーマンススキーマインストゥルメント命名規則</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-monitoring">22.5 パフォーマンススキーマステータスモニタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-atom-molecule-events">22.6 パフォーマンススキーマの原子的および分子的イベント</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-digests">22.7 パフォーマンススキーマステートメントダイジェスト</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-characteristics">22.8 パフォーマンススキーマの一般的なテーブル特性</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-descriptions">22.9 パフォーマンススキーマテーブルの説明</a></span></dt><dd><dl><dt><span class="section"><a href="performance-schema.html#performance-schema-table-index">22.9.1 パフォーマンススキーマテーブルインデックス</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-tables">22.9.2 パフォーマンススキーマセットアップテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instance-tables">22.9.3 パフォーマンススキーマインスタンステーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-wait-tables">22.9.4 パフォーマンススキーマ待機イベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-stage-tables">22.9.5 パフォーマンススキーマステージイベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-tables">22.9.6 パフォーマンススキーマステートメントイベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-tables">22.9.7 パフォーマンススキーマ接続テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-attribute-tables">22.9.8 パフォーマンススキーマ接続属性テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-summary-tables">22.9.9 パフォーマンススキーマサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-miscellaneous-tables">22.9.10 パフォーマンススキーマのその他のテーブル</a></span></dt></dl></dd><dt><span class="section"><a href="performance-schema.html#performance-schema-option-variable-reference">22.10 パフォーマンススキーマオプションおよび変数リファレンス</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-options">22.11 パフォーマンススキーマコマンドオプション</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-system-variables">22.12 パフォーマンススキーマシステム変数</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-variables">22.13 パフォーマンススキーマステータス変数</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-and-plugins">22.14 パフォーマンススキーマとプラグイン</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-examples">22.15 問題を診断するためのパフォーマンススキーマの使用</a></span></dt></dl></div><a class="indexterm" name="idm139979008849456"></a><a class="indexterm" name="idm139979008848000"></a><a class="indexterm" name="idm139979008846544"></a><a class="indexterm" name="idm139979008844592"></a><p>
    MySQL パフォーマンススキーマは低レベルで MySQL サーバーの実行をモニタリングするための機能です。パフォーマンススキーマには、これらの特性があります。
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        パフォーマンススキーマは、実行時にサーバーの内部実行を検査する方法を提供します。それは、<code class="literal">PERFORMANCE_SCHEMA</code> ストレージエンジンおよび <code class="literal">performance_schema</code> データベースを使用して実装されます。パフォーマンススキーマは、主にパフォーマンスデータに焦点を合わせています。これは、メタデータの検査に使用される <code class="literal">INFORMATION_SCHEMA</code> と異なります。
      </p></li><li class="listitem"><p>
        パフォーマンススキーマはサーバーイベントをモニターします。<span class="quote">「<span class="quote">イベント</span>」</span>は、時間がかかり、タイミング情報を収集できるようにインストゥルメントされた、サーバーが実行するすべてのことです。一般に、イベントは、関数呼び出し、オペレーティングシステムの待機、解析やソートなどの SQL ステートメント実行のステージ、またはステートメント全体やステートメントのグループなどになります。現在、イベントコレクションは、サーバーおよびいくつかのストレージエンジンの同期呼び出し (相互排他ロックのためなど) のファイルおよびテーブル I/O、テーブルロックなどに関する情報へのアクセスを提供します。
      </p></li><li class="listitem"><p>
        パフォーマンススキーマイベントは、サーバーのバイナリログに書き込まれるイベント (これはデータの変更を説明する) やイベントスケジューラのイベント (これはストアドプログラムの一種である) とは区別されます。
      </p></li><li class="listitem"><p>
        パフォーマンススキーマイベントは MySQL サーバーの特定のインスタンスに固有です。MySQL 5.6.9 以降では、パフォーマンススキーマテーブルはサーバーにローカルとみなされ、それらへの変更はバイナリログにレプリケートされたり、書き込まれたりしません。(Bug #14741537)
      </p></li><li class="listitem"><p>
        現在のイベントに加えて、イベントの履歴とサマリーを取得できます。これにより、インストゥルメントされたアクティビティーが何回実行され、それらにどのくらいの時間がかかったかを判断できます。イベント情報を取得して、特定のスレッドのアクティビティー、または相互排他ロックやファイルなどの特定のオブジェクトに関連付けられているアクティビティーを表示できます。
      </p></li><li class="listitem"><p>
        <code class="literal">PERFORMANCE_SCHEMA</code> ストレージエンジンは、サーバーソースコードで<span class="quote">「<span class="quote">インストゥルメンテーションポイント</span>」</span>を使用して、イベントデータを収集します。
      </p></li><li class="listitem"><p>
        収集されたイベントは、<code class="literal">performance_schema</code> データベース内のテーブルに格納されます。これらのテーブルは、ほかのテーブルと同様に <code class="literal">SELECT</code> ステートメントを使用してクエリーできます。
      </p></li><li class="listitem"><p>
        パフォーマンススキーマの構成は、SQL ステートメントから <code class="literal">performance_schema</code> データベース内のテーブルを更新することによって、動的に変更できます。構成の変更はデータコレクションにすぐに影響しません。
      </p></li><li class="listitem"><p>
        <code class="literal">performance_schema</code> データベース内のテーブルは、永続的なディスク上ストレージを使用しないビューや一時テーブルです。
      </p></li><li class="listitem"><p>
        モニタリングは MySQL でサポートされているすべてのプラットフォームで使用できます。
      </p><p>
        いくつかの制限が適用されることがあります。タイマーの種類はプラットフォームごとに異なることがあります。ストレージエンジンに適用されるインストゥルメントは、すべてのストレージエンジンに実装されていないことがあります。各サードパーティーエンジンのインストゥルメンテーションはエンジン管理者の責任です。<a class="xref" href="restrictions.html#performance-schema-restrictions" title="D.8 パフォーマンススキーマの制約">セクションD.8「パフォーマンススキーマの制約」</a>も参照してください。
      </p></li><li class="listitem"><p>
        データコレクションは、サーバーソースコードを変更し、インストゥルメンテーションを追加することによって実装されます。レプリケーションやイベントスケジューラなどのほかの機能と異なり、パフォーマンススキーマに関連付けられた個別のスレッドはありません。
      </p></li></ul></div><p>
    パフォーマンススキーマは、サーバーパフォーマンスに与える影響を最小にしながら、サーバー実行に関する有益な情報へのアクセスを提供することを目的としています。実装はこれらの設計目標に従います。
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        パフォーマンススキーマのアクティブ化によって、サーバーの動作は変更されません。たとえば、それによってスレッドスケジューリングが変更されず、クエリー実行計画 (<code class="literal">EXPLAIN</code> によって表示される) が変更されません。
      </p></li><li class="listitem"><p>
        サーバーの起動時に行われた以上のメモリー割り当ては行われません。固定サイズでの構造の早期割り当てを使用することで、それらのサイズ変更や再割り当てをする必要がなくなりますが、これは十分な実行時パフォーマンスの達成に重要です。
      </p></li><li class="listitem"><p>
        サーバーのモニタリングはごくわずかなオーバーヘッドで、継続的かつ目立たずに行われます。パフォーマンススキーマのアクティブ化によって、サーバーが使用不能になりません。
      </p></li><li class="listitem"><p>
        パーサーは変更されません。新しいキーワードやステートメントはありません。
      </p></li><li class="listitem"><p>
        パフォーマンススキーマが内部で失敗しても、サーバーコードの実行は正常に続行されます。
      </p></li><li class="listitem"><p>
        初期のイベントの収集時に処理を実行するか、あとのイベント取得時に処理を実行するかのどちらかを選択する場合、収集が速くなるほうが優先されます。これは、取得がオンデマンドで、まったく行われないこともあるのに対し、収集は進行中であるためです。
      </p></li><li class="listitem"><p>
        新しいインストゥルメンテーションポイントを追加することは簡単です。
      </p></li><li class="listitem"><p>
        インストゥルメンテーションはバージョン管理されます。インストゥルメンテーションの実装が変更された場合、以前にインストゥルメントされたコードが動作し続けます。これは、最新のパフォーマンススキーマの変更と同期させておくために、各プラグインをアップグレードする必要がないため、サードパーティープラグインの開発者にメリットがあります。
      </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-quick-start"></a>22.1 パフォーマンススキーマクイックスタート</h2></div></div></div><p>
      このセクションでは、その使用方法を示す例によって、パフォーマンススキーマについて簡単に紹介します。追加の例については、<a class="xref" href="performance-schema.html#performance-schema-examples" title="22.15 問題を診断するためのパフォーマンススキーマの使用">セクション22.15「問題を診断するためのパフォーマンススキーマの使用」</a>を参照してください。
    </p><p>
      パフォーマンススキーマを使用できるようにするには、MySQL の構築時にそのサポートが構成されている必要があります。これが当てはまるかどうかは、サーバーのヘルプ出力をチェックして確認できます。パフォーマンススキーマを使用できる場合、出力に、<code class="literal">performance_schema</code> で始まる名前の付いたいくつかの変数が示されます。
    </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>mysqld --verbose --help</code></strong>
...
  --performance_schema
                      Enable the performance schema.
  --performance_schema_events_waits_history_long_size=#
                      Number of rows in events_waits_history_long.
...
</pre><p>
      そのような変数が出力に表示されない場合、サーバーはパフォーマンススキーマをサポートするように構築されていません。この場合は、<a class="xref" href="performance-schema.html#performance-schema-configuration" title="22.2 パフォーマンススキーマ構成">セクション22.2「パフォーマンススキーマ構成」</a>を参照してください。
    </p><p>
      パフォーマンススキーマを使用できるものとして、MySQL 5.6.6 以降、それはデフォルトで有効にされます。5.6.6 より前では、それはデフォルトで無効にされます。それを明示的に有効または無効にするには、<code class="literal">performance_schema</code> 変数を適切な値に設定して、サーバーを起動します。たとえば、<code class="filename">my.cnf</code> ファイルでこれらの行を使用します。
    </p><pre class="programlisting">
[mysqld]
performance_schema=on
</pre><p>
      サーバーは起動すると、<code class="literal">performance_schema</code> を確認し、パフォーマンススキーマの初期化を試みます。初期化の成功を確認するには、このステートメントを使用します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'performance_schema';</code></strong>
+--------------------+-------+
| Variable_name      | Value |
+--------------------+-------+
| performance_schema | ON    |
+--------------------+-------+
</pre><p>
      <code class="literal">ON</code> の値はパフォーマンススキーマが正常に初期化され、使用する準備ができていることを意味します。<code class="literal">OFF</code> の値は何らかのエラーが発生していることを意味します。何に異常が発生したかに関する情報については、サーバーエラーログをチェックしてください。
    </p><p>
      パフォーマンススキーマはストレージエンジンとして実装されます。このエンジンを使用できる場合 (先にすでにチェックしているはずです)、<code class="literal">INFORMATION_SCHEMA.ENGINES</code> テーブルまたは <code class="literal">SHOW ENGINES</code> ステートメントからの出力に、<code class="literal">SUPPORT</code> 値が <code class="literal">YES</code> でそれが表示されていることでわかるはずです。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM INFORMATION_SCHEMA.ENGINES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE ENGINE='PERFORMANCE_SCHEMA'\G</code></strong>
*************************** 1. row ***************************
      ENGINE: PERFORMANCE_SCHEMA
     SUPPORT: YES
     COMMENT: Performance Schema
TRANSACTIONS: NO
          XA: NO
  SAVEPOINTS: NO

mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
...
      Engine: PERFORMANCE_SCHEMA
     Support: YES
     Comment: Performance Schema
Transactions: NO
          XA: NO
  Savepoints: NO
...
</pre><p>
      <code class="literal">PERFORMANCE_SCHEMA</code> ストレージエンジンは、<code class="literal">performance_schema</code> データベース内のテーブルを操作します。そのテーブルへの参照をデータベース名で修飾する必要がないように、<code class="literal">performance_schema</code> をデフォルトのデータベースにすることができます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>USE performance_schema;</code></strong>
</pre><p>
      この章の多くの例では、<code class="literal">performance_schema</code> がデフォルトのデータベースであるとしています。
    </p><p>
      パフォーマンススキーマテーブルは <code class="literal">performance_schema</code> データベースに格納されます。このデータベースとそのテーブルの構造に関する情報を取得するには、ほかのすべてのデータベースのように、<code class="literal">INFORMATION_SCHEMA</code> データベースから選択するか、<code class="literal">SHOW</code> ステートメントを使用します。たとえば、どのパフォーマンススキーマテーブルが存在するか確認するには、これらのいずれかのステートメントを使用します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE TABLE_SCHEMA = 'performance_schema';</code></strong>
+----------------------------------------------------+
| TABLE_NAME                                         |
+----------------------------------------------------+
| accounts                                           |
| cond_instances                                     |
| events_stages_current                              |
| events_stages_history                              |
| events_stages_history_long                         |
| events_stages_summary_by_account_by_event_name     |
| events_stages_summary_by_host_by_event_name        |
| events_stages_summary_by_thread_by_event_name      |
| events_stages_summary_by_user_by_event_name        |
| events_stages_summary_global_by_event_name         |
| events_statements_current                          |
| events_statements_history                          |
| events_statements_history_long                     |
...
| file_instances                                     |
| file_summary_by_event_name                         |
| file_summary_by_instance                           |
| host_cache                                         |
| hosts                                              |
| mutex_instances                                    |
| objects_summary_global_by_type                     |
| performance_timers                                 |
| rwlock_instances                                   |
| session_account_connect_attrs                      |
| session_connect_attrs                              |
| setup_actors                                       |
| setup_consumers                                    |
| setup_instruments                                  |
| setup_objects                                      |
| setup_timers                                       |
| socket_instances                                   |
| socket_summary_by_event_name                       |
| socket_summary_by_instance                         |
| table_io_waits_summary_by_index_usage              |
| table_io_waits_summary_by_table                    |
| table_lock_waits_summary_by_table                  |
| threads                                            |
| users                                              |
+----------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SHOW TABLES FROM performance_schema;</code></strong>
+----------------------------------------------------+
| Tables_in_performance_schema                       |
+----------------------------------------------------+
| accounts                                           |
| cond_instances                                     |
| events_stages_current                              |
| events_stages_history                              |
| events_stages_history_long                         |
...
</pre><p>
      パフォーマンススキーマテーブルの数は、追加のインストゥルメンテーションの実装が進行するにつれて、時間とともに増加することが予想されます。
    </p><p>
      <code class="literal">performance_schema</code> データベースの名前は小文字で、その中のテーブルの名前も同様です。クエリーでは名前を小文字で指定してください。
    </p><p>
      個々のテーブルの構造を表示するには、<code class="literal">SHOW CREATE TABLE</code> を使用します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE setup_timers\G</code></strong>
*************************** 1. row ***************************
       Table: setup_timers
Create Table: CREATE TABLE `setup_timers` (
  `NAME` varchar(64) NOT NULL,
  `TIMER_NAME` enum('CYCLE','NANOSECOND','MICROSECOND','MILLISECOND','TICK')
   NOT NULL
) ENGINE=PERFORMANCE_SCHEMA DEFAULT CHARSET=utf8
</pre><p>
      テーブル構造は、<code class="literal">INFORMATION_SCHEMA.COLUMNS</code> などのテーブルから選択するか、<code class="literal">SHOW COLUMNS</code> などのステートメントを使用して取得することもできます。
    </p><p>
      <code class="literal">performance_schema</code> データベース内のテーブルはそれらの中の情報の種類 (現在のイベント、イベント履歴およびサマリー、オブジェクトインスタンス、およびセットアップ (構成) 情報) に従ってグループ化できます。次の例に、これらのテーブルのいくつかの使用方法を示します。各グループのテーブルに関する詳細については、<a class="xref" href="performance-schema.html#performance-schema-table-descriptions" title="22.9 パフォーマンススキーマテーブルの説明">セクション22.9「パフォーマンススキーマテーブルの説明」</a>を参照してください。
    </p><p>
      最初に、すべてのインストゥルメントとコンシューマが有効にされていないため、パフォーマンススキーマはすべてのイベントを収集しません。これらのすべてをオンにし、イベントタイミングを有効にするには、2 つのステートメントを実行します (行のカウントは MySQL バージョンによって異なることがあります)。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'YES', TIMED = 'YES';</code></strong>
Query OK, 338 rows affected (0.12 sec)
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers SET ENABLED = 'YES';</code></strong>
Query OK, 8 rows affected (0.00 sec)
</pre><p>
      現在サーバーが何を行なっているかを確認するには、<code class="literal">events_waits_current</code> テーブルを調査します。それには、スレッドごとに、各スレッドの最新のモニターされたイベントを示す 1 行が含まれます。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM events_waits_current\G</code></strong>
*************************** 1. row ***************************
            THREAD_ID: 0
             EVENT_ID: 5523
           EVENT_NAME: wait/synch/mutex/mysys/THR_LOCK::mutex
               SOURCE: thr_lock.c:525
          TIMER_START: 201660494489586
            TIMER_END: 201660494576112
           TIMER_WAIT: 86526
                SPINS: NULL
        OBJECT_SCHEMA: NULL
          OBJECT_NAME: NULL
          OBJECT_TYPE: NULL
OBJECT_INSTANCE_BEGIN: 142270668
     NESTING_EVENT_ID: NULL
            OPERATION: lock
      NUMBER_OF_BYTES: NULL
                FLAGS: 0
...
</pre><p>
      このイベントは、スレッド 0 が <code class="literal">THR_LOCK::mutex</code> のロック、<code class="literal">mysys</code> サブシステム内の相互排他ロックを獲得するために、86,526 ピコ秒待機していたことを示しています。最初のいくつかのカラムは次の情報を提供します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          ID カラムはイベントの発生元のスレッドとイベント番号を示します。
        </p></li><li class="listitem"><p>
          <code class="literal">EVENT_NAME</code> はインストゥルメントされたものを示し、<code class="literal">SOURCE</code> は、インストゥルメントされたコードを含むソースファイルを示します。
        </p></li><li class="listitem"><p>
          タイマーカラムはイベントが開始および停止したタイミングとそれにかかった時間を示します。イベントがまだ進行中の場合は、<code class="literal">TIMER_END</code> と <code class="literal">TIMER_WAIT</code> の値が <code class="literal">NULL</code> になります。タイマー値は概算で、ピコ秒で表されます。タイマーおよびイベント時間コレクションについては、<a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 パフォーマンススキーマイベントタイミング">セクション22.2.3.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
        </p></li></ul></div><p>
      履歴テーブルには、現在のイベントテーブルと同じ種類の行が含まれますが、ほかの行もあり、サーバーが<span class="quote">「<span class="quote">現在</span>」</span>ではなく、<span class="quote">「<span class="quote">最近</span>」</span>何を実行していたかが示されます。<code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> テーブルにはスレッドごとに最新の 10 イベントと最新の 10,000 イベントがそれぞれ含まれます。たとえば、スレッド 13 によって生成された最新イベントの情報を表示するには、次を実行します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT EVENT_ID, EVENT_NAME, TIMER_WAIT</code></strong>
    -&gt; <strong class="userinput"><code>FROM events_waits_history WHERE THREAD_ID = 13</code></strong>
    -&gt; <strong class="userinput"><code>ORDER BY EVENT_ID;</code></strong>
+----------+-----------------------------------------+------------+
| EVENT_ID | EVENT_NAME                              | TIMER_WAIT |
+----------+-----------------------------------------+------------+
|       86 | wait/synch/mutex/mysys/THR_LOCK::mutex  |     686322 |
|       87 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     320535 |
|       88 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     339390 |
|       89 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     377100 |
|       90 | wait/synch/mutex/sql/LOCK_plugin        |     614673 |
|       91 | wait/synch/mutex/sql/LOCK_open          |     659925 |
|       92 | wait/synch/mutex/sql/THD::LOCK_thd_data |     494001 |
|       93 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     222489 |
|       94 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     214947 |
|       95 | wait/synch/mutex/mysys/LOCK_alarm       |     312993 |
+----------+-----------------------------------------+------------+
</pre><p>
      履歴テーブルに新しいイベントが追加されると、テーブルがいっぱいである場合、古いイベントが破棄されます。
    </p><p>
      サマリーテーブルは、時間をかけてすべてのイベントについて集計された情報を提供します。このグループのテーブルには、さまざまな方法で、イベントデータが要約されます。もっとも多くの回数実行されたか、またはもっとも待機時間がかかったインストゥルメントを確認するには、<code class="literal">COUNT_STAR</code> または <code class="literal">SUM_TIMER_WAIT</code> カラムで <code class="literal">events_waits_summary_global_by_event_name</code> テーブルをソートします。これらのカラムはすべてのイベント全体で計算された、<code class="literal">COUNT(*)</code> または <code class="literal">SUM(TIMER_WAIT)</code> 値にそれぞれ対応します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT EVENT_NAME, COUNT_STAR</code></strong>
    -&gt; <strong class="userinput"><code>FROM events_waits_summary_global_by_event_name</code></strong>
    -&gt; <strong class="userinput"><code>ORDER BY COUNT_STAR DESC LIMIT 10;</code></strong>
+---------------------------------------------------+------------+
| EVENT_NAME                                        | COUNT_STAR |
+---------------------------------------------------+------------+
| wait/synch/mutex/mysys/THR_LOCK_malloc            |       6419 |
| wait/io/file/sql/FRM                              |        452 |
| wait/synch/mutex/sql/LOCK_plugin                  |        337 |
| wait/synch/mutex/mysys/THR_LOCK_open              |        187 |
| wait/synch/mutex/mysys/LOCK_alarm                 |        147 |
| wait/synch/mutex/sql/THD::LOCK_thd_data           |        115 |
| wait/io/file/myisam/kfile                         |        102 |
| wait/synch/mutex/sql/LOCK_global_system_variables |         89 |
| wait/synch/mutex/mysys/THR_LOCK::mutex            |         89 |
| wait/synch/mutex/sql/LOCK_open                    |         88 |
+---------------------------------------------------+------------+

mysql&gt; <strong class="userinput"><code>SELECT EVENT_NAME, SUM_TIMER_WAIT</code></strong>
    -&gt; <strong class="userinput"><code>FROM events_waits_summary_global_by_event_name</code></strong>
    -&gt; <strong class="userinput"><code>ORDER BY SUM_TIMER_WAIT DESC LIMIT 10;</code></strong>
+----------------------------------------+----------------+
| EVENT_NAME                             | SUM_TIMER_WAIT |
+----------------------------------------+----------------+
| wait/io/file/sql/MYSQL_LOG             |     1599816582 |
| wait/synch/mutex/mysys/THR_LOCK_malloc |     1530083250 |
| wait/io/file/sql/binlog_index          |     1385291934 |
| wait/io/file/sql/FRM                   |     1292823243 |
| wait/io/file/myisam/kfile              |      411193611 |
| wait/io/file/myisam/dfile              |      322401645 |
| wait/synch/mutex/mysys/LOCK_alarm      |      145126935 |
| wait/io/file/sql/casetest              |      104324715 |
| wait/synch/mutex/sql/LOCK_plugin       |       86027823 |
| wait/io/file/sql/pid                   |       72591750 |
+----------------------------------------+----------------+
</pre><p>
      これらの結果には、<code class="literal">THR_LOCK_malloc</code> 相互排他ロックが、その使用される頻度とスレッドがそれを獲得しようとして待機する時間の量の両方に関して、<span class="quote">「<span class="quote">ホット</span>」</span>であることが示されます。
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
        <code class="literal">THR_LOCK_malloc</code> 相互排他ロックはデバッグビルドでのみ使用されます。本番ビルドでは、それが存在しないため、ホットではありません。
      </p></div><p>
      インスタンステーブルは、インストゥルメントされたオブジェクトの種類を記述します。インストゥルメントされたオブジェクトは、サーバーによって使われると、イベントを生成します。これらのテーブルは、イベント名と説明のメモまたはステータス情報を提供します。たとえば、<code class="literal">file_instances</code> テーブルは、ファイル I/O 操作のインストゥルメントのインスタンスとそれらに関連付けられたファイルを一覧表示します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM file_instances\G</code></strong>
*************************** 1. row ***************************
 FILE_NAME: /opt/mysql-log/60500/binlog.000007
EVENT_NAME: wait/io/file/sql/binlog
OPEN_COUNT: 0
*************************** 2. row ***************************
 FILE_NAME: /opt/mysql/60500/data/mysql/tables_priv.MYI
EVENT_NAME: wait/io/file/myisam/kfile
OPEN_COUNT: 1
*************************** 3. row ***************************
 FILE_NAME: /opt/mysql/60500/data/mysql/columns_priv.MYI
EVENT_NAME: wait/io/file/myisam/kfile
OPEN_COUNT: 1
...
</pre><p>
      セットアップテーブルは、モニタリング特性の構成と表示に使われます。たとえば、選択されているイベントタイマーを表示するには、<code class="literal">setup_timers</code> テーブルをクエリーします。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | CYCLE       |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
      <code class="literal">setup_instruments</code> は、イベントを収集できる一連のインストゥルメントを一覧表示し、それらのうちどれが有効にされているかを示します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments;</code></strong>
+------------------------------------------------------------+---------+-------+
| NAME                                                       | ENABLED | TIMED |
+------------------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                          | YES     | YES   |
...
| wait/synch/rwlock/sql/LOCK_grant                           | YES     | YES   |
| wait/synch/rwlock/sql/LOGGER::LOCK_logger                  | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_connect                | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_slave                  | YES     | YES   |
...
| wait/io/file/sql/binlog                                    | YES     | YES   |
| wait/io/file/sql/binlog_index                              | YES     | YES   |
| wait/io/file/sql/casetest                                  | YES     | YES   |
| wait/io/file/sql/dbopt                                     | YES     | YES   |
...
</pre><p>
      インストゥルメント名の解釈方法を理解するには、<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 パフォーマンススキーマインストゥルメント命名規則">セクション22.4「パフォーマンススキーマインストゥルメント命名規則」</a>を参照してください。
    </p><p>
      インストゥルメントのイベントを収集するかどうかを制御するには、その <code class="literal">ENABLED</code> 値を <code class="literal">YES</code> または <code class="literal">NO</code> に設定します。例:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/sql/LOCK_mysql_create_db';</code></strong>
</pre><p>
      パフォーマンススキーマは収集されたイベントを使用して、イベント情報の<span class="quote">「<span class="quote">コンシューマ</span>」</span>として機能する <code class="literal">performance_schema</code> データベース内のテーブルを更新します。<code class="literal">setup_consumers</code> テーブルは、使用可能なコンシューマとどれが有効にされているかを示します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_stages_current          | NO      |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| events_waits_current           | NO      |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
      パフォーマンススキーマがコンシューマをイベント情報の宛先として保守するかどうかを制御するには、その <code class="literal">ENABLED</code> 値を設定します。
    </p><p>
      セットアップテーブルについてとそれらを使用して、イベント収集を制御する詳細については、<a class="xref" href="performance-schema.html#performance-schema-filtering" title="22.2.3.2 パフォーマンススキーマイベントフィルタリング">セクション22.2.3.2「パフォーマンススキーマイベントフィルタリング」</a>を参照してください。
    </p><p>
      先述のグループのいずれにも分類されないその他のテーブルがいくつかあります。たとえば、<code class="literal">performance_timers</code> は、使用可能なイベントタイマーとそれらの特性を一覧表示します。タイマーの詳細については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 パフォーマンススキーマイベントタイミング">セクション22.2.3.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-configuration"></a>22.2 パフォーマンススキーマ構成</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-build-configuration">22.2.1 パフォーマンススキーマビルド構成</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-startup-configuration">22.2.2 パフォーマンススキーマ起動構成</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-runtime-configuration">22.2.3 パフォーマンススキーマ実行時構成</a></span></dt></dl></div><p>
      MySQL パフォーマンススキーマを使用するには、これらの構成の考慮事項が適用されます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          パフォーマンススキーマを使用できるようにするには、構築時に MySQL サーバーにそれを構成する必要があります。パフォーマンススキーマのサポートはバイナリ MySQL 配布に含まれています。ソースから構築する場合は、<a class="xref" href="performance-schema.html#performance-schema-build-configuration" title="22.2.1 パフォーマンススキーマビルド構成">セクション22.2.1「パフォーマンススキーマビルド構成」</a>に説明するように、それがビルドに構成されていることを確認する必要があります。
        </p></li><li class="listitem"><p>
          イベント収集が行われるようにするには、サーバーの起動時にパフォーマンススキーマが有効にされている必要があります。サーバーの起動時または実行時に特定のパフォーマンススキーマ機能を有効にして、行われるイベント収集の種類を制御できます。<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="22.2.2 パフォーマンススキーマ起動構成">セクション22.2.2「パフォーマンススキーマ起動構成」</a>、<a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="22.2.3 パフォーマンススキーマ実行時構成">セクション22.2.3「パフォーマンススキーマ実行時構成」</a>、および<a class="xref" href="performance-schema.html#performance-schema-filtering" title="22.2.3.2 パフォーマンススキーマイベントフィルタリング">セクション22.2.3.2「パフォーマンススキーマイベントフィルタリング」</a>を参照してください。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-build-configuration"></a>22.2.1 パフォーマンススキーマビルド構成</h3></div></div></div><p>
        パフォーマンススキーマを使用できるようにするには、構築時に MySQL サーバーにそれを構成する必要があります。Oracle Corporation によって提供されているバイナリ MySQL 配布は、パフォーマンススキーマをサポートするように構成されています。別のプロバイダのバイナリ MySQL 配布を使用する場合は、プロバイダに、配布が適切に構成されているかどうかを確認してください。
      </p><p>
        ソース配布から MySQL を構築する場合は、<code class="option">WITH_PERFSCHEMA_STORAGE_ENGINE</code> オプションを有効にして、<span class="command"><strong>CMake</strong></span> を実行し、パフォーマンススキーマを有効にします。
      </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>cmake . -DWITH_PERFSCHEMA_STORAGE_ENGINE=1</code></strong>
</pre><p>
        <code class="option">-DWITHOUT_PERFSCHEMA_STORAGE_ENGINE=1</code> オプションを使用して MySQL を構成すると、パフォーマンススキーマが含まれないため、それを含める場合は、このオプションを使用しないでください。<a class="xref" href="installing.html#source-configuration-options" title="2.9.4 MySQL ソース構成オプション">セクション2.9.4「MySQL ソース構成オプション」</a>を参照してください。
      </p><p>
        パフォーマンススキーマなし (または現在のすべてのテーブルを含まない可能性がある古いバージョンのパフォーマンススキーマ) で構成された以前のインストールに MySQL をインストールする場合は、サーバーの起動後に <span class="command"><strong>mysql_upgrade</strong></span> を実行して、すべての現在のテーブルを使用して <code class="literal">performance_schema</code> データベースが存在するようにしてください。次に、サーバーを再起動します。これを行う必要があることを示す 1 つの兆候は、エラーログ内に次のようなメッセージが存在することです。
      </p><pre class="programlisting">
[ERROR] Native table 'performance_schema'.'events_waits_history'
has the wrong structure
[ERROR] Native table 'performance_schema'.'events_waits_history_long'
has the wrong structure
...
</pre><p>
        サーバーにパフォーマンススキーマのサポートが組み込まれているかどうかを確認するには、そのヘルプ出力をチェックします。パフォーマンススキーマを使用できる場合、出力に、<code class="literal">performance_schema</code> で始まる名前の付いたいくつかの変数が示されます。
      </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>mysqld --verbose --help</code></strong>
...
  --performance_schema
                      Enable the performance schema.
  --performance_schema_events_waits_history_long_size=#
                      Number of rows in events_waits_history_long.
...
</pre><p>
        サーバーに接続し、<code class="literal">SHOW ENGINES</code> からの出力で <code class="literal">PERFORMANCE_SCHEMA</code> ストレージエンジンの名前が挙げられた行を探すこともできます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
...
      Engine: PERFORMANCE_SCHEMA
     Support: YES
     Comment: Performance Schema
Transactions: NO
          XA: NO
  Savepoints: NO
...
</pre><p>
        構築時にサーバーにパフォーマンススキーマが構成されていない場合、<code class="literal">SHOW ENGINES</code> からの出力に、<code class="literal">PERFORMANCE_SCHEMA</code> の行が表示されません。<code class="literal">SHOW DATABASES</code> からの出力に、<code class="literal">performance_schema</code> が示されていることもありますが、それにはテーブルがなく、それを使用することはできません。
      </p><p>
        <code class="literal">SHOW ENGINES</code> 出力の <code class="literal">PERFORMANCE_SCHEMA</code> の行は、パフォーマンススキーマを使用できることを意味し、それが有効にされていることを意味しているわけではありません。それを有効にするには、次のセクションで説明するように、サーバーの起動時にそうする必要があります。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-startup-configuration"></a>22.2.2 パフォーマンススキーマ起動構成</h3></div></div></div><p>
        パフォーマンススキーマを使用できるものとして、MySQL 5.6.6 以降、それはデフォルトで有効にされます。5.6.6 より前では、それはデフォルトで無効にされます。それを明示的に有効または無効にするには、<code class="literal">performance_schema</code> 変数を適切な値に設定して、サーバーを起動します。たとえば、<code class="filename">my.cnf</code> ファイルでこれらの行を使用します。
      </p><pre class="programlisting">
[mysqld]
performance_schema=on
</pre><p>
        パフォーマンススキーマの初期化時に、サーバーが内部バッファーを割り当てることができない場合、パフォーマンススキーマは自動的に無効になり、<code class="literal">performance_schema</code> を <code class="literal">OFF</code> に設定して、サーバーがインストゥルメンテーションなしで実行します。
      </p><p>
        MySQL 5.6.4 以降、パフォーマンススキーマは、サーバー起動時のインストゥルメントおよびコンシューマの構成を許可します。これは、以前 <code class="literal">setup_instruments</code> および <code class="literal">setup_consumers</code> テーブルに <code class="literal">UPDATE</code> ステートメントを使用して、実行時にのみ可能でした。この変更は、サーバーの起動時にすでに初期化されているインストゥルメントを、実行時の構成で無効にするには遅すぎるために行われました。たとえば、<code class="literal">wait/synch/mutex/sql/LOCK_open</code> 相互排他ロックはサーバー起動時に 1 回初期化されるため、実行時に対応するインストゥルメントを無効にする試みは無効です。
      </p><p>
        サーバー起動時のインストゥルメントを制御するには、この形式のオプションを使用します。
      </p><pre class="programlisting">
--performance-schema-instrument='<em class="replaceable"><code>instrument_name</code></em>=<em class="replaceable"><code>value</code></em>'
</pre><p>
        ここで <em class="replaceable"><code>instrument_name</code></em> は <code class="literal">wait/synch/mutex/sql/LOCK_open</code> などのインストゥルメント名で、<em class="replaceable"><code>value</code></em> はこれらのいずれかの値です。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">off</code>、<code class="literal">false</code>、または <code class="literal">0</code>: インストゥルメントを無効にします
          </p></li><li class="listitem"><p>
            <code class="literal">on</code>、<code class="literal">true</code>、または <code class="literal">1</code>: インストゥルメントを有効にして時間を測定します
          </p></li><li class="listitem"><p>
            <code class="literal">counted</code>: インストゥルメントを有効にしてカウント (時間測定ではなく) します
          </p></li></ul></div><p>
        各 <code class="option">--performance-schema-instrument</code> オプションではインストゥルメント名を 1 つしか指定できませんが、オプションの複数のインスタンスを指定して、複数のインストゥルメントを構成できます。さらに、インストゥルメント名にパターンを使用でき、パターンに一致するインストゥルメントを構成します。すべての条件同期インストゥルメントを有効で、カウント対象として構成するには、次のオプションを使用します。
      </p><pre class="programlisting">
--performance-schema-instrument='wait/synch/cond/%=counted'
</pre><p>
        すべてのインストゥルメントを無効にするには、次のオプションを使用します。
      </p><pre class="programlisting">
--performance-schema-instrument='%=off'
</pre><p>
        長いインストゥルメント名文字列は、順序に関係なく、短いパターン名より優先されます。インストゥルメントを選択するためのパターンの指定については、<a class="xref" href="performance-schema.html#performance-schema-filtering-names" title="22.2.3.4 フィルタリング操作のインストゥルメントまたはコンシューマの指定">セクション22.2.3.4「フィルタリング操作のインストゥルメントまたはコンシューマの指定」</a>を参照してください。
      </p><p>
        認識されないインストゥルメント名は無視されます。あとでインストールされたプラグインによってインストゥルメントを作成することは可能で、そのときに名前が認識され、構成されます。
      </p><p>
        サーバー起動時のコンシューマを制御するには、この形式のオプションを使用します。
      </p><pre class="programlisting">
--performance-schema-consumer-<em class="replaceable"><code>consumer_name</code></em>=<em class="replaceable"><code>value</code></em>
</pre><p>
        ここで、<em class="replaceable"><code>consumer_name</code></em> は <code class="literal">events_waits_history</code> などのコンシューマ名で、<em class="replaceable"><code>value</code></em> はこれらのいずれかです。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">off</code>、<code class="literal">false</code>、または <code class="literal">0</code>: コンシューマのイベントを収集しません
          </p></li><li class="listitem"><p>
            <code class="literal">on</code>、<code class="literal">true</code>、または <code class="literal">1</code>: コンシューマのイベントを収集します
          </p></li></ul></div><p>
        たとえば、<code class="literal">events_waits_history</code> コンシューマを有効にするには、次のオプションを使用します。
      </p><pre class="programlisting">
--performance-schema-consumer-events-waits-history=on
</pre><p>
        許可されるコンシューマ名は、<code class="literal">setup_consumers</code> テーブルを調べるとわかります。パターンは許可されません。<code class="literal">setup_consumers</code> テーブル内のコンシューマ名は下線が使われますが、起動時に設定されたコンシューマでは、名前の中のダッシュと下線は同等です。
      </p><p>
        パフォーマンススキーマには、構成情報を提供するいくつかのシステム変数が含まれます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'perf%';</code></strong>
+--------------------------------------------------------+---------+
| Variable_name                                          | Value   |
+--------------------------------------------------------+---------+
| performance_schema                                     | ON      |
| performance_schema_accounts_size                       | 100     |
| performance_schema_digests_size                        | 200     |
| performance_schema_events_stages_history_long_size     | 10000   |
| performance_schema_events_stages_history_size          | 10      |
| performance_schema_events_statements_history_long_size | 10000   |
| performance_schema_events_statements_history_size      | 10      |
| performance_schema_events_waits_history_long_size      | 10000   |
| performance_schema_events_waits_history_size           | 10      |
| performance_schema_hosts_size                          | 100     |
| performance_schema_max_cond_classes                    | 80      |
| performance_schema_max_cond_instances                  | 1000    |
...
</pre><p>
        <code class="literal">performance_schema</code> 変数は <code class="literal">ON</code> または <code class="literal">OFF</code> で、パフォーマンススキーマが有効か無効かを示します。ほかの変数はテーブルサイズ (行数) やメモリー割り当て値を示します。
      </p><a class="indexterm" name="idm139979008589104"></a><a class="indexterm" name="idm139979008586912"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
          パフォーマンススキーマが有効にされている場合、パフォーマンススキーマインスタンスの数は、おそらく大きくサーバーメモリーフットプリントに影響します。パフォーマンススキーマのシステム変数の値をチューニングして、インストゥルメントの不足と過剰なメモリー消費のバランスをとるインスタンスの数を見つける必要がある可能性があります。
        </p></div><p>
        パフォーマンススキーマシステム変数の値を変更するには、それらをサーバー起動時に設定します。たとえば、<code class="filename">my.cnf</code> ファイルに、履歴テーブルのサイズを変更するために次の行を入れます。
      </p><pre class="programlisting">
[mysqld]
performance_schema
performance_schema_events_waits_history_size=20
performance_schema_events_waits_history_long_size=15000
</pre><p>
        MySQL 5.6.6 以降、パフォーマンススキーマは、そのパラメータのいくつかの値を、それらが明示的に設定されていない場合に、サーバーの起動時に自動的にサイズ設定します。たとえば、それはイベント待機テーブルのサイズを制御するパラメータをこのようにサイズ設定します。どのパラメータがこのポリシーでサイズ設定されるかを確認するには、<span class="command"><strong>mysqld --verbose --help</strong></span> を使用し、−1 のデフォルト値を持つものを探すか、<a class="xref" href="performance-schema.html#performance-schema-system-variables" title="22.12 パフォーマンススキーマシステム変数">セクション22.12「パフォーマンススキーマシステム変数」</a>を参照してください。
      </p><p>
        サーバー起動時に設定されていない (または −1 に設定されている) 自動サイズ設定される各パラメータについて、パフォーマンススキーマは、次のシステム変数の値に基づいてその値を設定する方法を判断します。それらは、MySQL サーバーをどのように構成しているかに関する<span class="quote">「<span class="quote">ヒント</span>」</span>とみなされます。
      </p><pre class="programlisting">
max_connections
open_files_limit
table_definition_cache
table_open_cache
</pre><p>
        特定のパラメータの自動サイズ設定をオーバーライドするには、起動時にそれに −1 以外の値を設定します。この場合、パフォーマンススキーマはそれに指定された値を割り当てます。
      </p><p>
        実行時に、<code class="literal">SHOW VARIABLES</code> では、自動サイズ設定されたパラメータに設定されていた実際の値が表示されます。
      </p><p>
        パフォーマンススキーマが無効にされている場合、その自動サイズ設定されたパラメータは −1 に設定されたままになり、<code class="literal">SHOW VARIABLES</code> では −1 が表示されます。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-runtime-configuration"></a>22.2.3 パフォーマンススキーマ実行時構成</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-timing">22.2.3.1 パフォーマンススキーマイベントタイミング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-filtering">22.2.3.2 パフォーマンススキーマイベントフィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-pre-filtering">22.2.3.3 イベントの事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-filtering-names">22.2.3.4 フィルタリング操作のインストゥルメントまたはコンシューマの指定</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrumentation-checking">22.2.3.5 インストゥルメントされているものの特定</a></span></dt></dl></div><p>
        パフォーマンススキーマセットアップテーブルには、モニタリング構成に関する情報が含まれます。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE TABLE_SCHEMA = 'performance_schema'</code></strong>
    -&gt; <strong class="userinput"><code>AND TABLE_NAME LIKE 'setup%';</code></strong>
+-------------------+
| TABLE_NAME        |
+-------------------+
| setup_actors      |
| setup_consumers   |
| setup_instruments |
| setup_objects     |
| setup_timers      |
+-------------------+
</pre><p>
        これらのテーブルの内容を調査して、パフォーマンススキーマのモニタリング特性に関する情報を取得できます。<code class="literal">UPDATE</code> 権限を持っている場合は、セットアップテーブルを変更して、モニタリングが行われる方法に影響するパフォーマンススキーマ操作を変更できます。これらのテーブルの追加の詳細については、<a class="xref" href="performance-schema.html#performance-schema-setup-tables" title="22.9.2 パフォーマンススキーマセットアップテーブル">セクション22.9.2「パフォーマンススキーマセットアップテーブル」</a>を参照してください。
      </p><p>
        選択されているイベントタイマーを表示するには、<code class="literal">setup_timers</code> テーブルをクエリーします。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | CYCLE       |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
        <code class="literal">NAME</code> 値はタイマーが適用されるインストゥルメントの種類を示し、<code class="literal">TIMER_NAME</code> はそれらのインストゥルメントに適用されるタイマーを示します。タイマーは、名前が <code class="literal">NAME</code> 値に一致するコンポーネントから始まるインストゥルメントに適用されます。
      </p><p>
        タイマーを変更するには、<code class="literal">NAME</code> 値を更新します。たとえば、<code class="literal">wait</code> タイマーに <code class="literal">NANOSECOND</code> タイマーを使用するには:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'NANOSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | NANOSECOND  |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
        タイマーの説明については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 パフォーマンススキーマイベントタイミング">セクション22.2.3.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
      </p><p>
        <code class="literal">setup_instruments</code> および <code class="literal">setup_consumers</code> テーブルは、イベントを収集できるインストゥルメントと、イベント情報が実際に収集されるコンシューマの種類をそれぞれ一覧表示します。その他のセットアップテーブルにより、モニタリング構成をさらに変更できます。<a class="xref" href="performance-schema.html#performance-schema-filtering" title="22.2.3.2 パフォーマンススキーマイベントフィルタリング">セクション22.2.3.2「パフォーマンススキーマイベントフィルタリング」</a>では、イベントコレクションに影響するように、これらのテーブルをどのように変更できるかについて説明しています。
      </p><p>
        実行時に SQL ステートメントを使用して行う必要があるパフォーマンススキーマ構成の変更があり、これらの変更をサーバーが起動するたびに有効になるようにする場合、ファイルにステートメントを入れ、<code class="option">--init-file=<em class="replaceable"><code>file_name</code></em></code> オプションを使用してサーバーを起動します。この戦略は、簡易サーバーヘルスモニタリング、インシデント調査、アプリケーション動作のトラブルシューティングなど、さまざまな種類のモニタリングを生成するようにそれぞれカスタマイズされている複数のモニタリング構成がある場合にも役に立つ可能性があります。各モニタリング構成のステートメントをそれらの固有のファイルに入れ、サーバーの起動時に <code class="option">--init-file</code> 引数として、該当するファイルを指定します。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-timing"></a>22.2.3.1 パフォーマンススキーマイベントタイミング</h4></div></div></div><p>
          イベントは、サーバーソースコードに追加されたインストゥルメンテーションを使用して収集されます。インストゥルメントはイベントの時間を測定しますが、これはパフォーマンススキーマがイベントにどれくらいの時間がかかるかを知らせる方法です。タイミング情報を収集しないようにインストゥルメントを構成することもできます。このセクションでは、使用可能なタイマーとそれらの特性、およびイベント内のタイミング値を表す方法について説明します。
        </p><p>
          2 つのテーブルはタイマー情報を提供します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">performance_timers</code> は、使用可能なタイマーとそれらの特性を一覧表示します。
            </p></li><li class="listitem"><p>
              <code class="literal">setup_timers</code> は、どのタイマーがどのインストゥルメントに使用されるかを示します。
            </p></li></ul></div><p>
          <code class="literal">setup_timers</code> 内の各タイマー行は、<code class="literal">performance_timers</code> に示されているいずれかのタイマーを表している必要があります。
        </p><p>
          タイマーの精度とそれらに伴うオーバーヘッドの量はさまざまに異なります。使用可能なタイマーとそれらの特性を確認するには、<code class="literal">performance_timers</code> テーブルをチェックしてください。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_timers;</code></strong>
+-------------+-----------------+------------------+----------------+
| TIMER_NAME  | TIMER_FREQUENCY | TIMER_RESOLUTION | TIMER_OVERHEAD |
+-------------+-----------------+------------------+----------------+
| CYCLE       |      2389029850 |                1 |             72 |
| NANOSECOND  |            NULL |             NULL |           NULL |
| MICROSECOND |         1000000 |                1 |            585 |
| MILLISECOND |            1035 |                1 |            738 |
| TICK        |             101 |                1 |            630 |
+-------------+-----------------+------------------+----------------+
</pre><p>
          <code class="literal">TIMER_NAME</code> カラムには使用可能なタイマーの名前が表示されます。<code class="literal">CYCLE</code> は CPU (プロセッサ) サイクルカウンタに基づいたタイマーを表します。特定のタイマーに関連付けられた値が <code class="literal">NULL</code> の場合、そのタイマーはプラットフォームでサポートされていません。<code class="literal">NULL</code>のない行は、<code class="literal">setup_timers</code> で使用できるタイマーを示しています。
        </p><p>
          <code class="literal">TIMER_FREQUENCY</code> は、1 秒あたりのタイマー単位数を示します。サイクルタイマーの場合、頻度は一般に CPU 速度に関連します。示された値は、2.4GHz プロセッサを搭載するシステムで取得されました。ほかのタイマーは固定の数秒に基づきます。<code class="literal">TICK</code> の場合、頻度はプラットフォームごとに異なることがあります (たとえば、100 ティック/秒を使用するものや、1000 ティック/秒を使用するものがあります)。
        </p><p>
          <code class="literal">TIMER_RESOLUTION</code> は、タイマー値が一度に増加するタイマー単位数を示します。タイマーの分解能が 10 の場合、その値は毎回 10 ずつ増加します。
        </p><p>
          <code class="literal">TIMER_OVERHEAD</code> は特定のタイマーで 1 つのタイミングを取得するためのオーバーヘッドの最小サイクル数です。タイマーはイベントの開始と終了で呼び出されるため、イベントあたりのオーバーヘッドは表示される値の 2 倍になります。
        </p><p>
          有効なタイマーを確認し、タイマーを変更するには、<code class="literal">setup_timers</code> テーブルにアクセスします。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | NANOSECOND  |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+

mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'MICROSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | MICROSECOND |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
          デフォルトで、パフォーマンススキーマは各インストゥルメントの種類で使用可能な最高のタイマーを使用しますが、ユーザーが別のものを選択することもできます。
        </p><p>
          待機の時間を測定する場合、もっとも重要な基準は、タイマーの精度を犠牲にする可能性があっても、オーバーヘッドを削減することであるため、<code class="literal">CYCLE</code> タイマーを使用することがもっとも適切です。
        </p><p>
          ステートメント (またはステージ) の実行にかかる時間は、一般に単一の待機の実行にかかる時間より桁違いに大きくなります。ステートメントの時間を測定するために、もっとも重要な基準は、プロセッサの周波数の変更に影響を受けない正確な測定基準を設定することであるため、サイクルに基づいていないタイマーを使用することがもっとも適切です。ステートメントのデフォルトのタイマーは <code class="literal">NANOSECOND</code> です。タイマーを 2 回呼び出す (ステートメントの起動時に 1 回、その終了時に 1 回) ことによって発生するオーバーヘッドは、ステートメント自体の実行に使用される CPU 時間と比較して桁違いに小さいため、サイクルタイマーと比較した追加の<span class="quote">「<span class="quote">オーバーヘッド</span>」</span>は大きくありません。<code class="literal">CYCLE</code> タイマーを使用することにはメリットがなく、欠点だけです。
        </p><p>
          サイクルカウンタによって提供される精度はプロセッサ速度によって異なります。プロセッサが 1 GHz (10 億サイクル/秒) 以上で実行する場合、サイクルカウンタはナノ秒未満の精度を実現します。サイクルカウンタを使用することは、実際の時間を取得するより、はるかに負荷が小さくなります。たとえば、標準 <code class="literal">gettimeofday()</code> 関数は数百サイクルかかる可能性があり、これは 1 秒あたり数千または数百万回発生する可能性のあるデータ収集では、許容できないオーバーヘッドです。
        </p><p>
          サイクルカウンタには欠点もあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              エンドユーザーは、何分の 1 秒などの時計の単位でタイミングを知ることを期待します。サイクルから秒に変換することは大きな負荷がかかる可能性があります。このため、変換はすばやいかなり概算的な乗算演算です。
            </p></li><li class="listitem"><p>
              ラップトップが節電モードになったときや熱の生成を抑えるために、CPU の速度が低下したときなどに、プロセッササイクルレートが変わることがあります。プロセッサのサイクルレートが変動した場合、サイクルから実時間単位への変換でエラーが発生することがあります。
            </p></li><li class="listitem"><p>
              サイクルカウンタは、プロセッサやオペレーティングシステムによって、信頼できない場合や使用できない場合があります。たとえば、Pentium では、命令は <code class="literal">RDTSC</code> (C 命令ではなくアセンブリ言語) であり、理論上オペレーティングシステムはユーザーモードプログラムのその使用を妨げることができます。
            </p></li><li class="listitem"><p>
              異常実行またはマルチプロセッサ同期に関する一部のプロセッサの詳細により、カウンタが最大 1000 サイクルごとに高速になったり、低速になったりするように見えることがあります。
            </p></li></ul></div><p>
          現在、MySQL は、x386 (Windows、OS X、Linux、Solaris、およびその他の Unix フレーバー)、PowerPC、および IA-64 のサイクルカウンタと連携します。
        </p><p>
          <code class="literal">setup_instruments</code> テーブルにはイベントを収集するインストゥルメントを示す <code class="literal">ENABLED</code> カラムがあります。このテーブルには、時間が測定されるインストゥルメントを示す <code class="literal">TIMED</code> カラムもあります。インストゥルメントが有効にされていない場合、イベントを生成しません。有効にされているインストゥルメントの時間が測定されない場合、インストゥルメントによって生成されたイベントの <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> タイマー値が <code class="literal">NULL</code> になります。これによって、サマリーテーブルの合計、最小、最大、および平均の時間値の計算時に、それらの値が無視されます。
        </p><p>
          イベント内で、イベントのタイミングの開始時に、有効なタイマーによって指定された単位で時間が保存されます。表示には、選択されたタイマーに関係なく、時間は標準単位に正規化するために、ピコ秒 (1 兆分の 1 秒) で示されます。
        </p><p>
          <code class="literal">setup_timers</code> テーブルへの変更はただちにモニタリングに影響します。すでに進行中のイベントは、開始時間に元のタイマーを使用し、終了時間に新しいタイマーを使用する可能性があるため、予測不可能な結果に至る場合があります。タイマーを変更した場合、<code class="literal">TRUNCATE TABLE</code> を使用して、パフォーマンススキーマの統計をリセットする必要がある場合があります。
        </p><p>
          サーバー起動時のパフォーマンススキーマの初期化で、タイマーベースライン (<span class="quote">「<span class="quote">時間ゼロ</span>」</span>) が発生します。イベント内の <code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値はベースライン以降のピコ秒を表します。<code class="literal">TIMER_WAIT</code> 値はピコ秒での期間です。
        </p><p>
          イベント内のピコ秒値は概算です。それらの精度は、ある単位から別の単位への変換に伴う通常の誤差の形式に左右されます。<code class="literal">CYCLE</code> タイマーが使われ、プロセッサのレートがさまざまに異なる場合、ドリフトが発生することがあります。このため、サーバーの起動から経過した時間の正確な測定基準として、イベントの <code class="literal">TIMER_START</code> 値を見ることは妥当ではありません。一方、開始時間や期間によって、イベントを順序付けるために、<code class="literal">ORDER BY</code> 句に <code class="literal">TIMER_START</code> 値または <code class="literal">TIMER_WAIT</code> 値を使用することは適切です。
        </p><p>
          イベントでマイクロ秒などの値ではなく、ピコ秒を選択したことには、パフォーマンス上の根拠があります。1 つの実装目標は、タイマーに関係なく、統一された時間単位で結果を表示することでした。理想の世界では、この時間単位は時計の単位のように見え、適度に正確である、つまりマイクロ秒です。ただし、サイクルまたはナノ秒をマイクロ秒に変換するには、すべてのインストゥルメンテーションで除算を実行する必要がある場合があります。除算は多くのプラットフォームで高い負荷がかかります。乗算は負荷が高くないため、それを使用しています。そのため、時間単位は、大きな精度の損失がないように十分に大きな乗数を使用した、可能なかぎり最大の <code class="literal">TIMER_FREQUENCY</code> 値の整数の倍数です。その結果、時間単位が<span class="quote">「<span class="quote">ピコ秒</span>」</span>になります。この精度は疑似ですが、この決定によりオーバーヘッドを最小にすることができます。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-filtering"></a>22.2.3.2 パフォーマンススキーマイベントフィルタリング</h4></div></div></div><a class="indexterm" name="idm139979008469488"></a><a class="indexterm" name="idm139979008467328"></a><a class="indexterm" name="idm139979008465232"></a><p>
          イベントはプロデューサ/コンシューマ方式で処理されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              インストゥルメントされたコードは、イベントのソースで、収集されるイベントを生成します。<code class="literal">setup_instruments</code> テーブルは、イベントを収集できるインストゥルメント、それらが有効にされているかどうか、および (有効にされているインストゥルメントの場合) タイミング情報を収集するかどうかを一覧表示します。
            </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments;</code></strong>
+------------------------------------------------------------+---------+-------+
| NAME                                                       | ENABLED | TIMED |
+------------------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                          | YES     | YES   |
...
</pre><p>
              <code class="literal">setup_instruments</code> テーブルはイベント生成のもっとも基本的な制御の形式を提供します。モニターされるオブジェクトやスレッドの種類に基づいて、イベント生成をさらに絞り込むには、<a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 イベントの事前フィルタリング">セクション22.2.3.3「イベントの事前フィルタリング」</a>に説明するように、ほかのテーブルを使用できます。
            </p></li><li class="listitem"><p>
              パフォーマンススキーマテーブルは、イベントの宛先で、イベントを消費します。<code class="literal">setup_consumers</code> テーブルは、イベント情報を送信できるコンシューマの種類とそれらが有効にされているかどうかを一覧表示します。
            </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_stages_current          | NO      |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| events_waits_current           | NO      |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre></li></ul></div><p>
          フィルタリングはパフォーマンスモニタリングのさまざまなステージで実行できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <span class="bold"><strong>事前フィルタリング。</strong></span>これは、プロデューサから特定の種類のイベントのみが収集され、収集されたイベントが特定のコンシューマのみを更新するように、パフォーマンススキーマ構成を変更することによって行われます。これを実行するには、インストゥルメントまたはコンシューマを有効または無効にします。事前フィルタリングは、パフォーマンススキーマによって行われ、すべてのユーザーに適用されるグローバルな効果を持ちます。
            </p><p>
              事前フィルタリングを使用する理由:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  オーバーヘッドを削減するため。パフォーマンススキーマのオーバーヘッドは、すべてのインストゥルメントを有効にしていても最小であるはずですが、さらに縮小したいと考える可能性があります。または、タイミングイベントに関心がなく、タイミングオーバーヘッドを解消するために、タイミングコードを無効にしたいと考えます。
                </p></li><li class="listitem"><p>
                  関心のないイベントの現在のイベントまたは履歴テーブルへの入力を妨げるため。事前フィルタリングにより、これらのテーブル内に、有効なインストゥルメントの種類の行のインスタンス用に多くの<span class="quote">「<span class="quote">空き</span>」</span>を残します。事前フィルタリングでファイルインストゥルメントのみを有効にしている場合、非ファイルインストゥルメントの行は収集されません。事後フィルタリングで、非ファイルイベントが収集され、ファイルイベントの少ない行が残されます。
                </p></li><li class="listitem"><p>
                  特定の種類のイベントテーブルの保守を回避するため。コンシューマを無効にすると、サーバーはそのコンシューマの宛先の保守に時間を費やさなくなります。たとえば、イベント履歴に関心がない場合、履歴テーブルコンシューマを無効にして、パフォーマンスを向上できます。
                </p></li></ul></div></li><li class="listitem"><p>
              <span class="bold"><strong>事後フィルタリング。</strong></span>これには、クエリー内で、パフォーマンススキーマテーブルから情報を選択する <code class="literal">WHERE</code> 句を使用して、使用可能なイベントのうち表示したいものを指定することが含まれます。事後フィルタリングは、各ユーザーが使用可能なイベントのうち関心のあるものを選択するため、ユーザー単位で実行されます。
            </p><p>
              事後フィルタリングを使用する理由:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  関心のあるイベント情報に関して、個々のユーザーの決断を避けるため。
                </p></li><li class="listitem"><p>
                  事前フィルタリングの使用に課せられる制限が前もってわからない場合に、パフォーマンススキーマを使用して、パフォーマンスの問題を調査するため。
                </p></li></ul></div></li></ul></div><p>
          次のセクションでは、事前フィルタリングの詳細を説明し、フィルタリング操作でインストゥルメントやコンシューマを指定するためのガイドラインを提供します。情報を取得するためのクエリーの書き方 (事後フィルタリング) については、<a class="xref" href="performance-schema.html#performance-schema-queries" title="22.3 パフォーマンススキーマクエリー">セクション22.3「パフォーマンススキーマクエリー」</a>を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-pre-filtering"></a>22.2.3.3 イベントの事前フィルタリング</h4></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-instrument-filtering">22.2.3.3.1 インストゥルメントによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-object-filtering">22.2.3.3.2 オブジェクトによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-thread-filtering">22.2.3.3.3 スレッドによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-consumer-filtering">22.2.3.3.4 コンシューマによる事前フィルタリング</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-consumer-configurations">22.2.3.3.5 コンシューマ構成の例</a></span></dt></dl></div><p>
          事前フィルタリングは、パフォーマンススキーマによって行われ、すべてのユーザーに適用されるグローバルな効果を持ちます。事前フィルタリングは、イベント処理のプロデューサまたはコンシューマステージに適用できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              プロデューサステージで事前フィルタリングを構成するには、いくつかのテーブルを使用できます。
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">setup_instruments</code> は使用可能なインストゥルメントを示します。このテーブルで無効にされているインストゥルメントは、ほかの生成関連セットアップテーブルの内容に関係なく、イベントを生成しません。このテーブルで有効にされているインストゥルメントは、イベントの生成が許可され、ほかのテーブルの内容に依存します。
                </p></li><li class="listitem"><p>
                  <code class="literal">setup_objects</code> は、パフォーマンススキーマが特定のテーブルオブジェクトをモニターするかどうかを制御します。
                </p></li><li class="listitem"><p>
                  <code class="literal">threads</code> スレッドは各サーバースレッドでモニタリングが有効にされているかどうかを示します。
                </p></li><li class="listitem"><p>
                  <code class="literal">setup_actors</code> は、新しいフォアグラウンドスレッドの初期モニタリング状態を決定します。
                </p></li></ul></div></li><li class="listitem"><p>
              コンシューマステージで事前フィルタリングを構成するには、<code class="literal">setup_consumers</code> テーブルを変更します。これによって、イベントの送信先が決まります。<code class="literal">setup_consumers</code> はイベント生成にも暗黙的に影響します。特定のイベントがどの宛先にも送信されない (つまり消費されない) 場合、パフォーマンススキーマはそれを生成しません。
            </p></li></ul></div><p>
          これらのいずれかのテーブルの変更は、<code class="literal">setup_actors</code> を除いて、ただちにモニタリングに影響します。<code class="literal">setup_actors</code> の変更は、変更後に作成されるフォアグラウンドスレッドにのみ影響します。
        </p><p>
          モニタリング構成を変更すると、パフォーマンススキーマは履歴テーブルをフラッシュしません。すでに収集されたイベントは、新しいイベントによって置き換えられるまで、現在のイベントと履歴テーブルに残ります。インストゥルメントを無効にする場合、それらのイベントが関心のある新しいイベントによって置き換えられるまで、しばらく待つ必要がある場合があります。または、<code class="literal">TRUNCATE TABLE</code> を使用して、履歴テーブルを空にします。
        </p><p>
          インストゥルメンテーションを変更したら、サマリーテーブルを切り捨てて、以前に収集されたイベントの集計情報をクリアする必要がある場合があります。<code class="literal">events_statements_summary_by_digest</code> を除き、サマリーテーブルの <code class="literal">TRUNCATE TABLE</code> の効果は、サマリーカラムを 0 または <code class="literal">NULL</code> にリセットすることで、行を削除することではありません。
        </p><p>
          次のセクションでは、特定のテーブルを使用して、パフォーマンススキーマの事前フィルタリングを制御する方法について説明します。
        </p><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-instrument-filtering"></a>22.2.3.3.1 インストゥルメントによる事前フィルタリング</h5></div></div></div><p>
            <code class="literal">setup_instruments</code> テーブルは使用可能なインストゥルメントを一覧表示します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments;</code></strong>
+------------------------------------------------------------+---------+-------+
| NAME                                                       | ENABLED | TIMED |
+------------------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                          | YES     | YES   |
...
| wait/synch/rwlock/sql/LOCK_grant                           | YES     | YES   |
| wait/synch/rwlock/sql/LOGGER::LOCK_logger                  | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_connect                | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_slave                  | YES     | YES   |
...
| wait/io/file/sql/binlog                                    | YES     | YES   |
| wait/io/file/sql/binlog_index                              | YES     | YES   |
| wait/io/file/sql/casetest                                  | YES     | YES   |
| wait/io/file/sql/dbopt                                     | YES     | YES   |
...
</pre><p>
            インストゥルメントを有効にするかどうかを制御するには、その <code class="literal">ENABLED</code> カラムを <code class="literal">YES</code> または <code class="literal">NO</code> に設定します。有効にされたインストゥルメントのタイミング情報を収集するかどうかを構成するには、その <code class="literal">TIMED</code> 値を <code class="literal">YES</code> または <code class="literal">NO</code> に設定します。<code class="literal">TIMED</code> カラムを設定すると、<a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 パフォーマンススキーマイベントタイミング">セクション22.2.3.1「パフォーマンススキーマイベントタイミング」</a>に説明するように、パフォーマンススキーマテーブルの内容に影響します。
          </p><p>
            <code class="literal">setup_instruments</code> テーブルへの変更はただちにモニタリングに影響します。
          </p><p>
            <code class="literal">setup_instruments</code> テーブルはイベント生成のもっとも基本的な制御の形式を提供します。モニターされるオブジェクトやスレッドの種類に基づいて、イベント生成をさらに絞り込むには、<a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 イベントの事前フィルタリング">セクション22.2.3.3「イベントの事前フィルタリング」</a>に説明するように、ほかのテーブルを使用できます。
          </p><p>
            次の例に、<code class="literal">setup_instruments</code> テーブルへの可能な操作を示します。ほかの事前フィルタリング操作と同様に、これらの変更はすべてのユーザーに影響します。これらの一部のクエリーでは、<code class="literal">LIKE</code> 演算子とパターンマッチインストゥルメント名を使用しています。インストゥルメントを選択するためのパターンの指定に関する追加情報については、<a class="xref" href="performance-schema.html#performance-schema-filtering-names" title="22.2.3.4 フィルタリング操作のインストゥルメントまたはコンシューマの指定">セクション22.2.3.4「フィルタリング操作のインストゥルメントまたはコンシューマの指定」</a>を参照してください。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                すべてのインストゥルメントを無効にします。
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO';</code></strong>
</pre><p>
                これでイベントが収集されなくなります。
              </p></li><li class="listitem"><p>
                すべてのインストゥルメントを無効にし、それらを現在の無効にされているインストゥルメントのセットに追加します。
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/file/%';</code></strong>
</pre></li><li class="listitem"><p>
                ファイルインストゥルメントのみを無効にし、ほかのすべてのインストゥルメントを有効にします。
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = IF(NAME LIKE 'wait/io/file/%', 'NO', 'YES');</code></strong>
</pre></li><li class="listitem"><p>
                <code class="literal">mysys</code> ライブラリ内のインストゥルメントを除くすべてのインストゥルメントを有効にします。
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = CASE WHEN NAME LIKE '%/mysys/%' THEN 'YES' ELSE 'NO' END;</code></strong>
</pre></li><li class="listitem"><p>
                特定のインストゥルメントを無効にします。
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/mysys/TMPDIR_mutex';</code></strong>
</pre></li><li class="listitem"><p>
                インストゥルメントの状態を切り替えるには、その <code class="literal">ENABLED</code> 値を<span class="quote">「<span class="quote">反転</span>」</span>します。
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = IF(ENABLED = 'YES', 'NO', 'YES')</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/mysys/TMPDIR_mutex';</code></strong>
</pre></li><li class="listitem"><p>
                すべてのイベントのタイミングを無効にします。
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET TIMED = 'NO';</code></strong>
</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-object-filtering"></a>22.2.3.3.2 オブジェクトによる事前フィルタリング</h5></div></div></div><p>
            <code class="literal">setup_objects</code> テーブルは、パフォーマンススキーマが特定のテーブルオブジェクトをモニターするかどうかを制御します。初期 <code class="literal">setup_objects</code> の内容は次のように見えます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_objects;</code></strong>
+-------------+--------------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA      | OBJECT_NAME | ENABLED | TIMED |
+-------------+--------------------+-------------+---------+-------+
| TABLE       | mysql              | %           | NO      | NO    |
| TABLE       | performance_schema | %           | NO      | NO    |
| TABLE       | information_schema | %           | NO      | NO    |
| TABLE       | %                  | %           | YES     | YES   |
+-------------+--------------------+-------------+---------+-------+
</pre><p>
            <code class="literal">setup_objects</code> テーブルへの変更はただちにオブジェクトモニタリングに影響します。
          </p><p>
            <code class="literal">OBJECT_TYPE</code> カラムは行が適用されるオブジェクトの種類を示します。<code class="literal">TABLE</code> フィルタリングはテーブル I/O イベント (<code class="literal">wait/io/table/sql/handler</code> インストゥルメント) およびテーブルロックイベント (<code class="literal">wait/lock/table/sql/handler</code> インストゥルメント) に影響します。
          </p><p>
            <code class="literal">OBJECT_SCHEMA</code> および <code class="literal">OBJECT_NAME</code> カラムにはリテラルのスキーマまたはテーブル名、または任意の名前に一致する <code class="literal">'%'</code> が格納されているべきです。
          </p><p>
            <code class="literal">ENABLED</code> カラムは一致するオブジェクトがモニターされているかどうかを示し、<code class="literal">TIMED</code> はタイミング情報を収集するかどうかを示します。
          </p><p>
            デフォルトのオブジェクト構成の効果は、<code class="literal">mysql</code>、<code class="literal">INFORMATION_SCHEMA</code>、および <code class="literal">performance_schema</code> データベースのテーブルを除くすべてのテーブルをインストゥルメントすることです。(<code class="literal">INFORMATION_SCHEMA</code> データベース内のテーブルは、<code class="literal">setup_objects</code> の内容に関係なくインストゥルメントされず、<code class="literal">information_schema.%</code> の行は単にこのデフォルトを明示します。)
          </p><p>
            パフォーマンススキーマは、<code class="literal">setup_objects</code> の一致をチェックする場合、まずより詳細な一致を見つけようとします。たとえば、テーブル <code class="literal">db1.t1</code> では、<code class="literal">'db1'</code> と <code class="literal">'t1'</code>、次に <code class="literal">'db1'</code> と <code class="literal">'%'</code>、次に <code class="literal">'%'</code> と <code class="literal">'%'</code> の一致を検索します。さまざまな一致する <code class="literal">setup_objects</code> 行はさまざまな <code class="literal">ENABLED</code> 値と <code class="literal">TIMED</code> 値を持つ可能性があるため、一致が発生する順序が重要です。
          </p><p>
            テーブル関連イベントの場合、パフォーマンススキーマは <code class="literal">setup_objects</code> の内容と <code class="literal">setup_instruments</code> を組み合わせて、インストゥルメントを有効にするかどうか、および有効にされているインストゥルメントの時間を測定するかどうかを判断します。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">setup_objects</code> 内の行に一致するテーブルでは、テーブルインストゥルメントは、<code class="literal">setup_instruments</code> と <code class="literal">setup_objects</code> の両方で、<code class="literal">ENABLED</code> が <code class="literal">YES</code> である場合にのみイベントを生成します。
              </p></li><li class="listitem"><p>
                両方の値が <code class="literal">YES</code> の場合にのみ、タイミング情報が収集されるように、2 つのテーブル内の <code class="literal">TIMED</code> 値が組み合わされます。
              </p></li></ul></div><p>
            <code class="literal">setup_objects</code> には、<code class="literal">db1</code>、<code class="literal">db2</code>、および <code class="literal">db3</code> に適用される次の行が含まれるとします。
          </p><pre class="programlisting">
+-------------+---------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA | OBJECT_NAME | ENABLED | TIMED |
+-------------+---------------+-------------+---------+-------+
| TABLE       | db1           | t1          | YES     | YES   |
| TABLE       | db1           | t2          | NO      | NO    |
| TABLE       | db2           | %           | YES     | YES   |
| TABLE       | db3           | %           | NO      | NO    |
| TABLE       | %             | %           | YES     | YES   |
+-------------+---------------+-------------+---------+-------+
</pre><p>
            <code class="literal">setup_instruments</code> のテーブル関連インストゥルメントに <code class="literal">NO</code> の <code class="literal">ENABLED</code> 値がある場合、オブジェクトのイベントはモニターされません。<code class="literal">ENABLED</code> 値が <code class="literal">YES</code> の場合、イベントモニタリングは、関連 <code class="literal">setup_objects</code> 行内の <code class="literal">ENABLED</code> 値に従って行われます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">db1.t1</code> イベントはモニターされます
              </p></li><li class="listitem"><p>
                <code class="literal">db1.t2</code> イベントはモニターされません
              </p></li><li class="listitem"><p>
                <code class="literal">db2.t3</code> イベントはモニターされます
              </p></li><li class="listitem"><p>
                <code class="literal">db3.t4</code> イベントはモニターされません
              </p></li><li class="listitem"><p>
                <code class="literal">db4.t5</code> イベントはモニターされます
              </p></li></ul></div><p>
            <code class="literal">setup_instruments</code> および <code class="literal">setup_objects</code> テーブルの <code class="literal">TIMED</code> カラムを組み合わせて、イベントタイミング情報を収集するかどうかを判断する場合も同様のロジックが当てはまります。
          </p><p>
            永続的テーブルと一時テーブルが同じ名前を持つ場合、<code class="literal">setup_objects</code> 行に対する照合が両方に対して同様に行われます。一方のテーブルのモニタリングを有効にして、他方を有効にしないことはできません。ただし、各テーブルは個別にインストゥルメントされます。
          </p><p>
            <code class="literal">ENABLED</code> カラムは MySQL 5.6.3 で追加されました。<code class="literal">ENABLED</code> カラムがない初期バージョンでは、<code class="literal">setup_objects</code> はテーブル内の一部の行に一致するオブジェクトのモニタリングを有効にするためにのみ使用されます。テーブルによるインストゥルメンテーションを明示的に無効にする方法はありません。
          </p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-thread-filtering"></a>22.2.3.3.3 スレッドによる事前フィルタリング</h5></div></div></div><p>
            <code class="literal">threads</code> テーブルは各サーバースレッドの行を格納します。各行は、スレッドに関する情報を格納し、それに対するモニタリングが有効にされているかどうかを示します。スレッドをモニターするパフォーマンススキーマの場合、これらのことが当てはまる必要があります。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">setup_consumers</code> テーブル内の <code class="literal">thread_instrumentation</code> コンシューマは <code class="literal">YES</code> である必要があります。
              </p></li><li class="listitem"><p>
                <code class="literal">thread.INSTRUMENTED</code> カラムは <code class="literal">YES</code> である必要があります。
              </p></li><li class="listitem"><p>
                <code class="literal">setup_instruments</code> テーブル内で有効にされているインストゥルメントから生成されたスレッドイベントに対してのみ、モニタリングが行われます。
              </p></li></ul></div><p>
            <code class="literal">threads</code> テーブルの <code class="literal">INSTRUMENTED</code> カラムは各スレッドのモニタリング状態を示します。フォアグラウンドスレッド (クライアント接続の結果) では、初期 <code class="literal">INSTRUMENTED</code> 値は、スレッドに関連付けられているユーザーアカウントが <code class="literal">setup_actors</code> テーブル内のいずれかの行に一致するかどうかによって決定されます。バックグラウンドスレッドの場合、<code class="literal">INSTRUMENTED</code> はデフォルトで <code class="literal">YES</code> で、バックグラウンドスレッドに関連付けられたユーザーはないため、<code class="literal">setup_actors</code> は参照されません。どのスレッドでも、スレッドの有効期間の間にその <code class="literal">INSTRUMENTED</code> 値が変更されることがあります。
          </p><p>
            初期 <code class="literal">setup_actors</code> の内容は次のように見えます。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_actors;</code></strong>
+------+------+------+
| HOST | USER | ROLE |
+------+------+------+
| %    | %    | %    |
+------+------+------+
</pre><p>
            パフォーマンススキーマは <code class="literal">HOST</code> および <code class="literal">USER</code> カラムを使用し、新しい各フォアグラウンドスレッドと照合します。(<code class="literal">ROLE</code> は使用されません。)いずれかの行が一致した場合、スレッドの <code class="literal">INSTRUMENTED</code> 値は <code class="literal">YES</code> になり、それ以外の場合 <code class="literal">NO</code> になります。これにより、ホスト、ユーザー、またはホストとユーザーの組み合わせごとに、インストゥルメントが選択して適用されます。
          </p><p>
            <code class="literal">HOST</code> および <code class="literal">USER</code> カラムにはリテラルのホストまたはユーザー名、または任意の名前に一致する <code class="literal">'%'</code> が格納されているべきです。<code class="literal">setup_actors</code> テーブルには最初に <code class="literal">HOST</code> と <code class="literal">USER</code> のどちらにも <code class="literal">'%'</code> を含む行が格納されるため、デフォルトで、モニタリングはすべての新しいフォアグラウンドスレッドに対して有効にされます。一部のフォアグラウンドスレッドにのみモニタリングを有効にするなど、限定された照合を実行するには、この行はいずれかの接続に一致するため、これを削除する必要があります。
          </p><p>
            次のように <code class="literal">setup_actors</code> を変更するとします。
          </p><pre class="programlisting">
DELETE FROM setup_actors;
</pre><p>
            現在 <code class="literal">setup_actors</code> は空であるため、着信接続に一致する可能性のある行はありません。したがって、パフォーマンススキーマは、新しいすべてのフォアグラウンドスレッドの <code class="literal">INSTRUMENTED</code> カラムを <code class="literal">NO</code> に設定します。
          </p><p>
            さらに <code class="literal">setup_actors</code> を変更するとします。
          </p><pre class="programlisting">
INSERT INTO setup_actors (HOST,USER,ROLE) VALUES('localhost','joe','%');
INSERT INTO setup_actors (HOST,USER,ROLE) VALUES('%','sam','%');
</pre><p>
            ここで、パフォーマンススキーマは、次のように新しい接続スレッドの <code class="literal">INSTRUMENTED</code> 値の設定方法を判断します。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">joe</code> がローカルホストから接続する場合、接続は最初に挿入された行に一致します。
              </p></li><li class="listitem"><p>
                <code class="literal">joe</code> がほかのすべてのホストから接続する場合、一致はありません。
              </p></li><li class="listitem"><p>
                <code class="literal">sam</code> が任意のホストから接続する場合、接続は 2 番目に挿入された行に一致します。
              </p></li><li class="listitem"><p>
                ほかのすべての接続の場合、一致はありません。
              </p></li></ul></div><p>
            <code class="literal">setup_actors</code> テーブルへの変更は既存のスレッドに影響しません。
          </p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-consumer-filtering"></a>22.2.3.3.4 コンシューマによる事前フィルタリング</h5></div></div></div><p>
            <code class="literal">setup_consumers</code> テーブルは使用可能なコンシューマの種類とどれが有効にされているかを一覧表示します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_stages_current          | NO      |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| events_waits_current           | NO      |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
            コンシューマステージで、事前フィルタリングに影響するように、<code class="literal">setup_consumers</code> テーブルを変更し、イベントの送信先を決定します。コンシューマを有効または無効にするには、その <code class="literal">ENABLED</code> 値を <code class="literal">YES</code> または <code class="literal">NO</code> に設定します。
          </p><p>
            <code class="literal">setup_consumers</code> テーブルへの変更はただちにモニタリングに影響します。
          </p><p>
            コンシューマを無効にすると、サーバーはそのコンシューマの宛先の保守に時間を費やさなくなります。たとえば、履歴イベント情報に関心がない場合、履歴コンシューマを無効にします。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO' WHERE NAME LIKE '%history%';</code></strong>
</pre><p>
            <code class="literal">setup_consumers</code> テーブル内のコンシューマ設定は、高いレベルから低いレベルまでの階層を形成します。次の原則が当てはまります。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                パフォーマンススキーマがコンシューマをチェックし、コンシューマが有効にされていないかぎり、コンシューマに関連付けられている宛先はイベントを受信しません。
              </p></li><li class="listitem"><p>
                コンシューマは、それが依存するすべてのコンシューマ (ある場合) が有効にされている場合にのみチェックされます。
              </p></li><li class="listitem"><p>
                コンシューマがチェックされていない場合、またはチェックされているが無効にされている場合、それに依存するほかのコンシューマはチェックされません。
              </p></li><li class="listitem"><p>
                依存コンシューマには独自の依存コンシューマがあることがあります。
              </p></li><li class="listitem"><p>
                イベントがどの宛先にも送信されない場合、パフォーマンススキーマはそれを生成しません。
              </p></li></ul></div><p>
            次のリストに、使用可能なコンシューマ値を説明します。いくつかの代表的なコンシューマ構成とそれらのインストゥルメンテーションへの効果については、<a class="xref" href="performance-schema.html#performance-schema-consumer-configurations" title="22.2.3.3.5 コンシューマ構成の例">セクション22.2.3.3.5「コンシューマ構成の例」</a>を参照してください。
          </p><p>
            <span class="bold"><strong>グローバルおよびスレッドコンシューマ</strong></span>
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">global_instrumentation</code> は最高レベルのコンシューマです。<code class="literal">global_instrumentation</code> が <code class="literal">NO</code> の場合、それはグローバルインストゥルメンテーションを無効にします。ほかのすべての設定は低いレベルで、チェックされず、何が設定されているかは重要でありません。グローバルまたはスレッドごとに情報が保守されず、個々のイベントが現在のイベントまたはイベント履歴テーブルに収集されません。<code class="literal">global_instrumentation</code> が <code class="literal">YES</code> の場合、パフォーマンススキーマはグローバル状態の情報を保守し、<code class="literal">thread_instrumentation</code> コンシューマもチェックします。
              </p></li><li class="listitem"><p>
                <code class="literal">thread_instrumentation</code> は <code class="literal">global_instrumentation</code> が <code class="literal">YES</code> の場合のみチェックされます。そうでなければ、<code class="literal">thread_instrumentation</code> が <code class="literal">NO</code> の場合、スレッド固有のインストゥルメンテーションが無効になり、すべての低レベル設定が無視されます。スレッドごとに情報が保守されず、個々のイベントが現在のイベントまたはイベント履歴テーブルに収集されません。<code class="literal">thread_instrumentation</code> が <code class="literal">YES</code> の場合、パフォーマンススキーマはスレッド固有の情報を保守し、<code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code> コンシューマもチェックします。
              </p></li></ul></div><p>
            <span class="bold"><strong>ステートメントダイジェストコンシューマ</strong></span>
          </p><p>
            このコンシューマは <code class="literal">global_instrumentation</code> が <code class="literal">YES</code> である必要があり、そうでないとそれはチェックされません。ステートメントイベントコンシューマへの依存関係がないため、<code class="literal">events_statements_current</code> に統計を収集する必要なく、ダイジェストごとに統計を取得することができ、これはオーバーヘッドの点で有利です。逆に、ダイジェストなしで、<code class="literal">events_statements_current</code> で詳細ステートメントを取得できます (<code class="literal">DIGEST</code> および <code class="literal">DIGEST_TEXT</code> カラムは <code class="literal">NULL</code> になります)。
          </p><p>
            <span class="bold"><strong>待機イベントコンシューマ</strong></span>
          </p><p>
            これらのコンシューマには <code class="literal">global_instrumentation</code> と <code class="literal">thread_instrumentation</code> の両方が <code class="literal">YES</code> である必要があり、そうでないと、それらはチェックされません。チェックされた場合、それらは次のように動作します。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_waits_current</code>は <code class="literal">NO</code> の場合、<code class="literal">events_waits_current</code> テーブル内の個々の待機イベントの収集を無効にします。<code class="literal">YES</code> の場合、待機イベント収集を有効にし、パフォーマンススキーマは <code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> コンシューマをチェックします。
              </p></li><li class="listitem"><p>
                <code class="literal">events_waits_history</code> は <code class="literal">event_waits_current</code> が <code class="literal">NO</code> の場合にチェックされません。そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_waits_history</code> 値は、<code class="literal">events_waits_history</code> テーブルへの待機イベントの収集を無効または有効にします。
              </p></li><li class="listitem"><p>
                <code class="literal">events_waits_history_long</code> は <code class="literal">event_waits_current</code> が <code class="literal">NO</code> の場合にチェックされません。そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_waits_history_long</code> 値は、<code class="literal">events_waits_history_long</code> テーブルへの待機イベントの収集を無効または有効にします。
              </p></li></ul></div><p>
            <span class="bold"><strong>ステージイベントコンシューマ</strong></span>
          </p><p>
            これらのコンシューマには <code class="literal">global_instrumentation</code> と <code class="literal">thread_instrumentation</code> の両方が <code class="literal">YES</code> である必要があり、そうでないと、それらはチェックされません。チェックされた場合、それらは次のように動作します。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_stages_current</code>は、<code class="literal">NO</code> の場合に、<code class="literal">events_stages_current</code> テーブルへの個々のステージイベントの収集を無効にします。<code class="literal">YES</code> の場合、ステージイベント収集を有効にし、パフォーマンススキーマは <code class="literal">events_stages_history</code> および <code class="literal">events_stages_history_long</code> コンシューマをチェックします。
              </p></li><li class="listitem"><p>
                <code class="literal">events_stages_history</code> は <code class="literal">event_stages_current</code> が <code class="literal">NO</code> の場合にチェックされません。そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_stages_history</code> 値は、<code class="literal">events_stages_history</code> テーブルへのステージイベントの収集を無効または有効にします。
              </p></li><li class="listitem"><p>
                <code class="literal">events_stages_history_long</code> は <code class="literal">event_stages_current</code> が <code class="literal">NO</code> の場合にチェックされません。そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_stages_history_long</code> 値は、<code class="literal">events_stages_history_long</code> テーブルへのステージイベントの収集を無効または有効にします。
              </p></li></ul></div><p>
            <span class="bold"><strong>ステートメントイベントコンシューマ</strong></span>
          </p><p>
            これらのコンシューマには <code class="literal">global_instrumentation</code> と <code class="literal">thread_instrumentation</code> の両方が <code class="literal">YES</code> である必要があり、そうでないと、それらはチェックされません。チェックされた場合、それらは次のように動作します。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_statements_current</code>は <code class="literal">NO</code> の場合、<code class="literal">events_statements_current</code> テーブルへの個々のステートメントイベントの収集を無効にします。<code class="literal">YES</code> の場合、ステートメントイベント収集を有効にし、パフォーマンススキーマは <code class="literal">events_statements_history</code> および <code class="literal">events_statements_history_long</code> コンシューマをチェックします。
              </p></li><li class="listitem"><p>
                <code class="literal">events_statements_history</code> は <code class="literal">events_statements_current</code> が <code class="literal">NO</code> の場合にチェックされません。そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_statements_history</code> 値は、<code class="literal">events_statements_history</code> テーブルへのステートメントイベントの収集を無効または有効にします。
              </p></li><li class="listitem"><p>
                <code class="literal">events_statements_history_long</code> は <code class="literal">events_statements_current</code> が <code class="literal">NO</code> の場合にチェックされません。そうでない場合、<code class="literal">NO</code> または <code class="literal">YES</code> の <code class="literal">events_statements_history_long</code> 値は、<code class="literal">events_statements_history_long</code> テーブルへのステートメントイベントの収集を無効または有効にします。
              </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="performance-schema-consumer-configurations"></a>22.2.3.3.5 コンシューマ構成の例</h5></div></div></div><p>
            <code class="literal">setup_consumers</code> テーブル内のコンシューマ設定は、高いレベルから低いレベルまでの階層を形成します。次の説明では、コンシューマのしくみを説明し、コンシューマ設定が高から低に段階に有効にされたときの特定の構成とそれらの効果を示します。示されているコンシューマ値は代表的なものです。ここで説明する一般原則は、使用可能なほかのコンシューマ値に当てはまります。
          </p><p>
            構成の説明は、機能とオーバーヘッドが増加する順番で示しています。低レベルの設定を有効にして提供される情報が必要でない場合は、それらを無効にすると、パフォーマンススキーマがユーザーのために実行するコードが少なくなり、ユーザーが取捨選択する情報が少なくなります。
          </p><p>
            <code class="literal">setup_consumers</code> テーブルには次の値の階層が格納されます。
          </p><pre class="programlisting">
global_instrumentation
 thread_instrumentation
   events_waits_current
     events_waits_history
     events_waits_history_long
   events_stages_current
     events_stages_history
     events_stages_history_long
   events_statements_current
     events_statements_history
     events_statements_history_long
 statements_digest
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
              コンシューマ階層で、待機、ステージ、およびステートメントのコンシューマはすべて同じレベルになります。これは、待機イベントがステージイベント内にネストし、ステージイベントがステートメントイベント内にネストするイベントネスト階層とは異なります。
            </p></div><p>
            特定のコンシューマ設定が <code class="literal">NO</code> の場合、パフォーマンススキーマはコンシューマに関連付けられたインストゥルメンテーションを無効にし、すべての低レベルの設定を無視します。特定の設定が <code class="literal">YES</code> の場合、パフォーマンススキーマはそれに関連付けられたインストゥルメンテーションを有効にし、次の最低レベルの設定をチェックします。各コンシューマのルールの説明については、<a class="xref" href="performance-schema.html#performance-schema-consumer-filtering" title="22.2.3.3.4 コンシューマによる事前フィルタリング">セクション22.2.3.3.4「コンシューマによる事前フィルタリング」</a>を参照してください。
          </p><p>
            たとえば、<code class="literal">global_instrumentation</code> が有効にされている場合、<code class="literal">thread_instrumentation</code> がチェックされます。<code class="literal">thread_instrumentation</code> が有効にされている場合、<code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code> コンシューマがチェックされます。これらのうち <code class="literal">events_waits_current</code> が有効にされている場合、<code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> がチェックされます。
          </p><p>
            次の構成の各説明は、パフォーマンススキーマがチェックするセットアップ要素と、それが保守する出力テーブル (つまり、それが情報を収集するテーブル) を示します。
          </p><h6><a name="idm139979008104656"></a>インストゥルメンテーションなし</h6><p>
            サーバー構成の状態:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| global_instrumentation    | NO      |
...
+---------------------------+---------+
</pre><p>
            この構成では、何もインストゥルメントされません。
          </p><p>
            チェックされるセットアップ要素:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                テーブル <code class="literal">setup_consumers</code>、コンシューマ <code class="literal">global_instrumentation</code>
              </p></li></ul></div><p>
            保守される出力テーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                なし
              </p></li></ul></div><h6><a name="idm139979008096000"></a>グローバルインストゥルメンテーションのみ</h6><p>
            サーバー構成の状態:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| global_instrumentation    | YES     |
| thread_instrumentation    | NO      |
...
+---------------------------+---------+
</pre><p>
            この構成では、インストゥルメンテーションがグローバル状態に対してのみ保守されます。スレッドごとのインストゥルメンテーションは無効にされます。
          </p><p>
            先述の構成に関連して、チェックされる追加のセットアップ要素:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                テーブル <code class="literal">setup_consumers</code>、コンシューマ <code class="literal">thread_instrumentation</code>
              </p></li><li class="listitem"><p>
                テーブル <code class="literal">setup_instruments</code>
              </p></li><li class="listitem"><p>
                テーブル <code class="literal">setup_objects</code>
              </p></li><li class="listitem"><p>
                テーブル <code class="literal">setup_timers</code>
              </p></li></ul></div><p>
            先述の構成に関連して保守される追加の出力テーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">mutex_instances</code>
              </p></li><li class="listitem"><p>
                <code class="literal">rwlock_instances</code>
              </p></li><li class="listitem"><p>
                <code class="literal">cond_instances</code>
              </p></li><li class="listitem"><p>
                <code class="literal">file_instances</code>
              </p></li><li class="listitem"><p>
                <code class="literal">users</code>
              </p></li><li class="listitem"><p>
                <code class="literal">hosts</code>
              </p></li><li class="listitem"><p>
                <code class="literal">accounts</code>
              </p></li><li class="listitem"><p>
                <code class="literal">socket_summary_by_event_name</code>
              </p></li><li class="listitem"><p>
                <code class="literal">file_summary_by_instance</code>
              </p></li><li class="listitem"><p>
                <code class="literal">file_summary_by_event_name</code>
              </p></li><li class="listitem"><p>
                <code class="literal">objects_summary_global_by_type</code>
              </p></li><li class="listitem"><p>
                <code class="literal">table_lock_waits_summary_by_table</code>
              </p></li><li class="listitem"><p>
                <code class="literal">table_io_waits_summary_by_index_usage</code>
              </p></li><li class="listitem"><p>
                <code class="literal">table_io_waits_summary_by_table</code>
              </p></li><li class="listitem"><p>
                <code class="literal">events_waits_summary_by_instance</code>
              </p></li><li class="listitem"><p>
                <code class="literal">events_waits_summary_global_by_event_name</code>
              </p></li><li class="listitem"><p>
                <code class="literal">events_stages_summary_global_by_event_name</code>
              </p></li><li class="listitem"><p>
                <code class="literal">events_statements_summary_global_by_event_name</code>
              </p></li></ul></div><h6><a name="idm139979008051632"></a>グローバルおよびスレッドインストゥルメンテーションのみ</h6><p>
            サーバー構成の状態:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | NO      |
...
| events_stages_current          | NO      |
...
| events_statements_current      | YES     |
...
+--------------------------------+---------+
</pre><p>
            この構成では、インストゥルメンテーションがグローバルおよびスレッドごとに保守されます。現在のイベントまたはイベント履歴テーブルで、個々のイベントは収集されません。
          </p><p>
            先述の構成に関連して、チェックされる追加のセットアップ要素:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                テーブル <code class="literal">setup_consumers</code>、コンシューマ <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> です
              </p></li><li class="listitem"><p>
                テーブル <code class="literal">setup_actors</code>
              </p></li><li class="listitem"><p>
                カラム <code class="literal">threads.instrumented</code>
              </p></li></ul></div><p>
            先述の構成に関連して保守される追加の出力テーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_summary_by_<em class="replaceable"><code>yyy</code></em>_by_event_name</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> で、および <em class="replaceable"><code>yyy</code></em> は <code class="literal">thread</code>、<code class="literal">user</code>、<code class="literal">host</code>、<code class="literal">account</code> です
              </p></li></ul></div><h6><a name="idm139979008028368"></a>グローバル、スレッド、および現在のイベントインストゥルメンテーション</h6><p>
            サーバー構成の状態:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | YES     |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| events_stages_current          | YES     |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
...
+--------------------------------+---------+
</pre><p>
            この構成では、インストゥルメンテーションがグローバルおよびスレッドごとに保守されます。個々のイベントが現在のイベントテーブルに収集されますが、イベント履歴テーブルには収集されません。
          </p><p>
            先述の構成に関連して、チェックされる追加のセットアップ要素:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                コンシューマ <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> です
              </p></li><li class="listitem"><p>
                コンシューマ <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> です
              </p></li></ul></div><p>
            先述の構成に関連して保守される追加の出力テーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> です
              </p></li></ul></div><h6><a name="idm139979008008208"></a>グローバル、スレッド、現在のイベント、およびイベント履歴インストゥルメンテーション</h6><p>
            <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code> および <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code> コンシューマは無効にされているため、先述の構成はイベント履歴を収集しません。それらのコンシューマは個別またはまとめて有効にして、スレッドごと、グローバルに、またはその両方でイベント履歴を収集できます。
          </p><p>
            この構成はスレッドごとにイベントを収集しますが、グローバルには収集しません。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | YES     |
| events_waits_history           | YES     |
| events_waits_history_long      | NO      |
| events_stages_current          | YES     |
| events_stages_history          | YES     |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | YES     |
| events_statements_history_long | NO      |
...
+--------------------------------+---------+
</pre><p>
            この構成で保守されるイベント履歴テーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> です
              </p></li></ul></div><p>
            この構成はグローバルにイベント履歴を収集しますが、スレッドごとには収集しません。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | YES     |
| events_waits_history           | NO      |
| events_waits_history_long      | YES     |
| events_stages_current          | YES     |
| events_stages_history          | NO      |
| events_stages_history_long     | YES     |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | YES     |
...
+--------------------------------+---------+
</pre><p>
            この構成で保守されるイベント履歴テーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> です
              </p></li></ul></div><p>
            この構成はスレッドごとおよびグローバルにイベントを収集します。
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | YES     |
| events_waits_history           | YES     |
| events_waits_history_long      | YES     |
| events_stages_current          | YES     |
| events_stages_history          | YES     |
| events_stages_history_long     | YES     |
| events_statements_current      | YES     |
| events_statements_history      | YES     |
| events_statements_history_long | YES     |
...
+--------------------------------+---------+
</pre><p>
            この構成で保守されるイベント履歴テーブル:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> です
              </p></li><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、<code class="literal">statements</code> です
              </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-filtering-names"></a>22.2.3.4 フィルタリング操作のインストゥルメントまたはコンシューマの指定</h4></div></div></div><p>
          フィルタリング操作に指定する名前は、必要に応じて具体的なものでも一般的なものでも指定できます。単一のインストゥルメントまたはコンシューマを示すには、その名前を省略せずに指定します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/myisammrg/MYRG_INFO::mutex';</code></strong>

mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO' WHERE NAME = 'events_waits_current';</code></strong>
</pre><p>
          インストゥルメントまたはコンシューマのグループを指定するには、グループメンバーに一致するパターンを使用します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'wait/synch/mutex/%';</code></strong>

mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO' WHERE NAME LIKE '%history%';</code></strong>
</pre><p>
          パターンを使用する場合、それは関心のあるすべての項目に一致し、ほかの項目に一致しないように、選択してください。たとえば、すべてのファイル I/O インストゥルメントを選択するには、インストゥルメント名プリフィクス全体を含むパターンを使用することをお勧めします。
        </p><pre class="programlisting">
... WHERE NAME LIKE 'wait/io/file/%';
</pre><p>
          <code class="literal">'%/file/%'</code> のパターンは、名前の任意の位置に <code class="literal">'/file/'</code> のコンポーネントがあるほかのインストゥルメントに一致します。パターン <code class="literal">'%file%'</code> は <code class="literal">wait/synch/mutex/sql/LOCK_des_key_file</code> など、名前の任意の位置に <code class="literal">'file'</code> のあるインストゥルメントに一致するため、あまり適切ではありません。
        </p><p>
          パターンに一致するインストゥルメントまたはコンシューマ名をチェックするには、簡単なテストを実行します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NAME FROM setup_instruments WHERE NAME LIKE '<em class="replaceable"><code>pattern</code></em>';</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT NAME FROM setup_consumers WHERE NAME LIKE '<em class="replaceable"><code>pattern</code></em>';</code></strong>
</pre><p>
          サポートされる名前の種類については、<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 パフォーマンススキーマインストゥルメント命名規則">セクション22.4「パフォーマンススキーマインストゥルメント命名規則」</a>を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-schema-instrumentation-checking"></a>22.2.3.5 インストゥルメントされているものの特定</h4></div></div></div><p>
          パフォーマンススキーマにどのインストゥルメントが含まれているかを特定するには、常に <code class="literal">setup_instruments</code> テーブルをチェックすることで可能です。たとえば、<code class="literal">InnoDB</code> ストレージエンジンに、どのファイル関連イベントがインストゥルメントされているかを確認するには、次のクエリーを使用します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE NAME LIKE 'wait/io/file/innodb/%';</code></strong>
+--------------------------------------+---------+-------+
| NAME                                 | ENABLED | TIMED |
+--------------------------------------+---------+-------+
| wait/io/file/innodb/innodb_data_file | YES     | YES   |
| wait/io/file/innodb/innodb_log_file  | YES     | YES   |
| wait/io/file/innodb/innodb_temp_file | YES     | YES   |
+--------------------------------------+---------+-------+
</pre><p>
          このドキュメントでは、いくつかの理由で、正確に何がインストゥルメントされるかについて詳細に説明していません。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              何がインストゥルメントされるかは、サーバーコードです。このコードへの変更は頻繁に行われ、インストゥルメントのセットにも影響します。
            </p></li><li class="listitem"><p>
              すべてのインストゥルメントは数百もあるため、それらを挙げることは現実的ではありません。
            </p></li><li class="listitem"><p>
              先述のように、<code class="literal">setup_instruments</code> テーブルをクエリーすることによって見つけることができます。この情報は使用している MySQL のバージョンに常に最新であり、コアサーバーに含まれておらず、自動化されたツールで使用可能な、インストールしている可能性があるインストゥルメント済みのプラグインのインストゥルメンテーションも含みます。
            </p></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-queries"></a>22.3 パフォーマンススキーマクエリー</h2></div></div></div><p>
      事前フィルタリングは収集されるイベント情報を制限し、特定のユーザーと関係ありません。対照的に、事後フィルタリングは、各ユーザーが、事前フィルタリングの適用後に使用可能なイベントから選択するイベント情報を制限する、適切な <code class="literal">WHERE</code> 句でクエリーを使用することによって実行されます。
    </p><p>
      <a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 イベントの事前フィルタリング">セクション22.2.3.3「イベントの事前フィルタリング」</a>で、ファイルインストゥルメントの事前フィルタリング方法の例を示しました。イベントテーブルにファイルと非ファイルの両方の情報が格納されている場合、事後フィルタリングはファイルイベントのみの情報を表示するもう 1 つの方法です。イベント選択を適切に制限するには、クエリーに <code class="literal">WHERE</code> 句を追加します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT THREAD_ID, NUMBER_OF_BYTES</code></strong>
    -&gt; <strong class="userinput"><code>FROM events_waits_history</code></strong>
    -&gt; <strong class="userinput"><code>WHERE EVENT_NAME LIKE 'wait/io/file/%'</code></strong>
    -&gt; <strong class="userinput"><code>AND NUMBER_OF_BYTES IS NOT NULL;</code></strong>
+-----------+-----------------+
| THREAD_ID | NUMBER_OF_BYTES |
+-----------+-----------------+
|        11 |              66 |
|        11 |              47 |
|        11 |             139 |
|         5 |              24 |
|         5 |             834 |
+-----------+-----------------+
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-instrument-naming"></a>22.4 パフォーマンススキーマインストゥルメント命名規則</h2></div></div></div><p>
      インストゥルメント名は <code class="literal">'/'</code> 文字で区切られた一連のコンポーネントから構成されます。名前の例:
    </p><pre class="programlisting">
wait/io/file/myisam/log
wait/io/file/mysys/charset
wait/lock/table/sql/handler
wait/synch/cond/mysys/COND_alarm
wait/synch/cond/sql/BINLOG::update_cond
wait/synch/mutex/mysys/BITMAP_mutex
wait/synch/mutex/sql/LOCK_delete
wait/synch/rwlock/sql/Query_cache_query::lock
stage/sql/closing tables
stage/sql/Sorting result
statement/com/Execute
statement/com/Query
statement/sql/create_table
statement/sql/lock_tables
</pre><p>
      インストゥルメントの名前空間はツリー状の構造を持ちます。インストゥルメント名のコンポーネントは左から右に、より一般的からより具体的に進みます。名前のコンポーネント数はインストゥルメントの種類によって異なります。
    </p><p>
      名前の特定のコンポーネントの解釈は、その左側のコンポーネントによって異なります。たとえば、<code class="literal">myisam</code> は次の名前の両方に見られますが、最初の名前の <code class="literal">myisam</code> はファイル I/O に関連し、2 番目のそれは同期インストゥルメントに関連しています。
    </p><pre class="programlisting">
wait/io/file/myisam/log
wait/synch/cond/myisam/MI_SORT_INFO::cond
</pre><p>
      インストゥルメント名は、パフォーマンススキーマ実装によって定義された構造を持つプリフィクスと、インストゥルメントコードを実装する開発者によって定義されるサフィクスから構成されます。インストゥルメントプリフィクスのトップレベルコンポーネントはインストゥルメントの種類を示します。このコンポーネントによって、インストゥルメントに適用される <code class="literal">setup_timers</code> テーブル内のイベントタイマーも決まります。インストゥルメントのプリフィクス部分のトップレベルはインストゥルメントの種類を示します。
    </p><p>
      インストゥルメント名のサフィクス部分は、インストゥルメント自体のコードから生成されます。サフィクスには次のようなレベルが含まれることがあります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          主要コンポーネントの名前 (<code class="literal">myisam</code>、<code class="literal">innodb</code>、<code class="literal">mysys</code>、または <code class="literal">sql</code> などのサーバーモジュール) またはプラグイン名。
        </p></li><li class="listitem"><p>
          形式 <em class="replaceable"><code>XXX</code></em> (グローバル変数) または <code class="literal"><em class="replaceable"><code>CCC</code></em>::<em class="replaceable"><code>MMM</code></em></code> (クラス <em class="replaceable"><code>CCC</code></em> のメンバー <em class="replaceable"><code>MMM</code></em>) でのコード内の変数の名前。例: <code class="literal">COND_thread_cache</code>、<code class="literal">THR_LOCK_myisam</code>、<code class="literal">BINLOG::LOCK_index</code>。
        </p></li></ul></div><p>
      <span class="bold"><strong>トップレベルインストゥルメントコンポーネント</strong></span>
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">idle</code>: インストゥルメントされたアイドルイベント。このインストゥルメントにはそれ以上のコンポーネントがありません。
        </p></li><li class="listitem"><p>
          <code class="literal">stage</code>: インストゥルメントされたステージイベント。
        </p></li><li class="listitem"><p>
          <code class="literal">statement</code>: インストゥルメントされたステートメントイベント。
        </p></li><li class="listitem"><p>
          <code class="literal">wait</code>: インストゥルメントされた待機イベント。
        </p></li></ul></div><p>
      <span class="bold"><strong>アイドルインストゥルメントコンポーネント</strong></span>
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">idle</code>
        </p><p>
          アイドルインストゥルメント。パフォーマンススキーマは、<a class="xref" href="performance-schema.html#socket-instances-table" title="22.9.3.5 socket_instances テーブル">セクション22.9.3.5「socket_instances テーブル」</a>の <code class="literal">socket_instances.STATE</code> カラムの説明に示されているように、アイドルイベントを生成します。
        </p></li></ul></div><p>
      <span class="bold"><strong>ステージインストゥルメントコンポーネント</strong></span>
    </p><p>
      ステージインストゥルメントは、形式 <code class="literal">stage/<em class="replaceable"><code>code_area</code></em>/<em class="replaceable"><code>stage_name</code></em></code> の名前を持ちます。ここで <em class="replaceable"><code>code_area</code></em> は <code class="literal">sql</code> や <code class="literal">myisam</code> などの名前で、<em class="replaceable"><code>stage_name</code></em> は、<code class="literal">Sorting result</code> や <code class="literal">Sending data</code> などのステートメント処理のステージを示します。ステージは <code class="literal">SHOW PROCESSLIST</code> によって表示されるか、または <code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> テーブルに表示されるスレッドの状態に対応します。
    </p><p>
      <span class="bold"><strong>ステートメントインストゥルメントコンポーネント</strong></span>
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">statement/abstract/*</code>: ステートメント操作の抽象インストゥルメント。抽象インストゥルメントは、正確なステートメントの種類が分かる前のステートメント分類の初期段階時に使用され、その後種類がわかったときに、より具体的なステートメントインストゥルメントに変更されます。このプロセスの説明については、<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 パフォーマンススキーマステートメントイベントテーブル">セクション22.9.6「パフォーマンススキーマステートメントイベントテーブル」</a>を参照してください。
        </p></li><li class="listitem"><p>
          <code class="literal">statement/com</code>: インストゥルメントされたコマンド操作。これらは <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code> 操作に対応する名前を持ちます (<code class="filename">mysql_com.h</code> ヘッダーファイルおよび <code class="filename">sql/sql_parse.cc</code> を参照してください。たとえば、<code class="literal">statement/com/Connect</code> および <code class="literal">statement/com/Init DB</code> インストゥルメントは <code class="literal">COM_CONNECT</code> および <code class="literal">COM_INIT_DB</code> コマンドに対応します。
        </p></li><li class="listitem"><p>
          <code class="literal">statement/sql</code>: インストゥルメントされた SQL ステートメント操作。たとえば、<code class="literal">statement/sql/create_db</code> および <code class="literal">statement/sql/select</code> インストゥルメントは <code class="literal">CREATE DATABASE</code> および <code class="literal">SELECT</code> ステートメントに使用されます。
        </p></li></ul></div><p>
      <span class="bold"><strong>待機インストゥルメントコンポーネント</strong></span>
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">wait/io</code>
        </p><p>
          インストゥルメントされた I/O 操作。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">wait/io/file</code>
            </p><p>
              インストゥルメントされたファイル I/O 操作。ファイルの場合、待機はファイル操作の完了 (たとえば、<code class="literal">fwrite()</code> の呼び出し) を待機する時間です。キャッシュのため、この呼び出し内で、ディスクへの物理的なファイル I/O は行われない可能性があります。
            </p></li><li class="listitem"><p>
              <code class="literal">wait/io/socket</code>
            </p><p>
              インストゥルメントされたソケット操作。ソケットインストゥルメントは形式 <code class="literal">wait/io/socket/sql/<em class="replaceable"><code>socket_type</code></em></code>　の名前を持ちます。サーバーには、それがサポートする各ネットワークプロトコルの待機ソケットがあります。TCP/IP または Unix ソケットファイル接続の待機ソケットに関連付けられているインストゥルメントは、それぞれ <code class="literal">server_tcpip_socket</code> または <code class="literal">server_unix_socket</code> の <em class="replaceable"><code>socket_type</code></em> 値を持ちます。待機ソケットが接続を検出すると、サーバーは接続を、個別のスレッドによって管理される新しいソケットに転送します。新しい接続スレッドのインストゥルメントは、<code class="literal">client_connection</code> の <em class="replaceable"><code>socket_type</code></em> 値を持ちます。
            </p></li><li class="listitem"><p>
              <code class="literal">wait/io/table</code>
            </p><p>
              インストゥルメントされたテーブル I/O 操作。これらには、永続的ベーステーブルまたは一時テーブルへの行レベルアクセスが含まれます。行に影響する操作は、フェッチ、挿入、更新、および削除です。ビューの場合、待機はビューによって参照されるベーステーブルに関連付けられます。
            </p><p>
              ほとんどの待機と同様、テーブル I/O の待機にはほかの待機も含まれることがあります。たとえば、テーブル I/O にはファイル I/O またはメモリー操作が含まれることがあります。そのため、テーブル I/O 待機の <code class="literal">events_waits_current</code> には通常 2 行あります。詳細については、<a class="xref" href="performance-schema.html#performance-schema-atom-molecule-events" title="22.6 パフォーマンススキーマの原子的および分子的イベント">セクション22.6「パフォーマンススキーマの原子的および分子的イベント」</a>を参照してください。
            </p><p>
              一部の行操作では、複数のテーブル I/O 待機が発生することがあります。たとえば、挿入は更新を発生させるトリガーをアクティブにすることがあります。
            </p></li></ul></div></li><li class="listitem"><p>
          <code class="literal">wait/lock</code>
        </p><p>
          インストゥルメントされたロック操作。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">wait/lock/table</code>
            </p><p>
              インストゥルメントされたテーブルロック操作。
            </p></li></ul></div></li><li class="listitem"><p>
          <code class="literal">wait/synch</code>
        </p><p>
          インストゥルメントされた同期オブジェクト。同期オブジェクトでは、<code class="literal">TIMER_WAIT</code> 時間には、オブジェクトへのロックがある場合に、その獲得を試みている間のブロックされる時間の量が含まれます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">wait/synch/cond</code>
            </p><p>
              条件は、1 つのスレッドによって、ほかのスレッドに、それらが待機している何かが発生したことを伝えるために使用されます。単一のスレッドが条件を待機していた場合、それはウェイクアップし、その実行を再開できます。複数のスレッドが待機していた場合、それらすべてがウェイクアップし、それらが待機していたリソースを奪い合うことがあります。
            </p></li><li class="listitem"><p>
              <code class="literal">wait/synch/mutex</code>
            </p><p>
              ほかのスレッドのリソースへのアクセスを妨げながら、リソース (実行可能コードのセクションなど) へのアクセスを許可するために使用される相互排他オブジェクト。
            </p></li><li class="listitem"><p>
              <code class="literal">wait/synch/rwlock</code>
            </p><p>
              ほかのスレッドによるその使用を妨げながら、特定の変数のアクセスをロックするために使用される読み取り/書き込みロックオブジェクト。共有読み取りロックは複数のスレッドによって同時に獲得できます。排他的書き込みロックは、一度に 1 つのスレッドだけが獲得できます。
            </p></li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-status-monitoring"></a>22.5 パフォーマンススキーマステータスモニタリング</h2></div></div></div><p>
      パフォーマンススキーマに関連付けられたいくつかのステータス変数があります。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'perf%';</code></strong>
+-----------------------------------------------+-------+
| Variable_name                                 | Value |
+-----------------------------------------------+-------+
| Performance_schema_accounts_lost              | 0     |
| Performance_schema_cond_classes_lost          | 0     |
| Performance_schema_cond_instances_lost        | 0     |
| Performance_schema_digest_lost                | 0     |
| Performance_schema_file_classes_lost          | 0     |
| Performance_schema_file_handles_lost          | 0     |
| Performance_schema_file_instances_lost        | 0     |
| Performance_schema_hosts_lost                 | 0     |
| Performance_schema_locker_lost                | 0     |
| Performance_schema_mutex_classes_lost         | 0     |
| Performance_schema_mutex_instances_lost       | 0     |
| Performance_schema_rwlock_classes_lost        | 0     |
| Performance_schema_rwlock_instances_lost      | 0     |
| Performance_schema_session_connect_attrs_lost | 0     |
| Performance_schema_socket_classes_lost        | 0     |
| Performance_schema_socket_instances_lost      | 0     |
| Performance_schema_stage_classes_lost         | 0     |
| Performance_schema_statement_classes_lost     | 0     |
| Performance_schema_table_handles_lost         | 0     |
| Performance_schema_table_instances_lost       | 0     |
| Performance_schema_thread_classes_lost        | 0     |
| Performance_schema_thread_instances_lost      | 0     |
| Performance_schema_users_lost                 | 0     |
+-----------------------------------------------+-------+
</pre><p>
      パフォーマンススキーマステータス変数は、メモリー制約のためロードまたは作成できなかったインストゥルメンテーションに関する情報を提供します。これらの変数の名前にはいくつかの形式があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_classes_lost</code> は、種類 <em class="replaceable"><code>xxx</code></em> のロードできなかったインストゥルメントの数を示します。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_instances_lost</code> は、オブジェクトの種類 <em class="replaceable"><code>xxx</code></em> の作成できなかったインストゥルメントの数を示します。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_handles_lost</code> は、オブジェクトの種類 <em class="replaceable"><code>xxx</code></em> のオープンできなかったインストゥルメントの数を示します。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_locker_lost</code> は、<span class="quote">「<span class="quote">失われた</span>」</span>か、または記録されなかったイベント数を示します。
        </p></li></ul></div><p>
      たとえば、相互排他ロックがサーバーソースにインストゥルメントされているが、サーバーが実行時にインストゥルメンテーション用のメモリーを割り当てることができない場合、それは <code class="literal">Performance_schema_mutex_classes_lost</code> を増分します。相互排他ロックは、まだ同期オブジェクトとして機能します (つまり、サーバーは正常に機能し続けます) が、そのパフォーマンスデータは収集されません。インストゥルメントを割り当てることができる場合、それはインストゥルメントされた相互排他ロックインスタンスの初期化に使用できます。グローバル相互排他ロックなどのシングルトン相互排他ロックの場合、1 つのインスタンスだけが存在します。その他の相互排他ロックは、接続あたり、または各種キャッシュおよびデータバッファー内のページあたりに 1 つのインスタンスを持つため、インスタンスの数は時間の経過とともに変わります。接続の最大数または一部のバッファーの最大サイズを増やすと、一度に割り当てることができるインスタンスの最大数が増えます。サーバーが特定のインストゥルメントされた相互排他ロックインスタンスを作成できない場合、それは <code class="literal">Performance_schema_mutex_instances_lost</code> を増分します。
    </p><p>
      次の条件が維持されているとします。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          サーバーは <code class="option">--performance_schema_max_mutex_classes=200</code> オプションを使用して起動されているため、200 相互排他ロックインストゥルメントのための空きがあります。
        </p></li><li class="listitem"><p>
          150 相互排他ロックインストゥルメントはすでにロードされています。
        </p></li><li class="listitem"><p>
          <code class="literal">plugin_a</code> という名前のプラグインには 40 相互排他ロックインストゥルメントが含まれます。
        </p></li><li class="listitem"><p>
          <code class="literal">plugin_b</code> という名前のプラグインには 20 相互排他ロックインストゥルメントが含まれます。
        </p></li></ul></div><p>
      サーバーは、次の一連のステートメントに示すように、プラグインに、それらが必要とする数と使用可能な数に応じて、相互排他ロックインストゥルメントを割り当てます。
    </p><pre class="programlisting">
INSTALL PLUGIN plugin_a
</pre><p>
      現在サーバーには 150+40 = 190 相互排他ロックインストゥルメントがあります。
    </p><pre class="programlisting">
UNINSTALL PLUGIN plugin_a;
</pre><p>
      サーバーにはまだ 190 インストゥルメントがあります。プラグインコードによって生成されたすべての履歴データはまだ使用できますが、インストゥルメントの新しいイベントは収集されません。
    </p><pre class="programlisting">
INSTALL PLUGIN plugin_a;
</pre><p>
      サーバーは 40 インストゥルメントがすでに定義されていることを検出したため、新しいインストゥルメントが作成されず、以前に割り当てられた内部メモリーバッファーが再利用されます。サーバーにはまだ 190 インストゥルメントがあります。
    </p><pre class="programlisting">
INSTALL PLUGIN plugin_b;
</pre><p>
      サーバーは 200-190 = 10 インストゥルメント (この例では、相互排他ロッククラス) の空きがあり、プラグインに 20 個の新しいインストゥルメントが含まれていることを認識します。10 個のインストゥルメントがロードされ、10 個は破棄されるか<span class="quote">「<span class="quote">失われます。</span>」</span><code class="literal">Performance_schema_mutex_classes_lost</code> は失われたインストゥルメント (相互排他ロッククラス) の数を示します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE "perf%mutex_classes_lost";</code></strong>
+---------------------------------------+-------+
| Variable_name                         | Value |
+---------------------------------------+-------+
| Performance_schema_mutex_classes_lost | 10    |
+---------------------------------------+-------+
1 row in set (0.10 sec)
</pre><p>
      インストゥルメンテーションはまだ機能し、<code class="literal">plugin_b</code> の (部分) データを収集します。
    </p><p>
      サーバーが相互排他ロックインストゥルメントを作成できないと、次の結果が発生します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          インストゥルメントの行が <code class="literal">setup_instruments</code> テーブルに挿入されません。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_mutex_classes_lost</code> が 1 増加します。
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_mutex_instances_lost</code> は変更されません。(相互排他ロックインストゥルメントが作成されない場合、あとでインストゥルメントされた相互排他ロックインスタンスの作成にそれを使用できません。)
        </p></li></ul></div><p>
      先述のパターンは相互排他ロックだけでなく、すべての種類のインストゥルメントに当てはまります。
    </p><p>
      0 より大きい <code class="literal">Performance_schema_mutex_classes_lost</code> の値は 2 つのケースで発生する可能性があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          数バイトのメモリーを節約するには、サーバーを <code class="option">--performance_schema_max_mutex_classes=<em class="replaceable"><code>N</code></em></code> で起動します。ここで <em class="replaceable"><code>N</code></em> はデフォルト値未満です。デフォルト値を選択すれば、MySQL 配布で提供されるすべてのプラグインをロードするために十分ですが、一部のプラグインをロードしない場合にこれを減らすことができます。たとえば、配布内の一部のストレージエンジンをロードしないように選択できます。
        </p></li><li class="listitem"><p>
          パフォーマンススキーマ用にインストゥルメントされたサードパーティープラグインをロードしますが、サーバーの起動時に、プラグインのインストゥルメンテーションメモリー要件を考慮しません。それはサードパーティー製であるため、このエンジンのインストゥルメントメモリー消費は <code class="literal">performance_schema_max_mutex_classes</code> で選択されたデフォルト値で考慮されていません。
        </p><p>
          サーバーにプラグインのインストゥルメント用の十分なリソースがなく、ユーザーが <code class="option">--performance_schema_max_mutex_classes=<em class="replaceable"><code>N</code></em></code> を使用して、明示的に多く割り当てていない場合、このプラグインをロードすると、インストゥルメントが不足します。
        </p></li></ul></div><p>
      <code class="literal">performance_schema_max_mutex_classes</code> に選択されている値が小さすぎる場合、エラーログにエラーが報告されず、実行時に障害が発生しません。ただし、<code class="literal">performance_schema</code> データベース内のテーブルの内容にイベントが含まれません。<code class="literal">Performance_schema_mutex_classes_lost</code> ステータス変数は、インストゥルメントの作成の失敗のために、一部のイベントが内部で削除されたことを示す唯一の目に見えるしるしです。
    </p><p>
      インストゥルメントが失われていない場合、それはパフォーマンススキーマに認識され、インスタンスのインストゥルメント時に使用されます。たとえば、<code class="literal">wait/synch/mutex/sql/LOCK_delete</code> は <code class="literal">setup_instruments</code> テーブル内の相互排他ロックインストゥルメントの名前です。サーバーの実行時に相互排他ロックの多くのインスタンスが必要であっても、コード内 (<code class="literal">THD::LOCK_delete</code> 内) で相互排他ロックの作成時に、この単一のインストゥルメントが使用されます。この場合、<code class="literal">LOCK_delete</code> は接続 (<code class="literal">THD</code>) ごとの相互排他ロックであるため、サーバーに 1000 接続がある場合、1000 スレッドと 1000 個のインストゥルメントされた <code class="literal">LOCK_delete</code> 相互排他ロックインスタンス (<code class="literal">THD::LOCK_delete</code>) が存在します。
    </p><p>
      サーバーにこれらの 1000 個のインストゥルメントされた相互排他ロック (インスタンス) すべてのための空きがない場合、一部の相互排他ロックはインストゥルメンテーション付きで作成され、一部はインストゥルメンテーションなしで作成されます。サーバーが 800 インスタンスしか作成できない場合、200 インスタンスが失われます。サーバーは実行し続けますが、<code class="literal">Performance_schema_mutex_instances_lost</code> を 200 増分し、インスタンスを作成できなかったことを示します。
    </p><p>
      0 より大きい <code class="literal">Performance_schema_mutex_instances_lost</code> は、<code class="option">--performance_schema_max_mutex_instances=<em class="replaceable"><code>N</code></em></code> で割り当てられたものより多くの相互排他ロックを、コードで実行時に初期化した場合に発生する可能性があります。
    </p><p>
      結論として、<code class="literal">SHOW STATUS LIKE 'perf%'</code> に何も失われていないことが示されている (すべての値がゼロ) 場合に、パフォーマンススキーマデータは正確で信頼できます。何かが失われた場合、データは不完全であり、使用するように与えられたメモリーの量が不十分であったとすると、パフォーマンススキーマはすべてを記録できていません。この場合、特定の <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_lost</code> 変数に問題の領域が示されます。
    </p><p>
      場合によって、意図的にインストゥルメントの不足を発生させることが適切なことがあります。たとえば、ファイル I/O のパフォーマンスデータに関心がない場合は、ファイル I/O に関連するすべてのパフォーマンススキーマのパラメータを 0 に設定して、サーバーを起動できます。ファイル関連のクラス、インスタンス、またはハンドルにメモリーが割り当てられず、すべてのファイルイベントが失われます。
    </p><p>
      <code class="literal">SHOW ENGINE PERFORMANCE_SCHEMA STATUS</code> を使用して、パフォーマンススキーマコードの内部操作を検査します。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINE PERFORMANCE_SCHEMA STATUS\G</code></strong>
...
*************************** 3. row ***************************
  Type: performance_schema
  Name: events_waits_history.row_size
Status: 76
*************************** 4. row ***************************
  Type: performance_schema
  Name: events_waits_history.row_count
Status: 10000
*************************** 5. row ***************************
  Type: performance_schema
  Name: events_waits_history.memory
Status: 760000
...
*************************** 57. row ***************************
  Type: performance_schema
  Name: performance_schema.memory
Status: 26459600
...
</pre><p>
      このステートメントは、さまざまなパフォーマンススキーマオプションがメモリー要件に与える効果について、DBA が理解できるようにすることを目的としています。フィールドの意味の説明については、<a class="xref" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE 構文">セクション13.7.5.16「SHOW ENGINE 構文」</a>を参照してください。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-atom-molecule-events"></a>22.6 パフォーマンススキーマの原子的および分子的イベント</h2></div></div></div><p>
      テーブル I/O イベントの場合、<code class="literal">events_waits_current</code> には通常 1 行ではなく、2 行あります。たとえば、行フェッチにより、次のような行になる可能性があります。
    </p><pre class="programlisting">
Row# EVENT_NAME                 TIMER_START TIMER_END
---- ----------                 ----------- ---------
   1 wait/io/file/myisam/dfile        10001 10002
   2 wait/io/table/sql/handler        10000 NULL
</pre><p>
      行フェッチによりファイルが読み取られます。例では、テーブル I/O フェッチイベントがファイル I/O イベントの前に起動していますが、終了していません (その <code class="literal">TIMER_END</code> 値が <code class="literal">NULL</code> です)。ファイル I/O イベントはテーブル I/O イベント内に<span class="quote">「<span class="quote">ネスト</span>」</span>されます。
    </p><p>
      これは、相互排他ロックやファイル I/O などのほかの<span class="quote">「<span class="quote">原子的</span>」</span>待機イベントと異なり、テーブル I/O イベントは<span class="quote">「<span class="quote">分子的</span>」</span>で、ほかのイベントを含んで (重複して) います。<code class="literal">events_waits_current</code> で、テーブル I/O イベントには通常 2 つの行があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          最新のテーブル I/O 待機イベントについての 1 行
        </p></li><li class="listitem"><p>
          任意の種類の最新の待機イベントについての 1 行
        </p></li></ul></div><p>
      通常、ただし常にではありませんが、<span class="quote">「<span class="quote">どの種類の</span>」</span>待機イベントもテーブル I/O イベントと異なります。各従属イベントが完了すると、それは <code class="literal">events_waits_current</code> から消去されます。この時点で、および次の従属イベントが開始されるまで、テーブル I/O 待機は、あらゆる種類の最新の待機でもあります。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-statement-digests"></a>22.7 パフォーマンススキーマステートメントダイジェスト</h2></div></div></div><p>
      MySQL 5.6.5 現在、パフォーマンススキーマはステートメントダイジェスト情報を保守します。ダイジェストは、SQL ステートメントを正規化形式に変換し、結果のハッシュ値を計算します。正規化により、類似のステートメントがグループ化され、要約されて、サーバーが実行しているステートメントの種類とそれらが発生する頻度に関する情報が公開されます。このセクションでは、どのようにステートメントの正規化が行われ、どのように役立つ可能性があるかについて説明します。
    </p><p>
      ステートメントのダイジェストには、これらのパフォーマンススキーマコンポーネントが関係します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">setup_consumers</code> テーブル内の <code class="literal">statement_digest</code> コンシューマは、パフォーマンススキーマがダイジェスト情報を保守するかどうかを制御します。
        </p></li><li class="listitem"><p>
          ステートメントイベントテーブル (<code class="literal">events_statements_current</code>、<code class="literal">events_statements_history</code>、および <code class="literal">events_statements_history_long</code>) には、ダイジェスト MD5 値と対応する正規化されたステートメントテキスト文字列を格納する <code class="literal">DIGEST</code> および <code class="literal">DIGEST_TEXT</code> カラムがあります。
        </p></li><li class="listitem"><p>
          <code class="literal">events_statements_summary_by_digest</code> テーブルは集計されたステートメントダイジェスト情報を提供します。
        </p></li></ul></div><p>
      ステートメントの正規化によって、ステートメントテキストは、一般的なステートメント構造を保持しながら、構造に不可欠でない情報を削除する、より標準化された文字列表現に変換されます。データベースまたはテーブル名などのオブジェクト識別子は保持されます。値とコメントは削除され、空白は調整されます。パフォーマンススキーマは、名前、パスワード、日付などの情報を保持しません。
    </p><p>
      これらのステートメントを考慮してください。
    </p><pre class="programlisting">
SELECT * FROM orders WHERE customer_id=10 AND quantity&gt;20
SELECT * FROM orders WHERE customer_id = 20 AND quantity &gt; 100
</pre><p>
      これらのステートメントを正規化するため、パフォーマンススキーマはデータ値を <code class="literal">?</code> に置換し、空白を調整します。どちらのステートメントも同じ正規化形式になるため、<span class="quote">「<span class="quote">同じ</span>」</span>とみなされます。
    </p><pre class="programlisting">
SELECT * FROM orders WHERE customer_id = ? AND quantity &gt; ?
</pre><p>
      正規化されたステートメントは、格納される情報は少ないですが、引き続き元のステートメントを代表しています。さまざまな比較値を持つほかの類似のステートメントは同じ正規化形式になります。
    </p><p>
      ここで、これらのステートメントを考慮してください。
    </p><pre class="programlisting">
SELECT * FROM customers WHERE customer_id = 1000
SELECT * FROM orders WHERE customer_id = 1000
</pre><p>
      この場合、ステートメントは<span class="quote">「<span class="quote">同じ</span>」</span>ではありません。オブジェクト識別子が異なるため、ステートメントは異なる正規化形式になります。
    </p><pre class="programlisting">
SELECT * FROM customers WHERE customer_id = ?
SELECT * FROM orders WHERE customer_id = ?
</pre><p>
      正規化されたステートメントは固定長です。<code class="literal">DIGEST_TEXT</code> 値の最大長は 1024 バイトです。この最大を変更するオプションはありません。正規化によって、この長さを超えるステートメントが生成された場合、テキストは <span class="quote">「<span class="quote">...</span>」</span> で終わります。<span class="quote">「<span class="quote">...</span>」</span> のあとの部分のみが異なる長いステートメントは同じとみなされます。これらのステートメントを考慮してください。
    </p><pre class="programlisting">
SELECT * FROM mytable WHERE cola = 10 AND colb = 20
SELECT * FROM mytable WHERE cola = 10 AND colc = 20
</pre><p>
      <code class="literal">AND</code> の直後にカットオフが発生した場合、両方のステートメントがこの正規化形式になります。
    </p><pre class="programlisting">
SELECT * FROM mytable WHERE cola = ? AND ...
</pre><p>
      この場合、2 つ目のカラム名の違いが失われ、両方のステートメントが同じとみなされます。
    </p><p>
      正規化された各ステートメントについて、パフォーマンススキーマはハッシュダイジェスト値を計算し、その値とステートメントをステートメントイベントテーブル (<code class="literal">events_statements_current</code>、<code class="literal">events_statements_history</code>、および <code class="literal">events_statements_history_long</code>) の <code class="literal">DIGEST</code> および <code class="literal">DIGEST_TEXT</code> カラムに格納します。さらに、同じ <code class="literal">SCHEMA_NAME</code> および <code class="literal">DIGEST</code> 値を持つステートメントの情報が <code class="literal">events_statements_summary_by_digest</code> サマリーテーブルに集計されます。パフォーマンススキーマは MD5 ハッシュ値を使用します。それらは計算が速く、競合を最小にする望ましい統計的分布を持つためです。
    </p><p>
      <code class="literal">events_statements_summary_by_digest</code> サマリーテーブルは固定サイズであるため、それがいっぱいになると、テーブル内の既存の値に一致しない <code class="literal">SCHEMA_NAME</code> および <code class="literal">DIGEST</code> 値のあるステートメントは、<code class="literal">SCHEMA_NAME</code> および <code class="literal">DIGEST</code> が <code class="literal">NULL</code> に設定された特別な行にグループ化されます。これにより、すべてのステートメントがカウントされます。ただし、特別な行が、実行されるステートメントの大きな割合を占める場合、サマリーテーブルのサイズを増やすことが望ましい可能性があります。これを実行するには、サーバーの起動時に、<code class="literal">performance_schema_digests_size</code> システム変数を大きな値に設定します。<code class="literal">performance_schema_digests_size</code> 値が指定されていない場合、サーバーは起動時に使用する値を推定します。(MySQL 5.6.9 より前では、<code class="literal">SCHEMA_NAME</code> カラム値がなく、特別な行の <code class="literal">DIGEST</code> は <code class="literal">NULL</code> に設定されます。)
    </p><p>
      ステートメントダイジェストサマリーテーブルは、サーバーによって実行されるステートメントのプロファイルを提供します。それは、アプリケーションが実行しているステートメントの種類とその頻度を示します。アプリケーション開発者はこの情報をテーブル内のほかの情報と組み合わせて使用し、アプリケーションのパフォーマンス特性を査定できます。たとえば、待機時間、ロック時間、またはインデックスの使用を示すテーブルカラムは不十分なクエリーの種類を強調表示することができます。これにより、開発者が注意が必要なアプリケーションの部分を把握できます。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-table-characteristics"></a>22.8 パフォーマンススキーマの一般的なテーブル特性</h2></div></div></div><p>
      <code class="literal">performance_schema</code> データベースの名前は小文字で、その中のテーブルの名前も同様です。クエリーでは名前を小文字で指定してください。
    </p><a class="indexterm" name="idm139979007682032"></a><a class="indexterm" name="idm139979007679920"></a><p>
      <code class="literal">performance_schema</code> データベース内のほとんどのテーブルは読み取り専用で、変更できません。セットアップテーブルの一部には、パフォーマンススキーマ操作に影響するように変更できるカラムがあります。さらに行の挿入や削除を許可するものもあります。収集されたイベントをクリアするために切り捨てが許可されるため、<code class="literal">events_waits_</code> のプリフィクスのある名前のテーブルなど、それらの種類の情報を格納するテーブルで、<code class="literal">TRUNCATE TABLE</code> を使用できます。
    </p><p>
      <code class="literal">TRUNCATE TABLE</code> は、<code class="literal">events_statements_summary_by_digest</code> を除くサマリーテーブルでも使用できますが、その効果は行の削除ではなく、サマリーカラムを 0 または <code class="literal">NULL</code> にリセットすることです。
    </p><p>
      ほかのデータベースやテーブルに対する権限は次のようになります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">performance_schema</code> テーブルから取得するには、<code class="literal">SELECT</code> 権限が必要です。
        </p></li><li class="listitem"><p>
          変更可能なそれらのカラムを変更するには、<code class="literal">UPDATE</code> 権限が必要です。
        </p></li><li class="listitem"><p>
          切り捨て可能なテーブルを切り捨てるには、<code class="literal">DROP</code> 権限が必要です。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-table-descriptions"></a>22.9 パフォーマンススキーマテーブルの説明</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-table-index">22.9.1 パフォーマンススキーマテーブルインデックス</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-tables">22.9.2 パフォーマンススキーマセットアップテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instance-tables">22.9.3 パフォーマンススキーマインスタンステーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-wait-tables">22.9.4 パフォーマンススキーマ待機イベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-stage-tables">22.9.5 パフォーマンススキーマステージイベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-tables">22.9.6 パフォーマンススキーマステートメントイベントテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-tables">22.9.7 パフォーマンススキーマ接続テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-attribute-tables">22.9.8 パフォーマンススキーマ接続属性テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-summary-tables">22.9.9 パフォーマンススキーマサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-miscellaneous-tables">22.9.10 パフォーマンススキーマのその他のテーブル</a></span></dt></dl></div><p>
      <code class="literal">performance_schema</code> データベース内のテーブルは次のようにグループ化できます。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          セットアップテーブル。これらのテーブルは、モニタリング特性の構成と表示に使われます。
        </p></li><li class="listitem"><p>
          現在のイベントテーブル。<code class="literal">events_waits_current</code> テーブルには各スレッドの最新のイベントが格納されます。その他の類似のテーブルには、イベント階層のさまざまなレベルの現在のイベントが格納されます (ステージイベント用の <code class="literal">events_stages_current</code> とステートメントイベント用の <code class="literal">events_statements_current</code>)。
        </p></li><li class="listitem"><p>
          履歴テーブル。これらのテーブルは現在のイベントテーブルと同じ構造を持ちますが、多くの行を格納します。たとえば、待機イベントの場合、<code class="literal">events_waits_history</code> テーブルにはスレッドあたり最新の 10 イベントが格納されます。<code class="literal">events_waits_history_long</code> には最新の 10,000 イベントが格納されます。ステージおよびステートメント履歴用にほかの類似テーブルが存在します。
        </p><p>
          履歴テーブルのサイズを変更するには、サーバー起動時に、該当するシステム変数を設定します。たとえば、待機イベント履歴テーブルのサイズを設定するには、<code class="literal">performance_schema_events_waits_history_size</code> および <code class="literal">performance_schema_events_waits_history_long_size</code> を設定します。
        </p></li><li class="listitem"><p>
          サマリーテーブル。これらのテーブルには、履歴テーブルから破棄されたものを含むイベントのグループ全体で集計された情報が格納されます。
        </p></li><li class="listitem"><p>
          インスタンステーブル。これらのテーブルは、インストゥルメントされたオブジェクトの種類を記述します。インストゥルメントされたオブジェクトは、サーバーによって使われると、イベントを生成します。これらのテーブルは、イベント名と説明のメモまたはステータス情報を提供します。
        </p></li><li class="listitem"><p>
          その他のテーブル。これらはほかのどのテーブルグループにも分類されません。
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-table-index"></a>22.9.1 パフォーマンススキーマテーブルインデックス</h3></div></div></div><p>
        次の表に、各パフォーマンススキーマテーブルを一覧表示し、それぞれの簡単な説明を提供します。
      </p><div class="table"><a name="performance-schema-tables-table"></a><p class="title"><b>表 22.1 パフォーマンススキーマテーブル</b></p><div class="table-contents"><table summary="パフォーマンススキーマテーブル" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">テーブル名</th><th scope="col">説明</th></tr></thead><tbody><tr><td scope="row"><code class="literal">accounts</code></td><td>クライアントアカウントごとの接続統計</td></tr><tr><td scope="row"><code class="literal">cond_instances</code></td><td>同期オブジェクトインスタンス</td></tr><tr><td scope="row"><code class="literal">events_stages_current</code></td><td>現在のステージイベント</td></tr><tr><td scope="row"><code class="literal">events_stages_history</code></td><td>各スレッドの最新ステージイベント</td></tr><tr><td scope="row"><code class="literal">events_stages_history_long</code></td><td>全体の最新ステージイベント</td></tr><tr><td scope="row"><code class="literal">events_stages_summary_by_account_by_event_name</code></td><td>アカウントおよびイベント名ごとのステージイベント</td></tr><tr><td scope="row"><code class="literal">events_stages_summary_by_host_by_event_name</code></td><td>ホスト名およびイベント名ごとのステージイベント</td></tr><tr><td scope="row"><code class="literal">events_stages_summary_by_thread_by_event_name</code></td><td>スレッドおよびイベント名ごとのステージ待機</td></tr><tr><td scope="row"><code class="literal">events_stages_summary_by_user_by_event_name</code></td><td>ユーザー名およびイベント名ごとのステージイベント</td></tr><tr><td scope="row"><code class="literal">events_stages_summary_global_by_event_name</code></td><td>イベント名ごとのステージ待機</td></tr><tr><td scope="row"><code class="literal">events_statements_current</code></td><td>現在のステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_statements_history</code></td><td>各スレッドの最新ステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_statements_history_long</code></td><td>全体の最新ステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_statements_summary_by_account_by_event_name</code></td><td>アカウントおよびイベント名ごとのステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_statements_summary_by_digest</code></td><td>スキーマおよびダイジェスト値ごとのステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_statements_summary_by_host_by_event_name</code></td><td>ホスト名およびイベント名ごとのステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_statements_summary_by_thread_by_event_name</code></td><td>スレッドおよびイベント名ごとのステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_statements_summary_by_user_by_event_name</code></td><td>ユーザー名およびイベント名ごとのステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_statements_summary_global_by_event_name</code></td><td>イベント名ごとのステートメントイベント</td></tr><tr><td scope="row"><code class="literal">events_waits_current</code></td><td>現在の待機イベント</td></tr><tr><td scope="row"><code class="literal">events_waits_history</code></td><td>各スレッドの最新待機イベント</td></tr><tr><td scope="row"><code class="literal">events_waits_history_long</code></td><td>全体の最新待機イベント</td></tr><tr><td scope="row"><code class="literal">events_waits_summary_by_account_by_event_name</code></td><td>アカウントおよびイベント名ごとの待機イベント</td></tr><tr><td scope="row"><code class="literal">events_waits_summary_by_host_by_event_name</code></td><td>ホスト名およびイベント名ごとの待機イベント</td></tr><tr><td scope="row"><code class="literal">events_waits_summary_by_instance</code></td><td>インスタンスごとの待機イベント</td></tr><tr><td scope="row"><code class="literal">events_waits_summary_by_thread_by_event_name</code></td><td>スレッドおよびイベント名ごとの待機イベント</td></tr><tr><td scope="row"><code class="literal">events_waits_summary_by_user_by_event_name</code></td><td>ユーザー名およびイベント名ごとの待機イベント</td></tr><tr><td scope="row"><code class="literal">events_waits_summary_global_by_event_name</code></td><td>イベント名ごとの待機イベント</td></tr><tr><td scope="row"><code class="literal">file_instances</code></td><td>ファイルインスタンス</td></tr><tr><td scope="row"><code class="literal">file_summary_by_event_name</code></td><td>イベント名ごとのファイルイベント</td></tr><tr><td scope="row"><code class="literal">file_summary_by_instance</code></td><td>ファイルインスタンスごとのファイルイベント</td></tr><tr><td scope="row"><code class="literal">host_cache</code></td><td>内部ホストキャッシュからの情報</td></tr><tr><td scope="row"><code class="literal">hosts</code></td><td>クライアントホスト名ごとの接続統計</td></tr><tr><td scope="row"><code class="literal">mutex_instances</code></td><td>相互排他ロック同期オブジェクトインスタンス</td></tr><tr><td scope="row"><code class="literal">objects_summary_global_by_type</code></td><td>オブジェクトサマリー</td></tr><tr><td scope="row"><code class="literal">performance_timers</code></td><td>使用可能なイベントタイマー</td></tr><tr><td scope="row"><code class="literal">rwlock_instances</code></td><td>ロック同期オブジェクトインスタンス</td></tr><tr><td scope="row"><code class="literal">session_account_connect_attrs</code></td><td>現在のセッションごとの接続属性</td></tr><tr><td scope="row"><code class="literal">session_connect_attrs</code></td><td>すべてのセッションの接続属性</td></tr><tr><td scope="row"><code class="literal">setup_actors</code></td><td>新しいフォアグラウンドスレッドのモニタリングの初期化方法</td></tr><tr><td scope="row"><code class="literal">setup_consumers</code></td><td>イベント情報を格納できるコンシューマ</td></tr><tr><td scope="row"><code class="literal">setup_instruments</code></td><td>イベントを収集できるインストゥルメントされたオブジェクトのクラス</td></tr><tr><td scope="row"><code class="literal">setup_objects</code></td><td>モニターすべきオブジェクト</td></tr><tr><td scope="row"><code class="literal">setup_timers</code></td><td>現在のイベントタイマー</td></tr><tr><td scope="row"><code class="literal">socket_instances</code></td><td>アクティブな接続インスタンス</td></tr><tr><td scope="row"><code class="literal">socket_summary_by_event_name</code></td><td>イベント名ごとのソケット待機と I/O</td></tr><tr><td scope="row"><code class="literal">socket_summary_by_instance</code></td><td>インスタンスごとのソケット待機と I/O</td></tr><tr><td scope="row"><code class="literal">table_io_waits_summary_by_index_usage</code></td><td>インデックスごとのテーブル I/O 待機</td></tr><tr><td scope="row"><code class="literal">table_io_waits_summary_by_table</code></td><td>テーブルごとのテーブル I/O 待機</td></tr><tr><td scope="row"><code class="literal">table_lock_waits_summary_by_table</code></td><td>テーブルごとのテーブルロック待機</td></tr><tr><td scope="row"><code class="literal">threads</code></td><td>サーバースレッドに関する情報</td></tr><tr><td scope="row"><code class="literal">users</code></td><td>クライアントユーザー名ごとの接続統計</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-setup-tables"></a>22.9.2 パフォーマンススキーマセットアップテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#setup-actors-table">22.9.2.1 setup_actors テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#setup-consumers-table">22.9.2.2 setup_consumers テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#setup-instruments-table">22.9.2.3 setup_instruments テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#setup-objects-table">22.9.2.4 setup_objects テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#setup-timers-table">22.9.2.5 setup_timers テーブル</a></span></dt></dl></div><p>
        セットアップテーブルは現在のインストゥルメンテーションに関する情報を提供し、モニタリング構成の変更を可能にします。このため、<code class="literal">UPDATE</code> 権限を持つ場合、これらのテーブルの一部のカラムを変更できます。
      </p><p>
        セットアップ情報に個々の変数ではなく、テーブルを使用することで、パフォーマンススキーマ構成の変更の高度な柔軟性を提供します。たとえば、標準 SQL 構文の単一のステートメントを使用して、複数の同時の構成変更ができます。
      </p><p>
        これらのセットアップテーブルを使用できます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">setup_actors</code>: 新しいフォアグラウンドスレッドのモニタリングの初期化方法
          </p></li><li class="listitem"><p>
            <code class="literal">setup_consumers</code>: イベント情報を送信および格納できる宛先
          </p></li><li class="listitem"><p>
            <code class="literal">setup_instruments</code>: イベントを収集できるインストゥルメントされたオブジェクトのクラス
          </p></li><li class="listitem"><p>
            <code class="literal">setup_objects</code>: モニターすべきオブジェクト
          </p></li><li class="listitem"><p>
            <code class="literal">setup_timers</code>: 現在のイベントタイマー
          </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="setup-actors-table"></a>22.9.2.1 setup_actors テーブル</h4></div></div></div><a class="indexterm" name="idm139979007522272"></a><a class="indexterm" name="idm139979007520112"></a><p>
          <code class="literal">setup_actors</code> テーブルには、新しいフォアグラウンドサーバースレッド、つまりクライアント接続に関連付けられたスレッドのモニタリングを有効にするかどうかを決定する情報が格納されます。このテーブルはデフォルトで 100 行の最大サイズになります。テーブルサイズを変更するには、サーバー起動時に <code class="literal">performance_schema_setup_actors_size</code> システム変数を変更します。
        </p><p>
          新しいフォアグラウンドスレッドごとに、パフォーマンススキーマはスレッドのユーザーとホストを、<code class="literal">setup_actors</code> テーブルの行に対して照合します。一致する行があるかどうかに基づいて、スレッドの <code class="literal">threads</code> テーブル行の <code class="literal">INSTRUMENTED</code> カラムが <code class="literal">YES</code> または <code class="literal">NO</code> に設定されます。これにより、ホスト、ユーザー、またはホストとユーザーの組み合わせごとに、インストゥルメントが選択して適用されます。
        </p><p>
          <code class="literal">setup_actors</code> テーブルの初期の内容は、任意のユーザーとホストの組み合わせに一致するため、デフォルトですべてのフォアグラウンドスレッドのモニタリングが有効にされます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_actors;</code></strong>
+------+------+------+
| HOST | USER | ROLE |
+------+------+------+
| %    | %    | %    |
+------+------+------+
</pre><p>
          <code class="literal">setup_actors</code> テーブルへの変更は既存のスレッドに影響しません。
        </p><p>
          イベントモニタリングで <code class="literal">setup_actors</code> テーブルを使用する方法については、<a class="xref" href="performance-schema.html#performance-schema-thread-filtering" title="22.2.3.3.3 スレッドによる事前フィルタリング">セクション22.2.3.3.3「スレッドによる事前フィルタリング」</a>を参照してください。
        </p><p>
          <code class="literal">setup_actors</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              ホスト名。これらはリテラル名または<span class="quote">「<span class="quote">任意のホスト</span>」</span>を意味する <code class="literal">'%'</code> であるべきです。
            </p></li><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              ユーザー名。これはリテラル名または<span class="quote">「<span class="quote">任意のユーザー</span>」</span>を意味する <code class="literal">'%'</code> であるべきです。
            </p></li><li class="listitem"><p>
              <code class="literal">ROLE</code>
            </p><p>
              使用されません。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="setup-consumers-table"></a>22.9.2.2 setup_consumers テーブル</h4></div></div></div><a class="indexterm" name="idm139979007490992"></a><a class="indexterm" name="idm139979007488816"></a><p>
          <code class="literal">setup_consumers</code> テーブルは、イベント情報を格納でき、有効にされているコンシューマの種類を一覧表示します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_stages_current          | NO      |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| events_waits_current           | NO      |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
          <code class="literal">setup_consumers</code> テーブル内のコンシューマ設定は、高いレベルから低いレベルまでの階層を形成します。さまざまなコンシューマを有効にすることの効果の詳細については、<a class="xref" href="performance-schema.html#performance-schema-consumer-filtering" title="22.2.3.3.4 コンシューマによる事前フィルタリング">セクション22.2.3.3.4「コンシューマによる事前フィルタリング」</a>を参照してください。
        </p><p>
          <code class="literal">setup_consumers</code> テーブルへの変更はただちにモニタリングに影響します。
        </p><p>
          <code class="literal">setup_consumers</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              コンシューマ名。
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              コンシューマが有効にされているかどうか。このカラムは変更できます。コンシューマを無効にすると、サーバーはそれにイベント情報を追加する時間を費やさなくなります。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="setup-instruments-table"></a>22.9.2.3 setup_instruments テーブル</h4></div></div></div><a class="indexterm" name="idm139979007471552"></a><a class="indexterm" name="idm139979007469376"></a><p>
          <code class="literal">setup_instruments</code> テーブルは、イベントを収集できるインストゥルメントされたオブジェクトのクラスを一覧表示します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments;</code></strong>
+------------------------------------------------------------+---------+-------+
| NAME                                                       | ENABLED | TIMED |
+------------------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                          | YES     | YES   |
...
| wait/synch/rwlock/sql/LOCK_grant                           | YES     | YES   |
| wait/synch/rwlock/sql/LOGGER::LOCK_logger                  | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_connect                | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_slave                  | YES     | YES   |
...
| wait/io/file/sql/binlog                                    | YES     | YES   |
| wait/io/file/sql/binlog_index                              | YES     | YES   |
| wait/io/file/sql/casetest                                  | YES     | YES   |
| wait/io/file/sql/dbopt                                     | YES     | YES   |
...
</pre><p>
          ソースコードに追加された各インストゥルメントは、インストゥルメントされたコードが実行されない場合でもこのテーブルの行を提供します。インストゥルメントが有効にされており、実行されると、<code class="literal">*_instances</code> テーブルに表示されるインストゥルメントされたインスタンスが作成されます。
        </p><p>
          <code class="literal">setup_instruments</code> テーブルへの変更はただちにモニタリングに影響します。
        </p><p>
          イベントフィルタリングにおける <code class="literal">setup_instruments</code> テーブルの役割の詳細については、<a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 イベントの事前フィルタリング">セクション22.2.3.3「イベントの事前フィルタリング」</a>を参照してください。
        </p><p>
          <code class="literal">setup_instruments</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              インストゥルメント名。<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 パフォーマンススキーマインストゥルメント命名規則">セクション22.4「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。インストゥルメントの実行から生成されるイベントには、インストゥルメント <code class="literal">NAME</code> 値から取得される <code class="literal">EVENT_NAME</code> 値があります。(イベントには実際には<span class="quote">「<span class="quote">名前</span>」</span>がありませんが、これによって、イベントをインストゥルメントに関連付ける方法を提供します。)
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              インストゥルメントが有効にされているかどうか。このカラムは変更できます。無効にされたインストゥルメントはイベントを生成しません。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMED</code>
            </p><p>
              インストゥルメントの時間が測定されるかどうか。このカラムは変更できます。
            </p><p>
              有効にされたインストゥルメントの時間が測定されない場合、インストゥルメントコードは有効ですが、タイマーは有効ではありません。インストゥルメントによって生成されたイベントの <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> タイマー値が <code class="literal">NULL</code> になります。これによって、サマリーテーブルの合計、最小、最大、および平均の時間値の計算時に、それらの値が無視されます。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="setup-objects-table"></a>22.9.2.4 setup_objects テーブル</h4></div></div></div><a class="indexterm" name="idm139979007440560"></a><a class="indexterm" name="idm139979007438400"></a><p>
          <code class="literal">setup_objects</code> テーブルは、パフォーマンススキーマが特定のオブジェクトをモニターするかどうかを制御します。このテーブルはデフォルトで 100 行の最大サイズになります。テーブルサイズを変更するには、サーバー起動時に <code class="literal">performance_schema_setup_objects_size</code> システム変数を変更します。
        </p><p>
          初期 <code class="literal">setup_objects</code> の内容は次のように見えます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_objects;</code></strong>
+-------------+--------------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA      | OBJECT_NAME | ENABLED | TIMED |
+-------------+--------------------+-------------+---------+-------+
| TABLE       | mysql              | %           | NO      | NO    |
| TABLE       | performance_schema | %           | NO      | NO    |
| TABLE       | information_schema | %           | NO      | NO    |
| TABLE       | %                  | %           | YES     | YES   |
+-------------+--------------------+-------------+---------+-------+
</pre><p>
          <code class="literal">setup_objects</code> テーブルへの変更はただちにオブジェクトモニタリングに影響します。
        </p><p>
          <code class="literal">setup_objects</code> に示されているオブジェクトの種類では、パフォーマンススキーマはそれらのモニター方法にテーブルを使用します。オブジェクトの一致は <code class="literal">OBJECT_SCHEMA</code> および <code class="literal">OBJECT_NAME</code> カラムに基づきます。一致のないオブジェクトはモニターされません。
        </p><p>
          デフォルトのオブジェクト構成の効果は、<code class="literal">mysql</code>、<code class="literal">INFORMATION_SCHEMA</code>、および <code class="literal">performance_schema</code> データベースのテーブルを除くすべてのテーブルをインストゥルメントすることです。(<code class="literal">INFORMATION_SCHEMA</code> データベース内のテーブルは、<code class="literal">setup_objects</code> の内容に関係なくインストゥルメントされず、<code class="literal">information_schema.%</code> の行は単にこのデフォルトを明示します。)
        </p><p>
          パフォーマンススキーマは、<code class="literal">setup_objects</code> の一致をチェックする場合、まずより詳細な一致を見つけようとします。たとえば、テーブル <code class="literal">db1.t1</code> では、<code class="literal">'db1'</code> と <code class="literal">'t1'</code>、次に <code class="literal">'db1'</code> と <code class="literal">'%'</code>、次に <code class="literal">'%'</code> と <code class="literal">'%'</code> の一致を検索します。さまざまな一致する <code class="literal">setup_objects</code> 行はさまざまな <code class="literal">ENABLED</code> 値と <code class="literal">TIMED</code> 値を持つ可能性があるため、一致が発生する順序が重要です。
        </p><p>
          テーブルへの <code class="literal">INSERT</code> または <code class="literal">DELETE</code> 権限を持つユーザーが、<code class="literal">setup_objects</code> に行を挿入したり、削除したりできます。既存の行では、テーブルへの <code class="literal">UPDATE</code> 権限を持つユーザーによって、<code class="literal">ENABLED</code> および <code class="literal">TIMED</code> カラムのみを変更できます。
        </p><p>
          イベントフィルタリングにおける <code class="literal">setup_objects</code> テーブルの役割の詳細については、<a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 イベントの事前フィルタリング">セクション22.2.3.3「イベントの事前フィルタリング」</a>を参照してください。
        </p><p>
          <code class="literal">setup_objects</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">OBJECT_TYPE</code>
            </p><p>
              インストゥルメントするオブジェクトの種類。現在、これは常に <code class="literal">'TABLE'</code> (ベーステーブル) です。
            </p><p>
              <code class="literal">TABLE</code> フィルタリングはテーブル I/O イベント (<code class="literal">wait/io/table/sql/handler</code> インストゥルメント) およびテーブルロックイベント (<code class="literal">wait/lock/table/sql/handler</code> インストゥルメント) に影響します。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>
            </p><p>
              オブジェクトを格納するスキーマ。これはリテラル名、または<span class="quote">「<span class="quote">任意のスキーマ</span>」</span>を意味する <code class="literal">'%'</code> であるべきです。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_NAME</code>
            </p><p>
              インストゥルメントされたオブジェクトの名前。これはリテラル名、または<span class="quote">「<span class="quote">任意のオブジェクト</span>」</span>を意味する <code class="literal">'%'</code> であるべきです。
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              オブジェクトのイベントがインストゥルメントされるかどうか。このカラムは変更できます。
            </p><p>
              このカラムは、MySQL 5.6.3 で追加されました。それが存在しない初期バージョンの場合、パフォーマンススキーマはテーブル内の一部の行に一致するオブジェクトに対してのみモニタリングを有効にします。一致しないオブジェクトに対しては、モニタリングは暗黙的に無効にされます。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMED</code>
            </p><p>
              オブジェクトのイベントの時間が測定されるかどうか。このカラムは変更できます。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="setup-timers-table"></a>22.9.2.5 setup_timers テーブル</h4></div></div></div><a class="indexterm" name="idm139979007380016"></a><a class="indexterm" name="idm139979007377856"></a><p>
          <code class="literal">setup_timers</code> テーブルには現在選択されているイベントタイマーが表示されます。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | CYCLE       |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
          <code class="literal">setup_timers.TIMER_NAME</code> 値を変更して、異なるタイマーを選択できます。値は <code class="literal">performance_timers.TIMER_NAME</code> カラム内の任意の値にすることができます。イベントタイミングがどのように行われるかの説明については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 パフォーマンススキーマイベントタイミング">セクション22.2.3.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
        </p><p>
          <code class="literal">setup_timers</code> テーブルへの変更はただちにモニタリングに影響します。すでに進行中のイベントは、開始時間に元のタイマーを使用し、終了時間に新しいタイマーを使用する可能性があるため、予測不可能な結果に至る場合があります。タイマーを変更した場合、<code class="literal">TRUNCATE TABLE</code> を使用して、パフォーマンススキーマの統計をリセットする必要がある場合があります。
        </p><p>
          <code class="literal">setup_timers</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              タイマーが使用されるインストゥルメントの種類。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_NAME</code>
            </p><p>
              インストゥルメントの種類に適用されるタイマー。このカラムは変更できます。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-instance-tables"></a>22.9.3 パフォーマンススキーマインスタンステーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#cond-instances-table">22.9.3.1 cond_instances テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#file-instances-table">22.9.3.2 file_instances テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#mutex-instances-table">22.9.3.3 mutex_instances テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#rwlock-instances-table">22.9.3.4 rwlock_instances テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#socket-instances-table">22.9.3.5 socket_instances テーブル</a></span></dt></dl></div><p>
        インスタンステーブルは、インストゥルメントされたオブジェクトの種類を記述します。それらは、イベント名と説明のメモまたはステータス情報を提供します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">cond_instances</code>: 条件同期オブジェクトインスタンス
          </p></li><li class="listitem"><p>
            <code class="literal">file_instances</code>: ファイルインスタンス
          </p></li><li class="listitem"><p>
            <code class="literal">mutex_instances</code>: 相互排他ロック同期オブジェクトインスタンス
          </p></li><li class="listitem"><p>
            <code class="literal">rwlock_instances</code>: ロック同期オブジェクトインスタンス
          </p></li><li class="listitem"><p>
            <code class="literal">socket_instances</code>: アクティブな接続インスタンス
          </p></li></ul></div><p>
        これらのテーブルはインストゥルメントされた同期オブジェクト、ファイル、および接続を一覧表示します。3 種類の同期オブジェクト <code class="literal">cond</code>、<code class="literal">mutex</code>、および <code class="literal">rwlock</code> があります。各インスタンステーブルには、各行に関連付けられているインストゥルメントを示す <code class="literal">EVENT_NAME</code> または <code class="literal">NAME</code> カラムがあります。<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 パフォーマンススキーマインストゥルメント命名規則">セクション22.4「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。
      </p><p>
        <code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code> および <code class="literal">rwlock_instances.WRITE_LOCKED_BY_THREAD_ID</code> カラムは、パフォーマンスボトルネックまたはデッドロックの調査にきわめて重要です。この目的でそれらを使用する方法の例については、<a class="xref" href="performance-schema.html#performance-schema-examples" title="22.15 問題を診断するためのパフォーマンススキーマの使用">セクション22.15「問題を診断するためのパフォーマンススキーマの使用」</a>を参照してください
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="cond-instances-table"></a>22.9.3.1 cond_instances テーブル</h4></div></div></div><a class="indexterm" name="idm139979007339008"></a><a class="indexterm" name="idm139979007336848"></a><p>
          <code class="literal">cond_instances</code> テーブルは、サーバーの実行中にパフォーマンススキーマによって確認されるすべての条件を一覧表示します。条件は、この条件を待機しているスレッドが作業を再開できるように、特定のイベントが発生したことを伝えるために、コードで使用される同期メカニズムです。
        </p><p>
          スレッドが何かの発生を待機している場合、条件名は、スレッドが待機しているものを示しますが、ほかのどのスレッドが条件を発生させるかを伝えるための直接の方法はありません。
        </p><p>
          <code class="literal">cond_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              条件に関連付けられているインストゥルメント名。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              インストゥルメントされた条件のメモリー内のアドレス。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="file-instances-table"></a>22.9.3.2 file_instances テーブル</h4></div></div></div><a class="indexterm" name="idm139979007324704"></a><a class="indexterm" name="idm139979007322544"></a><p>
          <code class="literal">file_instances</code> テーブルは、ファイル I/O インストゥルメンテーションの実行中にパフォーマンススキーマによって確認されるすべてのファイルを一覧表示します。ディスク上のファイルが開かれたことがない場合、<code class="literal">file_instances</code> に含まれません。ファイルがディスクから削除されると、<code class="literal">file_instances</code> テーブルからも削除されます。
        </p><p>
          <code class="literal">file_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">FILE_NAME</code>
            </p><p>
              ファイル名。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              ファイルに関連付けられているインストゥルメント名。
            </p></li><li class="listitem"><p>
              <code class="literal">OPEN_COUNT</code>
            </p><p>
              ファイルへのオープンハンドルのカウント。ファイルが開かれ、閉じられた場合、それは 1 回開かれていますが、<code class="literal">OPEN_COUNT</code> は 0 になります。サーバーによって現在開かれているすべてのファイルを一覧表示するには、<code class="literal">WHERE OPEN_COUNT &gt; 0</code> を使用します。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mutex-instances-table"></a>22.9.3.3 mutex_instances テーブル</h4></div></div></div><a class="indexterm" name="idm139979007305392"></a><a class="indexterm" name="idm139979007303216"></a><p>
          <code class="literal">mutex_instances</code> テーブルは、サーバーの実行中にパフォーマンススキーマによって確認されるすべての相互排他ロックを一覧表示します。相互排他ロックは、特定の時間に 1 つだけのスレッドが特定の共通リソースにアクセスできるようにする、コードで使用される同期メカニズムです。リソースは相互排他ロックによって<span class="quote">「<span class="quote">保護されている</span>」</span>と呼ばれます。
        </p><p>
          サーバーで実行している 2 つのスレッド (たとえば、クエリーを同時に実行している 2 つのユーザーセッション) が同じリソース (ファイル、バッファー、データの一部) にアクセスする必要がある場合、これらの 2 つのスレッドは互いに競争するため、相互排他ロックのロックを取得する最初のクエリーによって、ほかのクエリーは最初のクエリーが終了し、相互排他ロックを解除するまで待たされます。
        </p><p>
          相互排他ロックの保持中に実行される作業は<span class="quote">「<span class="quote">クリティカルセクション</span>」</span>にあると呼ばれ、複数のクエリーがこのクリティカルセクションを連続して (一度に 1 つずつ) 実行するため、これは潜在的なボトルネックになります。
        </p><p>
          <code class="literal">mutex_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              相互排他ロックに関連付けられているインストゥルメント名。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              インストゥルメントされた相互排他ロックのメモリー内のアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">LOCKED_BY_THREAD_ID</code>
            </p><p>
              スレッドが現在相互排他ロックされている場合、<code class="literal">LOCKED_BY_THREAD_ID</code> はロックしているスレッドの <code class="literal">THREAD_ID</code> になり、そうでない場合、それは <code class="literal">NULL</code> になります。
            </p></li></ul></div><p>
          コードにインストゥルメントされた各相互排他ロックについて、パフォーマンススキーマは次の情報を提供します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">setup_instruments</code> テーブルは、プリフィクス <code class="literal">wait/synch/mutex/</code> を付けて、インストゥルメンテーションポイントの名前を一覧表示します。
            </p></li><li class="listitem"><p>
              一部のコードで相互排他ロックが作成されると、行が <code class="literal">mutex_instances</code> テーブルに追加されます。<code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムは相互排他ロックを一意に識別するプロパティーです。
            </p></li><li class="listitem"><p>
              スレッドが相互排他ロックのロックを試みた場合、<code class="literal">events_waits_current</code> テーブルにそのスレッドの行が表示され、それが相互排他ロックを待機していることが示され (<code class="literal">EVENT_NAME</code> カラム内)、待機されている相互排他ロックが示されます (<code class="literal">OBJECT_INSTANCE_BEGIN</code> カラム内)。
            </p></li><li class="listitem"><p>
              スレッドが相互排他ロックのロックに成功した場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">events_waits_current</code> は相互排他ロックへの待機が完了したことを示します (<code class="literal">TIMER_END</code> および <code class="literal">TIMER_WAIT</code> カラム内)
                </p></li><li class="listitem"><p>
                  完了した待機イベントは <code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> テーブルに追加されます。
                </p></li><li class="listitem"><p>
                  <code class="literal">mutex_instances</code> は相互排他ロックがスレッドによって所有されるようになったことを示します (<code class="literal">THREAD_ID</code> カラム内)。
                </p></li></ul></div></li><li class="listitem"><p>
              スレッドが相互排他ロックのロックを解除すると、<code class="literal">mutex_instances</code> は相互排他ロックに所有者がいなくなったことを示します (<code class="literal">THREAD_ID</code> カラムが <code class="literal">NULL</code> になります)。
            </p></li><li class="listitem"><p>
              相互排他ロックオブジェクトが破棄されると、対応する行が <code class="literal">mutex_instances</code> から削除されます。
            </p></li></ul></div><p>
          次の両方のテーブルに対してクエリーを実行することによって、モニタリングアプリケーションまたは DBA は相互排他ロックを伴うスレッド間のボトルネックやデッドロックを検出できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_current</code>、スレッドが待機している相互排他ロックを確認する場合
            </p></li><li class="listitem"><p>
              <code class="literal">mutex_instances</code>、相互排他ロックを現在所有しているほかのスレッドを確認する場合
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="rwlock-instances-table"></a>22.9.3.4 rwlock_instances テーブル</h4></div></div></div><a class="indexterm" name="idm139979007253440"></a><a class="indexterm" name="idm139979007251264"></a><p>
          <code class="literal">rwlock_instances</code> テーブルは、サーバーの実行中にパフォーマンススキーマによって確認されるすべての <code class="literal">rwlock</code> インスタンス (読み取り書き込みロック) を一覧表示します。<code class="literal">rwlock</code> は、特定の時間にそのスレッドが、次の特定のルールに従って、一部の共通リソースにアクセスできるようにするために、コードで使用される同期メカニズムです。リソースは <code class="literal">rwlock</code> によって<span class="quote">「<span class="quote">保護されている</span>」</span>と呼ばれます。アクセスは共有されている (多くのスレッドが同時に読み取りロックを持つことができる) かまたは排他的 (特定の時間に 1 つのスレッドだけが書き込みロックを持つことができる) のいずれかです。
        </p><p>
          ロックをリクエストしているスレッドの数、およびリクエストされているロックの性質に応じて、アクセスが共有モードで許可されるか、排他モードで許可されるか、またはまったく許可されないかのいずれかになる可能性があり、まずほかのスレッドが終了するのを待機します。
        </p><p>
          <code class="literal">rwlock_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              ロックに関連付けられているインストゥルメント名。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              インストゥルメントされたロックのメモリー内のアドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">WRITE_LOCKED_BY_THREAD_ID</code>
            </p><p>
              スレッドが現在排他 (書き込み) モードでロックされた <code class="literal">rwlock</code> を持つ場合、<code class="literal">WRITE_LOCKED_BY_THREAD_ID</code> はロックしているスレッドの <code class="literal">THREAD_ID</code> になり、そうでない場合、それは <code class="literal">NULL</code> になります。
            </p></li><li class="listitem"><p>
              <code class="literal">READ_LOCKED_BY_COUNT</code>
            </p><p>
              スレッドが現在共有 (読み取り) モードでロックされた <code class="literal">rwlock</code> を持つ場合、<code class="literal">READ_LOCKED_BY_COUNT</code> が 1 増分されます。これはカウンタのみであるため、読み取りロックを保持するスレッドを見つけるためにそれを直接使用することはできませんが、<code class="literal">rwlock</code> に対して読み取りの競合があるかどうかを確認し、現在アクティブなリーダー数を確認するために使用することができます。
            </p></li></ul></div><p>
          次の両方のテーブルに対してクエリーを実行することによって、モニタリングアプリケーションまたは DBA はロックを伴うスレッド間の何らかのボトルネックやデッドロックを検出できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_current</code>、スレッドが待機している <code class="literal">rwlock</code> を確認する場合
            </p></li><li class="listitem"><p>
              <code class="literal">rwlock_instances</code>、<code class="literal">rwlock</code> を現在所有しているほかのスレッドを確認する場合
            </p></li></ul></div><p>
          制限があります。<code class="literal">rwlock_instances</code> は、書き込みロックを保持しているスレッドの識別にのみ使用できますが、読み取りロックを保持しているスレッドの識別には使用できません。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="socket-instances-table"></a>22.9.3.5 socket_instances テーブル</h4></div></div></div><a class="indexterm" name="idm139979007217504"></a><a class="indexterm" name="idm139979007215328"></a><a class="indexterm" name="idm139979007213344"></a><a class="indexterm" name="idm139979007212000"></a><p>
          <code class="literal">socket_instances</code> テーブルは MySQL サーバーへのアクティブな接続のリアルタイムスナップショットを提供します。テーブルには、TCP/IP または Unix ソケットファイル接続ごとに 1 行含まれます。このテーブルで使用可能な情報は、サーバーへのアクティブな接続のリアルタイムスナップショットを提供します。(ソケット操作や送受信されたバイト数などのネットワークアクティビティーを含む、追加の情報はソケットサマリーテーブルで入手できます。<a class="xref" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 ソケットサマリーテーブル">セクション22.9.9.8「ソケットサマリーテーブル」</a>を参照してください)。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM socket_instances\G</code></strong>
*************************** 1. row ***************************
           EVENT_NAME: wait/io/socket/sql/server_unix_socket
OBJECT_INSTANCE_BEGIN: 4316619408
            THREAD_ID: 1
            SOCKET_ID: 16
                   IP: 
                 PORT: 0
                STATE: ACTIVE
*************************** 2. row ***************************
           EVENT_NAME: wait/io/socket/sql/client_connection
OBJECT_INSTANCE_BEGIN: 4316644608
            THREAD_ID: 21
            SOCKET_ID: 39
                   IP: 127.0.0.1
                 PORT: 55233
                STATE: ACTIVE
*************************** 3. row ***************************
           EVENT_NAME: wait/io/socket/sql/server_tcpip_socket
OBJECT_INSTANCE_BEGIN: 4316699040
            THREAD_ID: 1
            SOCKET_ID: 14
                   IP: 0.0.0.0
                 PORT: 50603
                STATE: ACTIVE
</pre><p>
          ソケットインストゥルメントは形式 <code class="literal">wait/io/socket/sql/<em class="replaceable"><code>socket_type</code></em></code> の名前を持ち、次のように使用されます。
        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
              サーバーには、それがサポートする各ネットワークプロトコルの待機ソケットがあります。TCP/IP または Unix ソケットファイル接続の待機ソケットに関連付けられているインストゥルメントは、それぞれ <code class="literal">server_tcpip_socket</code> または <code class="literal">server_unix_socket</code> の <em class="replaceable"><code>socket_type</code></em> 値を持ちます。
            </p></li><li class="listitem"><p>
              待機ソケットが接続を検出すると、サーバーは接続を、個別のスレッドによって管理される新しいソケットに転送します。新しい接続スレッドのインストゥルメントは、<code class="literal">client_connection</code> の <em class="replaceable"><code>socket_type</code></em> 値を持ちます。
            </p></li><li class="listitem"><p>
              接続が終了すると、<code class="literal">socket_instances</code> 内のそれに対応する行が削除されます。
            </p></li></ol></div><p>
          <code class="literal">socket_instances</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントを生成した <code class="literal">wait/io/socket/*</code> インストゥルメントの名前。これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 パフォーマンススキーマインストゥルメント命名規則">セクション22.4「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              このカラムは一意にソケットを識別します。この値はメモリー内のオブジェクトのアドレスです。
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              サーバーによって割り当てられた内部スレッド識別子。各ソケットは単一のスレッドによって管理されるため、各ソケットはスレッドにマップでき、スレッドはサーバープロセスにマップできます。
            </p></li><li class="listitem"><p>
              <code class="literal">SOCKET_ID</code>
            </p><p>
              ソケットに割り当てられている内部ファイルハンドル。
            </p></li><li class="listitem"><p>
              <code class="literal">IP</code>
            </p><p>
              クライアントの IP アドレス。この値は IPv4 または IPv6 アドレスのいずれか、または Unix ソケットファイル接続を示すブランクになります。
            </p></li><li class="listitem"><p>
              <code class="literal">PORT</code>
            </p><p>
              0 から 65535 の範囲の TCP/IP ポート番号。
            </p></li><li class="listitem"><p>
              <code class="literal">STATE</code>
            </p><p>
              <code class="literal">IDLE</code> または <code class="literal">ACTIVE</code> のいずれかのソケットステータス。アクティブなソケットの待機時間は、対応するソケットインストゥルメントを使用して追跡されます。アイドルソケットの待機時間は、<code class="literal">idle</code> インストゥルメントを使用して追跡されます。
            </p><p>
              ソケットはクライアントからのリクエストを待機している場合、アイドルになります。ソケットがアイドルになると、ソケットを追跡している <code class="literal">socket_instances</code> 内のイベント行が <code class="literal">ACTIVE</code> のステータスから <code class="literal">IDLE</code> に切り替わります。<code class="literal">EVENT_NAME</code> 値は <code class="literal">wait/io/socket/*</code> のままになりますが、インストゥルメントのタイミングは一時停止されます。代わりに、<code class="literal">idle</code> の <code class="literal">EVENT_NAME</code> 値で <code class="literal">events_waits_current</code> テーブルにイベントが生成されます。
            </p><p>
              次のリクエストを受信すると、<code class="literal">idle</code> イベントが終了し、ソケットインスタンスが <code class="literal">IDLE</code> から <code class="literal">ACTIVE</code> に切り替わり、ソケットインストゥルメントのタイミングが再開します。
            </p></li></ul></div><p>
          <code class="literal">IP:PORT</code> カラムの組み合わせの値は接続を識別します。この組み合わせの値は、ソケットイベントの発生元の接続を識別するために、<code class="literal">events_waits_<em class="replaceable"><code>xxx</code></em></code> テーブルの <code class="literal">OBJECT_NAME</code> カラムで使用されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Unix ドメインリスナーソケット (<code class="literal">server_unix_socket</code>) の場合、ポートは 0 で IP は <code class="literal">''</code> です。
            </p></li><li class="listitem"><p>
              Unix ドメインリスナー経由のクライアント接続 (<code class="literal">client_connection</code>) の場合、ポートは 0 で IP は <code class="literal">''</code> です。
            </p></li><li class="listitem"><p>
              TCP/IP サーバーリスナーソケット (<code class="literal">server_tcpip_socket</code>) の場合、ポートは常にマスターポート (たとえば 3306) で、IP は常に <code class="literal">0.0.0.0</code> です。
            </p></li><li class="listitem"><p>
              TCP/IP リスナー経由のクライアント接続 (<code class="literal">client_connection</code>) の場合、ポートはサーバーが割り当てたものになりますが、0 にはなりません。IP は発信元ホストの IP (ローカルホストの場合 <code class="literal">127.0.0.1</code> または <code class="literal">::1</code>) です
            </p></li></ul></div><p>
          <code class="literal">socket_instances</code> テーブルは MySQL 5.6.3 で追加されました。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-wait-tables"></a>22.9.4 パフォーマンススキーマ待機イベントテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#events-waits-current-table">22.9.4.1 events_waits_current テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-waits-history-table">22.9.4.2 events_waits_history テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-waits-history-long-table">22.9.4.3 events_waits_history_long テーブル</a></span></dt></dl></div><p>
        これらのテーブルは待機イベントを格納します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_waits_current</code>: 現在の待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_history</code>: 各スレッドの最新の待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_history_long</code>: 全体の最新の待機イベント
          </p></li></ul></div><p>
        次のセクションでそれらのテーブルについて説明します。待機イベントに関する情報を集計するサマリーテーブルもあります。<a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 イベント待機サマリーテーブル">セクション22.9.9.1「イベント待機サマリーテーブル」</a>を参照してください。
      </p><h4><a name="wait-event-configuration"></a>待機イベント構成</h4><p>
        待機イベントの収集を有効にするには、関連インストゥルメントとコンシューマを有効にします。
      </p><p>
        <code class="literal">setup_instruments</code> テーブルには、<code class="literal">wait</code> で始まる名前を持つインストゥルメントが格納されます。例:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE NAME LIKE 'wait/io/file/innodb%';</code></strong>
+--------------------------------------+---------+-------+
| NAME                                 | ENABLED | TIMED |
+--------------------------------------+---------+-------+
| wait/io/file/innodb/innodb_data_file | YES     | YES   |
| wait/io/file/innodb/innodb_log_file  | YES     | YES   |
| wait/io/file/innodb/innodb_temp_file | YES     | YES   |
+--------------------------------------+---------+-------+
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE NAME LIKE 'wait/io/socket/%';</code></strong>
+----------------------------------------+---------+-------+
| NAME                                   | ENABLED | TIMED |
+----------------------------------------+---------+-------+
| wait/io/socket/sql/server_tcpip_socket | NO      | NO    |
| wait/io/socket/sql/server_unix_socket  | NO      | NO    |
| wait/io/socket/sql/client_connection   | NO      | NO    |
+----------------------------------------+---------+-------+
</pre><p>
        待機イベントの収集を変更するには、関連インストゥルメントの <code class="literal">ENABLED</code> および <code class="literal">TIMING</code> カラムを変更します。例:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'YES', TIMED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/socket/sql/%';</code></strong>
</pre><p>
        <code class="literal">setup_consumers</code> テーブルには現在および最近の待機イベントテーブル名に対応する名前を持つコンシューマ値が格納されます。これらのコンシューマは待機イベントのコレクションをフィルタ処理するために使用できます。待機コンシューマはデフォルトで無効にされています。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers WHERE NAME LIKE '%waits%';</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| events_waits_current      | NO      |
| events_waits_history      | NO      |
| events_waits_history_long | NO      |
+---------------------------+---------+
</pre><p>
        すべての待機コンシューマを有効にするには、次を実行します。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers SET ENABLED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE '%waits%';</code></strong>
</pre><p>
        <code class="literal">setup_timers</code> テーブルには、待機イベントのタイミングの単位を示す <code class="literal">wait</code> の <code class="literal">NAME</code> 値のある行が格納されます。デフォルトの単位は <code class="literal">CYCLE</code> です。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers WHERE NAME = 'wait';</code></strong>
+------+------------+
| NAME | TIMER_NAME |
+------+------------+
| wait | CYCLE      |
+------+------------+
</pre><p>
        タイミングの単位を変更するには、<code class="literal">TIMER_NAME</code> 値を変更します。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'NANOSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait';</code></strong>
</pre><p>
        イベント収集の構成に関する追加情報については、<a class="xref" href="performance-schema.html#performance-schema-configuration" title="22.2 パフォーマンススキーマ構成">セクション22.2「パフォーマンススキーマ構成」</a>を参照してください。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-waits-current-table"></a>22.9.4.1 events_waits_current テーブル</h4></div></div></div><a class="indexterm" name="idm139979007106208"></a><a class="indexterm" name="idm139979007104048"></a><p>
          <code class="literal">events_waits_current</code> テーブルには、スレッドの最新のモニター対象待機イベントの現在のステータスを示すスレッドごとに 1 行で現在の待機イベントが格納されます。
        </p><p>
          <code class="literal">events_waits_current</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          待機イベント行を格納するテーブルのうち、<code class="literal">events_waits_current</code> はもっとも基本的です。待機イベント行を格納するほかのテーブルは論理的に現在のイベントから派生します。たとえば、<code class="literal">events_waits_history</code> および <code class="literal">events_waits_history_long</code> テーブルは固定の行数以下の最新の待機イベントのコレクションです。
        </p><p>
          待機イベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="22.9.4 パフォーマンススキーマ待機イベントテーブル">セクション22.9.4「パフォーマンススキーマ待機イベントテーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_waits_current</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>
            </p><p>
              イベントに関連付けられたスレッドとイベントの起動時のスレッドの現在のイベント番号。一緒に取得された <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_ID</code> 値は、行を一意に識別する主キーを形成します。2 つの行が同じ値のペアを持つことはありません。
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              このカラムは、イベントの起動時に <code class="literal">NULL</code> に設定され、イベントの終了時にスレッドの現在のイベント番号に更新されます。このカラムは、MySQL 5.6.4 で追加されました。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントを生成したインストゥルメントの名前。これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 パフォーマンススキーマインストゥルメント命名規則">セクション22.4「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              イベントを生成した、インストゥルメントされたコードを格納するソースファイルの名前と、インストゥルメンテーションが行われたファイルの行番号。これにより、ソースをチェックして、コードに含まれるものを正確に判断することができます。たとえば、相互排他ロックまたはロックがブロックされた場合、これが発生するコンテキストをチェックできます。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、<code class="literal">TIMER_WAIT</code>
            </p><p>
              イベントのタイミング情報。これらの値の単位はピコ秒 (秒の 1 兆分の 1) です。<code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値は、イベントのタイミングが開始されたときと終了したときを示します。<code class="literal">TIMER_WAIT</code> はイベントの経過時間 (期間) です。
            </p><p>
              イベントが終了していない場合、<code class="literal">TIMER_END</code> と <code class="literal">TIMER_WAIT</code> は <code class="literal">NULL</code> です。
            </p><p>
              イベントが <code class="literal">TIMED = NO</code> のインストゥルメントから生成されている場合、タイミング情報は収集されず、<code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> はすべて <code class="literal">NULL</code> になります。
            </p><p>
              イベント時間の単位としてのピコ秒および時間値に影響する要因については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 パフォーマンススキーマイベントタイミング">セクション22.2.3.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">SPINS</code>
            </p><p>
              相互排他ロックの場合、スピンラウンドの数。値が <code class="literal">NULL</code> の場合、コードはスピンラウンドを使用しないか、スピニングがインストゥルメントされません。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>、<code class="literal">OBJECT_NAME</code>、<code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              これらのカラムは<span class="quote">「<span class="quote">作用している</span>」</span>オブジェクトを識別します。その意味は、オブジェクトの種類によって異なります。
            </p><p>
              同期オブジェクト (<code class="literal">cond</code>、<code class="literal">mutex</code>、および <code class="literal">rwlock</code>) の場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code>、<code class="literal">OBJECT_NAME</code>、および <code class="literal">OBJECT_TYPE</code> は <code class="literal">NULL</code> です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> はメモリー内の同期オブジェクトのアドレスです。
                </p></li></ul></div><p>
              ファイル I/O オブジェクトの場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code> は <code class="literal">NULL</code> です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> はファイル名です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_TYPE</code> は <code class="literal">FILE</code> です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> はメモリー内のアドレスです。
                </p></li></ul></div><p>
              ソケットオブジェクトの場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> はソケットの <code class="literal">IP:PORT</code> 値です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> はメモリー内のアドレスです。
                </p></li></ul></div><p>
              テーブル I/O オブジェクトの場合:
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code> はテーブルを格納するスキーマの名前です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> はテーブル名です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_TYPE</code> は永続的ベーステーブルの <code class="literal">TABLE</code> または一時テーブルの <code class="literal">TEMPORARY TABLE</code> です。
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> はメモリー内のアドレスです。
                </p></li></ul></div><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code> 値自体には、さまざまな値がさまざまなオブジェクトを示すことを除いて、意味がありません。<code class="literal">OBJECT_INSTANCE_BEGIN</code> はデバッグに使用できます。たとえば、それを <code class="literal">GROUP BY OBJECT_INSTANCE_BEGIN</code> で使用して、1,000 相互排他ロック (つまり、データの 1,000 ページまたはブロックを保護する) の負荷が均等に広がっているか、または少数のボトルネックだけに関わっているかを確認できます。これにより、ログファイルやほかのデバッグまたはパフォーマンスツールで同じオブジェクトアドレスが見られた場合に、情報のほかのソースと関連付けることができます。
            </p></li><li class="listitem"><p>
              <code class="literal">INDEX_NAME</code>
            </p><p>
              使用されるインデックスの名前。<code class="literal">PRIMARY</code> はテーブルプライマリインデックスを示します。<code class="literal">NULL</code> はインデックスが使用されなかったことを意味します。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>
            </p><p>
              このイベントが中にネストされているイベントの <code class="literal">EVENT_ID</code> 値。MySQL 5.6.3 より前では、このカラムは常に <code class="literal">NULL</code> です。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              ネストしているイベントの種類。値は <code class="literal">STATEMENT</code>、<code class="literal">STAGE</code>、または <code class="literal">WAIT</code> です。このカラムは、MySQL 5.6.3 で追加されました。
            </p></li><li class="listitem"><p>
              <code class="literal">OPERATION</code>
            </p><p>
              <code class="literal">lock</code>、<code class="literal">read</code>、または <code class="literal">write</code> などの実行される操作の種類。
            </p></li><li class="listitem"><p>
              <code class="literal">NUMBER_OF_BYTES</code>
            </p><p>
              操作によって読み取りまたは書き込まれるバイト数。テーブル I/O 待機 (<code class="literal">wait/io/table/sql/handler</code> インストゥルメントのイベント) の場合、<code class="literal">NUMBER_OF_BYTES</code> は <code class="literal">NULL</code> になります。
            </p></li><li class="listitem"><p>
              <code class="literal">FLAGS</code>
            </p><p>
              将来使用するために予約されています。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-waits-history-table"></a>22.9.4.2 events_waits_history テーブル</h4></div></div></div><a class="indexterm" name="idm139979006996368"></a><a class="indexterm" name="idm139979006994208"></a><p>
          <code class="literal">events_waits_history</code> テーブルには、スレッドごとの最新の <em class="replaceable"><code>N</code></em> 待機イベントが格納されます。<em class="replaceable"><code>N</code></em> の値はサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_waits_history_size</code> システム変数を設定します。待機イベントはそれらが終了するまでテーブルに追加されません。新しいイベントが追加されたときに、テーブルがいっぱいである場合、古いイベントが破棄されます。
        </p><p>
          <code class="literal">events_waits_history</code> テーブルは <code class="literal">events_waits_current</code> と同じ構造を持ちます。<a class="xref" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 events_waits_current テーブル">セクション22.9.4.1「events_waits_current テーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_waits_history</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          待機イベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="22.9.4 パフォーマンススキーマ待機イベントテーブル">セクション22.9.4「パフォーマンススキーマ待機イベントテーブル」</a>を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-waits-history-long-table"></a>22.9.4.3 events_waits_history_long テーブル</h4></div></div></div><a class="indexterm" name="idm139979006979696"></a><a class="indexterm" name="idm139979006977456"></a><p>
          <code class="literal">events_waits_history_long</code> テーブルには、最新の <em class="replaceable"><code>N</code></em> 待機イベントが格納されます。<em class="replaceable"><code>N</code></em> の値はサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_waits_history_long_size</code> システム変数を設定します。待機イベントはそれらが終了するまでテーブルに追加されません。新しいイベントが追加されたときに、テーブルがいっぱいである場合、古いイベントが破棄されます。
        </p><p>
          <code class="literal">events_waits_history_long</code> テーブルは <code class="literal">events_waits_current</code> と同じ構造を持ちます。<a class="xref" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 events_waits_current テーブル">セクション22.9.4.1「events_waits_current テーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_waits_history_long</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          待機イベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="22.9.4 パフォーマンススキーマ待機イベントテーブル">セクション22.9.4「パフォーマンススキーマ待機イベントテーブル」</a>を参照してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-stage-tables"></a>22.9.5 パフォーマンススキーマステージイベントテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#events-stages-current-table">22.9.5.1 events_stages_current テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-stages-history-table">22.9.5.2 events_stages_history テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-stages-history-long-table">22.9.5.3 events_stages_history_long テーブル</a></span></dt></dl></div><p>
        MySQL 5.6.3 現在、パフォーマンススキーマは、ステートメントの解析、テーブルのオープン、または <code class="literal">filesort</code> 操作の実行などのステートメント実行プロセス中のステップであるステージをインストゥルメントします。ステージは <code class="literal">SHOW PROCESSLIST</code> によって表示されるか、または <code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> テーブルに表示されるスレッドの状態に対応します。ステージは、状態値が変化したときに開始および終了します。
      </p><p>
        イベント階層内で、待機イベントはステージイベント内にネストし、ステージイベントはステートメントイベント内にネストします。
      </p><p>
        これらのテーブルはステージイベントを格納します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_stages_current</code>: 現在のステージイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_history</code>: 各スレッドの最新のステージイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_history_long</code>: 全体の最新のステージイベント
          </p></li></ul></div><p>
        次のセクションでそれらのテーブルについて説明します。ステージイベントに関する情報を集計するサマリーテーブルもあります。<a class="xref" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 ステージサマリーテーブル">セクション22.9.9.2「ステージサマリーテーブル」</a>を参照してください。
      </p><h4><a name="stage-event-configuration"></a>ステージイベント構成</h4><p>
        ステージイベントの収集を有効にするには、関連インストゥルメントとコンシューマを有効にします。
      </p><p>
        <code class="literal">setup_instruments</code> テーブルには、<code class="literal">stage</code> で始まる名前を持つインストゥルメントが格納されます。これらのインストゥルメントはデフォルトで無効にされています。例:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE NAME RLIKE 'stage/sql/[a-c]';</code></strong>
+----------------------------------------------------+---------+-------+
| NAME                                               | ENABLED | TIMED |
+----------------------------------------------------+---------+-------+
| stage/sql/After create                             | NO      | NO    |
| stage/sql/allocating local table                   | NO      | NO    |
| stage/sql/altering table                           | NO      | NO    |
| stage/sql/committing alter table to storage engine | NO      | NO    |
| stage/sql/Changing master                          | NO      | NO    |
| stage/sql/Checking master version                  | NO      | NO    |
| stage/sql/checking permissions                     | NO      | NO    |
| stage/sql/checking privileges on cached query      | NO      | NO    |
| stage/sql/checking query cache for query           | NO      | NO    |
| stage/sql/cleaning up                              | NO      | NO    |
| stage/sql/closing tables                           | NO      | NO    |
| stage/sql/Connecting to master                     | NO      | NO    |
| stage/sql/converting HEAP to MyISAM                | NO      | NO    |
| stage/sql/Copying to group table                   | NO      | NO    |
| stage/sql/Copying to tmp table                     | NO      | NO    |
| stage/sql/copy to tmp table                        | NO      | NO    |
| stage/sql/Creating delayed handler                 | NO      | NO    |
| stage/sql/Creating sort index                      | NO      | NO    |
| stage/sql/creating table                           | NO      | NO    |
| stage/sql/Creating tmp table                       | NO      | NO    |
+----------------------------------------------------+---------+-------+
</pre><p>
        ステージイベントの収集を変更するには、関連インストゥルメントの <code class="literal">ENABLED</code> および <code class="literal">TIMING</code> カラムを変更します。例:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'YES', TIMED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'stage/sql/altering table';</code></strong>
</pre><p>
        <code class="literal">setup_consumers</code> テーブルには現在および最近のステージイベントテーブル名に対応する名前を持つコンシューマ値が格納されます。これらのコンシューマはステージイベントのコレクションをフィルタ処理するために使用できます。ステージコンシューマはデフォルトで無効にされています。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers WHERE NAME LIKE '%stages%';</code></strong>
+----------------------------+---------+
| NAME                       | ENABLED |
+----------------------------+---------+
| events_stages_current      | NO      |
| events_stages_history      | NO      |
| events_stages_history_long | NO      |
+----------------------------+---------+
</pre><p>
        すべてのステージコンシューマを有効にするには、次を実行します。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers SET ENABLED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE '%stages%';</code></strong>
</pre><p>
        <code class="literal">setup_timers</code> テーブルには、ステージイベントのタイミングの単位を示す <code class="literal">stage</code> の <code class="literal">NAME</code> 値のある行が格納されます。デフォルトの単位は <code class="literal">NANOSECOND</code> です。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers WHERE NAME = 'stage';</code></strong>
+-------+------------+
| NAME  | TIMER_NAME |
+-------+------------+
| stage | NANOSECOND |
+-------+------------+
</pre><p>
        タイミングの単位を変更するには、<code class="literal">TIMER_NAME</code> 値を変更します。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'MICROSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'stage';</code></strong>
</pre><p>
        イベント収集の構成に関する追加情報については、<a class="xref" href="performance-schema.html#performance-schema-configuration" title="22.2 パフォーマンススキーマ構成">セクション22.2「パフォーマンススキーマ構成」</a>を参照してください。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-stages-current-table"></a>22.9.5.1 events_stages_current テーブル</h4></div></div></div><a class="indexterm" name="idm139979006918784"></a><a class="indexterm" name="idm139979006916624"></a><p>
          <code class="literal">events_stages_current</code> テーブルには、スレッドの最新のモニター対象ステージイベントの現在のステータスを示すスレッドごとに 1 行で現在のステージイベントが格納されます。
        </p><p>
          <code class="literal">events_stages_current</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          ステージイベント行を格納するテーブルのうち、<code class="literal">events_stages_current</code> はもっとも基本的です。ステージイベント行を格納するほかのテーブルは論理的に現在のイベントから派生します。たとえば、<code class="literal">events_stages_history</code> および <code class="literal">events_stages_history_long</code> テーブルは固定の行数以下の最新のステージイベントのコレクションです。
        </p><p>
          ステージイベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="22.9.5 パフォーマンススキーマステージイベントテーブル">セクション22.9.5「パフォーマンススキーマステージイベントテーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_stages_current</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>
            </p><p>
              イベントに関連付けられたスレッドとイベントの起動時のスレッドの現在のイベント番号。一緒に取得された <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_ID</code> 値は、行を一意に識別する主キーを形成します。2 つの行が同じ値のペアを持つことはありません。
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              このカラムは、イベントの起動時に <code class="literal">NULL</code> に設定され、イベントの終了時にスレッドの現在のイベント番号に更新されます。このカラムは、MySQL 5.6.4 で追加されました。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントを生成したインストゥルメントの名前。これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 パフォーマンススキーマインストゥルメント命名規則">セクション22.4「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              イベントを生成した、インストゥルメントされたコードを格納するソースファイルの名前と、インストゥルメンテーションが行われたファイルの行番号。これにより、ソースをチェックして、コードに含まれるものを正確に判断することができます。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、<code class="literal">TIMER_WAIT</code>
            </p><p>
              イベントのタイミング情報。これらの値の単位はピコ秒 (秒の 1 兆分の 1) です。<code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値は、イベントのタイミングが開始されたときと終了したときを示します。<code class="literal">TIMER_WAIT</code> はイベントの経過時間 (期間) です。
            </p><p>
              イベントが終了していない場合、<code class="literal">TIMER_END</code> と <code class="literal">TIMER_WAIT</code> は <code class="literal">NULL</code> です。
            </p><p>
              イベントが <code class="literal">TIMED = NO</code> のインストゥルメントから生成されている場合、タイミング情報は収集されず、<code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> はすべて <code class="literal">NULL</code> になります。
            </p><p>
              イベント時間の単位としてのピコ秒および時間値に影響する要因については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 パフォーマンススキーマイベントタイミング">セクション22.2.3.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>
            </p><p>
              このイベントが中にネストされているイベントの <code class="literal">EVENT_ID</code> 値。ステージイベントのネストしているイベントは通常ステートメントイベントです。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              ネストしているイベントの種類。値は <code class="literal">STATEMENT</code>、<code class="literal">STAGE</code>、または <code class="literal">WAIT</code> です。
            </p></li></ul></div><p>
          <code class="literal">events_stages_current</code> テーブルは MySQL 5.6.3 で追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-stages-history-table"></a>22.9.5.2 events_stages_history テーブル</h4></div></div></div><a class="indexterm" name="idm139979006864048"></a><a class="indexterm" name="idm139979006861888"></a><p>
          <code class="literal">events_stages_history</code> テーブルにはスレッドごとに最新の <em class="replaceable"><code>N</code></em> ステージイベントが格納されます。<em class="replaceable"><code>N</code></em> の値はサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_stages_history_size</code> システム変数を設定します。ステージイベントは終了するまでテーブルに追加されません。新しいイベントが追加されたときに、テーブルがいっぱいである場合、古いイベントが破棄されます。
        </p><p>
          <code class="literal">events_stages_history</code> テーブルは <code class="literal">events_stages_current</code> と同じ構造を持ちます。<a class="xref" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 events_stages_current テーブル">セクション22.9.5.1「events_stages_current テーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_stages_history</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          <code class="literal">events_stages_history</code> テーブルは MySQL 5.6.3 で追加されました。
        </p><p>
          ステージイベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="22.9.5 パフォーマンススキーマステージイベントテーブル">セクション22.9.5「パフォーマンススキーマステージイベントテーブル」</a>を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-stages-history-long-table"></a>22.9.5.3 events_stages_history_long テーブル</h4></div></div></div><a class="indexterm" name="idm139979006845920"></a><a class="indexterm" name="idm139979006843680"></a><p>
          <code class="literal">events_stages_history_long</code> テーブルには最新の <em class="replaceable"><code>N</code></em> ステージイベントが格納されます。<em class="replaceable"><code>N</code></em> の値はサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_stages_history_long_size</code> システム変数を設定します。ステージイベントは終了するまでテーブルに追加されません。新しいイベントが追加されたときに、テーブルがいっぱいである場合、古いイベントが破棄されます。
        </p><p>
          <code class="literal">events_stages_history_long</code> テーブルは <code class="literal">events_stages_current</code> と同じ構造を持ちます。<a class="xref" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 events_stages_current テーブル">セクション22.9.5.1「events_stages_current テーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_stages_history_long</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          <code class="literal">events_stages_history_long</code> テーブルは MySQL 5.6.3 で追加されました。
        </p><p>
          ステージイベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="22.9.5 パフォーマンススキーマステージイベントテーブル">セクション22.9.5「パフォーマンススキーマステージイベントテーブル」</a>を参照してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-statement-tables"></a>22.9.6 パフォーマンススキーマステートメントイベントテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#events-statements-current-table">22.9.6.1 events_statements_current テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-statements-history-table">22.9.6.2 events_statements_history テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-statements-history-long-table">22.9.6.3 events_statements_history_long テーブル</a></span></dt></dl></div><p>
        MySQL 5.6.3 現在、パフォーマンススキーマはステートメント実行をインストゥルメントします。ステートイベントイベントはイベント階層の高いレベルで発生します。待機イベントはステージイベント内にネストし、ステージイベントはステートメントイベント内にネストします。
      </p><p>
        これらのテーブルはステートメントイベントを格納します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_statements_current</code>: 現在のステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_history</code>: 各スレッドの最新のステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_history_long</code>: 全体の最新のステートメントイベント
          </p></li></ul></div><p>
        次のセクションでそれらのテーブルについて説明します。ステートメントイベントに関する情報を集計するサマリーテーブルもあります。<a class="xref" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 ステートメントサマリーテーブル">セクション22.9.9.3「ステートメントサマリーテーブル」</a>を参照してください。
      </p><h4><a name="statement-event-configuration"></a>ステートメントイベント構成</h4><p>
        ステートメントイベントの収集を有効にするには、関連インストゥルメントとコンシューマを有効にします。
      </p><p>
        <code class="literal">setup_instruments</code> テーブルには、<code class="literal">statement</code> で始まる名前を持つインストゥルメントが格納されます。これらのインストゥルメントはデフォルトで有効にされています。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE NAME LIKE 'statement/%';</code></strong>
+---------------------------------------------+---------+-------+
| NAME                                        | ENABLED | TIMED |
+---------------------------------------------+---------+-------+
| statement/sql/select                        | YES     | YES   |
| statement/sql/create_table                  | YES     | YES   |
| statement/sql/create_index                  | YES     | YES   |
...
| statement/sp/stmt                           | YES     | YES   |
| statement/sp/set                            | YES     | YES   |
| statement/sp/set_trigger_field              | YES     | YES   |
| statement/scheduler/event                   | YES     | YES   |
| statement/com/Sleep                         | YES     | YES   |
| statement/com/Quit                          | YES     | YES   |
| statement/com/Init DB                       | YES     | YES   |
...
| statement/abstract/Query                    | YES     | YES   |
| statement/abstract/new_packet               | YES     | YES   |
| statement/abstract/relay_log                | YES     | YES   |
+---------------------------------------------+---------+-------+
</pre><p>
        ステートメントイベントの収集を変更するには、関連インストゥルメントの <code class="literal">ENABLED</code> および <code class="literal">TIMING</code> カラムを変更します。例:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'statement/com/%';</code></strong>
</pre><p>
        <code class="literal">setup_consumers</code> テーブルには現在および最近のステートメントイベントテーブル名に対応する名前を持つコンシューマ値とステートメントダイジェストコンシューマが格納されます。これらのコンシューマはステートメントイベントのコレクションとステートメントダイジェストをフィルタ処理するために使用できます。<code class="literal">events_statements_current</code> と <code class="literal">statements_digest</code> のみがデフォルトで有効にされています。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers WHERE NAME LIKE '%statements%';</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
        すべてのステートメントコンシューマを有効にするには、次を実行します。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers SET ENABLED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE '%statements%';</code></strong>
</pre><p>
        <code class="literal">setup_timers</code> テーブルには、ステートメントイベントのタイミングの単位を示す <code class="literal">statement</code> の <code class="literal">NAME</code> 値のある行が格納されます。デフォルトの単位は <code class="literal">NANOSECOND</code> です。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers WHERE NAME = 'statement';</code></strong>
+-----------+------------+
| NAME      | TIMER_NAME |
+-----------+------------+
| statement | NANOSECOND |
+-----------+------------+
</pre><p>
        タイミングの単位を変更するには、<code class="literal">TIMER_NAME</code> 値を変更します。
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'MICROSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'statement';</code></strong>
</pre><p>
        イベント収集の構成に関する追加情報については、<a class="xref" href="performance-schema.html#performance-schema-configuration" title="22.2 パフォーマンススキーマ構成">セクション22.2「パフォーマンススキーマ構成」</a>を参照してください。
      </p><h4><a name="idm139979006789056"></a>ステートメントモニタリング</h4><p>
        ステートメントのモニタリングは、サーバーがスレッドに対してアクティビティーがリクエストされていることを確認した時点から、すべてのアクティビティーが終了した時点までに開始されます。一般に、これはサーバーがクライアントから最初のパケットを受け取ったときから、サーバーが応答の送信を終了したときまでを意味します。モニタリングは、トップレベルステートメントに対してのみ行われます。ストアドプログラムとサブクエリー内のステートメントは別々に見られません。
      </p><p>
        パフォーマンススキーマがリクエスト (サーバーコマンドまたは SQL ステートメント) をインストゥルメントする場合、最終的なインストゥルメント名に到達するまで、より一般的 (または<span class="quote">「<span class="quote">抽象的</span>」</span>) から、より具体的へと段階を追って進むインストゥルメント名を使用します。
      </p><p>
        最終インストゥルメント名はサーバーコマンドと SQL ステートメントに対応します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            サーバーコマンドは <code class="filename">mysql_com.h</code> ヘッダーファイルに定義され、<code class="filename">sql/sql_parse.cc</code> で処理される <code class="literal">COM_<em class="replaceable"><code>xxx</code></em> codes</code> に対応します。例は <code class="literal">COM_PING</code> と <code class="literal">COM_QUIT</code> です。コマンドのインストゥルメントは、<code class="literal">statement/com/Ping</code> や <code class="literal">statement/com/Quit</code> などの <code class="literal">statement/com</code> から始まる名前を持ちます。
          </p></li><li class="listitem"><p>
            SQL ステートメントは <code class="literal">DELETE FROM t1</code> または <code class="literal">SELECT * FROM t2</code> などのテキストとして表されます。SQL ステートメントのインストゥルメントは、<code class="literal">statement/sql/delete</code> や <code class="literal">statement/sql/select</code> などの <code class="literal">statement/sql</code> から始まる名前を持ちます。
          </p></li></ul></div><p>
        いくつかの最終インストゥルメント名はエラー処理に固有です。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">statement/com/Error</code> は帯域外のサーバーによって受信されたメッセージから構成されます。これはサーバーが理解しないクライアントによって送信されたコマンドを検出するために使用できます。これは、構成が誤っているか、サーバーよりも新しい MySQL のバージョンを使用しているクライアントや、サーバーへの攻撃を試みているクライアントの識別などの目的で役に立つことがあります。
          </p></li><li class="listitem"><p>
            <code class="literal">statement/sql/error</code> は解析に失敗した SQL ステートメントから構成されます。これはクライアントによって送信された不正な形式のクエリーを検出するために使用できます。解析に失敗するクエリーは、解析するが、実行中のエラーのために失敗するクエリーと異なります。たとえば、<code class="literal">SELECT * FROM</code> は不正な形式で、<code class="literal">statement/sql/error</code> インストゥルメントが使用されます。対照的に <code class="literal">SELECT *</code> は解析しますが、<code class="literal">「表が指定されていません」</code>エラーを伴って失敗します。この場合、<code class="literal">statement/sql/select</code> が使用され、ステートメントイベントにはエラーの性質を示す情報が含まれます。
          </p></li></ul></div><p>
        リクエストはこれらの任意のソースから取得できます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            リクエストをパケットとして送信するクライアントからのコマンドまたはステートメントリクエストとして
          </p></li><li class="listitem"><p>
            レプリケーションスレーブ上のリレーログから読み取られたステートメント文字列として (MySQL 5.6.13 以降)
          </p></li></ul></div><p>
        リクエストの詳細は最初は不明で、パフォーマンススキーマはリクエストのソースに依存する順序で、抽象から特定のインストゥルメント名に進みます。
      </p><p>
        クライアントから受信したリクエストの場合:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            サーバーがソケットレベルで新しいパケットを検出すると、新しいステートメントが <code class="literal">statement/abstract/new_packet</code> の抽象インストゥルメント名で開始されます。
          </p></li><li class="listitem"><p>
            サーバーはパケット番号を読み取ると、受信したリクエストの種類について詳しく知り、パフォーマンススキーマがインストゥルメント名を絞り込みます。たとえば、リクエストが <code class="literal">COM_PING</code> パケットの場合、インストゥルメント名は <code class="literal">statement/com/Ping</code> になり、それが最終名になります。リクエストが <code class="literal">COM_QUERY</code> パケットの場合、それは SQL ステートメントに対応するが、特定のステートメントの種類ではないことがわかります。この場合、インストゥルメントはある抽象名から、やや具体的だが、まだ抽象名である <code class="literal">statement/abstract/Query</code> に変更され、リクエストはさらに分類する必要があります。
          </p></li><li class="listitem"><p>
            リクエストがステートメントである場合、ステートメントテキストが読み取られ、パーサーに提供されます。解析後、正確なステートメントの種類が認識されます。リクエストがたとえば <code class="literal">INSERT</code> ステートメントの場合、パフォーマンススキーマはインストゥルメント名を <code class="literal">statement/abstract/Query</code> から最終名である <code class="literal">statement/sql/insert</code> に絞り込みます。
          </p></li></ol></div><p>
        レプリケーションスレーブ上のリレーログからステートメントとして読み取られるリクエストの場合:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            リレーログ内のステートメントはテキストとして保存され、そのように読み取られます。ネットワークプロトコルはないため、<code class="literal">statement/abstract/new_packet</code> インストゥルメントは使用されません。代わりに、初期インストゥルメントは <code class="literal">statement/abstract/relay_log</code> になります。
          </p></li><li class="listitem"><p>
            ステートメントが解析されると、正確なステートメントの種類が認識されます。リクエストがたとえば <code class="literal">INSERT</code> ステートメントの場合、パフォーマンススキーマはインストゥルメント名を <code class="literal">statement/abstract/Query</code> から最終名である <code class="literal">statement/sql/insert</code> に絞り込みます。
          </p></li></ol></div><p>
        先述の説明はステートメントベースのレプリケーションにのみ適用されます。行ベースのレプリケーションでは、行の変更を処理しながら、スレーブで実行されるテーブル I/O をインストゥルメントできますが、リレーログ内の行イベントは、個別のステートメントとして表示されません。
      </p><p>
        ステートメントに対して収集される統計の場合、各ステートメントの種類に使用される最終 <code class="literal">statement/sql/*</code> インストゥルメントを有効にするだけでは十分ではありません。抽象 <code class="literal">statement/abstract/*</code> インストゥルメントも有効にする必要があります。すべてのステートメントインストゥルメントがデフォルトで有効にされるため、これは通常問題にならないはずです。ただし、ステートメントインストゥルメントを選択して有効または無効にするアプリケーションは、抽象インストゥルメントを無効にすると、個々のステートメントインストゥルメントの統計収集も無効になることを考慮する必要があります。たとえば、<code class="literal">INSERT</code> ステートメントの統計を収集するには、<code class="literal">statement/sql/insert</code> を有効にする必要がありますが、<code class="literal">statement/abstract/new_packet</code> と <code class="literal">statement/abstract/Query</code> も有効にする必要があります。同様に、レプリケートされたステートメントをインストゥルメントするには、<code class="literal">statement/abstract/relay_log</code> が有効にされている必要があります。
      </p><p>
        ステートメントが最終ステートメント名として抽象インストゥルメントに分類されることはないため、<code class="literal">statement/abstract/Query</code> などの抽象インストゥルメントに対して統計は集計されません。
      </p><p>
        先述の説明の抽象インストゥルメント名は MySQL 5.6.15 現在です。5.6 より前では、それらの名前が決定されるまでに、いくらかの名前の変更がありました。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            MySQL 5.6.14 では <code class="literal">statement/abstract/new_packet</code> は <code class="literal">statement/com/</code> で、MySQL 5.6.13 では <code class="literal">statement/com/new_packet</code> で、それ以前は <code class="literal">statement/com/</code> でした。
          </p></li><li class="listitem"><p>
            MySQL 5.6.15 より前では、<code class="literal">statement/abstract/Query</code> は <code class="literal">statement/com/Query</code> でした。
          </p></li><li class="listitem"><p>
            MySQL 5.6.13 から 5.6.14 では <code class="literal">statement/abstract/relay_log</code> は <code class="literal">statement/rpl/relay_log</code> で、それより前は存在していませんでした。
          </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-statements-current-table"></a>22.9.6.1 events_statements_current テーブル</h4></div></div></div><a class="indexterm" name="idm139979006716576"></a><a class="indexterm" name="idm139979006714336"></a><p>
          <code class="literal">events_statements_current</code> テーブルには、スレッドの最新のモニター対象ステートメントイベントの現在のステータスを示す、スレッドごとに 1 行で現在のステートメントイベントが格納されます。
        </p><p>
          <code class="literal">events_statements_current</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          ステートメントイベント行を格納するテーブルのうち、<code class="literal">events_statements_current</code> はもっとも基本的です。ステートメントイベント行を格納するほかのテーブルは論理的に現在のイベントから派生します。たとえば、<code class="literal">events_statements_history</code> および <code class="literal">events_statements_history_long</code> テーブルは固定の行数以下の最新のステートメントイベントのコレクションです。
        </p><p>
          ステートメントイベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 パフォーマンススキーマステートメントイベントテーブル">セクション22.9.6「パフォーマンススキーマステートメントイベントテーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_statements_current</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>、<code class="literal">EVENT_ID</code>
            </p><p>
              イベントに関連付けられたスレッドとイベントの起動時のスレッドの現在のイベント番号。一緒に取得された <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_ID</code> 値は、行を一意に識別する主キーを形成します。2 つの行が同じ値のペアを持つことはありません。
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              このカラムは、イベントの起動時に <code class="literal">NULL</code> に設定され、イベントの終了時にスレッドの現在のイベント番号に更新されます。このカラムは、MySQL 5.6.4 で追加されました。
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              イベントが収集されたインストゥルメントの名前。これは <code class="literal">setup_instruments</code> テーブルからの <code class="literal">NAME</code> 値です。<a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 パフォーマンススキーマインストゥルメント命名規則">セクション22.4「パフォーマンススキーマインストゥルメント命名規則」</a>に説明するように、インストゥルメント名には複数の部分があり、階層を形成することがあります。
            </p><p>
              SQL ステートメントの場合、ステートメントが解析されるまで、<code class="literal">EVENT_NAME</code> 値は最初 <code class="literal">statement/com/Query</code> であり、その後<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 パフォーマンススキーマステートメントイベントテーブル">セクション22.9.6「パフォーマンススキーマステートメントイベントテーブル」</a>に説明するように、より適切な値に変更されます。 
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              イベントを生成した、インストゥルメントされたコードを格納するソースファイルの名前と、インストゥルメンテーションが行われたファイルの行番号。これにより、ソースをチェックして、コードに含まれるものを正確に判断することができます。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、<code class="literal">TIMER_WAIT</code>
            </p><p>
              イベントのタイミング情報。これらの値の単位はピコ秒 (秒の 1 兆分の 1) です。<code class="literal">TIMER_START</code> および <code class="literal">TIMER_END</code> 値は、イベントのタイミングが開始されたときと終了したときを示します。<code class="literal">TIMER_WAIT</code> はイベントの経過時間 (期間) です。
            </p><p>
              イベントが終了していない場合、<code class="literal">TIMER_END</code> と <code class="literal">TIMER_WAIT</code> は <code class="literal">NULL</code> です。
            </p><p>
              イベントが <code class="literal">TIMED = NO</code> のインストゥルメントから生成されている場合、タイミング情報は収集されず、<code class="literal">TIMER_START</code>、<code class="literal">TIMER_END</code>、および <code class="literal">TIMER_WAIT</code> はすべて <code class="literal">NULL</code> になります。
            </p><p>
              イベント時間の単位としてのピコ秒および時間値に影響する要因については、<a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 パフォーマンススキーマイベントタイミング">セクション22.2.3.1「パフォーマンススキーマイベントタイミング」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_TIME</code>
            </p><p>
              テーブルロックの待機に費やされた時間。この値はマイクロ秒で計算されますが、ほかのパフォーマンススキーマタイマーとの比較を容易にするため、ピコ秒に正規化されます。
            </p></li><li class="listitem"><p>
              <code class="literal">SQL_TEXT</code>
            </p><p>
              SQL ステートメントのテキスト。SQL ステートメントに関連付けられていないコマンドの場合、値は <code class="literal">NULL</code> です。
            </p></li><li class="listitem"><p>
              <code class="literal">DIGEST</code>
            </p><p>
              32 個の 16 進文字の文字列としてのステートメントダイジェスト MD5 値または <code class="literal">statement_digest</code> コンシューマが <code class="literal">no</code> の場合は <code class="literal">NULL</code>。ステートメントダイジェストの詳細については、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="22.7 パフォーマンススキーマステートメントダイジェスト">セクション22.7「パフォーマンススキーマステートメントダイジェスト」</a>を参照してください。このカラムは、MySQL 5.6.5 で追加されました。
            </p></li><li class="listitem"><p>
              <code class="literal">DIGEST_TEXT</code>
            </p><p>
              正規化されたステートメントダイジェストテキストまたは <code class="literal">statement_digest</code> コンシューマが <code class="literal">no</code> の場合は <code class="literal">NULL</code>。ステートメントダイジェストの詳細については、<a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="22.7 パフォーマンススキーマステートメントダイジェスト">セクション22.7「パフォーマンススキーマステートメントダイジェスト」</a>を参照してください。このカラムは、MySQL 5.6.5 で追加されました。
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_SCHEMA</code>
            </p><p>
              ステートメントのデフォルトのデータベース、何もない場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>、<code class="literal">OBJECT_NAME</code>、<code class="literal">OBJECT_TYPE</code>
            </p><p>
              予約済み。現在は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              このカラムはステートメントを識別します。この値はメモリー内のオブジェクトのアドレスです。
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_ERRNO</code>
            </p><p>
              ステートメント診断領域からのステートメントエラー番号。
            </p></li><li class="listitem"><p>
              <code class="literal">RETURNED_SQLSTATE</code>
            </p><p>
              ステートメント診断領域からのステートメント SQLSTATE 値。
            </p></li><li class="listitem"><p>
              <code class="literal">MESSAGE_TEXT</code>
            </p><p>
              ステートメント診断領域からのステートメントエラーメッセージ。
            </p></li><li class="listitem"><p>
              <code class="literal">ERRORS</code>
            </p><p>
              ステートメントにエラーが発生したかどうか。SQLSTATE 値が <code class="literal">00</code> (完了) または <code class="literal">01</code> (警告) から始まる場合、値は 0 です。SQLSTATE 値がほかの値の場合、値は 1 です。
            </p></li><li class="listitem"><p>
              <code class="literal">WARNINGS</code>
            </p><p>
              ステートメント診断領域からの警告数。
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_AFFECTED</code>
            </p><p>
              ステートメントに影響を受けた行数。<span class="quote">「<span class="quote">影響を受けた</span>」</span>の意味については、<a class="xref" href="connectors-apis.html#mysql-affected-rows" title="23.8.7.1 mysql_affected_rows()">セクション23.8.7.1「mysql_affected_rows()」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_SENT</code>
            </p><p>
              ステートメントから返された行数。
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_EXAMINED</code>
            </p><p>
              ステートメント実行中にストレージエンジンから読み取られた行数。
            </p></li><li class="listitem"><p>
              <code class="literal">CREATED_TMP_DISK_TABLES</code>
            </p><p>
              <code class="literal">Created_tmp_disk_tables</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">CREATED_TMP_TABLES</code>
            </p><p>
              <code class="literal">Created_tmp_tables</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_FULL_JOIN</code>
            </p><p>
              <code class="literal">Select_full_join</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_FULL_RANGE_JOIN</code>
            </p><p>
              <code class="literal">Select_full_range_join</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_RANGE</code>
            </p><p>
              <code class="literal">Select_range</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_RANGE_CHECK</code>
            </p><p>
              <code class="literal">Select_range_check</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_SCAN</code>
            </p><p>
              <code class="literal">Select_scan</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_MERGE_PASSES</code>
            </p><p>
              <code class="literal">Sort_merge_passes</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_RANGE</code>
            </p><p>
              <code class="literal">Sort_range</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_ROWS</code>
            </p><p>
              <code class="literal">Sort_rows</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_SCAN</code>
            </p><p>
              <code class="literal">Sort_scan</code> ステータス変数と同様ですが、ステートメントに固有です。
            </p></li><li class="listitem"><p>
              <code class="literal">NO_INDEX_USED</code>
            </p><p>
              ステートメントがインデックスを使用せずにテーブルスキャンを実行した場合は 1、そうでない場合は 0。
            </p></li><li class="listitem"><p>
              <code class="literal">NO_GOOD_INDEX_USED</code>
            </p><p>
              サーバーがステートメントに使用する適切なインデックスを見つけられなかった場合は 1、そうでない場合は 0。追加の情報については、<a class="xref" href="optimization.html#explain-output" title="8.8.2 EXPLAIN 出力フォーマット">セクション8.8.2「EXPLAIN 出力フォーマット」</a>で、<code class="literal">EXPLAIN</code> 出力の <code class="literal">Extra</code> カラムの <code class="literal">Range checked for each record</code> 値の説明を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>、<code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              予約済み。現在は <code class="literal">NULL</code>。
            </p></li></ul></div><p>
          <code class="literal">events_statements_current</code> テーブルは MySQL 5.6.3 で追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-statements-history-table"></a>22.9.6.2 events_statements_history テーブル</h4></div></div></div><a class="indexterm" name="idm139979006578256"></a><a class="indexterm" name="idm139979006576016"></a><p>
          <code class="literal">events_statements_history</code> テーブルには、スレッドごとの最新の <em class="replaceable"><code>N</code></em> ステートメントイベントが格納されます。<em class="replaceable"><code>N</code></em> の値はサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_statements_history_size</code> システム変数を設定します。ステートメントイベントは終了するまでテーブルに追加されません。新しいイベントが追加されたときに、テーブルがいっぱいである場合、古いイベントが破棄されます。
        </p><p>
          <code class="literal">events_statements_history</code> テーブルは <code class="literal">events_statements_current</code> と同じ構造を持ちます。<a class="xref" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 events_statements_current テーブル">セクション22.9.6.1「events_statements_current テーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_statements_history</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          <code class="literal">events_statements_history</code> テーブルは MySQL 5.6.3 で追加されました。
        </p><p>
          ステートメントイベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 パフォーマンススキーマステートメントイベントテーブル">セクション22.9.6「パフォーマンススキーマステートメントイベントテーブル」</a>を参照してください。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="events-statements-history-long-table"></a>22.9.6.3 events_statements_history_long テーブル</h4></div></div></div><a class="indexterm" name="idm139979006559920"></a><a class="indexterm" name="idm139979006557680"></a><p>
          <code class="literal">events_statements_history_long</code> テーブルには、最新の <em class="replaceable"><code>N</code></em> ステートメントイベントが格納されます。<em class="replaceable"><code>N</code></em> の値はサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_events_statements_history_long_size</code> システム変数を設定します。ステートメントイベントは終了するまでテーブルに追加されません。新しいイベントが追加されたときに、テーブルがいっぱいである場合、古いイベントが破棄されます。
        </p><p>
          <code class="literal">events_statements_history_long</code> テーブルは <code class="literal">events_statements_current</code> と同じ構造を持ちます。<a class="xref" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 events_statements_current テーブル">セクション22.9.6.1「events_statements_current テーブル」</a>を参照してください。
        </p><p>
          <code class="literal">events_statements_history_long</code> テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。
        </p><p>
          <code class="literal">events_statements_history_long</code> テーブルは MySQL 5.6.3 で追加されました。
        </p><p>
          ステートメントイベント収集の構成については、<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 パフォーマンススキーマステートメントイベントテーブル">セクション22.9.6「パフォーマンススキーマステートメントイベントテーブル」</a>を参照してください。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-connection-tables"></a>22.9.7 パフォーマンススキーマ接続テーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#accounts-table">22.9.7.1 accounts テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#hosts-table">22.9.7.2 hosts テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#users-table">22.9.7.3 users テーブル</a></span></dt></dl></div><p>
        MySQL 5.6.3 以降、パフォーマンススキーマはサーバーへの接続に関する統計を提供します。クライアントが接続する場合、特定のユーザー名で特定のホストからそれを行います。パフォーマンススキーマは、これらのテーブルを使用して、アカウント (ユーザー名とホスト名) ごとに、およびユーザー名ごととホスト名ごとの個別に、接続を追跡します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">accounts</code>: クライアントアカウントごとの接続統計
          </p></li><li class="listitem"><p>
            <code class="literal">hosts</code>: クライアントホスト名ごとの接続統計
          </p></li><li class="listitem"><p>
            <code class="literal">users</code>: クライアントユーザー名ごとの接続統計
          </p></li></ul></div><p>
        接続に関する情報を集計するサマリーテーブルもあります。<a class="xref" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 接続サマリーテーブル">セクション22.9.9.7「接続サマリーテーブル」</a>を参照してください。
      </p><p>
        接続テーブルでの<span class="quote">「<span class="quote">アカウント</span>」</span>の意味は、その用語がユーザーとホスト値の組み合わせを表すという点で、<code class="literal">mysql</code> データベース内の MySQL 付与テーブルでのその意味に似ています。付与テーブルでそれらが異なる点は、アカウントのホスト部分をパターンにできるのに対し、接続テーブルではホスト値は常に固有の非パターンホスト名であることです。
      </p><p>
        接続テーブルにはすべて <code class="literal">CURRENT_CONNECTIONS</code> および <code class="literal">TOTAL_CONNECTIONS</code> カラムがあり、統計が基づく<span class="quote">「<span class="quote">追跡値</span>」</span>ごとの現在と合計の接続数を追跡します。テーブルは、それらが追跡値に使用するものに違いがあります。<code class="literal">accounts</code> テーブルには <code class="literal">USER</code> および <code class="literal">HOST</code> カラムがあり、ユーザー名とホスト名の組み合わせごとに接続を追跡します。<code class="literal">users</code> および <code class="literal">hosts</code> テーブルには <code class="literal">USER</code> および <code class="literal">HOST</code> カラムがあり、それぞれユーザー名ごとおよびホスト名ごとに接続を追跡します。
      </p><p>
        <code class="literal">user1</code> と <code class="literal">user2</code> というクライアントがそれぞれ <code class="literal">hosta</code> と <code class="literal">hostb</code> から一度に接続するとします。パフォーマンススキーマは次のように接続を追跡します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">accounts</code> テーブルには、<code class="literal">user1</code>/<code class="literal">hosta</code>、<code class="literal">user1</code>/<code class="literal">hostb</code>、<code class="literal">user2</code>/<code class="literal">hosta</code>、および <code class="literal">user2</code>/<code class="literal">hostb</code> アカウント値の 4 つの行があり、各行はアカウントごとに 1 つの接続をカウントします。
          </p></li><li class="listitem"><p>
            <code class="literal">users</code> テーブルには、<code class="literal">user1</code> と <code class="literal">user2</code> 値の 2 つの行があり、各行はユーザー名ごとに 2 つの接続をカウントします。
          </p></li><li class="listitem"><p>
            <code class="literal">hosts</code> テーブルには、<code class="literal">hosta</code> と <code class="literal">hostb</code> 値の 2 つの行があり、各行はホスト名ごとに 2 つの接続をカウントします。
          </p></li></ul></div><p>
        クライアントが接続すると、パフォーマンススキーマは、各テーブルに該当する追跡値を使用して、接続に適用する各接続テーブル内の行を判断します。そのような行がない場合、追加されます。次に、パフォーマンススキーマはその行の <code class="literal">CURRENT_CONNECTIONS</code> および <code class="literal">TOTAL_CONNECTIONS</code> カラムを 1 つ増分します。
      </p><p>
        クライアントが切断すると、パフォーマンススキーマはその行の <code class="literal">CURRENT_CONNECTIONS</code> カラムを 1 つ減分し、<code class="literal">TOTAL_CONNECTIONS</code> カラムは変更しないままにします。
      </p><p>
        パフォーマンススキーマは内部スレッドと認証に失敗したユーザーセッションのスレッドもカウントします。これらは、<code class="literal">NULL</code> の値の <code class="literal">USER</code> および <code class="literal">HOST</code> カラムのある行でカウントされます。
      </p><p>
        各接続テーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができ、次の効果があります。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">CURRENT_CONNECTIONS = 0</code> の行が削除されます。
          </p></li><li class="listitem"><p>
            <code class="literal">CURRENT_CONNECTIONS &gt; 0</code> の行で、<code class="literal">TOTAL_CONNECTIONS</code> が <code class="literal">CURRENT_CONNECTIONS</code> にリセットされます。
          </p></li><li class="listitem"><p>
            接続テーブルに依存する接続サマリーテーブルは暗黙的に切り捨てられます (サマリー値は 0 に設定されます)。暗黙的な切り捨ての詳細については、<a class="xref" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 接続サマリーテーブル">セクション22.9.9.7「接続サマリーテーブル」</a>を参照してください。
          </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="accounts-table"></a>22.9.7.1 accounts テーブル</h4></div></div></div><a class="indexterm" name="idm139979006486416"></a><a class="indexterm" name="idm139979006484272"></a><p>
          <code class="literal">accounts</code> テーブルは、MySQL サーバーに接続した各アカウントの行を格納します。各アカウントについて、テーブルは現在と合計の接続数をカウントします。テーブルサイズはサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_accounts_size</code> システム変数を設定します。アカウント統計を無効にするには、この変数を 0 に設定します。
        </p><p>
          <code class="literal">accounts</code> テーブルには次のカラムがあります。<code class="literal">TRUNCATE TABLE</code> の効果を含む、パフォーマンススキーマがこのテーブルの行を保守する方法については、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="22.9.7 パフォーマンススキーマ接続テーブル">セクション22.9.7「パフォーマンススキーマ接続テーブル」</a>を参照してください。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              接続のクライアントユーザー名、または内部スレッドまたは認証に失敗したユーザーセッションの場合 <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              クライアントの接続元のホスト名、または内部スレッドまたは認証に失敗したユーザーセッションの場合 <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              アカウントの現在の接続数。
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              アカウントの合計の接続数。
            </p></li></ul></div><p>
          <code class="literal">accounts</code> テーブルは MySQL 5.6.3 で追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="hosts-table"></a>22.9.7.2 hosts テーブル</h4></div></div></div><a class="indexterm" name="idm139979006462752"></a><a class="indexterm" name="idm139979006460624"></a><p>
          <code class="literal">hosts</code> テーブルは、クライアントが MySQL サーバーに接続している各ホストの行を格納します。各ホスト名について、テーブルは現在と合計の接続数をカウントします。テーブルサイズはサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_hosts_size</code> システム変数を設定します。ホスト統計を無効にするには、この変数を 0 に設定します。
        </p><p>
          <code class="literal">hosts</code> テーブルには次のカラムがあります。<code class="literal">TRUNCATE TABLE</code> の効果を含む、パフォーマンススキーマがこのテーブルの行を保守する方法については、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="22.9.7 パフォーマンススキーマ接続テーブル">セクション22.9.7「パフォーマンススキーマ接続テーブル」</a>を参照してください。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              クライアントの接続元のホスト名、または内部スレッドまたは認証に失敗したユーザーセッションの場合 <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              ホストの現在の接続数。
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              ホストの合計の接続数。
            </p></li></ul></div><p>
          <code class="literal">hosts</code> テーブルは MySQL 5.6.3 で追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="users-table"></a>22.9.7.3 users テーブル</h4></div></div></div><a class="indexterm" name="idm139979006442096"></a><a class="indexterm" name="idm139979006439968"></a><p>
          <code class="literal">users</code> テーブルは、MySQL サーバーに接続している各ユーザーの行を格納します。各ユーザー名について、テーブルは現在と合計の接続数をカウントします。テーブルサイズはサーバー起動時に自動サイズ設定されます。テーブルサイズを明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_users_size</code> システム変数を設定します。ユーザー統計を無効にするには、この変数を 0 に設定します。
        </p><p>
          <code class="literal">users</code> テーブルには次のカラムがあります。<code class="literal">TRUNCATE TABLE</code> の効果を含む、パフォーマンススキーマがこのテーブルの行を保守する方法については、<a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="22.9.7 パフォーマンススキーマ接続テーブル">セクション22.9.7「パフォーマンススキーマ接続テーブル」</a>を参照してください。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              接続のクライアントユーザー名、または内部スレッドまたは認証に失敗したユーザーセッションの場合 <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              ユーザーの現在の接続数。
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              ユーザーの合計の接続数。
            </p></li></ul></div><p>
          <code class="literal">users</code> テーブルは MySQL 5.6.3 で追加されました。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-connection-attribute-tables"></a>22.9.8 パフォーマンススキーマ接続属性テーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#session-account-connect-attrs-table">22.9.8.1 session_account_connect_attrs テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#session-connect-attrs-table">22.9.8.2 session_connect_attrs テーブル</a></span></dt></dl></div><p>
        MySQL 5.6.6 以降、アプリケーションプログラムでは、<code class="literal">mysql_options()</code> および <code class="literal">mysql_options4()</code> C API 関数を使用して、接続時にサーバーに渡されるキー/値接続属性を提供できます。パフォーマンススキーマはこれらのテーブルからこの情報を公開します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">session_account_connect_attrs</code>: 現在のアカウントのセッションの接続属性。
          </p></li><li class="listitem"><p>
            <code class="literal">session_connect_attrs</code>: すべてのセッションの接続属性。
          </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="session-account-connect-attrs-table"></a>22.9.8.1 session_account_connect_attrs テーブル</h4></div></div></div><a class="indexterm" name="idm139979006412896"></a><a class="indexterm" name="idm139979006410656"></a><p>
          MySQL 5.6.6 以降、アプリケーションプログラムでは、<code class="literal">mysql_options()</code> および <code class="literal">mysql_options4()</code> C API 関数を使用して、接続時にサーバーに渡されるキー/値接続属性を提供できます。
        </p><p>
          <code class="literal">session_account_connect_attrs</code> テーブルは、自分のアカウントに対してオープンしているセッションの接続属性のみを格納します。すべてのセッションの接続属性を確認するには、<code class="literal">session_connect_attrs</code> テーブルを調べてください。
        </p><p>
          <code class="literal">session_account_connect_attrs</code> テーブルは、これらのカラムを格納します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              セッションの接続識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_NAME</code>
            </p><p>
              属性名。
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_VALUE</code>
            </p><p>
              属性値。
            </p></li><li class="listitem"><p>
              <code class="literal">ORDINAL_POSITION</code>
            </p><p>
              属性が一連の接続属性に追加された順序。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="session-connect-attrs-table"></a>22.9.8.2 session_connect_attrs テーブル</h4></div></div></div><a class="indexterm" name="idm139979006391952"></a><a class="indexterm" name="idm139979006389792"></a><p>
          MySQL 5.6.6 以降、アプリケーションプログラムでは、<code class="literal">mysql_options()</code> および <code class="literal">mysql_options4()</code> C API 関数を使用して、接続時にサーバーに渡されるキー/値接続属性を提供できます。
        </p><p>
          <code class="literal">session_connect_attrs</code> テーブルはすべてのセッションの接続属性を格納します。自分のアカウントに対してオープンしているセッションの接続属性のみを確認するには、<code class="literal">session_account_connect_attrs</code> テーブルを調べてください。
        </p><p>
          <code class="literal">session_connect_attrs</code> テーブルは、これらのカラムを格納します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              セッションの接続識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_NAME</code>
            </p><p>
              属性名。
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_VALUE</code>
            </p><p>
              属性値。
            </p></li><li class="listitem"><p>
              <code class="literal">ORDINAL_POSITION</code>
            </p><p>
              属性が一連の接続属性に追加された順序。
            </p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-summary-tables"></a>22.9.9 パフォーマンススキーマサマリーテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#wait-summary-tables">22.9.9.1 イベント待機サマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#stage-summary-tables">22.9.9.2 ステージサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#statement-summary-tables">22.9.9.3 ステートメントサマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#objects-summary-global-by-type-table">22.9.9.4 オブジェクト待機サマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#file-summary-tables">22.9.9.5 ファイル I/O サマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#table-waits-summary-tables">22.9.9.6 テーブル I/O およびロック待機サマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#connection-summary-tables">22.9.9.7 接続サマリーテーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#socket-summary-tables">22.9.9.8 ソケットサマリーテーブル</a></span></dt></dl></div><p>
        サマリーテーブルは、時間の経過とともに強制終了されたイベントについて集計された情報を提供します。このグループのテーブルには、さまざまな方法で、イベントデータが要約されます。
      </p><p>
        <span class="bold"><strong>イベント待機サマリー:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_waits_summary_global_by_event_name</code>: イベント名ごとに要約された待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_instance</code>: インスタンスごとに要約された待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_thread_by_event_name</code>: スレッドおよびイベント名ごとに要約された待機イベント
          </p></li></ul></div><p>
        <span class="bold"><strong>ステージサマリー:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_stages_summary_by_thread_by_event_name</code>: スレッドおよびイベント名ごとに要約されたステージ待機
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_summary_global_by_event_name</code>: イベント名ごとに要約されたステージ待機
          </p></li></ul></div><p>
        <span class="bold"><strong>ステートメントサマリー:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_digest</code>: スキーマおよびダイジェスト値ごとに要約されたステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_thread_by_event_name</code>: スレッドおよびイベント名ごとに要約されたステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_global_by_event_name</code>: イベント名ごとに要約されたステートメントイベント
          </p></li></ul></div><p>
        <span class="bold"><strong>オブジェクト待機サマリー:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">objects_summary_global_by_type</code>: オブジェクトサマリー
          </p></li></ul></div><p>
        <span class="bold"><strong>ファイル I/O サマリー:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">file_summary_by_event_name</code>: イベント名ごとに要約されたファイルイベント
          </p></li><li class="listitem"><p>
            <code class="literal">file_summary_by_instance</code>: ファイルインスタンスごとに要約されたファイルイベント
          </p></li></ul></div><p>
        <span class="bold"><strong>テーブル I/O およびロック待機サマリー:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">table_io_waits_summary_by_index_usage</code>: インデックスごとのテーブル I/O 待機
          </p></li><li class="listitem"><p>
            <code class="literal">table_io_waits_summary_by_table</code>: テーブルごとのテーブル I/O 待機
          </p></li><li class="listitem"><p>
            <code class="literal">table_lock_waits_summary_by_table</code>: テーブルごとのテーブルロック待機
          </p></li></ul></div><p>
        <span class="bold"><strong>接続サマリー:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとに要約された待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとに要約された待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_waits_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとに要約された待機イベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとに要約されたステージイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとに要約されたステージイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_stages_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとに要約されたステージイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_digest</code>: スキーマおよびダイジェスト値ごとに要約されたステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとに要約されたステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとに要約されたステートメントイベント
          </p></li><li class="listitem"><p>
            <code class="literal">events_statements_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとに要約されたステートメントイベント
          </p></li></ul></div><p>
        <span class="bold"><strong>ソケットサマリー:</strong></span>
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">socket_summary_by_instance</code>: インスタンスごとに要約されたソケット待機および I/O
          </p></li><li class="listitem"><p>
            <code class="literal">socket_summary_by_event_name</code>: イベント名ごとに要約されたソケット待機および I/O
          </p></li></ul></div><p>
        各サマリーテーブルには、集計するデータのグループ化の方法を決定するグループ化カラムと、集計値を格納するサマリーカラムがあります。同様の方法でイベントを要約するテーブルには、多くの場合に類似の一連のサマリーカラムがあり、イベントの集計方法を決定するために使用されるグループ化カラムのみ異なります。
      </p><p>
        サマリーテーブルは <code class="literal">TRUNCATE TABLE</code> で切り捨てることができます。<code class="literal">events_statements_summary_by_digest</code> を除き、その効果は、サマリーカラムを 0 または <code class="literal">NULL</code> にリセットすることで、行を削除することではありません。これにより、収集された値をクリアし、アグリゲーションを再開できます。それは、実行時構成の変更を行なったあとなどに便利な場合があります。
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wait-summary-tables"></a>22.9.9.1 イベント待機サマリーテーブル</h4></div></div></div><a class="indexterm" name="idm139979006302560"></a><a class="indexterm" name="idm139979006300336"></a><a class="indexterm" name="idm139979006298304"></a><a class="indexterm" name="idm139979006296016"></a><a class="indexterm" name="idm139979006293952"></a><a class="indexterm" name="idm139979006291664"></a><p>
          パフォーマンススキーマは現在および最近の待機イベントを収集するためのテーブルを保守し、その情報をサマリーテーブルに集計します。<a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="22.9.4 パフォーマンススキーマ待機イベントテーブル">セクション22.9.4「パフォーマンススキーマ待機イベントテーブル」</a>に待機サマリーが基づいているイベントについて説明しています。待機イベントの内容、現在および最近の待機イベントテーブル、および待機イベント収集の制御方法に関する情報については、その説明を参照してください。
        </p><p>
          各イベント待機サマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を表します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_summary_global_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。各行は特定のイベント名のイベントを要約します。インストゥルメントを使用して、インストゥルメントされるオブジェクトの複数のインスタンスを作成できます。たとえば、接続ごとに作成される相互排他ロックのインストゥルメントがある場合、接続と同じ数のインスタンスがあります。インストゥルメントのサマリー行は、これらのすべてのインスタンス全体を要約します。
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_instance</code> には <code class="literal">EVENT_NAME</code> および <code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムがあります。各行は特定のイベント名とオブジェクトのイベントを要約します。複数のインスタンスを作成するためにインストゥルメントが使用される場合、各インスタンスには一意の <code class="literal">OBJECT_INSTANCE_BEGIN</code> 値があるため、これらのインスタンスはこのテーブルで個別に要約されます。
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_thread_by_event_name</code> には <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_NAME</code> カラムがあります。各行は特定のスレッドおよびイベント名のイベントを要約します。
            </p></li></ul></div><p>
          すべてのイベント待機サマリーテーブルには、集計された値を格納するこれらのサマリーカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>
            </p><p>
              要約されたイベントの数。この値には、時間付きか時間なしかに関係なく、すべてのイベントが含まれます。
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_TIMER_WAIT</code>
            </p><p>
              要約された時間付きイベントの合計待機時間。時間なしイベントは <code class="literal">NULL</code> の待機時間を持つため、この値は時間付きイベントに対してのみ計算されます。同じことがほかの <code class="literal"><em class="replaceable"><code>xxx</code></em>_TIMER_WAIT</code> 値にも当てはまります。
            </p></li><li class="listitem"><p>
              <code class="literal">MIN_TIMER_WAIT</code>
            </p><p>
              要約された時間付きイベントの最小待機時間。
            </p></li><li class="listitem"><p>
              <code class="literal">AVG_TIMER_WAIT</code>
            </p><p>
              要約された時間付きイベントの平均待機時間。
            </p></li><li class="listitem"><p>
              <code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              要約された時間付きイベントの最大待機時間。
            </p></li></ul></div><p>
          待機イベントサマリー情報の例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM events_waits_summary_global_by_event_name\G</code></strong>
...
*************************** 6. row ***************************
    EVENT_NAME: wait/synch/mutex/sql/BINARY_LOG::LOCK_index
    COUNT_STAR: 8
SUM_TIMER_WAIT: 2119302
MIN_TIMER_WAIT: 196092
AVG_TIMER_WAIT: 264912
MAX_TIMER_WAIT: 569421
...
*************************** 9. row ***************************
    EVENT_NAME: wait/synch/mutex/sql/hash_filo::lock
    COUNT_STAR: 69
SUM_TIMER_WAIT: 16848828
MIN_TIMER_WAIT: 0
AVG_TIMER_WAIT: 244185
MAX_TIMER_WAIT: 735345
...
</pre><p>
          <code class="literal">TRUNCATE TABLE</code> は待機サマリーテーブルに使用できます。それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="stage-summary-tables"></a>22.9.9.2 ステージサマリーテーブル</h4></div></div></div><a class="indexterm" name="idm139979006255088"></a><a class="indexterm" name="idm139979006252832"></a><a class="indexterm" name="idm139979006250768"></a><a class="indexterm" name="idm139979006248480"></a><p>
          MySQL 5.6.3 以降、パフォーマンススキーマは現在および最近のステージイベントを収集するためのテーブルを保守し、その情報をサマリーテーブルに集計します。<a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="22.9.5 パフォーマンススキーマステージイベントテーブル">セクション22.9.5「パフォーマンススキーマステージイベントテーブル」</a>で、ステージサマリーが基づいているイベントについて説明しています。ステージイベントの内容、現在および最近のステージイベントテーブル、およびステージイベント収集の制御方法に関する情報については、その説明を参照してください。
        </p><p>
          各ステージサマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を表します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_thread_by_event_name</code> には <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_NAME</code> カラムがあります。各行は特定のスレッドおよびイベント名のイベントを要約します。
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_global_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。各行は特定のイベント名のイベントを要約します。
            </p></li></ul></div><p>
          すべてのステージサマリーテーブルには、集計された値を格納するこれらのサマリーカラムがあります。<code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>, <code class="literal">AVG_TIMER_WAIT</code>、および <code class="literal">MAX_TIMER_WAIT</code>。ステージサマリーテーブルでは、<code class="literal">events_waits_current</code> ではなく <code class="literal">events_stages_current</code> から待機を集計することを除き、これらのカラムはイベント待機サマリーテーブル (<a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 イベント待機サマリーテーブル">セクション22.9.9.1「イベント待機サマリーテーブル」</a>を参照) の同じ名前のカラムに似ています。
        </p><p>
          ステージイベントサマリー情報の例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM events_stages_summary_global_by_event_name\G</code></strong>
...
*************************** 5. row ***************************
    EVENT_NAME: stage/sql/checking permissions
    COUNT_STAR: 57
SUM_TIMER_WAIT: 26501888880
MIN_TIMER_WAIT: 7317456
AVG_TIMER_WAIT: 464945295
MAX_TIMER_WAIT: 12858936792
...
*************************** 9. row ***************************
    EVENT_NAME: stage/sql/closing tables
    COUNT_STAR: 37
SUM_TIMER_WAIT: 662606568
MIN_TIMER_WAIT: 1593864
AVG_TIMER_WAIT: 17907891
MAX_TIMER_WAIT: 437977248
...
</pre><p>
          <code class="literal">TRUNCATE TABLE</code> はステージサマリーテーブルに使用できます。それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="statement-summary-tables"></a>22.9.9.3 ステートメントサマリーテーブル</h4></div></div></div><a class="indexterm" name="idm139979006222608"></a><a class="indexterm" name="idm139979006220288"></a><a class="indexterm" name="idm139979006218192"></a><a class="indexterm" name="idm139979006215904"></a><a class="indexterm" name="idm139979006213840"></a><a class="indexterm" name="idm139979006211696"></a><p>
          MySQL 5.6.3 以降、パフォーマンススキーマは現在および最近のステートメントイベントを集計するためのテーブルを保守し、その情報をサマリーテーブルに集計します。<a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 パフォーマンススキーマステートメントイベントテーブル">セクション22.9.6「パフォーマンススキーマステートメントイベントテーブル」</a>で、ステートメントサマリーが基づいているイベントについて説明しています。ステートメントイベントの内容、現在および最近のステートメントイベントテーブル、およびステートメントイベント収集の制御方法に関する情報については、その説明を参照してください。
        </p><p>
          各ステートメントサマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を表します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_digest</code> には <code class="literal">SCHEMA_NAME</code> および <code class="literal">DIGEST</code> カラムがあります。各行は特定のスキーマ/ダイジェスト値のイベントを要約します。( <code class="literal">DIGEST_TEXT</code> カラムは、対応する正規化されたステートメントダイジェストテキストを格納しますが、グループ化カラムでもサマリーカラムでもありません。)
            </p><p>
              このテーブルは、5.6.5 で追加されました。MySQL 5.6.9 より前では、<code class="literal">SCHEMA_NAME</code> カラム値がなく、グループ化は <code class="literal">DIGEST</code> 値のみに基づきます。
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_thread_by_event_name</code> には <code class="literal">THREAD_ID</code> および <code class="literal">EVENT_NAME</code> カラムがあります。各行は特定のスレッドおよびイベント名のイベントを要約します。
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_global_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。各行は特定のイベント名のイベントを要約します。
            </p></li></ul></div><p>
          すべてのステートメントサマリーテーブルには、集計された値を格納するこれらのサマリーカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              ステートメントサマリーテーブルは、<code class="literal">events_waits_current</code> ではなく <code class="literal">events_statements_current</code> からイベントを集計することを除き、これらのカラムはイベント待機サマリーテーブル (<a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 イベント待機サマリーテーブル">セクション22.9.9.1「イベント待機サマリーテーブル」</a>を参照) の同じ名前のカラムに似ています。
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_<em class="replaceable"><code>xxx</code></em></code>
            </p><p>
              <code class="literal">events_statements_current</code> テーブル内の対応する <em class="replaceable"><code>xxx</code></em> カラムの集計。たとえば、ステートメントサマリーテーブルの <code class="literal">SUM_LOCK_TIME</code> および <code class="literal">SUM_ERRORS</code> カラムは <code class="literal">events_statements_current</code> テーブルの <code class="literal">LOCK_TIME</code> および <code class="literal">ERRORS</code> カラムの集計です。
            </p></li></ul></div><p>
          <code class="literal">events_statements_summary_by_digest</code> テーブルにはこれらの追加のサマリーカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">FIRST_SEEN_TIMESTAMP</code>、<code class="literal">LAST_SEEN_TIMESTAMP</code>
            </p><p>
              特定のダイジェスト値を持つステートメントが最初に確認された時間と最後に確認された時間。
            </p></li></ul></div><p>
          ステートメントイベントサマリー情報の例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM events_statements_summary_global_by_event_name\G</code></strong>
*************************** 1. row ***************************
                 EVENT_NAME: statement/sql/select
                 COUNT_STAR: 25
             SUM_TIMER_WAIT: 1535983999000
             MIN_TIMER_WAIT: 209823000
             AVG_TIMER_WAIT: 61439359000
             MAX_TIMER_WAIT: 1363397650000
              SUM_LOCK_TIME: 20186000000
                 SUM_ERRORS: 0
               SUM_WARNINGS: 0
          SUM_ROWS_AFFECTED: 0
              SUM_ROWS_SENT: 388
          SUM_ROWS_EXAMINED: 370
SUM_CREATED_TMP_DISK_TABLES: 0
     SUM_CREATED_TMP_TABLES: 0
       SUM_SELECT_FULL_JOIN: 0
 SUM_SELECT_FULL_RANGE_JOIN: 0
           SUM_SELECT_RANGE: 0
     SUM_SELECT_RANGE_CHECK: 0
            SUM_SELECT_SCAN: 6
      SUM_SORT_MERGE_PASSES: 0
             SUM_SORT_RANGE: 0
              SUM_SORT_ROWS: 0
              SUM_SORT_SCAN: 0
          SUM_NO_INDEX_USED: 6
     SUM_NO_GOOD_INDEX_USED: 0
...
</pre><p>
          <code class="literal">TRUNCATE TABLE</code> はステートメントサマリーテーブルに使用できます。<code class="literal">events_statements_summary_by_digest</code> に対して、それはテーブルを空にします。ほかのステートメントサマリーテーブルに対して、それは行を削除するのではなく、サマリーカラムを 0 にリセットします。
        </p><h5><a name="idm139979006163856"></a>ステートメントダイジェストアグリゲーションルール</h5><p>
          <code class="literal">statement_digest</code> コンシューマを有効にすると、ステートメントの完了時に、<code class="literal">events_statements_summary_by_digest</code> へのアグリゲーションが次のように行われます。アグリゲーションはステートメントに対して計算された <code class="literal">DIGEST</code> 値に基づきます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              完了したばかりのステートメントのダイジェスト値のある <code class="literal">events_statements_summary_by_digest</code> 行がすでに存在する場合、ステートメントの統計はその行に集計されます。<code class="literal">LAST_SEEN</code> カラムは現在の時間に更新されます。
            </p></li><li class="listitem"><p>
              完了したばかりのステートメントのダイジェスト値のある行がなく、テーブルがいっぱいでない場合、そのステートメントに対して新しい行が作成されます。<code class="literal">FIRST_SEEN</code> および <code class="literal">LAST_SEEN</code> カラムは現在の時間で初期化されます。
            </p></li><li class="listitem"><p>
              完了したばかりのステートメントのステートメントダイジェスト値のある行がなく、テーブルがいっぱいである場合、完了したばかりのステートメントの統計が、必要に応じて作成される特別な<span class="quote">「<span class="quote">多目的</span>」</span>行に、<code class="literal">DIGEST</code> = <code class="literal">NULL</code> で追加されます。この行が作成された場合、<code class="literal">FIRST_SEEN</code> および <code class="literal">LAST_SEEN</code> カラムは現在の時間で初期化されます。そうでない場合、<code class="literal">LAST_SEEN</code> カラムが現在の時間で更新されます。
            </p></li></ul></div><p>
          パフォーマンススキーマテーブルには、メモリー制約による最大サイズがあるため、<code class="literal">DIGEST</code> = <code class="literal">NULL</code> の行は保守されます。<code class="literal">DIGEST</code> = <code class="literal">NULL</code> 行は、ほかの行に一致しないダイジェストが、サマリーテーブルがいっぱいである場合でも、共通の<span class="quote">「<span class="quote">ほかの</span>」</span>バケットを使用して、カウントされることを許可します。この行は、ダイジェストサマリーが代表的であるかどうかを推定するのに役立ちます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              すべてのダイジェストのうち 5% を表す <code class="literal">COUNT_STAR</code> 値がある <code class="literal">DIGEST</code> = <code class="literal">NULL</code> 行は、ダイジェストサマリーテーブルがきわめて代表的であることを示します。ほかの行が、存在するステートメントの 95% を占めます。
            </p></li><li class="listitem"><p>
              すべてのダイジェストのうち 50% を表す <code class="literal">COUNT_STAR</code> 値がある <code class="literal">DIGEST</code> = <code class="literal">NULL</code> 行は、ダイジェストサマリーテーブルがあまり代表的でないことを示します。ほかの行は、存在するステートメントの半分しか占めません。たいていの場合に DBA は <code class="literal">DIGEST</code> = <code class="literal">NULL</code> 行にカウントされる行の多くが、代わりにより具体的な行を使用してカウントされるように、最大テーブルサイズを拡大するべきです。これを実行するには、サーバーの起動時に、<code class="literal">performance_schema_digests_size</code> システム変数を大きな値に設定します。デフォルトサイズは 200 です。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="objects-summary-global-by-type-table"></a>22.9.9.4 オブジェクト待機サマリーテーブル</h4></div></div></div><a class="indexterm" name="idm139979006131728"></a><a class="indexterm" name="idm139979006129488"></a><p>
          <code class="literal">objects_summary_global_by_type</code> テーブルはオブジェクト待機イベントを集計します。これにはテーブルのイベントの集計方法を示すグループ化カラム <code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_SCHEMA</code>、および <code class="literal">OBJECT_NAME</code> があります。各行は特定のオブジェクトのイベントを要約します。
        </p><p>
          <code class="literal">objects_summary_global_by_type</code> には <code class="literal">events_waits_summary_by_<em class="replaceable"><code>xxx</code></em></code> テーブルと同じサマリーカラムがあります。<a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 イベント待機サマリーテーブル">セクション22.9.9.1「イベント待機サマリーテーブル」</a>を参照してください。
        </p><p>
          オブジェクト待機イベントサマリー情報の例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM objects_summary_global_by_type\G</code></strong>
...
*************************** 3. row ***************************
   OBJECT_TYPE: TABLE
 OBJECT_SCHEMA: test
   OBJECT_NAME: t
    COUNT_STAR: 3
SUM_TIMER_WAIT: 263126976
MIN_TIMER_WAIT: 1522272
AVG_TIMER_WAIT: 87708678
MAX_TIMER_WAIT: 258428280
...
*************************** 10. row ***************************
   OBJECT_TYPE: TABLE
 OBJECT_SCHEMA: mysql
   OBJECT_NAME: user
    COUNT_STAR: 14
SUM_TIMER_WAIT: 365567592
MIN_TIMER_WAIT: 1141704
AVG_TIMER_WAIT: 26111769
MAX_TIMER_WAIT: 334783032
...
</pre><p>
          <code class="literal">TRUNCATE TABLE</code> はオブジェクトサマリーテーブルに使用できます。それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="file-summary-tables"></a>22.9.9.5 ファイル I/O サマリーテーブル</h4></div></div></div><a class="indexterm" name="idm139979006114288"></a><a class="indexterm" name="idm139979006112080"></a><a class="indexterm" name="idm139979006110064"></a><a class="indexterm" name="idm139979006107824"></a><p>
          ファイル I/O サマリーテーブルは I/O 操作に関する情報を集計します。
        </p><p>
          各ファイル I/O サマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を表します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">file_summary_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。各行は特定のイベント名のイベントを要約します。
            </p></li><li class="listitem"><p>
              <code class="literal">file_summary_by_instance</code> には <code class="literal">FILE_NAME</code>、<code class="literal">EVENT_NAME</code>、および (MySQL 5.6.4 現在) <code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムがあります。各行は特定のファイルおよびイベント名のイベントを要約します。
            </p></li></ul></div><p>
          すべてのファイル I/O サマリーテーブルには、集計された値を格納する次のサマリーカラムがあります。(MySQL 5.6.4 より前では、テーブルに <code class="literal">COUNT_READ</code> <code class="literal">COUNT_WRITE</code> <code class="literal">SUM_NUMBER_OF_BYTES_READ</code>、および <code class="literal">SUM_NUMBER_OF_BYTES_WRITE</code> アグリゲーションカラムのみが格納されます。)一部のカラムは一般的で、より詳細なカラムの値の合計と同じ値を持ちます。このように、低レベルカラムを合計するユーザー定義ビューを必要とせずに、高レベルでのアグリゲーションを直接取得できます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              これらのカラムはすべての I/O 操作を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_READ</code>、<code class="literal">SUM_TIMER_READ</code>、<code class="literal">MIN_TIMER_READ</code>、<code class="literal">AVG_TIMER_READ</code>、<code class="literal">MAX_TIMER_READ</code>、<code class="literal">SUM_NUMBER_OF_BYTES_READ</code>
            </p><p>
              これらのカラムは <code class="literal">FGETS</code>、<code class="literal">FGETC</code>、<code class="literal">FREAD</code>、および <code class="literal">READ</code> を含むすべての読み取り操作を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_WRITE</code>、<code class="literal">SUM_TIMER_WRITE</code>、<code class="literal">MIN_TIMER_WRITE</code>、<code class="literal">AVG_TIMER_WRITE</code>、<code class="literal">MAX_TIMER_WRITE</code>、<code class="literal">SUM_NUMBER_OF_BYTES_WRITE</code>
            </p><p>
              これらのカラムは <code class="literal">FPUTS</code>、<code class="literal">FPUTC</code>、<code class="literal">FPRINTF</code>、<code class="literal">VFPRINTF</code>、<code class="literal">FWRITE</code>、および <code class="literal">PWRITE</code> を含むすべての書き込み操作を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MISC</code>、<code class="literal">SUM_TIMER_MISC</code>、<code class="literal">MIN_TIMER_MISC</code>、<code class="literal">AVG_TIMER_MISC</code>、<code class="literal">MAX_TIMER_MISC</code>
            </p><p>
              これらのカラムは <code class="literal">CREATE</code>、<code class="literal">DELETE</code>、<code class="literal">OPEN</code>、<code class="literal">CLOSE</code>、<code class="literal">STREAM_OPEN</code>、<code class="literal">STREAM_CLOSE</code>、<code class="literal">SEEK</code>、<code class="literal">TELL</code>、<code class="literal">FLUSH</code>、<code class="literal">STAT</code>、<code class="literal">FSTAT</code>、<code class="literal">CHSIZE</code>、<code class="literal">RENAME</code>、および <code class="literal">SYNC</code> を含むその他のすべての I/O 操作を集計します。これらの操作のバイトカウントはありません。
            </p></li></ul></div><p>
          ファイル I/O イベントサマリー情報の例:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM file_summary_by_event_name\G</code></strong>
...
*************************** 2. row ***************************
               EVENT_NAME: wait/io/file/sql/binlog
               COUNT_STAR: 31
           SUM_TIMER_WAIT: 8243784888
           MIN_TIMER_WAIT: 0
           AVG_TIMER_WAIT: 265928484
           MAX_TIMER_WAIT: 6490658832
...
mysql&gt; <strong class="userinput"><code>SELECT * FROM file_summary_by_instance\G</code></strong>
...
*************************** 2. row ***************************
                FILE_NAME: /var/mysql/share/english/errmsg.sys
               EVENT_NAME: wait/io/file/sql/ERRMSG
               EVENT_NAME: wait/io/file/sql/ERRMSG
    OBJECT_INSTANCE_BEGIN: 4686193384
               COUNT_STAR: 5
           SUM_TIMER_WAIT: 13990154448
           MIN_TIMER_WAIT: 26349624
           AVG_TIMER_WAIT: 2798030607
           MAX_TIMER_WAIT: 8150662536
...
</pre><p>
          <code class="literal">TRUNCATE TABLE</code> はファイル I/O サマリーテーブルに使用できます。それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。
        </p><p>
          MySQL サーバーは、いくつかの技法を使用して、ファイルから読み取られた情報をキャッシュすることによって I/O 操作を回避するため、I/O イベントが発生すると予想されるようなステートメントでも発生しない可能性があります。キャッシュをフラッシュするか、サーバーを再起動して、その状態をリセットすることによって、I/O を発生させることができる場合があります。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="table-waits-summary-tables"></a>22.9.9.6 テーブル I/O およびロック待機サマリーテーブル</h4></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#table-io-waits-summary-by-table-table">22.9.9.6.1 table_io_waits_summary_by_table テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#table-io-waits-summary-by-index-usage-table">22.9.9.6.2 table_io_waits_summary_by_index_usage テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#table-lock-waits-summary-by-table-table">22.9.9.6.3 table_lock_waits_summary_by_table テーブル</a></span></dt></dl></div><p>
          次のセクションでは、テーブル I/O およびロック待機サマリーテーブルについて説明します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">table_io_waits_summary_by_index_usage</code>: インデックスごとのテーブル I/O 待機
            </p></li><li class="listitem"><p>
              <code class="literal">table_io_waits_summary_by_table</code>: テーブルごとのテーブル I/O 待機
            </p></li><li class="listitem"><p>
              <code class="literal">table_lock_waits_summary_by_table</code>: テーブルごとのテーブルロック待機
            </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="table-io-waits-summary-by-table-table"></a>22.9.9.6.1 table_io_waits_summary_by_table テーブル</h5></div></div></div><a class="indexterm" name="idm139979006036928"></a><a class="indexterm" name="idm139979006034784"></a><p>
            <code class="literal">table_io_waits_summary_by_table</code> テーブルは、<code class="literal">wait/io/table/sql/handler</code> インストゥルメントによって生成されるすべてのテーブル I/O 待機イベントを集計します。グループ化はテーブル単位です。
          </p><p>
            <code class="literal">table_io_waits_summary_by_table</code> テーブルには、テーブルのイベントの集計方法を示すこれらのグループ化カラムがあります。<code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_SCHEMA</code>、および <code class="literal">OBJECT_NAME</code>。これらのカラムは、<code class="literal">events_waits_current</code> テーブル内と同じ意味を持ちます。それらは、行の適用先のテーブルを識別します。
          </p><p>
            <code class="literal">table_io_waits_summary_by_table</code> には集計された値を格納する次のサマリーカラムがあります。カラムの説明に示すように、一部のカラムは一般的で、より詳細なカラムの値の合計と同じ値を持ちます。たとえば、すべての書き込みを集計するカラムは、挿入、更新、および削除を集計する対応するカラムの合計を保持します。このように、低レベルカラムを合計するユーザー定義ビューを必要とせずに、高レベルでのアグリゲーションを直接取得できます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
              </p><p>
                これらのカラムはすべての I/O 操作を集計します。それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ</code> および <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE</code> カラムの合計と同じです。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ</code>、<code class="literal">SUM_TIMER_READ</code>、<code class="literal">MIN_TIMER_READ</code>、<code class="literal">AVG_TIMER_READ</code>、<code class="literal">MAX_TIMER_READ</code>
              </p><p>
                これらのカラムはすべての読み取り操作を集計します。それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_FETCH</code> カラムの合計と同じです。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE</code>、<code class="literal">SUM_TIMER_WRITE</code>、<code class="literal">MIN_TIMER_WRITE</code>、<code class="literal">AVG_TIMER_WRITE</code>、<code class="literal">MAX_TIMER_WRITE</code>
              </p><p>
                これらのカラムはすべての書き込み操作を集計します。それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_INSERT</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_UPDATE</code>、および <code class="literal"><em class="replaceable"><code>xxx</code></em>_DELETE</code> カラムの合計と同じです。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_FETCH</code>、<code class="literal">SUM_TIMER_FETCH</code>、<code class="literal">MIN_TIMER_FETCH</code>、<code class="literal">AVG_TIMER_FETCH</code>、<code class="literal">MAX_TIMER_FETCH</code>
              </p><p>
                これらのカラムはすべてのフェッチ操作を集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_INSERT</code>、<code class="literal">SUM_TIMER_INSERT</code>、<code class="literal">MIN_TIMER_INSERT</code>、<code class="literal">AVG_TIMER_INSERT</code>、<code class="literal">MAX_TIMER_INSERT</code>
              </p><p>
                これらのカラムはすべての挿入操作を集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_UPDATE</code>、<code class="literal">SUM_TIMER_UPDATE</code>、<code class="literal">MIN_TIMER_UPDATE</code>、<code class="literal">AVG_TIMER_UPDATE</code>、<code class="literal">MAX_TIMER_UPDATE</code>
              </p><p>
                これらのカラムはすべての更新操作を集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_DELETE</code>、<code class="literal">SUM_TIMER_DELETE</code>、<code class="literal">MIN_TIMER_DELETE</code>、<code class="literal">AVG_TIMER_DELETE</code>、<code class="literal">MAX_TIMER_DELETE</code>
              </p><p>
                これらのカラムはすべての削除操作を集計します。
              </p></li></ul></div><p>
            <code class="literal">TRUNCATE TABLE</code> はテーブル I/O サマリーテーブルに使用できます。それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。このテーブルを切り捨てると、<code class="literal">table_io_waits_summary_by_index_usage</code> テーブルも切り捨てられます。
          </p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="table-io-waits-summary-by-index-usage-table"></a>22.9.9.6.2 table_io_waits_summary_by_index_usage テーブル</h5></div></div></div><a class="indexterm" name="idm139979005977744"></a><a class="indexterm" name="idm139979005975472"></a><p>
            <code class="literal">table_io_waits_summary_by_index_usage</code> テーブルは、<code class="literal">wait/io/table/sql/handler</code> インストゥルメントによって生成されるすべてのテーブルインデックス I/O 待機イベントを集計します。グループ化はテーブルインデックス単位です。
          </p><p>
            <code class="literal">table_io_waits_summary_by_index_usage</code> の構造は、<code class="literal">table_io_waits_summary_by_table</code> とほぼ同一です。唯一の違いは、テーブル I/O 待機イベントが記録されたときに使用されたインデックスの名前に対応する、追加のグループカラム <code class="literal">INDEX_NAME</code> です。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">PRIMARY</code> の値はテーブル I/O でプライマリインデックスが使用されたことを示します。
              </p></li><li class="listitem"><p>
                <code class="literal">NULL</code> の値はテーブル I/O でインデックスが使用されなかったことを示します。
              </p></li><li class="listitem"><p>
                挿入は <code class="literal">INDEX_NAME = NULL</code> に対してカウントされます。
              </p></li></ul></div><p>
            <code class="literal">TRUNCATE TABLE</code> はテーブル I/O サマリーテーブルに使用できます。それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。このテーブルも、<code class="literal">table_io_waits_summary_by_table</code> テーブルの切り捨てによって切り捨てられます。テーブルのインデックス構造を変更する DDL 操作により、インデックスごとの統計がリセットされることがあります。
          </p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="table-lock-waits-summary-by-table-table"></a>22.9.9.6.3 table_lock_waits_summary_by_table テーブル</h5></div></div></div><a class="indexterm" name="idm139979005957408"></a><a class="indexterm" name="idm139979005955264"></a><p>
            <code class="literal">table_lock_waits_summary_by_table</code> テーブルは、<code class="literal">wait/lock/table/sql/handler</code> インストゥルメントによって生成されるすべてのテーブルロック待機イベントを集計します。グループ化はテーブル単位です。
          </p><p>
            このテーブルには、内部および外部ロックに関する情報が格納されます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                内部ロックは、SQL レイヤーのロックに対応します。これは現在 <code class="literal">thr_lock()</code> への呼び出しによって実装されます。イベント行で、これらのロックは、次のいずれかの値を持つ <code class="literal">OPERATION</code> カラムによって区別されます。
              </p><pre class="programlisting">
read normal
read with shared locks
read high priority
read no insert
write allow write
write concurrent insert
write delayed
write low priority
write normal
</pre></li><li class="listitem"><p>
                外部ロックはストレージエンジンレイヤーのロックに対応します。これは現在 <code class="literal">handler::external_lock()</code> への呼び出しによって実装されます。イベント行で、これらのロックは、次のいずれかの値を持つ <code class="literal">OPERATION</code> カラムによって区別されます。
              </p><pre class="programlisting">
read external
write external
</pre></li></ul></div><p>
            <code class="literal">table_lock_waits_summary_by_table</code> テーブルには、テーブルのイベントの集計方法を示すこれらのグループ化カラムがあります。<code class="literal">OBJECT_TYPE</code>、<code class="literal">OBJECT_SCHEMA</code>、および <code class="literal">OBJECT_NAME</code>。これらのカラムは、<code class="literal">events_waits_current</code> テーブル内と同じ意味を持ちます。それらは、行の適用先のテーブルを識別します。
          </p><p>
            <code class="literal">table_lock_waits_summary_by_table</code> には集計された値を格納する次のサマリーカラムがあります。カラムの説明に示すように、一部のカラムは一般的で、より詳細なカラムの値の合計と同じ値を持ちます。たとえば、すべてのロックを集計するカラムは、読み取りおよび書き込みロックを集計する対応するカラムの合計を保持します。このように、低レベルカラムを合計するユーザー定義ビューを必要とせずに、高レベルでのアグリゲーションを直接取得できます。
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
              </p><p>
                これらのカラムはすべてのロック操作を集計します。それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ</code> および <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE</code> カラムの合計と同じです。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ</code>、<code class="literal">SUM_TIMER_READ</code>、<code class="literal">MIN_TIMER_READ</code>、<code class="literal">AVG_TIMER_READ</code>、<code class="literal">MAX_TIMER_READ</code>
              </p><p>
                これらのカラムはすべての読み取りロック操作を集計します。それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_NORMAL</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_WITH_SHARED_LOCKS</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_HIGH_PRIORITY</code>、および <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_NO_INSERT</code> カラムの合計と同じです。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE</code>、<code class="literal">SUM_TIMER_WRITE</code>、<code class="literal">MIN_TIMER_WRITE</code>、<code class="literal">AVG_TIMER_WRITE</code>、<code class="literal">MAX_TIMER_WRITE</code>
              </p><p>
                これらのカラムはすべての書き込みロック操作を集計します。それらは対応する <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_ALLOW_WRITE</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_CONCURRENT_INSERT</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_DELAYED</code>、<code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_LOW_PRIORITY</code>、および <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_NORMAL</code> カラムの合計と同じです。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_NORMAL</code>、<code class="literal">SUM_TIMER_READ_NORMAL</code>、<code class="literal">MIN_TIMER_READ_NORMAL</code>、<code class="literal">AVG_TIMER_READ_NORMAL</code>、<code class="literal">MAX_TIMER_READ_NORMAL</code>
              </p><p>
                これらのカラムは内部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_WITH_SHARED_LOCKS</code>、<code class="literal">SUM_TIMER_READ_WITH_SHARED_LOCKS</code>、<code class="literal">MIN_TIMER_READ_WITH_SHARED_LOCKS</code>、<code class="literal">AVG_TIMER_READ_WITH_SHARED_LOCKS</code>、<code class="literal">MAX_TIMER_READ_WITH_SHARED_LOCKS</code>
              </p><p>
                これらのカラムは内部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_HIGH_PRIORITY</code>、<code class="literal">SUM_TIMER_READ_HIGH_PRIORITY</code>、<code class="literal">MIN_TIMER_READ_HIGH_PRIORITY</code>、<code class="literal">AVG_TIMER_READ_HIGH_PRIORITY</code>、<code class="literal">MAX_TIMER_READ_HIGH_PRIORITY</code>
              </p><p>
                これらのカラムは内部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_NO_INSERT</code>、<code class="literal">SUM_TIMER_READ_NO_INSERT</code>、<code class="literal">MIN_TIMER_READ_NO_INSERT</code>、<code class="literal">AVG_TIMER_READ_NO_INSERT</code>、<code class="literal">MAX_TIMER_READ_NO_INSERT</code>
              </p><p>
                これらのカラムは内部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_EXTERNAL</code>、<code class="literal">SUM_TIMER_READ_EXTERNAL</code>、<code class="literal">MIN_TIMER_READ_EXTERNAL</code>、<code class="literal">AVG_TIMER_READ_EXTERNAL</code>、<code class="literal">MAX_TIMER_READ_EXTERNAL</code>
              </p><p>
                これらのカラムは外部読み取りロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_ALLOW_WRITE</code>、<code class="literal">SUM_TIMER_WRITE_ALLOW_WRITE</code>、<code class="literal">MIN_TIMER_WRITE_ALLOW_WRITE</code>、<code class="literal">AVG_TIMER_WRITE_ALLOW_WRITE</code>、<code class="literal">MAX_TIMER_WRITE_ALLOW_WRITE</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_CONCURRENT_INSERT</code>、<code class="literal">SUM_TIMER_WRITE_CONCURRENT_INSERT</code>、<code class="literal">MIN_TIMER_WRITE_CONCURRENT_INSERT</code>、<code class="literal">AVG_TIMER_WRITE_CONCURRENT_INSERT</code>、<code class="literal">MAX_TIMER_WRITE_CONCURRENT_INSERT</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_DELAYED</code>、<code class="literal">SUM_TIMER_WRITE_DELAYED</code>、<code class="literal">MIN_TIMER_WRITE_DELAYED</code>、<code class="literal">AVG_TIMER_WRITE_DELAYED</code>、<code class="literal">MAX_TIMER_WRITE_DELAYED</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p><p>
                MySQL 5.6.6 以降、<code class="literal">DELAYED</code> 挿入は非推奨であるため、これらのカラムは将来のリリースで削除されます。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_LOW_PRIORITY</code>、<code class="literal">SUM_TIMER_WRITE_LOW_PRIORITY</code>、<code class="literal">MIN_TIMER_WRITE_LOW_PRIORITY</code>、<code class="literal">AVG_TIMER_WRITE_LOW_PRIORITY</code>、<code class="literal">MAX_TIMER_WRITE_LOW_PRIORITY</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_NORMAL</code>、<code class="literal">SUM_TIMER_WRITE_NORMAL</code>、<code class="literal">MIN_TIMER_WRITE_NORMAL</code>、<code class="literal">AVG_TIMER_WRITE_NORMAL</code>、<code class="literal">MAX_TIMER_WRITE_NORMAL</code>
              </p><p>
                これらのカラムは内部書き込みロックを集計します。
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_EXTERNAL</code>、<code class="literal">SUM_TIMER_WRITE_EXTERNAL</code>、<code class="literal">MIN_TIMER_WRITE_EXTERNAL</code>、<code class="literal">AVG_TIMER_WRITE_EXTERNAL</code>、<code class="literal">MAX_TIMER_WRITE_EXTERNAL</code>
              </p><p>
                これらのカラムは外部書き込みロックを集計します。
              </p></li></ul></div><p>
            <code class="literal">TRUNCATE TABLE</code> はテーブルロックサマリーテーブルに使用できます。それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。
          </p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="connection-summary-tables"></a>22.9.9.7 接続サマリーテーブル</h4></div></div></div><a class="indexterm" name="idm139979005849776"></a><a class="indexterm" name="idm139979005847488"></a><a class="indexterm" name="idm139979005845424"></a><a class="indexterm" name="idm139979005843136"></a><a class="indexterm" name="idm139979005841072"></a><a class="indexterm" name="idm139979005838784"></a><a class="indexterm" name="idm139979005836720"></a><a class="indexterm" name="idm139979005834416"></a><a class="indexterm" name="idm139979005832416"></a><a class="indexterm" name="idm139979005830128"></a><a class="indexterm" name="idm139979005828064"></a><a class="indexterm" name="idm139979005825776"></a><a class="indexterm" name="idm139979005823776"></a><a class="indexterm" name="idm139979005821456"></a><a class="indexterm" name="idm139979005819360"></a><a class="indexterm" name="idm139979005817040"></a><a class="indexterm" name="idm139979005814944"></a><a class="indexterm" name="idm139979005812624"></a><p>
          接続サマリーテーブルは、スレッド単位ではなく、アカウント、ユーザー、またホストごとにアグリゲーションが行われることを除いて、対応する <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_summary_by_thread_by_event_name</code> テーブルに似ています。
        </p><p>
          パフォーマンススキーマは、イベント名とアカウント、ユーザー、またはホストで接続統計を集計するサマリーテーブルを保守します。待機、ステージ、およびステートメントイベントを集計する個別のテーブルのグループを使用でき、それによってこの一連の接続サマリーテーブルが得られます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとに要約された待機イベント
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとに要約された待機イベント
            </p></li><li class="listitem"><p>
              <code class="literal">events_waits_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとに要約された待機イベント
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとに要約されたステージイベント
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとに要約されたステージイベント
            </p></li><li class="listitem"><p>
              <code class="literal">events_stages_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとに要約されたステージイベント
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_account_by_event_name</code>: アカウントおよびイベント名ごとに要約されたステートメントイベント
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_user_by_event_name</code>: ユーザー名およびイベント名ごとに要約されたステートメントイベント
            </p></li><li class="listitem"><p>
              <code class="literal">events_statements_summary_by_host_by_event_name</code>: ホスト名およびイベント名ごとに要約されたステートメントイベント
            </p></li></ul></div><p>
          つまり、接続サマリーテーブルは、形式 <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_summary_<em class="replaceable"><code>yyy</code></em>_by_event_name</code> の名前を持ちます。ここで <em class="replaceable"><code>xxx</code></em> は <code class="literal">waits</code>、<code class="literal">stages</code>、または <code class="literal">statements</code> で、<em class="replaceable"><code>yyy</code></em> は <code class="literal">account</code>、<code class="literal">user</code>、または <code class="literal">host</code> です。
        </p><p>
          接続サマリーテーブルは中間アグリゲーションレベルを提供します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>xxx</code></em>_summary_by_thread_by_event_name</code> テーブルは接続サマリーテーブルより詳細です
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>xxx</code></em>_summary_global_by_event_name</code> テーブルは接続サマリーテーブルより詳細ではありません
            </p></li></ul></div><p>
          各接続サマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を表します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              名前に <code class="literal">_by_account</code> のあるテーブルでは、<code class="literal">USER</code>、<code class="literal">HOST</code>、および <code class="literal">EVENT_NAME</code> カラムで、アカウントとイベント名ごとにイベントがグループ化されます。
            </p></li><li class="listitem"><p>
              名前に <code class="literal">_by_host</code> のあるテーブルでは、<code class="literal">HOST</code> および <code class="literal">EVENT_NAME</code> カラムで、ホスト名とイベント名ごとにイベントがグループ化されます。
            </p></li><li class="listitem"><p>
              名前に <code class="literal">_by_user</code> のあるテーブルでは、<code class="literal">USER</code> および <code class="literal">EVENT_NAME</code> カラムで、ユーザー名とイベント名ごとにイベントがグループ化されます。
            </p></li></ul></div><p>
          すべての接続サマリーテーブルには、集計された値を格納するこれらのサマリーカラムがあります。<code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>, <code class="literal">AVG_TIMER_WAIT</code>、および <code class="literal">MAX_TIMER_WAIT</code>。これらは <code class="literal">events_waits_summary_by_instance</code> テーブル内の同じ名前のカラムに似ています。ステートメントの接続サマリーテーブルには、ステートメントの種類を集計する追加の <code class="literal">SUM_<em class="replaceable"><code>xxx</code></em></code> カラムがあります。
        </p><p>
          接続サマリーテーブルは MySQL 5.6.3 で追加されました。
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> は接続サマリーテーブルに使用できます。それは、行を削除するのではなく、サマリーカラムを 0 にリセットします。さらに、接続サマリーテーブルは、それらが依存する接続テーブルが切り捨てられた場合に、暗黙的に切り捨てられます。<a class="xref" href="performance-schema.html#connection-table-implicit-truncation" title="表 22.2 暗黙的なテーブル切り捨ての効果">表22.2「暗黙的なテーブル切り捨ての効果」</a> に接続テーブルの切り捨てと暗黙的に切り捨てられるテーブルの関係を説明しています。
        </p><div class="table"><a name="connection-table-implicit-truncation"></a><p class="title"><b>表 22.2 暗黙的なテーブル切り捨ての効果</b></p><div class="table-contents"><table summary="暗黙的なテーブル切り捨ての効果" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">切り捨てられたテーブル</th><th scope="col">暗黙的に切り捨てられたサマリーテーブル</th></tr></thead><tbody><tr><td scope="row"><code class="literal">accounts</code></td><td><code class="literal">%_by_account%</code>、<code class="literal">%_by_thread%</code> に一致する名前を持つテーブル</td></tr><tr><td scope="row"><code class="literal">hosts</code></td><td><code class="literal">%_by_account%</code>、<code class="literal">%_by_host%</code>、<code class="literal">%_by_thread%</code> に一致する名前を持つテーブル</td></tr><tr><td scope="row"><code class="literal">users</code></td><td><code class="literal">%_by_account%</code>、<code class="literal">%_by_user%</code>、<code class="literal">%_by_thread%</code> に一致する名前を持つテーブル</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="socket-summary-tables"></a>22.9.9.8 ソケットサマリーテーブル</h4></div></div></div><a class="indexterm" name="idm139979005737952"></a><a class="indexterm" name="idm139979005735744"></a><a class="indexterm" name="idm139979005733728"></a><a class="indexterm" name="idm139979005731488"></a><p>
          これらのソケットサマリーテーブルは、ソケット操作のタイマーおよびバイトカウント情報を集計します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">socket_summary_by_instance</code>: ソケットインスタンスごとに、すべてのソケット I/O 操作の <code class="literal">wait/io/socket/*</code> インストゥルメントによって生成されたタイマーおよびバイトカウント統計を集計します。接続が終了すると、<code class="literal">socket_summary_by_instance</code> 内のそれに対応する行が削除されます。
            </p></li><li class="listitem"><p>
              <code class="literal">socket_summary_by_event_name</code>: ソケットインストゥルメントごとに、すべてのソケット I/O 操作の <code class="literal">wait/io/socket/*</code> インストゥルメントによって生成されたタイマーおよびバイトカウント統計を集計します。
            </p></li></ul></div><p>
          ソケットサマリーテーブルは、ソケットがクライアントからの次のリクエストを待っている間に、<code class="literal">idle</code> イベントによって生成される待機は集計しません。<code class="literal">idle</code> イベントアグリゲーションには、待機イベントサマリーテーブルを使用します。<a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 イベント待機サマリーテーブル">セクション22.9.9.1「イベント待機サマリーテーブル」</a>を参照してください。
        </p><p>
          各ソケットサマリーテーブルには、テーブルのイベントの集計方法を示す 1 つまたは複数のグループ化カラムがあります。イベント名は、<code class="literal">setup_instruments</code> テーブル内のイベントインストゥルメントの名前を表します。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">socket_summary_by_instance</code> には <code class="literal">OBJECT_INSTANCE_BEGIN</code> カラムがあります。各行は特定のオブジェクトのイベントを要約します。
            </p></li><li class="listitem"><p>
              <code class="literal">socket_summary_by_event_name</code> には <code class="literal">EVENT_NAME</code> カラムがあります。各行は特定のイベント名のイベントを要約します。
            </p></li></ul></div><p>
          すべてのソケットサマリーテーブルには、集計された値を格納するこれらのサマリーカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>、<code class="literal">SUM_TIMER_WAIT</code>、<code class="literal">MIN_TIMER_WAIT</code>、<code class="literal">AVG_TIMER_WAIT</code>、<code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              これらのカラムはすべての操作を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_READ</code>、<code class="literal">SUM_TIMER_READ</code>、<code class="literal">MIN_TIMER_READ</code>、<code class="literal">AVG_TIMER_READ</code>、<code class="literal">MAX_TIMER_READ</code>、<code class="literal">SUM_NUMBER_OF_BYTES_READ</code>
            </p><p>
              これらのカラムはすべての受信操作 (<code class="literal">RECV</code>、<code class="literal">RECVFROM</code>、および <code class="literal">RECVMSG</code>) を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_WRITE</code>、<code class="literal">SUM_TIMER_WRITE</code>、<code class="literal">MIN_TIMER_WRITE</code>、<code class="literal">AVG_TIMER_WRITE</code>、<code class="literal">MAX_TIMER_WRITE</code>、<code class="literal">SUM_NUMBER_OF_BYTES_WRITE</code>
            </p><p>
              これらのカラムはすべての送信操作 (<code class="literal">SEND</code>、<code class="literal">SENDTO</code>、および <code class="literal">SENDMSG</code>) を集計します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MISC</code>、<code class="literal">SUM_TIMER_MISC</code>、<code class="literal">MIN_TIMER_MISC</code>、<code class="literal">AVG_TIMER_MISC</code>、<code class="literal">MAX_TIMER_MISC</code>
            </p><p>
              これらのカラムは <code class="literal">CONNECT</code>、<code class="literal">LISTEN</code>、<code class="literal">ACCEPT</code>、<code class="literal">CLOSE</code>、および <code class="literal">SHUTDOWN</code> などのほかのすべてのソケット操作を集計します。これらの操作のバイトカウントはありません。
            </p></li></ul></div><p>
          <code class="literal">socket_summary_by_instance</code> テーブルには、ソケットのクラス (<code class="literal">client_connection</code>、<code class="literal">server_tcpip_socket</code>、<code class="literal">server_unix_socket</code>) を示す <code class="literal">EVENT_NAME</code> カラムもあります。このカラムは、たとえば、クライアントアクティビティーをサーバー待機ソケットのそれから分離するために、グループ化できます。
        </p><p>
          これらのテーブルは MySQL 5.6.3 で追加されました。
        </p><p>
          <code class="literal">TRUNCATE TABLE</code> はソケットサマリーテーブルに使用できます。<code class="literal">events_statements_summary_by_digest</code> を除き、tt は行を削除するのではなく、サマリーカラムを 0 にリセットします。
        </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="performance-schema-miscellaneous-tables"></a>22.9.10 パフォーマンススキーマのその他のテーブル</h3></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="performance-schema.html#host-cache-table">22.9.10.1 host_cache テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-timers-table">22.9.10.2 performance_timers テーブル</a></span></dt><dt><span class="section"><a href="performance-schema.html#threads-table">22.9.10.3 スレッドテーブル</a></span></dt></dl></div><p>
        次のセクションでは、先述のセクションで説明したテーブルカテゴリに収まらないテーブルについて説明します。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">host_cache</code>: 内部ホストキャッシュからの情報
          </p></li><li class="listitem"><p>
            <code class="literal">performance_timers</code>: 使用可能なイベントタイマー
          </p></li><li class="listitem"><p>
            <code class="literal">threads</code>: サーバースレッドに関する情報
          </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="host-cache-table"></a>22.9.10.1 host_cache テーブル</h4></div></div></div><a class="indexterm" name="idm139979005663024"></a><a class="indexterm" name="idm139979005660912"></a><p>
          <code class="literal">host_cache</code> は、クライアントホスト名および IP アドレス情報を格納し、DNS ルックアップを回避するために使用されるホストキャッシュの内容へのアクセスを提供します。(<a class="xref" href="optimization.html#host-cache" title="8.11.5.2 DNS ルックアップの最適化とホストキャッシュ">セクション8.11.5.2「DNS ルックアップの最適化とホストキャッシュ」</a>を参照してください。)<code class="literal">host_cache</code> テーブルは、<code class="literal">SELECT</code> ステートメントを使用して調査できるようにホストキャッシュの内容を公開します。パフォーマンススキーマを有効にしている必要があり、そうでなければこのテーブルは空になります。
        </p><p>
          <code class="literal">FLUSH HOSTS</code> と <code class="literal">TRUNCATE TABLE host_cache</code> は同じ効果を持ちます。それらはホストキャッシュをクリアします。これは <code class="literal">host_cache</code> テーブルを空にし (それはキャッシュの可視表現であるため)、ブロックされたすべてのホストのブロックも解除します (<a class="xref" href="error-handling.html#blocked-host" title="B.5.2.6 ホスト 'host_name' は拒否されました">セクションB.5.2.6「ホスト 'host_name' は拒否されました」</a>を参照してください)。<code class="literal">FLUSH HOSTS</code> には <code class="literal">RELOAD</code> 権限が必要です。<code class="literal">TRUNCATE TABLE</code> では <code class="literal">host_cache</code> テーブルへの <code class="literal">DROP</code> 権限が必要です。
        </p><p>
          <code class="literal">host_cache</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">IP</code>
            </p><p>
              文字列で表された、サーバーに接続しているクライアントの IP アドレス。
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              そのクライアント IP の解決済みの DNS ホスト名、または名前が不明な場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">HOST_VALIDATED</code>
            </p><p>
              クライアント IP に対し、IP からホスト名、ホスト名から IP の DNS 解決が正常に実行されたかどうか。<code class="literal">HOST_VALIDATED</code> が <code class="literal">YES</code> の場合、DNS への呼び出しを回避できるように、IP に対応するホスト名として <code class="literal">HOST</code> カラムが使用されます。<code class="literal">HOST_VALIDATED</code> が <code class="literal">NO</code> である間、各接続について、最終的にそれが有効な結果または永続的エラーのいずれかで完了するまで、DNS 解決が試みられます。この情報により、サーバーは、クライアントに永久に影響することがある、一時的な DNS 障害発生時の不正または失われたホスト名のキャッシュを避けることができます。
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_CONNECT_ERRORS</code>
            </p><p>
              <span class="quote">「<span class="quote">ブロック</span>」</span>とみなされる接続エラーの数 (<code class="literal">max_connect_errors</code> システム変数に対して評価される)。現在、プロトコルハンドシェークエラーのみが、検証に合格したホスト (<code class="literal">HOST_VALIDATED = YES</code>) に対してのみカウントされます。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HOST_BLOCKED_ERRORS</code>
            </p><p>
              <code class="literal">SUM_CONNECT_ERRORS</code> が <code class="literal">max_connect_errors</code> システム変数の値を超えたため、ブロックされた接続の数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NAMEINFO_TRANSIENT_ERRORS</code>
            </p><p>
              IP からホスト名への DNS 解決時の一時的なエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NAMEINFO_PERMANENT_ERRORS</code>
            </p><p>
              IP からホスト名への DNS 解決時の永続的なエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_FORMAT_ERRORS</code>
            </p><p>
              ホスト名形式エラーの数。MySQL は、<code class="literal">1.2.example.com</code> など、名前の最初のコンポーネントの 1 つまたは複数がすべて数値であるホスト名に対して、<code class="literal">mysql.user</code> テーブル内の <code class="literal">Host</code> カラム値の照合を実行しません。代わりにクライアント IP アドレスが使用されます。この種類の照合が行われない理由については、<a class="xref" href="security.html#account-names" title="6.2.3 アカウント名の指定">セクション6.2.3「アカウント名の指定」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_ADDRINFO_TRANSIENT_ERRORS</code>
            </p><p>
              ホスト名から IP への逆引き DNS 解決時の一時的なエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_ADDRINFO_PERMANENT_ERRORS</code>
            </p><p>
              ホスト名から IP への逆引き DNS 解決時の永続的なエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_FCRDNS_ERRORS</code>
            </p><p>
              Forward-confirmed reverse DNS エラーの数。これらのエラーは、IP からホスト名、ホスト名から IP の DNS 解決で、クライアントの発信元の IP アドレスに一致しない IP アドレスが生成された場合に発生します。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HOST_ACL_ERRORS</code>
            </p><p>
              クライアントホストからログインできる可能性のあるユーザーがいないために発生するエラーの数。そのような場合、サーバーは <code class="literal">ER_HOST_NOT_PRIVILEGED</code> を返し、ユーザー名やパスワードも要求しません。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NO_AUTH_PLUGIN_ERRORS</code>
            </p><p>
              使用できない認証プラグインのリクエストによるエラーの数。プラグインが使用できない可能性があるのは、たとえば、それがロードされていないか、ロードの試みに失敗した場合です。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code>
            </p><p>
              認証プラグインによって報告されるエラーの数。
            </p><p>
              認証プラグインは、障害の原因を示すために、さまざまなエラーコードを報告することがあります。エラーの種類に応じて、これらのいずれかのカラムが増分されます。<code class="literal">COUNT_AUTHENTICATION_ERRORS</code>、<code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code>、<code class="literal">COUNT_HANDSHAKE_ERRORS</code>。新しいリターンコードは、既存のプラグイン API へのオプションの拡張です。不明または予期しないプラグインエラーは <code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code> カラムにカウントされます。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HANDSHAKE_ERRORS</code>
            </p><p>
              有線プロトコルレベルで検出されたエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_PROXY_USER_ERRORS</code>
            </p><p>
              プロキシユーザー A が、存在しない別のユーザー B にプロキシ設定された場合に、検出されたエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_PROXY_USER_ACL_ERRORS</code>
            </p><p>
              存在はしているが、それに対してプロキシユーザー A が <code class="literal">PROXY</code> 権限を持たない別のユーザー B に A がプロキシ設定された場合に、検出されたエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_AUTHENTICATION_ERRORS</code>
            </p><p>
              失敗した認証によって発生したエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_SSL_ERRORS</code>
            </p><p>
              SSL の問題によるエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MAX_USER_CONNECTIONS_ERRORS</code>
            </p><p>
              ユーザーごとの接続割り当てを超えることによって発生したエラーの数。<a class="xref" href="security.html#user-resources" title="6.3.4 アカウントリソース制限の設定">セクション6.3.4「アカウントリソース制限の設定」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS</code>
            </p><p>
              時間あたりのユーザーごとの接続割り当てを超えることによって発生したエラーの数。<a class="xref" href="security.html#user-resources" title="6.3.4 アカウントリソース制限の設定">セクション6.3.4「アカウントリソース制限の設定」</a>を参照してください。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_DEFAULT_DATABASE_ERRORS</code>
            </p><p>
              デフォルトのデータベースに関連するエラーの数。たとえば、データベースが存在していないか、ユーザーがそれにアクセスするための権限を持っていませんでした。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_INIT_CONNECT_ERRORS</code>
            </p><p>
              <code class="literal">init_connect</code> システム変数値内のステートメントの実行の失敗によって発生したエラーの数。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_LOCAL_ERRORS</code>
            </p><p>
              サーバー実装にローカルで、ネットワーク、認証、または承認に関連しないエラーの数。たとえば、メモリー不足状況はこのカテゴリに収まります。
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_UNKNOWN_ERRORS</code>
            </p><p>
              このテーブルのほかのカラムによって報告されない、ほかの不明なエラーの数。このカラムは、新しいエラー状況を報告する必要がある場合や、下位互換性を維持し、<code class="literal">host_cache</code> テーブルのテーブル構造を必要とする場合に備えて、将来使用するために予約されています。
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_SEEN</code>
            </p><p>
              <code class="literal">IP</code> カラム内のクライアントから確認された最初の接続の試みのタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_SEEN</code>
            </p><p>
              <code class="literal">IP</code> カラム内のクライアントから確認された最後の接続の試みのタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_ERROR_SEEN</code>
            </p><p>
              <code class="literal">IP</code> カラム内のクライアントから確認された最初のエラーのタイムスタンプ。
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_SEEN</code>
            </p><p>
              <code class="literal">IP</code> カラム内のクライアントから確認された最後のエラーのタイムスタンプ。
            </p></li></ul></div><p>
          <code class="literal">host_cache</code> テーブルは MySQL 5.6.5 で追加されました。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="performance-timers-table"></a>22.9.10.2 performance_timers テーブル</h4></div></div></div><a class="indexterm" name="idm139979005551568"></a><a class="indexterm" name="idm139979005549408"></a><p>
          <code class="literal">performance_timers</code> テーブルは使用可能なイベントタイマーを示します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_timers;</code></strong>
+-------------+-----------------+------------------+----------------+
| TIMER_NAME  | TIMER_FREQUENCY | TIMER_RESOLUTION | TIMER_OVERHEAD |
+-------------+-----------------+------------------+----------------+
| CYCLE       |      2389029850 |                1 |             72 |
| NANOSECOND  |            NULL |             NULL |           NULL |
| MICROSECOND |         1000000 |                1 |            585 |
| MILLISECOND |            1035 |                1 |            738 |
| TICK        |             101 |                1 |            630 |
+-------------+-----------------+------------------+----------------+
</pre><p>
          特定のタイマーに関連付けられた値が <code class="literal">NULL</code> の場合、そのタイマーはプラットフォームでサポートされていません。<code class="literal">NULL</code> を含まない行は、<code class="literal">setup_timers</code> で使用できるタイマーを示しています。
        </p><p>
          <code class="literal">performance_timers</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">TIMER_NAME</code>
            </p><p>
              <code class="literal">setup_timers</code> テーブルの構成時に、タイマーを参照する名前。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_FREQUENCY</code>
            </p><p>
              秒あたりのタイマーユニットの数。サイクルタイマーの場合、頻度は一般に CPU 速度に関連します。たとえば、2.4GHz プロセッサを搭載するシステムでは、<code class="literal">CYCLE</code> は 2400000000 に近い可能性があります。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_RESOLUTION</code>
            </p><p>
              タイマー値が増加するタイマーユニット数を示します。タイマーの分解能が 10 の場合、その値は毎回 10 ずつ増加します。
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_OVERHEAD</code>
            </p><p>
              特定のタイマーで 1 つのタイミングを取得するためのオーバーヘッドの最小サイクル数。パフォーマンススキーマは、初期化時にタイマーを 20 回呼び出し、最小値を選択することによって、この値を決定します。インストゥルメンテーションは、各イベントの開始と終了でタイマーを呼び出すため、実際の合計のオーバーヘッドはこの量の 2 倍になります。タイマーコードは、時間付きイベントにのみ呼び出されるため、このオーバーヘッドは時間なしイベントには適用されません。
            </p><p>
              テーブルの最大行数は、サーバー起動時に自動サイズ設定されます。この最大を明示的に設定するには、サーバー起動時に <code class="literal">performance_schema_digests_size</code> システム変数を設定します。
            </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="threads-table"></a>22.9.10.3 スレッドテーブル</h4></div></div></div><a class="indexterm" name="idm139979005524048"></a><a class="indexterm" name="idm139979005521904"></a><a class="indexterm" name="idm139979005519952"></a><p>
          <code class="literal">threads</code> テーブルは各サーバースレッドの行を格納します。各行は、スレッドに関する情報を格納し、それに対するモニタリングが有効にされているかどうかを示します。
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM threads\G</code></strong>
*************************** 1. row ***************************
          THREAD_ID: 1
               NAME: thread/sql/main
               TYPE: BACKGROUND
     PROCESSLIST_ID: NULL
   PROCESSLIST_USER: NULL
   PROCESSLIST_HOST: NULL
     PROCESSLIST_DB: NULL
PROCESSLIST_COMMAND: NULL
   PROCESSLIST_TIME: 80284
  PROCESSLIST_STATE: NULL
   PROCESSLIST_INFO: NULL
   PARENT_THREAD_ID: NULL
               ROLE: NULL
       INSTRUMENTED: YES
...
*************************** 4. row ***************************
          THREAD_ID: 51
               NAME: thread/sql/one_connection
               TYPE: FOREGROUND
     PROCESSLIST_ID: 34
   PROCESSLIST_USER: paul
   PROCESSLIST_HOST: localhost
     PROCESSLIST_DB: performance_schema
PROCESSLIST_COMMAND: Query
   PROCESSLIST_TIME: 0
  PROCESSLIST_STATE: Sending data
   PROCESSLIST_INFO: SELECT * FROM threads
   PARENT_THREAD_ID: 1
               ROLE: NULL
       INSTRUMENTED: YES
...
</pre><p>
          <code class="literal">threads</code> テーブルの初期の内容は、パフォーマンススキーマの初期化が行われるときに、存在しているスレッドに基づきます。その後、サーバーがスレッドを作成するたびに新しい行が追加されます。
        </p><a class="indexterm" name="idm139979005511920"></a><p>
          スレッドの終了時に、<code class="literal">threads</code> テーブルからの行の削除が行われます。クライアントセッションに関連付けられたスレッドでは、セッションの終了時に削除が行われます。クライアントの自動再接続が有効にされており、セッションが切断後に再接続した場合、そのセッションは異なる <code class="literal">PROCESSLIST_ID</code> 値を持つ <code class="literal">threads</code> テーブル内の新しい行に関連付けられます。新しいスレッドの初期 <code class="literal">INSTRUMENTED</code> 値は元のスレッドの値と異なることがあります。その間に <code class="literal">setup_actors</code> テーブルが変更されている可能性があり、元のスレッドの <code class="literal">INSTRUMENTED</code> 値が初期化後に変更されている場合、その変更は新しいスレッドに持ち越されません。
        </p><p>
          <code class="literal">PROCESSLIST_</code> のプリフィクスのある名前を持つ <code class="literal">threads</code> テーブルカラムは、<code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> テーブルまたは <code class="literal">SHOW PROCESSLIST</code> ステートメントから入手できるものに似た情報を提供します。そのため、これらのすべてのソースはスレッドモニタリング情報を提供します。<code class="literal">threads</code> の使用は、次の点で、ほかの 2 つのソースの使用と異なります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">threads</code> へのアクセスには相互排他ロックは必要なく、サーバーパフォーマンスへの影響は最小です。<code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> と <code class="literal">SHOW PROCESSLIST</code> では相互排他ロックが必要になるため、パフォーマンスの低下につながります。
            </p></li><li class="listitem"><p>
              <code class="literal">threads</code> は、スレッドがフォアグラウンドスレッドかバックグラウンドスレッドか、およびスレッドに関連付けられているサーバー内の場所などの、各スレッドの追加情報を提供します。
            </p></li><li class="listitem"><p>
              <code class="literal">threads</code> はバックグラウンドスレッドに関する情報を提供するため、ほかのスレッド情報ソースでは不可能なアクティビティーのモニターに使用できます。
            </p></li><li class="listitem"><p>
              スレッドモニタリングを有効または無効にできます (つまり、スレッドによって実行されるイベントがインストゥルメントされるかどうか)。既存のスレッドのモニタリングを制御するには、<code class="literal">threads</code> テーブルの <code class="literal">INSTRUMENTED</code> カラムを設定します。新しいフォアグラウンドスレッドの初期 <code class="literal">INSTRUMENTED</code> 値を制御するには、<code class="literal">setup_actors</code> テーブルを使用します。(スレッドモニタリングが行われる状況の詳細については、<code class="literal">INSTRUMENTED</code> カラムの説明を参照してください。)
            </p></li></ul></div><p>
          これらの理由で、<code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> または <code class="literal">SHOW PROCESSLIST</code> を使用して、サーバーモニタリングを実行する DBA は、代わりに <code class="literal">threads</code> を使用してモニターしたいと考える場合があります。
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">注記</div><p>
            <code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> および <code class="literal">SHOW PROCESSLIST</code> では、ほかのユーザーのスレッドに関する情報は、現在のユーザーに <code class="literal">PROCESS</code> 権限がある場合にのみ表示されます。これは <code class="literal">threads</code> テーブルには当てはまりません。テーブルの <code class="literal">SELECT</code> 権限を持つすべてのユーザーに、すべての行が表示されます。ほかのユーザーのスレッドを表示できないようにすべきであるユーザーには、その権限を与えないでください。
          </p></div><p>
          <code class="literal">threads</code> テーブルにはこれらのカラムがあります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              一意のスレッド識別子。
            </p></li><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              サーバーのスレッドインストゥルメンテーションコードに関連付けられている名前。たとえば、<code class="literal">thread/sql/one_connection</code> はユーザー接続の処理を担当するコード内のスレッド関数に対応し、<code class="literal">thread/sql/main</code> はサーバーの <code class="literal">main()</code> 関数を表します。
            </p></li><li class="listitem"><p>
              <code class="literal">TYPE</code>
            </p><p>
              <code class="literal">FOREGROUND</code> または <code class="literal">BACKGROUND</code> のスレッドの種類。ユーザー接続スレッドはフォアグラウンドスレッドです。内部サーバーアクティビティーに関連付けられているスレッドはバックグラウンドスレッドです。例は、内部 <code class="literal">InnoDB</code> スレッド、スレーブに情報を送信する <span class="quote">「<span class="quote">Binlog Dump</span>」</span> スレッド、スレーブ I/O および SQL スレッドです。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              <code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code> テーブルに表示されるスレッドの場合、これはそのテーブルの <code class="literal">ID</code> カラムに表示される同じ値です。それは、<code class="literal">SHOW PROCESSLIST</code> 出力の <code class="literal">Id</code> カラムに表示される値と、そのスレッド内で <code class="literal">CONNECTION_ID()</code> が返す値でもあります。
            </p><p>
              バックグラウンドスレッド (ユーザー接続に関連付けられないスレッド) の場合、<code class="literal">PROCESSLIST_ID</code> は <code class="literal">NULL</code> であるため、値は一意ではありません。(MySQL 5.6.9 より前では、バックグラウンドスレッドの場合の値は 0 です。)
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_USER</code>
            </p><p>
              フォアグラウンドスレッドに関連付けられているユーザー、バックグラウンドスレッドの場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_HOST</code>
            </p><p>
              フォアグラウンドスレッドに関連付けられているクライアントのホスト名、バックグラウンドスレッドの場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_DB</code>
            </p><p>
              スレッドのデフォルトのデータベース、何もない場合は <code class="literal">NULL</code>。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_COMMAND</code>
            </p><p>
              スレッドが実行しているコマンドの種類。スレッドコマンドの説明については、<a class="xref" href="optimization.html#thread-information" title="8.12.5 スレッド情報の検査">セクション8.12.5「スレッド情報の検査」</a>を参照してください。このカラムの値は、クライアント/サーバープロトコルの <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code> コマンドと <code class="literal">Com_<em class="replaceable"><code>xxx</code></em></code> ステータス変数に対応します。<a class="xref" href="server-administration.html#server-status-variables" title="5.1.6 サーバーステータス変数">セクション5.1.6「サーバーステータス変数」</a>を参照してください
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_TIME</code>
            </p><p>
              スレッドが現在の状態になってからの秒数。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_STATE</code>
            </p><p>
              スレッドが行なっていることを示すアクション、イベント、または状態。<code class="literal">PROCESSLIST_STATE</code> 値の説明については、<a class="xref" href="optimization.html#thread-information" title="8.12.5 スレッド情報の検査">セクション8.12.5「スレッド情報の検査」</a>を参照してください。
            </p><p>
              ほとんどの状態がきわめてすばやい操作に対応します。スレッドが何秒間も特定の状態にとどまっている場合は、問題が発生している可能性があり、調査が必要です。
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_INFO</code>
            </p><p>
              スレッドが実行しているステートメント、またはそれがどのステートメントも実行していない場合は <code class="literal">NULL</code>。このステートメントは、サーバーに送信されるステートメント、またはこのステートメントがほかのステートメントを実行する場合は、もっとも内側のステートメントである可能性があります。たとえば、<code class="literal">CALL</code> ステートメントが <code class="literal">SELECT</code> ステートメントを実行しているストアドプロシージャーを実行する場合、<code class="literal">PROCESSLIST_INFO</code> 値には <code class="literal">SELECT</code> ステートメントが示されます。
            </p></li><li class="listitem"><p>
              <code class="literal">PARENT_THREAD_ID</code>
            </p><p>
              このスレッドがサブスレッド (別のスレッドによって生成される) である場合、これは生成されるスレッドの <code class="literal">THREAD_ID</code> 値です。スレッドの生成は、<code class="literal">INSERT DELAYED</code> ステートメントからの行の挿入を処理するためなどに発生します。
            </p></li><li class="listitem"><p>
              <code class="literal">ROLE</code>
            </p><p>
              使用されません。
            </p></li><li class="listitem"><p>
              <code class="literal">INSTRUMENTED</code>
            </p><p>
              スレッドがインストゥルメントされるかどうか。これは、スレッドの <code class="literal">threads</code> テーブル行に影響せず、スレッドによって実行されるイベントがインストゥルメントされるかどうかに影響します。
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  フォアグラウンドスレッドでは、初期 <code class="literal">INSTRUMENTED</code> 値は、スレッドに関連付けられているユーザーアカウントが <code class="literal">setup_actors</code> テーブル内の任意の行に一致するかどうかによって決定されます。照合は <code class="literal">PROCESSLIST_USER</code> および <code class="literal">PROCESSLIST_HOST</code> カラムの値に基づきます。
                </p><p>
                  スレッドがサブスレッドを生成する場合、そのサブスレッドに対して照合が再度行われます。
                </p></li><li class="listitem"><p>
                  バックグラウンドスレッドの場合、<code class="literal">INSTRUMENTED</code> はデフォルトで <code class="literal">YES</code> です。バックグラウンドスレッドに関連付けられたユーザーはないため、<code class="literal">setup_actors</code> は参照されません。
                </p></li><li class="listitem"><p>
                  どのスレッドでも、スレッドの有効期間の間にその <code class="literal">INSTRUMENTED</code> 値が変更されることがあります。これは、唯一の変更可能な <code class="literal">threads</code> テーブルカラムです。
                </p></li></ul></div><p>
              スレッドによって実行されるイベントのモニタリングが行われる場合、これらのことが当てはまる必要があります。
            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">setup_consumers</code> テーブル内の <code class="literal">thread_instrumentation</code> コンシューマは <code class="literal">YES</code> である必要があります。
                </p></li><li class="listitem"><p>
                  <code class="literal">thread.INSTRUMENTED</code> カラムは <code class="literal">YES</code> である必要があります。
                </p></li><li class="listitem"><p>
                  <code class="literal">setup_instruments</code> テーブル内で有効にされているインストゥルメントから生成されたスレッドイベントに対してのみ、モニタリングが行われます。
                </p></li></ul></div></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-option-variable-reference"></a>22.10 パフォーマンススキーマオプションおよび変数リファレンス</h2></div></div></div><div class="table"><a name="idm139979005390336"></a><p class="title"><b>表 22.3 パフォーマンススキーマ変数リファレンス</b></p><div class="table-contents"><table summary="パフォーマンススキーマ変数リファレンス" border="1"><colgroup><col class="name"><col class="cmd-line"><col class="option_file"><col class="system_var"><col class="status_var"><col class="var_scope"><col class="dynamic"></colgroup><thead><tr><th scope="col">名前</th><th scope="col">コマンド行</th><th scope="col">オプションファイル</th><th scope="col">システム変数</th><th scope="col">ステータス変数</th><th scope="col">変数スコープ</th><th scope="col">動的</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema">performance_schema</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_accounts_lost">Performance_schema_accounts_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_accounts_size">performance_schema_accounts_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_cond_classes_lost">Performance_schema_cond_classes_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_cond_instances_lost">Performance_schema_cond_instances_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-current">performance-schema-consumer-events-stages-current</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-history">performance-schema-consumer-events-stages-history</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-history-long">performance-schema-consumer-events-stages-history-long</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-current">performance-schema-consumer-events-statements-current</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-history">performance-schema-consumer-events-statements-history</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-history-long">performance-schema-consumer-events-statements-history-long</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-current">performance-schema-consumer-events-waits-current</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-history">performance-schema-consumer-events-waits-history</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-history-long">performance-schema-consumer-events-waits-history-long</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-global-instrumentation">performance-schema-consumer-global-instrumentation</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-statements-digest">performance-schema-consumer-statements-digest</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-thread-instrumentation">performance-schema-consumer-thread-instrumentation</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_digest_lost">Performance_schema_digest_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size">performance_schema_digests_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_long_size">performance_schema_events_stages_history_long_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size">performance_schema_events_stages_history_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_long_size">performance_schema_events_statements_history_long_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size">performance_schema_events_statements_history_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size">performance_schema_events_waits_history_long_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size">performance_schema_events_waits_history_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_classes_lost">Performance_schema_file_classes_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_handles_lost">Performance_schema_file_handles_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_instances_lost">Performance_schema_file_instances_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_hosts_lost">Performance_schema_hosts_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_hosts_size">performance_schema_hosts_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-instrument">performance-schema-instrument</a></td><td>はい</td><td>はい</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_locker_lost">Performance_schema_locker_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_classes">performance_schema_max_cond_classes</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_instances">performance_schema_max_cond_instances</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_classes">performance_schema_max_file_classes</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles">performance_schema_max_file_handles</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_instances">performance_schema_max_file_instances</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes">performance_schema_max_mutex_classes</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_instances">performance_schema_max_mutex_instances</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_classes">performance_schema_max_rwlock_classes</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_instances">performance_schema_max_rwlock_instances</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_classes">performance_schema_max_socket_classes</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_instances">performance_schema_max_socket_instances</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_stage_classes">performance_schema_max_stage_classes</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_classes">performance_schema_max_statement_classes</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_handles">performance_schema_max_table_handles</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_instances">performance_schema_max_table_instances</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_classes">performance_schema_max_thread_classes</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances">performance_schema_max_thread_instances</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_classes_lost">Performance_schema_mutex_classes_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_instances_lost">Performance_schema_mutex_instances_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_rwlock_classes_lost">Performance_schema_rwlock_classes_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_rwlock_instances_lost">Performance_schema_rwlock_instances_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_session_connect_attrs_lost">Performance_schema_session_connect_attrs_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_session_connect_attrs_size">performance_schema_session_connect_attrs_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_actors_size">performance_schema_setup_actors_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_objects_size">performance_schema_setup_objects_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_socket_classes_lost">Performance_schema_socket_classes_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_socket_instances_lost">Performance_schema_socket_instances_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_stage_classes_lost">Performance_schema_stage_classes_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_statement_classes_lost">Performance_schema_statement_classes_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_table_handles_lost">Performance_schema_table_handles_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_table_instances_lost">Performance_schema_table_instances_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_thread_classes_lost">Performance_schema_thread_classes_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_thread_instances_lost">Performance_schema_thread_instances_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_users_lost">Performance_schema_users_lost</a></td><td> </td><td> </td><td> </td><td>はい</td><td>グローバル</td><td>いいえ</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_users_size">performance_schema_users_size</a></td><td>はい</td><td>はい</td><td>はい</td><td> </td><td>グローバル</td><td>いいえ</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-options"></a>22.11 パフォーマンススキーマコマンドオプション</h2></div></div></div><p>
      パフォーマンススキーマパラメータは、サーバー起動時にコマンド行またはオプションファイルに指定して、パフォーマンススキーマのインストゥルメントおよびコンシューマを構成できます。多くの場合に実行時構成も可能ですが (<a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="22.2.3 パフォーマンススキーマ実行時構成">セクション22.2.3「パフォーマンススキーマ実行時構成」</a> を参照)、実行時構成で、起動プロセス中にすでに初期化されているインストゥルメントに影響を与えるには遅すぎる場合は、起動時構成を使用する必要があります。
    </p><p>
      パフォーマンススキーマのコンシューマおよびインストゥルメントは、次の構文を使用して起動時に構成できます。追加の詳細については、<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="22.2.2 パフォーマンススキーマ起動構成">セクション22.2.2「パフォーマンススキーマ起動構成」</a>を参照してください。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-xxx"></a>
          <a class="indexterm" name="idm139979005154912"></a> <a class="indexterm" name="idm139979005152720"></a> <code class="option">--performance-schema-consumer-<em class="replaceable"><code>consumer_name</code></em>=<code class="literal">value</code></code>
        </p><p>
          パフォーマンススキーマコンシューマを構成します。<code class="literal">setup_consumers</code> テーブル内のコンシューマ名は下線が使われますが、起動時に設定されたコンシューマでは、名前の中のダッシュと下線は同等です。各コンシューマを構成するためのオプションについては、このセクションの後半で詳しく説明します。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-instrument"></a>
          <a class="indexterm" name="idm139979005145280"></a> <a class="indexterm" name="idm139979005143088"></a> <code class="option">--performance-schema-instrument=<em class="replaceable"><code>instrument_name</code></em>=<code class="literal">value</code></code>
        </p><p>
          パフォーマンススキーマインストゥルメントを構成します。名前をパターンとして指定して、パターンに一致するインストゥルメントを構成できます。
        </p></li></ul></div><p>
      次の項目は各コンシューマを構成します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-current"></a>
          <a class="indexterm" name="idm139979005136224"></a> <a class="indexterm" name="idm139979005133904"></a> <code class="option">--performance-schema-consumer-events-stages-current=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-stages-current</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-history"></a>
          <a class="indexterm" name="idm139979005127920"></a> <a class="indexterm" name="idm139979005125600"></a> <code class="option">--performance-schema-consumer-events-stages-history=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-stages-history</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-history-long"></a>
          <a class="indexterm" name="idm139979005119616"></a> <a class="indexterm" name="idm139979005117280"></a> <code class="option">--performance-schema-consumer-events-stages-history-long=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-stages-history-long</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-current"></a>
          <a class="indexterm" name="idm139979005111248"></a> <a class="indexterm" name="idm139979005108912"></a> <code class="option">--performance-schema-consumer-events-statements-current=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-statements-current</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-history"></a>
          <a class="indexterm" name="idm139979005102880"></a> <a class="indexterm" name="idm139979005100544"></a> <code class="option">--performance-schema-consumer-events-statements-history=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-statements-history</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-history-long"></a>
          <a class="indexterm" name="idm139979005094464"></a> <a class="indexterm" name="idm139979005092224"></a> <code class="option">--performance-schema-consumer-events-statements-history-long=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-statements-history-long</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-current"></a>
          <a class="indexterm" name="idm139979005086112"></a> <a class="indexterm" name="idm139979005083792"></a> <code class="option">--performance-schema-consumer-events-waits-current=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-waits-current</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-history"></a>
          <a class="indexterm" name="idm139979005077872"></a> <a class="indexterm" name="idm139979005075552"></a> <code class="option">--performance-schema-consumer-events-waits-history=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-waits-history</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-history-long"></a>
          <a class="indexterm" name="idm139979005069568"></a> <a class="indexterm" name="idm139979005067232"></a> <code class="option">--performance-schema-consumer-events-waits-history-long=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">events-waits-history-long</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-global-instrumentation"></a>
          <a class="indexterm" name="idm139979005061200"></a> <a class="indexterm" name="idm139979005058880"></a> <code class="option">--performance-schema-consumer-global-instrumentation=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">global-instrumentation</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-statements-digest"></a>
          <a class="indexterm" name="idm139979005052896"></a> <a class="indexterm" name="idm139979005050672"></a> <code class="option">--performance-schema-consumer-statements-digest=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">statements-digest</code> コンシューマを構成します。このオプションは MySQL 5.6.5 で追加されました。
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-thread-instrumentation"></a>
          <a class="indexterm" name="idm139979005044624"></a> <a class="indexterm" name="idm139979005042304"></a> <code class="option">--performance-schema-consumer-thread-instrumentation=<code class="literal">value</code></code>
        </p><p>
          <code class="literal">thread-instrumentation</code> コンシューマを構成します。このオプションは MySQL 5.6.4 で追加されました。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-system-variables"></a>22.12 パフォーマンススキーマシステム変数</h2></div></div></div><p>
      パフォーマンススキーマは、構成情報を提供するいくつかのシステム変数を実装しています。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'perf%';</code></strong>
+--------------------------------------------------------+---------+
| Variable_name                                          | Value   |
+--------------------------------------------------------+---------+
| performance_schema                                     | ON      |
| performance_schema_accounts_size                       | 100     |
| performance_schema_digests_size                        | 200     |
| performance_schema_events_stages_history_long_size     | 10000   |
| performance_schema_events_stages_history_size          | 10      |
| performance_schema_events_statements_history_long_size | 10000   |
| performance_schema_events_statements_history_size      | 10      |
| performance_schema_events_waits_history_long_size      | 10000   |
| performance_schema_events_waits_history_size           | 10      |
| performance_schema_hosts_size                          | 100     |
| performance_schema_max_cond_classes                    | 80      |
| performance_schema_max_cond_instances                  | 1000    |
| performance_schema_max_file_classes                    | 50      |
| performance_schema_max_file_handles                    | 32768   |
| performance_schema_max_file_instances                  | 10000   |
| performance_schema_max_mutex_classes                   | 200     |
| performance_schema_max_mutex_instances                 | 1000000 |
| performance_schema_max_rwlock_classes                  | 30      |
| performance_schema_max_rwlock_instances                | 1000000 |
| performance_schema_max_socket_classes                  | 10      |
| performance_schema_max_socket_instances                | 1000    |
| performance_schema_max_stage_classes                   | 150     |
| performance_schema_max_statement_classes               | 165     |
| performance_schema_max_table_handles                   | 10000   |
| performance_schema_max_table_instances                 | 1000    |
| performance_schema_max_thread_classes                  | 50      |
| performance_schema_max_thread_instances                | 1000    |
| performance_schema_session_connect_attrs_size          | 512     |
| performance_schema_setup_actors_size                   | 100     |
| performance_schema_setup_objects_size                  | 100     |
| performance_schema_users_size                          | 100     |
+--------------------------------------------------------+---------+
</pre><p>
      パフォーマンススキーマシステム変数は、コマンド行またはオプションファイルでサーバーの起動時に設定でき、多くは実行時に設定できます。<a class="xref" href="performance-schema.html#performance-schema-option-variable-reference" title="22.10 パフォーマンススキーマオプションおよび変数リファレンス">セクション22.10「パフォーマンススキーマオプションおよび変数リファレンス」</a>を参照してください。
    </p><p>
      MySQL 5.6.6 以降、パフォーマンススキーマは、そのパラメータのいくつかの値を、それらが明示的に設定されていない場合に、サーバーの起動時に自動的にサイズ設定します。詳細については、<a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="22.2.2 パフォーマンススキーマ起動構成">セクション22.2.2「パフォーマンススキーマ起動構成」</a>を参照してください。
    </p><p>
      パフォーマンススキーマシステム変数には次の意味があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="sysvar_performance_schema"></a>
          <a class="indexterm" name="idm139979005026288"></a> <a class="indexterm" name="idm139979005024736"></a> <code class="literal">performance_schema</code>
        </p><div class="informaltable"><table summary="Options for performance_schema" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema">performance_schema</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">ブール</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">OFF</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">ブール</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">ON</code></td></tr></tbody></table></div><p>
          この変数の値は <code class="literal">ON</code> または <code class="literal">OFF</code> で、パフォーマンススキーマが有効にされているかどうかを示します。デフォルトで、この値は MySQL 5.6.6 以降 <code class="literal">ON</code> で、それより前では <code class="literal">OFF</code> です。サーバーの起動時に、この変数を値なし、またはそれを有効にする <code class="literal">ON</code> または 1 の値、またはそれを無効にする <code class="literal">OFF</code> または 0 の値で指定できます。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_accounts_size"></a>
          <a class="indexterm" name="idm139979004990368"></a> <a class="indexterm" name="idm139979004988896"></a> <code class="literal">performance_schema_accounts_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_accounts_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_accounts_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_accounts_size">performance_schema_accounts_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row"><span class="bold"><strong>最小値</strong></span></td><td colspan="2"><code class="literal">0</code></td></tr><tr><td scope="row"><span class="bold"><strong>最大値</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>最小値</strong></span></td><td colspan="2"><code class="literal">-1</code></td></tr><tr><td scope="row"><span class="bold"><strong>最大値</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table></div><p>
          <code class="literal">accounts</code> テーブルの行数。この変数が 0 の場合、パフォーマンススキーマは <code class="literal">accounts</code> テーブル内の接続統計を保守しません。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_digests_size"></a>
          <a class="indexterm" name="idm139979004946224"></a> <a class="indexterm" name="idm139979004944752"></a> <code class="literal">performance_schema_digests_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_digests_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.5</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_digests_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size">performance_schema_digests_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>最小値</strong></span></td><td colspan="2"><code class="literal">-1</code></td></tr><tr><td scope="row"><span class="bold"><strong>最大値</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table></div><p>
          <code class="literal">events_statements_summary_by_digest</code> テーブル内の最大行数。この変数は MySQL 5.6.5 で追加されました。この最大を超えたため、ダイジェストをインストゥルメントできない場合、パフォーマンススキーマは <code class="literal">Performance_schema_digest_lost</code> ステータス変数を増分します。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_stages_history_long_size"></a>
          <a class="indexterm" name="idm139979004912032"></a> <a class="indexterm" name="idm139979004910384"></a> <code class="literal">performance_schema_events_stages_history_long_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_events_stages_history_long_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_stages_history_long_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_long_size">performance_schema_events_stages_history_long_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          <code class="literal">events_stages_history_long</code> テーブルの行数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_stages_history_size"></a>
          <a class="indexterm" name="idm139979004877536"></a> <a class="indexterm" name="idm139979004875904"></a> <code class="literal">performance_schema_events_stages_history_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_events_stages_history_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_stages_history_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size">performance_schema_events_stages_history_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          <code class="literal">events_stages_history</code> テーブルのスレッドあたりの行数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_statements_history_long_size"></a>
          <a class="indexterm" name="idm139979004843200"></a> <a class="indexterm" name="idm139979004841536"></a> <code class="literal">performance_schema_events_statements_history_long_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_events_statements_history_long_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_statements_history_long_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_long_size">performance_schema_events_statements_history_long_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          <code class="literal">events_statements_history_long</code> テーブル内の行数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_statements_history_size"></a>
          <a class="indexterm" name="idm139979004808688"></a> <a class="indexterm" name="idm139979004807040"></a> <code class="literal">performance_schema_events_statements_history_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_events_statements_history_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_statements_history_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size">performance_schema_events_statements_history_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          <code class="literal">events_statements_history</code> テーブル内のスレッドあたりの行数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_waits_history_long_size"></a>
          <a class="indexterm" name="idm139979004774192"></a> <a class="indexterm" name="idm139979004772544"></a> <code class="literal">performance_schema_events_waits_history_long_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_events_waits_history_long_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_waits_history_long_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size">performance_schema_events_waits_history_long_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          <code class="literal">events_waits_history_long</code> テーブル内の行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_waits_history_size"></a>
          <a class="indexterm" name="idm139979004741632"></a> <a class="indexterm" name="idm139979004740000"></a> <code class="literal">performance_schema_events_waits_history_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_events_waits_history_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_waits_history_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size">performance_schema_events_waits_history_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          <code class="literal">events_waits_history</code> テーブル内のスレッドあたりの行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_hosts_size"></a>
          <a class="indexterm" name="idm139979004709328"></a> <a class="indexterm" name="idm139979004707856"></a> <code class="literal">performance_schema_hosts_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_hosts_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_hosts_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_hosts_size">performance_schema_hosts_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row"><span class="bold"><strong>最小値</strong></span></td><td colspan="2"><code class="literal">0</code></td></tr><tr><td scope="row"><span class="bold"><strong>最大値</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>最小値</strong></span></td><td colspan="2"><code class="literal">-1</code></td></tr><tr><td scope="row"><span class="bold"><strong>最大値</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table></div><p>
          <code class="literal">hosts</code> テーブル内の行数。この変数が 0 の場合、パフォーマンススキーマは <code class="literal">hosts</code> テーブル内の接続統計を保守しません。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_cond_classes"></a>
          <a class="indexterm" name="idm139979004665072"></a> <a class="indexterm" name="idm139979004663472"></a> <code class="literal">performance_schema_max_cond_classes</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_cond_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_cond_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_classes">performance_schema_max_cond_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">80</code></td></tr></tbody></table></div><p>
          条件インストゥルメントの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_cond_instances"></a>
          <a class="indexterm" name="idm139979004639520"></a> <a class="indexterm" name="idm139979004637920"></a> <code class="literal">performance_schema_max_cond_instances</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_cond_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_cond_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_instances">performance_schema_max_cond_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          インストゥルメントされた条件オブジェクトの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_classes"></a>
          <a class="indexterm" name="idm139979004608064"></a> <a class="indexterm" name="idm139979004606464"></a> <code class="literal">performance_schema_max_file_classes</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_file_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_file_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_classes">performance_schema_max_file_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">50</code></td></tr></tbody></table></div><p>
          ファイルインストゥルメントの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_handles"></a>
          <a class="indexterm" name="idm139979004582560"></a> <a class="indexterm" name="idm139979004580960"></a> <code class="literal">performance_schema_max_file_handles</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_file_handles" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_file_handles=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles">performance_schema_max_file_handles</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">32768</code></td></tr></tbody></table></div><p>
          オープンしているファイルオブジェクトの最大数。
        </p><p>
          <code class="literal">performance_schema_max_file_handles</code> の値は、<code class="literal">open_files_limit</code> の値より大きくしてください。<code class="literal">open_files_limit</code> は、サーバーがサポート可能なオープンファイルハンドルの最大数に影響し、<code class="literal">performance_schema_max_file_handles</code> はこれらのファイルハンドルのうちインストゥルメント可能な数に影響します。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_instances"></a>
          <a class="indexterm" name="idm139979004552112"></a> <a class="indexterm" name="idm139979004550512"></a> <code class="literal">performance_schema_max_file_instances</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_file_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_file_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_instances">performance_schema_max_file_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          インストゥルメントされるファイルオブジェクトの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_mutex_classes"></a>
          <a class="indexterm" name="idm139979004520592"></a> <a class="indexterm" name="idm139979004518992"></a> <code class="literal">performance_schema_max_mutex_classes</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_mutex_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_mutex_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes">performance_schema_max_mutex_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">200</code></td></tr></tbody></table></div><p>
          相互排他ロックインストゥルメントの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_mutex_instances"></a>
          <a class="indexterm" name="idm139979004495056"></a> <a class="indexterm" name="idm139979004493456"></a> <code class="literal">performance_schema_max_mutex_instances</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_mutex_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_mutex_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_instances">performance_schema_max_mutex_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          インストゥルメントされる相互排他ロックオブジェクトの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_rwlock_classes"></a>
          <a class="indexterm" name="idm139979004463520"></a> <a class="indexterm" name="idm139979004461920"></a> <code class="literal">performance_schema_max_rwlock_classes</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_rwlock_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_rwlock_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_classes">performance_schema_max_rwlock_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (5.6.0)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">20</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.1, &lt;= 5.6.14)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">30</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.15)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">40</code></td></tr></tbody></table></div><p>
          rwlock インストゥルメントの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_rwlock_instances"></a>
          <a class="indexterm" name="idm139979004426448"></a> <a class="indexterm" name="idm139979004424848"></a> <code class="literal">performance_schema_max_rwlock_instances</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_rwlock_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_rwlock_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_instances">performance_schema_max_rwlock_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          インストゥルメントされる rwlock オブジェクトの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_socket_classes"></a>
          <a class="indexterm" name="idm139979004395008"></a> <a class="indexterm" name="idm139979004393408"></a> <code class="literal">performance_schema_max_socket_classes</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_socket_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_socket_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_classes">performance_schema_max_socket_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr></tbody></table></div><p>
          ソケットインストゥルメントの最大数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_socket_instances"></a>
          <a class="indexterm" name="idm139979004367536"></a> <a class="indexterm" name="idm139979004365936"></a> <code class="literal">performance_schema_max_socket_instances</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_socket_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_socket_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_instances">performance_schema_max_socket_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          インストゥルメントされるソケットオブジェクトの最大数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_stage_classes"></a>
          <a class="indexterm" name="idm139979004334064"></a> <a class="indexterm" name="idm139979004332464"></a> <code class="literal">performance_schema_max_stage_classes</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_stage_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_stage_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_stage_classes">performance_schema_max_stage_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">150</code></td></tr></tbody></table></div><p>
          ステージインストゥルメントの最大数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_statement_classes"></a>
          <a class="indexterm" name="idm139979004306544"></a> <a class="indexterm" name="idm139979004304928"></a> <code class="literal">performance_schema_max_statement_classes</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_statement_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_statement_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_classes">performance_schema_max_statement_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">(autosized)</code></td></tr></tbody></table></div><p>
          ステートメントインストゥルメントの最大数。デフォルト値は、サーバー構築時に、クライアント/サーバープロトコルのコマンド数とサーバーでサポートされる SQL ステートメントの種類の数に基づいて計算されます。
        </p><p>
          この変数は、それを 0 に設定して、すべてのステートメントインストゥルメンテーションを無効にし、それに関連付けられているすべてのメモリーを節約しないかぎり、変更するべきではありません。変数をデフォルトでない 0 以外の値に設定してもメリットはありません。特にデフォルトより大きい値は、必要以上のメモリーが割り当てられます。
        </p><p>
          この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_table_handles"></a>
          <a class="indexterm" name="idm139979004277040"></a> <a class="indexterm" name="idm139979004275440"></a> <code class="literal">performance_schema_max_table_handles</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_table_handles" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_table_handles=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_handles">performance_schema_max_table_handles</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">100000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          オープンしているテーブルオブジェクトの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_table_instances"></a>
          <a class="indexterm" name="idm139979004245552"></a> <a class="indexterm" name="idm139979004243952"></a> <code class="literal">performance_schema_max_table_instances</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_table_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_table_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_instances">performance_schema_max_table_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">50000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          インストゥルメントされるテーブルオブジェクトの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_thread_classes"></a>
          <a class="indexterm" name="idm139979004214032"></a> <a class="indexterm" name="idm139979004212432"></a> <code class="literal">performance_schema_max_thread_classes</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_thread_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_thread_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_classes">performance_schema_max_thread_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">50</code></td></tr></tbody></table></div><p>
          スレッドインストゥルメントの最大数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_thread_instances"></a>
          <a class="indexterm" name="idm139979004188512"></a> <a class="indexterm" name="idm139979004186912"></a> <code class="literal">performance_schema_max_thread_instances</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_max_thread_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_thread_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances">performance_schema_max_thread_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table></div><p>
          インストゥルメントされるスレッドオブジェクトの最大数。この値は <code class="literal">threads</code> テーブルのサイズを制御します。この最大を超えたため、スレッドをインストゥルメントできない場合、パフォーマンススキーマは <code class="literal">Performance_schema_thread_instances_lost</code> ステータス変数を増分します。
        </p><p>
          <code class="literal">max_connections</code> システム変数はサーバーで実行するスレッド数に影響します。<code class="literal">performance_schema_max_thread_instances</code> はこれらの実行中のスレッドのうちインストゥルメント可能なスレッド数に影響します。<code class="literal">performance_schema_max_thread_instances</code> のデフォルト値は、<code class="literal">max_connections</code> の値に基づいて自動サイズ設定されます。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_session_connect_attrs_size"></a>
          <a class="indexterm" name="idm139979004149712"></a> <a class="indexterm" name="idm139979004148080"></a> <code class="literal">performance_schema_session_connect_attrs_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_session_connect_attrs_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.6</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_session_connect_attrs_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_session_connect_attrs_size">performance_schema_session_connect_attrs_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>最小値</strong></span></td><td colspan="2"><code class="literal">-1</code></td></tr><tr><td scope="row"><span class="bold"><strong>最大値</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table></div><p>
          接続属性文字列を保持するために使用される、スレッドごとに事前割り当てされるメモリーの量。接続属性文字列が予約されたストレージより大きい場合、<code class="literal">Performance_schema_session_connect_attrs_lost</code> ステータス変数が増分されます。この変数は MySQL 5.6.7 で追加されました。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_setup_actors_size"></a>
          <a class="indexterm" name="idm139979004116240"></a> <a class="indexterm" name="idm139979004114640"></a> <code class="literal">performance_schema_setup_actors_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_setup_actors_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.1</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_setup_actors_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_actors_size">performance_schema_setup_actors_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">100</code></td></tr></tbody></table></div><p>
          <code class="literal">setup_actors</code> テーブル内の行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_setup_objects_size"></a>
          <a class="indexterm" name="idm139979004088016"></a> <a class="indexterm" name="idm139979004086416"></a> <code class="literal">performance_schema_setup_objects_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_setup_objects_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.1</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_setup_objects_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_objects_size">performance_schema_setup_objects_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>許可されている値</strong></span></td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">100</code></td></tr></tbody></table></div><p>
          <code class="literal">setup_objects</code> テーブル内の行数。
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_users_size"></a>
          <a class="indexterm" name="idm139979004059840"></a> <a class="indexterm" name="idm139979004058368"></a> <code class="literal">performance_schema_users_size</code>
        </p><div class="informaltable"><table summary="Options for performance_schema_users_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>導入</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>コマンド行形式</strong></span></td><td colspan="3"><code class="literal">--performance_schema_users_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>システム変数</strong></span></td><td><span class="bold"><strong>名前</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_users_size">performance_schema_users_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>変数スコープ</strong></span></td><td colspan="2">グローバル</td></tr><tr><td scope="row"><span class="bold"><strong>動的変数</strong></span></td><td colspan="2">いいえ</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>許可されている値</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row"><span class="bold"><strong>最小値</strong></span></td><td colspan="2"><code class="literal">0</code></td></tr><tr><td scope="row"><span class="bold"><strong>最大値</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>許可されている値</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>型</strong></span></td><td colspan="2"><code class="literal">数値</code></td></tr><tr><td scope="row"><span class="bold"><strong>デフォルト</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>最小値</strong></span></td><td colspan="2"><code class="literal">-1</code></td></tr><tr><td scope="row"><span class="bold"><strong>最大値</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table></div><p>
          <code class="literal">users</code> テーブル内の行数。この変数が 0 の場合、パフォーマンススキーマは <code class="literal">users</code> テーブル内の接続統計を保守しません。この変数は MySQL 5.6.3 で追加されました。
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-status-variables"></a>22.13 パフォーマンススキーマステータス変数</h2></div></div></div><p>
      パフォーマンススキーマは、メモリー制約のためロードまたは作成できなかったインストゥルメンテーションついての情報を提供するいくつかのステータス変数を実装しています。
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'perf%';</code></strong>
+-------------------------------------------+-------+
| Variable_name                             | Value |
+-------------------------------------------+-------+
| Performance_schema_accounts_lost          | 0     |
| Performance_schema_cond_classes_lost      | 0     |
| Performance_schema_cond_instances_lost    | 0     |
| Performance_schema_file_classes_lost      | 0     |
| Performance_schema_file_handles_lost      | 0     |
| Performance_schema_file_instances_lost    | 0     |
| Performance_schema_hosts_lost             | 0     |
| Performance_schema_locker_lost            | 0     |
| Performance_schema_mutex_classes_lost     | 0     |
| Performance_schema_mutex_instances_lost   | 0     |
| Performance_schema_rwlock_classes_lost    | 0     |
| Performance_schema_rwlock_instances_lost  | 0     |
| Performance_schema_socket_classes_lost    | 0     |
| Performance_schema_socket_instances_lost  | 0     |
| Performance_schema_stage_classes_lost     | 0     |
| Performance_schema_statement_classes_lost | 0     |
| Performance_schema_table_handles_lost     | 0     |
| Performance_schema_table_instances_lost   | 0     |
| Performance_schema_thread_classes_lost    | 0     |
| Performance_schema_thread_instances_lost  | 0     |
| Performance_schema_users_lost             | 0     |
+-------------------------------------------+-------+
</pre><p>
      パフォーマンススキーマステータス変数には次の意味があります。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="statvar_Performance_schema_accounts_lost"></a>
          <code class="literal">Performance_schema_accounts_lost</code>
        </p><p>
          <code class="literal">accounts</code> テーブルがいっぱいであったため、行を追加できなかった回数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_cond_classes_lost"></a>
          <code class="literal">Performance_schema_cond_classes_lost</code>
        </p><p>
          ロードできなかった条件インストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_cond_instances_lost"></a>
          <code class="literal">Performance_schema_cond_instances_lost</code>
        </p><p>
          作成できなかった条件インストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_digest_lost"></a>
          <code class="literal">Performance_schema_digest_lost</code>
        </p><p>
          <code class="literal">events_statements_summary_by_digest</code> テーブルにインストゥルメントできなかったダイジェストインスタンスの数。<code class="literal">performance_schema_digests_size</code> の値が小さすぎる場合、これは 0 以外になることがあります。この変数は MySQL 5.6.5 で追加されました。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_classes_lost"></a>
          <code class="literal">Performance_schema_file_classes_lost</code>
        </p><p>
          ロードできなかったファイルインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_handles_lost"></a>
          <code class="literal">Performance_schema_file_handles_lost</code>
        </p><p>
          オープンできなかったファイルインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_instances_lost"></a>
          <code class="literal">Performance_schema_file_instances_lost</code>
        </p><p>
          作成できなかったファイルインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_hosts_lost"></a>
          <code class="literal">Performance_schema_hosts_lost</code>
        </p><p>
          <code class="literal">hosts</code> テーブルがいっぱいであったため、行を追加できなかった回数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_locker_lost"></a>
          <code class="literal">Performance_schema_locker_lost</code>
        </p><p>
          次の状況のため、<span class="quote">「<span class="quote">失われる</span>」</span>か記録されないイベント数。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              イベントが再帰的です (たとえば、A を待機することによって B で待機が発生し、それによって C で待機が発生したなど)。
            </p></li><li class="listitem"><p>
              ネストしたイベントスタックの深さが、実装によって課せられる制限より大きいです。
            </p></li></ul></div><p>
          現在、パフォーマンススキーマによって記録されるイベントは再帰的でないため、この変数は常に 0 になるはずです。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_mutex_classes_lost"></a>
          <code class="literal">Performance_schema_mutex_classes_lost</code>
        </p><p>
          ロードできなかった相互排他ロックインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_mutex_instances_lost"></a>
          <code class="literal">Performance_schema_mutex_instances_lost</code>
        </p><p>
          作成できなかった相互排他ロックインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_rwlock_classes_lost"></a>
          <code class="literal">Performance_schema_rwlock_classes_lost</code>
        </p><p>
          ロードできなかった rwlock インストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_rwlock_instances_lost"></a>
          <code class="literal">Performance_schema_rwlock_instances_lost</code>
        </p><p>
          作成できなかった rwlock インストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_session_connect_attrs_lost"></a>
          <code class="literal">Performance_schema_session_connect_attrs_lost</code>
        </p><p>
          接続属性文字列が予約されたストレージより大きかった回数。この変数は MySQL 5.6.7 で追加されました。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_socket_classes_lost"></a>
          <code class="literal">Performance_schema_socket_classes_lost</code>
        </p><p>
          ロードできなかったソケットインストゥルメントの数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_socket_instances_lost"></a>
          <code class="literal">Performance_schema_socket_instances_lost</code>
        </p><p>
          作成できなかったソケットインストゥルメントインスタンスの数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_stage_classes_lost"></a>
          <code class="literal">Performance_schema_stage_classes_lost</code>
        </p><p>
          ロードできなかったステージインストゥルメントの数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_statement_classes_lost"></a>
          <code class="literal">Performance_schema_statement_classes_lost</code>
        </p><p>
          ロードできなかったステートメントインストゥルメントの数。この変数は MySQL 5.6.3 で追加されました。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_table_handles_lost"></a>
          <code class="literal">Performance_schema_table_handles_lost</code>
        </p><p>
          オープンできなかったテーブルインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_table_instances_lost"></a>
          <code class="literal">Performance_schema_table_instances_lost</code>
        </p><p>
          作成できなかったテーブルインストゥルメントインスタンスの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_thread_classes_lost"></a>
          <code class="literal">Performance_schema_thread_classes_lost</code>
        </p><p>
          ロードできなかったスレッドインストゥルメントの数。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_thread_instances_lost"></a>
          <code class="literal">Performance_schema_thread_instances_lost</code>
        </p><p>
          <code class="literal">threads</code> テーブルにインストゥルメントできなかったスレッドインスタンスの数。<code class="literal">performance_schema_max_thread_instances</code> の値が小さすぎる場合、これは 0 以外になることがあります。
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_users_lost"></a>
          <code class="literal">Performance_schema_users_lost</code>
        </p><p>
          <code class="literal">users</code> テーブルがいっぱいであったため、行を追加できなかった回数。この変数は MySQL 5.6.3 で追加されました。
        </p></li></ul></div><p>
      これらの変数を使用して、パフォーマンススキーマのステータスをチェックすることについては、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="22.5 パフォーマンススキーマステータスモニタリング">セクション22.5「パフォーマンススキーマステータスモニタリング」</a>を参照してください。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-and-plugins"></a>22.14 パフォーマンススキーマとプラグイン</h2></div></div></div><p>
      <code class="literal">UNINSTALL PLUGIN</code> によってプラグインを削除することは、そのプラグインのコードですでに収集された情報には影響しません。プラグインのロード中にコードの実行に費やされた時間は、プラグインがあとでアンロードされた場合でも費やされます。集計情報を含む関連付けられたイベント情報は、<code class="literal">performance_schema</code> データベーステーブルで読み取り可能なままになります。プラグインのインストールと削除の効果の追加情報については、<a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="22.5 パフォーマンススキーマステータスモニタリング">セクション22.5「パフォーマンススキーマステータスモニタリング」</a>を参照してください。
    </p><p>
      プラグインコードをインストゥルメントするプラグイン実装者は、プラグインをロードするユーザーがその要件を把握できるように、インストゥルメンテーションの特性をドキュメント化してください。たとえば、サードパーティーストレージエンジンでは、そのドキュメントに、エンジンが相互排他ロックおよびその他のインストゥルメントに必要とするメモリーの量を記載してください。
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-schema-examples"></a>22.15 問題を診断するためのパフォーマンススキーマの使用</h2></div></div></div><a class="indexterm" name="idm139979003930816"></a><a class="indexterm" name="idm139979003928576"></a><p>
      パフォーマンススキーマは、DBA が<span class="quote">「<span class="quote">大まかな推量</span>」</span>ではなく、実際に測定して、パフォーマンスのチューニングを行うのに役立つツールです。このセクションでは、この目的でパフォーマンススキーマを使用するいくつかの方法について説明します。ここでの説明は、<a class="xref" href="performance-schema.html#performance-schema-filtering" title="22.2.3.2 パフォーマンススキーマイベントフィルタリング">セクション22.2.3.2「パフォーマンススキーマイベントフィルタリング」</a>で説明しているイベントフィルタリングの使用に依存します。
    </p><p>
      次の例では、パフォーマンスボトルネックの調査など、反復される問題の分析に使用できる 1 つの方法を示しています。開始するには、パフォーマンスが<span class="quote">「<span class="quote">遅すぎる</span>」</span>とみなされ、最適化が必要な反復可能なユースケースが必要であり、すべてのインストゥルメンテーションを有効にすべきです (事前フィルタリングなし)。
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          ユースケースを実行します。
        </p></li><li class="listitem"><p>
          パフォーマンススキーマテーブルを使用して、パフォーマンスの問題の原因を分析します。この分析は事後フィルタリングに大きく依存します。
        </p></li><li class="listitem"><p>
          除外する問題領域については、対応するインストゥルメントを無効にします。たとえば、問題が特定のストレージエンジンのファイル I/O に関連していないことが分析に示されている場合、そのエンジンのファイル I/O インストゥルメントを無効にします。次に、履歴およびサマリーテーブルを切り捨て、これまでに収集されたイベントを削除します。
        </p></li><li class="listitem"><p>
          ステップ 1 のプロセスを繰り返します。
        </p><p>
          繰り返しのたびに、パフォーマンススキーマの出力、特に <code class="literal">events_waits_history_long</code> テーブルに格納される、無意味なインストゥルメントによって発生する<span class="quote">「<span class="quote">ノイズ</span>」</span>が減っていき、このテーブルが固定のサイズである場合、当面の問題の分析に関連するデータが増えていきます。
        </p><p>
          繰り返しのたびに、調査は問題の原因に近づいていくはずであり、<span class="quote">「<span class="quote">シグナル/ノイズ</span>」</span>率が改善するにつれて、分析が簡単になります。
        </p></li><li class="listitem"><p>
          パフォーマンスボトルネックの原因を突き止めたら、次のような適切な修正措置をとります。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              サーバーパラメータ (キャッシュサイズ、メモリーなど) をチューニングします。
            </p></li><li class="listitem"><p>
              クエリーを違う方法で書いてチューニングします。
            </p></li><li class="listitem"><p>
              データベーススキーマ (テーブル、インデックスなど) をチューニングします。
            </p></li><li class="listitem"><p>
              コードをチューニングします (これはストレージエンジンまたはサーバー開発者のみに適用されます)。
            </p></li></ul></div></li><li class="listitem"><p>
          ステップ 1 から再開して、パフォーマンスへの変更の効果を確認します。
        </p></li></ol></div><p>
      <code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code> および <code class="literal">rwlock_instances.WRITE_LOCKED_BY_THREAD_ID</code> カラムは、パフォーマンスボトルネックまたはデッドロックの調査にきわめて重要です。これは、次のようなパフォーマンススキーマインストゥルメンテーションによって可能になります。
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          スレッド 1 は相互排他ロックを待機してスタックしているとします。
        </p></li><li class="listitem"><p>
          スレッドが何を待機しているかを特定できます。
        </p><pre class="programlisting">
SELECT * FROM events_waits_current WHERE THREAD_ID = <em class="replaceable"><code>thread_1</code></em>;
</pre><p>
          たとえば、<code class="literal">events_waits_current.OBJECT_INSTANCE_BEGIN</code> にあるように、スレッドが相互排他ロック A を待機していることがクエリー結果に示されます。
        </p></li><li class="listitem"><p>
          相互排他ロック A を保持しているスレッドを特定できます。
        </p><pre class="programlisting">
SELECT * FROM mutex_instances WHERE OBJECT_INSTANCE_BEGIN = <em class="replaceable"><code>mutex_A</code></em>;
</pre><p>
          たとえば、<code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code> にあるように、相互排他ロック A を保持しているのがスレッド 2 であることがクエリー結果に示されます。
        </p></li><li class="listitem"><p>
          スレッド 2 が何を実行しているかを確認できます。
        </p><pre class="programlisting">
SELECT * FROM events_waits_current WHERE THREAD_ID = <em class="replaceable"><code>thread_2</code></em>;
</pre></li></ol></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="information-schema.html">前</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="connectors-apis.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第 21 章 INFORMATION_SCHEMA テーブル </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 第 23 章 Connector および API</td></tr></table></div><div class="copyright-footer"></div></body></html>
